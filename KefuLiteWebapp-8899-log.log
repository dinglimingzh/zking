2018-12-30 18:00:00,112 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:00,197 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:00,203 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:00,710 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:00,715 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:00,919 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:02,113 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:02,190 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:02,194 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:02,709 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:02,714 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:02,919 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:04,112 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:04,191 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:04,198 INFO  [consumer-kf:schedule:signal:a-7-thread-46]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:04,715 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:04,720 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:04,919 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:06,113 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:06,190 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:06,194 INFO  [consumer-kf:schedule:signal:a-7-thread-6]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:06,712 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:06,717 INFO  [consumer-kf:schedule:signal:a-7-thread-25]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:06,942 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:08,113 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:08,198 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:08,202 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:08,718 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:08,722 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:08,919 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:10,113 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:10,189 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:10,193 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:10,709 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:10,714 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:10,919 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:12,113 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:12,191 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:12,195 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:12,715 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:12,720 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:12,919 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:00 start
2018-12-30 18:00:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:00
2018-12-30 18:00:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:00 complete
2018-12-30 18:00:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:00:14,113 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:14,190 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:14,194 INFO  [consumer-kf:schedule:signal:a-7-thread-46]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:14,712 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:14,717 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:14,932 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:16,113 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:16,192 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:16,197 INFO  [consumer-kf:schedule:signal:a-7-thread-6]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:16,709 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:16,714 INFO  [consumer-kf:schedule:signal:a-7-thread-25]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:16,934 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:18,113 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:18,193 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:18,198 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:18,771 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:18,776 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:18,920 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:20,117 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:20,193 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:20,197 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:20,731 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:20,736 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:20,920 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:22,113 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:22,191 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:22,195 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:22,711 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:22,715 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:22,920 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:24,117 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:24,194 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:24,198 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:24,711 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:24,716 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:24,920 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:26,113 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:26,192 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:26,196 INFO  [consumer-kf:schedule:signal:a-7-thread-6]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:26,713 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:26,717 INFO  [consumer-kf:schedule:signal:a-7-thread-25]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:26,920 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:28,113 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:28,196 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:28,201 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:28,710 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:28,717 INFO  [consumer-kf:schedule:signal:a-7-thread-35]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:28,920 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:30,114 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:30,194 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:30,198 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:30,726 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:30,731 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:30,931 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:32,114 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:32,197 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:32,201 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:32,735 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:32,740 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:32,920 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:00 start
2018-12-30 18:00:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:00
2018-12-30 18:00:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:00 complete
2018-12-30 18:00:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:00:34,113 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:34,192 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:34,198 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:34,717 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:34,722 INFO  [consumer-kf:schedule:signal:a-7-thread-18]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:34,920 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:36,142 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:36,192 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:36,195 INFO  [consumer-kf:schedule:signal:a-7-thread-25]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:36,715 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:36,720 INFO  [consumer-kf:schedule:signal:a-7-thread-42]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:36,920 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:38,114 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:38,192 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:38,196 INFO  [consumer-kf:schedule:signal:a-7-thread-35]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:38,754 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:38,759 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:38,931 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:40,114 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:40,208 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:40,218 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:40,728 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:40,733 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:40,921 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:42,114 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:42,194 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:42,198 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:42,715 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:42,720 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:42,921 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:44,114 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:44,193 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:44,197 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:44,713 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:44,718 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:44,921 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:46,114 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:46,200 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:46,205 INFO  [consumer-kf:schedule:signal:a-7-thread-42]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:46,725 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:46,729 INFO  [consumer-kf:schedule:signal:a-7-thread-37]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:46,921 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:47,394 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.VisitorUserWaittingDataService - the tenantIds for visitoruser waiting data are empty.
2018-12-30 18:00:48,114 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:48,194 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:48,198 INFO  [consumer-kf:schedule:signal:a-7-thread-35]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:48,729 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:48,733 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:48,921 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:50,114 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:50,193 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:50,197 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:50,720 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:50,726 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:50,921 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:52,114 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:52,197 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:52,205 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:52,762 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:52,780 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:52,921 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:00 start
2018-12-30 18:00:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:00
2018-12-30 18:00:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:00 complete
2018-12-30 18:00:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:00:54,114 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:54,236 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:54,241 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:54,717 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:54,722 INFO  [consumer-kf:schedule:signal:a-7-thread-18]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:54,921 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:55,596 INFO  [kf-webapp-scheduler-pool-5]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:00:55,596 INFO  [kf-webapp-scheduler-pool-5]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:00:56,114 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:56,196 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:56,200 INFO  [consumer-kf:schedule:signal:a-7-thread-42]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:56,713 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:56,717 INFO  [consumer-kf:schedule:signal:a-7-thread-37]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:56,921 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:00:58,114 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:00:58,193 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:00:58,198 INFO  [consumer-kf:schedule:signal:a-7-thread-35]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:00:58,715 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:00:58,720 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:00:58,923 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:00,114 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:00,205 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:00,209 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:00,713 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:00,717 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:00,922 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:02,114 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:02,205 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:02,210 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:02,720 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:02,725 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:02,922 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:03,085 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotAgentIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Sun, 30 Dec 2018 10:01:03 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@4e36bd5c 
2018-12-30 18:01:03,085 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotAgentIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2018-12-30 18:01:03,092 ERROR [http-nio-8899-exec-4]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 43, robotAgentId : 0fd687f3-09be-4919-b533-3d89c613590e
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2018-12-30 18:01:03,099 ERROR [http-nio-8899-exec-4]  c.e.w.rest.mvc.agent.HomeController - robotFeignClient getRobotUserById occur exception, userId : 0fd687f3-09be-4919-b533-3d89c613590e
com.easemob.weichat.models.exception.EasemobException: no available robot
	at com.easemob.weichat.service.robot.KefuRobotIntegrationUtil.getRobotUserById(KefuRobotIntegrationUtil.java:147)
	at com.easemob.weichat.rest.mvc.agent.HomeController.checkRobot(HomeController.java:115)
	at com.easemob.weichat.rest.mvc.agent.HomeController.getInitData(HomeController.java:71)
	at sun.reflect.GeneratedMethodAccessor1327.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:799)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2018-12-30 18:01:03,102 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d0f602d0-0c19-11e9-83fa-4112db660c72","type":"com.easemob.weichat.service.events.agent.AgentInitDataEvent","timestamp":1546164063101,"body":{"source":{},"timestamp":1546164063101,"actor":{"bizId":"43","userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"},"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":null,"eventTime":1546164063101,"kickOff":true}} has been send to kafka with in topic events partition 2, current offset is 3515
2018-12-30 18:01:03,104 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=d0f602d0-0c19-11e9-83fa-4112db660c72, service=null, type=com.easemob.weichat.service.events.agent.AgentInitDataEvent, timestamp=1546164063101, properties={}, body={source={}, timestamp=1546164063101, actor={bizId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, roles=agent}, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser=null, eventTime=1546164063101, kickOff=true}, topic=events, partitionKey=43:0fd687f3-09be-4919-b533-3d89c613590e).
2018-12-30 18:01:03,142 INFO  [http-nio-8899-exec-15]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":298}
2018-12-30 18:01:03,146 INFO  [http-nio-8899-exec-6]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, userResourceData : UserResourceData(method=GET, url=/agents/0fd687f3-09be-4919-b533-3d89c613590e)
2018-12-30 18:01:03,149 INFO  [http-nio-8899-exec-6]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, hasPermission : true
2018-12-30 18:01:03,153 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.a.v0.AgentsApiV0Controller - AccountController getAgentInfo start, params: tenantId=43,userId=0fd687f3-09be-4919-b533-3d89c613590e
2018-12-30 18:01:03,154 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.a.v0.AgentsApiV0Controller - AccountController getAgentInfo end, result: tenantId=43,userId=0fd687f3-09be-4919-b533-3d89c613590e,agentUserData=AgentUserData(agentId=0fd687f3-09be-4919-b533-3d89c613590e, nickname=, username=lszbz@zking.com, trueName=, roles=agent, createdAt=2018-12-27 01:22:45.0, updatedAt=2018-12-29 20:11:27.0, mobilePhone=, agentNumber=null, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300, status=Enable, userType=Agent, language=zh_CN, timeZone=UTC+8)
2018-12-30 18:01:03,270 INFO  [http-nio-8899-exec-2]  c.e.w.r.permission.UsersController - queryResourceCategoriesByUser | obtain request, tenantId : 43 , userId : 0fd687f3-09be-4919-b533-3d89c613590e
2018-12-30 18:01:03,270 INFO  [http-nio-8899-exec-2]  c.e.w.r.permission.UsersController - queryResourceCategoriesByUser success, tenantId : 43 , userId : 0fd687f3-09be-4919-b533-3d89c613590e, userResourceCategoryData : UserResourceCategoryData(userId=0fd687f3-09be-4919-b533-3d89c613590e, resourceCategories=[agent_sessionhistory, agent_quality_appealrecord, agent_knowledgebase, agent_quality_qualityrecord, agent_queue, agent_search, agent_phrase, agent_statistics, agent_quality, agent_currentsession, agent_ticket, agent_agentinfo, agent_export, agent_activity])
2018-12-30 18:01:03,524 INFO  [http-nio-8899-exec-11]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":307}
2018-12-30 18:01:03,529 INFO  [http-nio-8899-exec-4]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, userResourceData : UserResourceData(method=GET, url=/agents/0fd687f3-09be-4919-b533-3d89c613590e/skillgroups)
2018-12-30 18:01:03,532 INFO  [http-nio-8899-exec-4]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, hasPermission : true
2018-12-30 18:01:03,689 INFO  [http-nio-8899-exec-6]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":294}
2018-12-30 18:01:03,694 INFO  [http-nio-8899-exec-12]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, userResourceData : UserResourceData(method=GET, url=/tenants/43)
2018-12-30 18:01:03,696 INFO  [http-nio-8899-exec-12]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, hasPermission : true
2018-12-30 18:01:03,704 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.a.v.TenantsApiV0Controller - /tenants/43  GET end: tenantData:TenantData(name=, description=, phone=+8618625569898, address=3718, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, logo=null, agentMaxNum=0, agentMaxOnlineNum=null, agentMaxEnableNum=null, domain=null, grade=STANDARD, isExperience=null, language=zh_CN, timeZone=UTC+8, status=Enable, createAt=2018-12-16 21:25:40.0, updateAt=2018-12-28 01:30:01.0, agreementExpireTime=null).
2018-12-30 18:01:04,115 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:04,198 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:04,206 INFO  [consumer-kf:schedule:signal:a-7-thread-18]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:04,399 INFO  [http-nio-8899-exec-3]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":453}
2018-12-30 18:01:04,845 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:04,851 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:04,922 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:05,899 INFO  [http-nio-8899-exec-14]  c.e.w.n.handler.MainHandler - session connected wsId:2zdz3nv2 count:5
2018-12-30 18:01:06,115 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:06,230 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:06,233 INFO  [consumer-kf:schedule:signal:a-7-thread-37]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:06,635 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.impl.StrangerSessionFSM - StrangerSessionFSM wsId:2zdz3nv2 handleMessage:{"token":"3874264b-147f-4bfb-a084-46b8be352b7b"}
2018-12-30 18:01:06,714 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:06,717 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthenticatedSessionFSM - AuthenticatedSessionFSM wsId:2zdz3nv2 handleMessage:{"path":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:06,718 INFO  [http-nio-8899-exec-4]  c.e.w.n.service.AmqpService - declare queue wsId:2zdz3nv2 name:/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788
2018-12-30 18:01:06,718 INFO  [consumer-kf:pool:agentstate-19-thread-1]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent 0fd687f3-09be-4919-b533-3d89c613590e connected, workstate Hidden ttl:-2
2018-12-30 18:01:06,719 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d31debea-0c19-11e9-b7d3-abbe7f663a4d","type":"com.easemob.weichat.service.events.agent.AgentUserConnectedEvent","timestamp":1546164066718,"body":{"source":{},"timestamp":1546164066718,"actor":null,"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":null,"eventTime":1546164066718,"kickOff":true}} has been send to kafka with in topic events partition 2, current offset is 3516
2018-12-30 18:01:06,719 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:06,724 INFO  [http-nio-8899-exec-4]  c.e.w.n.service.AmqpService - declare binding wsId:2zdz3nv2 queueName:Queue [name=/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788, durable=false, autoDelete=false, exclusive=false, arguments={x-expires=30000}] routingKey:tenants.43.agents
2018-12-30 18:01:06,724 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=d31debea-0c19-11e9-b7d3-abbe7f663a4d, service=null, type=com.easemob.weichat.service.events.agent.AgentUserConnectedEvent, timestamp=1546164066718, properties={}, body={source={}, timestamp=1546164066718, actor=null, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser=null, eventTime=1546164066718, kickOff=true}, topic=events, partitionKey=43:0fd687f3-09be-4919-b533-3d89c613590e).
2018-12-30 18:01:06,726 INFO  [http-nio-8899-exec-4]  c.e.w.n.service.AmqpService - declare binding wsId:2zdz3nv2 queueName:Queue [name=/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788, durable=false, autoDelete=false, exclusive=false, arguments={x-expires=30000}] routingKey:tenants.43.agents.0fd687f3-09be-4919-b533-3d89c613590e.#
2018-12-30 18:01:06,922 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:07,046 INFO  [http-nio-8899-exec-14]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":271}
2018-12-30 18:01:07,065 INFO  [http-nio-8899-exec-5]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":267}
2018-12-30 18:01:07,074 WARN  [hystrix-KFRulai-50]  c.e.w.s.r.u.f.RulaiFeignClient$HystrixClientFallback - RulaiFeignClient method getState with param easemob_43 fallback
2018-12-30 18:01:07,085 INFO  [http-nio-8899-exec-4]  c.e.w.r.mvc.tenant.TenantController - TenantController | getExpireData start. tenantId:43
2018-12-30 18:01:07,087 INFO  [http-nio-8899-exec-4]  c.e.w.r.mvc.tenant.TenantController - TenantController | getExpireData end. tenantId:43,map:{}
2018-12-30 18:01:07,324 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:07,325 INFO  [consumer-kf:pool:agentstate-19-thread-1]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent 0fd687f3-09be-4919-b533-3d89c613590e keepalive, workstate Hidden
2018-12-30 18:01:07,326 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d37ab1e0-0c19-11e9-99a7-89a49d2c0ea1","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164067326,"body":{"source":{},"timestamp":1546164067326,"actor":null,"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164067326,"status":"Hidden","kickOff":false}} has been send to kafka with in topic events partition 2, current offset is 3517
2018-12-30 18:01:07,328 INFO  [kafka-events-consumer-1-thread-15]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:0fd687f3-09be-4919-b533-3d89c613590e,agentState:Hidden
2018-12-30 18:01:07,328 INFO  [kafka-events-consumer-1-thread-15]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = 0fd687f3-09be-4919-b533-3d89c613590e] status changed to Hidden
2018-12-30 18:01:07,329 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=d37ab1e0-0c19-11e9-99a7-89a49d2c0ea1, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164067326, properties={}, body={source={}, timestamp=1546164067326, actor=null, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userType=Agent, userScope=Tenant, nicename=, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-12-27 01:22:45, lastUpdateDateTime=2018-12-29 20:11:27, firstLoginTimeOfRecentDay=2018-12-29 16:15:21, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164067326, status=Hidden, kickOff=false}, topic=events, partitionKey=43:0fd687f3-09be-4919-b533-3d89c613590e).
2018-12-30 18:01:07,329 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d37b000a-0c19-11e9-b5b6-f908ec91fc7f","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164067328,"body":{"source":{},"timestamp":1546164067328,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164067326,"actor":null,"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164067326,"status":"Hidden","kickOff":false}}],"broadcast":true}}} has been send to kafka with in topic events partition 17, current offset is 3031
2018-12-30 18:01:07,329 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164067326,"actor":null,"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164067326,"status":"Hidden","kickOff":false}}],"timestamp":1546164067328,"type":null}
2018-12-30 18:01:07,329 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - prepare message noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:bfbnlzqk noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f messageType:AgentUserStateChange
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:aniu0ppp noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f messageType:AgentUserStateChange
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:qqwgjyob noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f messageType:AgentUserStateChange
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f messageType:AgentUserStateChange
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:bfbnlzqk noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:aniu0ppp noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:qqwgjyob noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,330 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,331 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:fiek5iwl noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f messageType:AgentUserStateChange
2018-12-30 18:01:07,331 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:fiek5iwl noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,331 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=d37b000a-0c19-11e9-b5b6-f908ec91fc7f, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164067328, properties={}, body={source={}, timestamp=1546164067328, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164067326, actor=null, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userType=Agent, userScope=Tenant, nicename=, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-12-27 01:22:45, lastUpdateDateTime=2018-12-29 20:11:27, firstLoginTimeOfRecentDay=2018-12-29 16:15:21, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164067326, status=Hidden, kickOff=false}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:01:07,336 INFO  [http-nio-8899-exec-14]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":334}
2018-12-30 18:01:07,360 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"noticeId":"e564703b-b9df-4f8b-bf14-6048c298b25f"}
2018-12-30 18:01:07,360 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:qqwgjyob noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,361 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"noticeId":"e564703b-b9df-4f8b-bf14-6048c298b25f"}
2018-12-30 18:01:07,361 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:fiek5iwl noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,369 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"noticeId":"e564703b-b9df-4f8b-bf14-6048c298b25f"}
2018-12-30 18:01:07,369 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:bfbnlzqk noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,375 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"noticeId":"e564703b-b9df-4f8b-bf14-6048c298b25f"}
2018-12-30 18:01:07,375 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:aniu0ppp noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,388 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"e564703b-b9df-4f8b-bf14-6048c298b25f"}
2018-12-30 18:01:07,388 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:e564703b-b9df-4f8b-bf14-6048c298b25f
2018-12-30 18:01:07,548 INFO  [http-nio-8899-exec-9]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"0fd687f3-09be-4919-b533-3d89c613590e","tenantId":43,"type":"StateChange"}}],"timestamp":1546164067444,"type":null}
2018-12-30 18:01:07,548 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:1492a088-7658-4b85-81ab-147a20dd73d4 message:{"path":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"0fd687f3-09be-4919-b533-3d89c613590e","tenantId":43,"type":"StateChange"}}],"timestamp":1546164067444,"type":null}
2018-12-30 18:01:07,548 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.PushDataService - prepare message noticeId:1492a088-7658-4b85-81ab-147a20dd73d4 messageType:Daas path:/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e
2018-12-30 18:01:07,549 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:1492a088-7658-4b85-81ab-147a20dd73d4 messageType:Daas
2018-12-30 18:01:07,549 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:1492a088-7658-4b85-81ab-147a20dd73d4
2018-12-30 18:01:07,578 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"1492a088-7658-4b85-81ab-147a20dd73d4"}
2018-12-30 18:01:07,578 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:1492a088-7658-4b85-81ab-147a20dd73d4
2018-12-30 18:01:07,816 INFO  [http-nio-8899-exec-12]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":283}
2018-12-30 18:01:08,115 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:08,204 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:08,208 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:08,744 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:08,749 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:08,922 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:09,136 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:10,115 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:10,199 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:10,204 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:10,739 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:10,744 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:10,922 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:11,137 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:12,115 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:12,169 INFO  [http-nio-8899-exec-11]  c.e.w.r.mvc.agent.AccountController - The agentUser 0fd687f3-09be-4919-b533-3d89c613590e update agent state, status:AgentStatusRequest(agentStatus=Online)
2018-12-30 18:01:12,171 INFO  [http-nio-8899-exec-11]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log : agent 0fd687f3-09be-4919-b533-3d89c613590e status change to Online
2018-12-30 18:01:12,171 INFO  [http-nio-8899-exec-11]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log session exists: agent 0fd687f3-09be-4919-b533-3d89c613590e status change to Online
2018-12-30 18:01:12,171 INFO  [http-nio-8899-exec-11]  c.e.w.service.agent.AgentUserService - update agent end, agentUser:AgentUser{agentNumber=null, username='lszbz@zking.com', roles='agent', status=Enable, state=Hidden, maxServiceSessionCount=5, trueName='', mobilePhone='', connected=false, realState=null}
2018-12-30 18:01:12,171 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d65dd4a0-0c19-11e9-b87d-6b6cbfdacae5","type":"com.easemob.weichat.service.events.agent.AgentUserStateAttributeChangeEvent","timestamp":1546164072170,"body":{"source":{},"timestamp":1546164072170,"actor":{"bizId":"43","userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"},"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164072170,"status":"Online","kickOff":true}} has been send to kafka with in topic events partition 2, current offset is 3518
2018-12-30 18:01:12,172 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d65dfbb0-0c19-11e9-be70-cd8595efb387","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164072171,"body":{"source":{},"timestamp":1546164072171,"actor":{"bizId":"43","userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"},"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164072171,"status":"Online","kickOff":true}} has been send to kafka with in topic events partition 2, current offset is 3519
2018-12-30 18:01:12,173 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=d65dd4a0-0c19-11e9-b87d-6b6cbfdacae5, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateAttributeChangeEvent, timestamp=1546164072170, properties={}, body={source={}, timestamp=1546164072170, actor={bizId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, roles=agent}, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userType=Agent, userScope=Tenant, nicename=, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-12-27 01:22:45, lastUpdateDateTime=2018-12-29 20:11:27, firstLoginTimeOfRecentDay=2018-12-29 16:15:21, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164072170, status=Online, kickOff=true}, topic=events, partitionKey=43:0fd687f3-09be-4919-b533-3d89c613590e).
2018-12-30 18:01:12,174 INFO  [kafka-events-consumer-1-thread-15]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:0fd687f3-09be-4919-b533-3d89c613590e,agentState:Online
2018-12-30 18:01:12,175 INFO  [kafka-events-consumer-1-thread-15]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = 0fd687f3-09be-4919-b533-3d89c613590e] status changed to Online
2018-12-30 18:01:12,175 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=d65dfbb0-0c19-11e9-be70-cd8595efb387, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164072171, properties={}, body={source={}, timestamp=1546164072171, actor={bizId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, roles=agent}, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userType=Agent, userScope=Tenant, nicename=, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-12-27 01:22:45, lastUpdateDateTime=2018-12-29 20:11:27, firstLoginTimeOfRecentDay=2018-12-29 16:15:21, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164072171, status=Online, kickOff=true}, topic=events, partitionKey=43:0fd687f3-09be-4919-b533-3d89c613590e).
2018-12-30 18:01:12,175 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"d65e97f0-0c19-11e9-8b5a-df15307e47df","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164072175,"body":{"source":{},"timestamp":1546164072175,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164072171,"actor":{"bizId":"43","userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"},"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164072171,"status":"Online","kickOff":true}}],"broadcast":true}}} has been send to kafka with in topic events partition 11, current offset is 2956
2018-12-30 18:01:12,175 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164072171,"actor":{"bizId":"43","userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"},"version":"1.1","tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userPK":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e"},"agentUser":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-12-27 01:22:45","lastUpdateDateTime":"2018-12-29 20:11:27","firstLoginTimeOfRecentDay":"2018-12-29 16:15:21","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164072171,"status":"Online","kickOff":true}}],"timestamp":1546164072175,"type":null}
2018-12-30 18:01:12,175 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - prepare message noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:bfbnlzqk noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a messageType:AgentUserStateChange
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a messageType:AgentUserStateChange
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:aniu0ppp noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a messageType:AgentUserStateChange
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:qqwgjyob noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a messageType:AgentUserStateChange
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:fiek5iwl noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a messageType:AgentUserStateChange
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:bfbnlzqk noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,176 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:aniu0ppp noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,177 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:fiek5iwl noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,177 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:qqwgjyob noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,177 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=d65e97f0-0c19-11e9-8b5a-df15307e47df, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164072175, properties={}, body={source={}, timestamp=1546164072175, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164072171, actor={bizId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, roles=agent}, version=1.1, tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userPK={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e}, agentUser={tenantId=43, userId=0fd687f3-09be-4919-b533-3d89c613590e, userType=Agent, userScope=Tenant, nicename=, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-12-27 01:22:45, lastUpdateDateTime=2018-12-29 20:11:27, firstLoginTimeOfRecentDay=2018-12-29 16:15:21, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/fc0d2f40-4569-4c1b-988a-5a0f4e78add45b6u5L-h5Zu-54mHXzIwMTgxMjI3MTE0MDUxLnBuZw==/cutout?arg=0_37_523_523_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164072171, status=Online, kickOff=true}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:01:12,198 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:12,202 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:12,206 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"noticeId":"36ff829d-8e88-4d04-8606-b5e8470dca2a"}
2018-12-30 18:01:12,206 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:qqwgjyob noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,206 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"noticeId":"36ff829d-8e88-4d04-8606-b5e8470dca2a"}
2018-12-30 18:01:12,206 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:fiek5iwl noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,209 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"36ff829d-8e88-4d04-8606-b5e8470dca2a"}
2018-12-30 18:01:12,209 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,214 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"noticeId":"36ff829d-8e88-4d04-8606-b5e8470dca2a"}
2018-12-30 18:01:12,214 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:aniu0ppp noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,222 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"noticeId":"36ff829d-8e88-4d04-8606-b5e8470dca2a"}
2018-12-30 18:01:12,222 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:bfbnlzqk noticeId:36ff829d-8e88-4d04-8606-b5e8470dca2a
2018-12-30 18:01:12,431 INFO  [http-nio-8899-exec-12]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"0fd687f3-09be-4919-b533-3d89c613590e","tenantId":43,"type":"StateChange"}}],"timestamp":1546164072327,"type":null}
2018-12-30 18:01:12,431 INFO  [http-nio-8899-exec-12]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:396b6b95-418b-4e79-9dcb-3c477ba90dd7 message:{"path":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"0fd687f3-09be-4919-b533-3d89c613590e","tenantId":43,"type":"StateChange"}}],"timestamp":1546164072327,"type":null}
2018-12-30 18:01:12,431 INFO  [http-nio-8899-exec-12]  c.e.w.n.service.PushDataService - prepare message noticeId:396b6b95-418b-4e79-9dcb-3c477ba90dd7 messageType:Daas path:/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e
2018-12-30 18:01:12,432 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:396b6b95-418b-4e79-9dcb-3c477ba90dd7 messageType:Daas
2018-12-30 18:01:12,432 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:396b6b95-418b-4e79-9dcb-3c477ba90dd7
2018-12-30 18:01:12,463 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"396b6b95-418b-4e79-9dcb-3c477ba90dd7"}
2018-12-30 18:01:12,463 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:396b6b95-418b-4e79-9dcb-3c477ba90dd7
2018-12-30 18:01:12,467 INFO  [http-nio-8899-exec-5]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":262}
2018-12-30 18:01:12,716 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:12,721 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:12,922 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:13,138 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:13,140 WARN  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - agent not in skillgroup rank tenantId:43 skillGroupId:47 agentId:0fd687f3-09be-4919-b533-3d89c613590e
2018-12-30 18:01:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:01 start
2018-12-30 18:01:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:01
2018-12-30 18:01:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:01 complete
2018-12-30 18:01:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:01:14,115 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:14,210 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:14,214 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:14,726 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:14,732 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e","ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:14,922 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:15,137 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:16,115 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:16,199 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:16,203 INFO  [consumer-kf:schedule:signal:a-7-thread-42]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:16,715 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:16,720 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e","ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:16,922 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:17,137 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:18,115 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:18,197 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:18,201 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:18,724 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:18,730 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e","ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:18,923 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:19,137 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:20,115 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:20,197 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:20,201 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:20,735 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:20,740 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e","ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:20,923 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:21,138 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:22,115 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:22,231 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:22,236 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:22,720 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:22,725 INFO  [consumer-kf:schedule:signal:a-7-thread-46]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e","ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:22,924 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:23,138 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:24,115 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:24,198 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:24,202 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:24,719 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:24,725 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e","ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"] s1:[] s2:[]
2018-12-30 18:01:24,924 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:25,138 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:26,115 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:26,226 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:26,231 INFO  [consumer-kf:schedule:signal:a-7-thread-37]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:26,676 INFO  [http-nio-8899-exec-11]  c.e.w.r.mvc.agent.AccountController - The agentUser ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0 update agent state, status:AgentStatusRequest(agentStatus=Hidden)
2018-12-30 18:01:26,677 INFO  [http-nio-8899-exec-11]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log : agent ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0 status change to Hidden
2018-12-30 18:01:26,677 INFO  [http-nio-8899-exec-11]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log session exists: agent ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0 status change to Hidden
2018-12-30 18:01:26,678 INFO  [http-nio-8899-exec-11]  c.e.w.service.agent.AgentUserService - update agent end, agentUser:AgentUser{agentNumber=null, username='mawei@zking.com', roles='agent', status=Enable, state=Online, maxServiceSessionCount=5, trueName='', mobilePhone='', connected=false, realState=null}
2018-12-30 18:01:26,679 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"df036c50-0c19-11e9-acb2-3d8bc7c91d9a","type":"com.easemob.weichat.service.events.agent.AgentUserStateAttributeChangeEvent","timestamp":1546164086677,"body":{"source":{},"timestamp":1546164086677,"actor":{"bizId":"43","userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","roles":"agent"},"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Online","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164086677,"status":"Hidden","kickOff":true}} has been send to kafka with in topic events partition 1, current offset is 3228
2018-12-30 18:01:26,679 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"df039360-0c19-11e9-b273-db86a9922863","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164086678,"body":{"source":{},"timestamp":1546164086678,"actor":{"bizId":"43","userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","roles":"agent"},"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Online","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164086678,"status":"Hidden","kickOff":false}} has been send to kafka with in topic events partition 1, current offset is 3229
2018-12-30 18:01:26,681 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=df036c50-0c19-11e9-acb2-3d8bc7c91d9a, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateAttributeChangeEvent, timestamp=1546164086677, properties={}, body={source={}, timestamp=1546164086677, actor={bizId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, roles=agent}, version=1.1, tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userPK={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0}, agentUser={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userType=Agent, userScope=Tenant, nicename=, password=, username=mawei@zking.com, roles=agent, createDateTime=2018-12-27 01:23:06, lastUpdateDateTime=2018-12-29 17:03:17, firstLoginTimeOfRecentDay=2018-12-27 10:31:05, status=Enable, state=Online, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164086677, status=Hidden, kickOff=true}, topic=events, partitionKey=43:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0).
2018-12-30 18:01:26,681 INFO  [kafka-events-consumer-1-thread-7]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0,agentState:Hidden
2018-12-30 18:01:26,681 INFO  [kafka-events-consumer-1-thread-7]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0] status changed to Hidden
2018-12-30 18:01:26,682 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=df039360-0c19-11e9-b273-db86a9922863, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164086678, properties={}, body={source={}, timestamp=1546164086678, actor={bizId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, roles=agent}, version=1.1, tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userPK={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0}, agentUser={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userType=Agent, userScope=Tenant, nicename=, password=, username=mawei@zking.com, roles=agent, createDateTime=2018-12-27 01:23:06, lastUpdateDateTime=2018-12-29 17:03:17, firstLoginTimeOfRecentDay=2018-12-27 10:31:05, status=Enable, state=Online, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164086678, status=Hidden, kickOff=false}, topic=events, partitionKey=43:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0).
2018-12-30 18:01:26,682 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164086678,"actor":{"bizId":"43","userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","roles":"agent"},"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Online","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164086678,"status":"Hidden","kickOff":false}}],"timestamp":1546164086681,"type":null}
2018-12-30 18:01:26,682 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - prepare message noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:01:26,682 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"df04089a-0c19-11e9-b7f6-a9cd17e36203","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164086681,"body":{"source":{},"timestamp":1546164086681,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164086678,"actor":{"bizId":"43","userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","roles":"agent"},"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Online","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164086678,"status":"Hidden","kickOff":false}}],"broadcast":true}}} has been send to kafka with in topic events partition 2, current offset is 3520
2018-12-30 18:01:26,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:fiek5iwl noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a messageType:AgentUserStateChange
2018-12-30 18:01:26,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:bfbnlzqk noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a messageType:AgentUserStateChange
2018-12-30 18:01:26,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:qqwgjyob noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a messageType:AgentUserStateChange
2018-12-30 18:01:26,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:aniu0ppp noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a messageType:AgentUserStateChange
2018-12-30 18:01:26,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a messageType:AgentUserStateChange
2018-12-30 18:01:26,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:fiek5iwl noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,684 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:qqwgjyob noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,684 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,684 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:bfbnlzqk noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,684 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:aniu0ppp noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,684 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=df04089a-0c19-11e9-b7f6-a9cd17e36203, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164086681, properties={}, body={source={}, timestamp=1546164086681, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164086678, actor={bizId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, roles=agent}, version=1.1, tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userPK={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0}, agentUser={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userType=Agent, userScope=Tenant, nicename=, password=, username=mawei@zking.com, roles=agent, createDateTime=2018-12-27 01:23:06, lastUpdateDateTime=2018-12-29 17:03:17, firstLoginTimeOfRecentDay=2018-12-27 10:31:05, status=Enable, state=Online, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164086678, status=Hidden, kickOff=false}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:01:26,713 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"noticeId":"bc8ae370-3a72-4e66-802c-6a246348d77a"}
2018-12-30 18:01:26,713 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:qqwgjyob noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,713 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"bc8ae370-3a72-4e66-802c-6a246348d77a"}
2018-12-30 18:01:26,713 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,713 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"noticeId":"bc8ae370-3a72-4e66-802c-6a246348d77a"}
2018-12-30 18:01:26,713 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:fiek5iwl noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,740 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:26,744 WARN  [consumer-kf:schedule:signal:a-7-thread-1]  c.e.w.s.a.AgentRankingManagerImpl - agent not available removed tenantId:43 skillGroupId:47 agentId:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0
2018-12-30 18:01:26,745 INFO  [consumer-kf:schedule:signal:a-7-thread-1]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:26,751 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"noticeId":"bc8ae370-3a72-4e66-802c-6a246348d77a"}
2018-12-30 18:01:26,751 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:bfbnlzqk noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,751 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"noticeId":"bc8ae370-3a72-4e66-802c-6a246348d77a"}
2018-12-30 18:01:26,751 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:aniu0ppp noticeId:bc8ae370-3a72-4e66-802c-6a246348d77a
2018-12-30 18:01:26,908 INFO  [http-nio-8899-exec-12]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","tenantId":43,"type":"StateChange"}}],"timestamp":1546164086804,"type":null}
2018-12-30 18:01:26,908 INFO  [http-nio-8899-exec-12]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:c8fef613-499d-4ada-959f-ec4289b8a0be message:{"path":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","tenantId":43,"type":"StateChange"}}],"timestamp":1546164086804,"type":null}
2018-12-30 18:01:26,908 INFO  [http-nio-8899-exec-12]  c.e.w.n.service.PushDataService - prepare message noticeId:c8fef613-499d-4ada-959f-ec4289b8a0be messageType:Daas path:/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0
2018-12-30 18:01:26,908 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:fiek5iwl noticeId:c8fef613-499d-4ada-959f-ec4289b8a0be messageType:Daas
2018-12-30 18:01:26,908 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:fiek5iwl noticeId:c8fef613-499d-4ada-959f-ec4289b8a0be
2018-12-30 18:01:26,923 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:26,938 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"noticeId":"c8fef613-499d-4ada-959f-ec4289b8a0be"}
2018-12-30 18:01:26,938 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:fiek5iwl noticeId:c8fef613-499d-4ada-959f-ec4289b8a0be
2018-12-30 18:01:26,942 INFO  [http-nio-8899-exec-11]  c.e.w.a.rest.AuthController - authenticateBySession, session:d98fac7b-4601-4883-8afd-1e76758378fc, response:{"status":true,"entity":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","roles":"agent"}}, cost:{"total":288}
2018-12-30 18:01:27,137 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:28,115 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:28,200 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:28,204 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:28,722 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:28,726 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:28,923 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:29,137 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:30,116 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:30,196 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:30,201 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:30,715 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:30,719 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:30,923 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:31,137 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:32,117 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:32,289 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:32,293 INFO  [consumer-kf:schedule:signal:a-7-thread-46]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:32,748 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:32,753 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:32,923 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:33,138 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:01 start
2018-12-30 18:01:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:01
2018-12-30 18:01:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:01 complete
2018-12-30 18:01:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:01:34,116 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:34,196 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:34,202 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:34,725 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:34,730 INFO  [consumer-kf:schedule:signal:a-7-thread-7]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:34,924 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:35,138 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:36,116 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:36,245 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:36,249 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:36,714 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:36,719 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:36,923 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:37,139 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:38,116 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:38,197 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:38,201 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:38,716 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:38,721 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:38,923 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:39,140 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:40,116 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:40,201 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:40,206 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:40,716 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:40,720 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:40,924 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:41,139 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:42,119 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:42,207 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:42,211 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:42,719 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:42,729 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:42,924 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:43,139 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:44,116 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:44,220 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:44,224 INFO  [consumer-kf:schedule:signal:a-7-thread-7]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:44,781 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:44,786 INFO  [consumer-kf:schedule:signal:a-7-thread-45]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:44,925 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:45,139 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:46,116 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:46,304 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:46,308 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:46,718 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:46,723 INFO  [consumer-kf:schedule:signal:a-7-thread-1]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:46,924 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:47,139 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:48,116 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:48,205 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:48,209 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:48,720 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:48,724 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:48,924 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:49,139 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:50,116 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:50,197 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:50,201 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:50,715 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:50,719 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:50,834 INFO  [kf-webapp-scheduler-pool-11]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 1ms
2018-12-30 18:01:50,924 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:51,139 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:52,116 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:52,198 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:52,203 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:52,718 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:52,723 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:52,926 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:53,140 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:01 start
2018-12-30 18:01:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:01
2018-12-30 18:01:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:01 complete
2018-12-30 18:01:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:01:54,116 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:54,201 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:54,205 INFO  [consumer-kf:schedule:signal:a-7-thread-45]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:54,715 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:54,720 INFO  [consumer-kf:schedule:signal:a-7-thread-43]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:54,924 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:55,140 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:55,597 INFO  [kf-webapp-scheduler-pool-17]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:01:55,597 INFO  [kf-webapp-scheduler-pool-17]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:01:56,116 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:56,200 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:56,204 INFO  [consumer-kf:schedule:signal:a-7-thread-37]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:56,715 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:56,720 INFO  [consumer-kf:schedule:signal:a-7-thread-1]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:57,018 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:57,140 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:01:58,117 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:01:58,206 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:01:58,210 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:01:58,716 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:01:58,721 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:01:58,924 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:01:59,139 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:00,116 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:00,207 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:00,211 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:00,716 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:00,720 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:00,925 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:fiek5iwl handleMessage:{"keepalive":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151"}
2018-12-30 18:02:01,141 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:01,740 INFO  [http-nio-8899-exec-4]  c.e.w.n.handler.MainHandler - session closed wsId:fiek5iwl count:4 path:/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0/1546128193151 token:d98fac7b-4601-4883-8afd-1e76758378fc
2018-12-30 18:02:01,744 INFO  [http-nio-8899-exec-4]  o.s.a.r.l.SimpleMessageListenerContainer - Waiting for workers to finish.
2018-12-30 18:02:01,911 INFO  [http-nio-8899-exec-4]  o.s.a.r.l.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2018-12-30 18:02:01,913 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"f403db8a-0c19-11e9-982c-9370bc19057e","type":"com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent","timestamp":1546164121912,"body":{"source":{},"timestamp":1546164121912,"actor":null,"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":null,"eventTime":1546164121912,"kickOff":true}} has been send to kafka with in topic events partition 1, current offset is 3230
2018-12-30 18:02:01,916 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=f403db8a-0c19-11e9-982c-9370bc19057e, service=null, type=com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent, timestamp=1546164121912, properties={}, body={source={}, timestamp=1546164121912, actor=null, version=1.1, tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userPK={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0}, agentUser=null, eventTime=1546164121912, kickOff=true}, topic=events, partitionKey=43:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0).
2018-12-30 18:02:02,117 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:02,200 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:02,204 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:02,719 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:02,725 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:03,140 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:04,117 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:04,198 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:04,205 INFO  [consumer-kf:schedule:signal:a-7-thread-43]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:04,718 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:04,723 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:05,140 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:06,117 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:06,199 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:06,203 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:06,717 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:06,721 INFO  [consumer-kf:schedule:signal:a-7-thread-1]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:07,140 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:08,117 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:08,198 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:08,202 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:08,722 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:08,727 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:09,140 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:10,117 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:10,203 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:10,208 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:10,735 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:10,740 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:11,141 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:12,117 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:12,199 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:12,204 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:12,723 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:12,727 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:13,140 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:02 start
2018-12-30 18:02:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:02
2018-12-30 18:02:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:02 complete
2018-12-30 18:02:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:02:14,117 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:14,217 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:14,221 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:14,729 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:aniu0ppp handleMessage:{"keepalive":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886"}
2018-12-30 18:02:14,734 INFO  [consumer-kf:schedule:signal:a-7-thread-5]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:b3888ccb-4415-4918-ac5f-4eee97f9c2f7 toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:15,141 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:16,117 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:16,205 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:16,210 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:16,572 INFO  [http-nio-8899-exec-11]  c.e.w.n.handler.MainHandler - session closed wsId:aniu0ppp count:3 path:/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7/1546163839886 token:ff2ed9ec-07fc-4e79-a2a8-33b8c1572662
2018-12-30 18:02:16,576 INFO  [http-nio-8899-exec-11]  o.s.a.r.l.SimpleMessageListenerContainer - Waiting for workers to finish.
2018-12-30 18:02:16,688 INFO  [http-nio-8899-exec-11]  o.s.a.r.l.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2018-12-30 18:02:16,690 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fcd27f0a-0c19-11e9-a68b-8f5b86258397","type":"com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent","timestamp":1546164136688,"body":{"source":{},"timestamp":1546164136688,"actor":null,"version":"1.1","tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userPK":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7"},"agentUser":null,"eventTime":1546164136688,"kickOff":true}} has been send to kafka with in topic events partition 8, current offset is 3330
2018-12-30 18:02:16,692 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=fcd27f0a-0c19-11e9-a68b-8f5b86258397, service=null, type=com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent, timestamp=1546164136688, properties={}, body={source={}, timestamp=1546164136688, actor=null, version=1.1, tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7, userPK={tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7}, agentUser=null, eventTime=1546164136688, kickOff=true}, topic=events, partitionKey=43:b3888ccb-4415-4918-ac5f-4eee97f9c2f7).
2018-12-30 18:02:17,141 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:17,145 WARN  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.AgentRankingManagerImpl - agent not in skill group removed tenantId:43 skillGroupId:47 agentId:b3888ccb-4415-4918-ac5f-4eee97f9c2f7
2018-12-30 18:02:17,145 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:18,117 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:18,207 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:18,211 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:19,142 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:19,145 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:20,117 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:20,710 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:20,715 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:21,141 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:21,145 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:22,117 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:22,687 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:22,692 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:23,141 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:23,145 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:24,117 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:24,695 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:24,700 INFO  [consumer-kf:schedule:signal:a-7-thread-5]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:25,141 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:25,145 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:26,167 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:26,695 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:26,699 INFO  [consumer-kf:schedule:signal:a-7-thread-1]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:27,141 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:27,146 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:28,117 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:28,700 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:28,705 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:29,141 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:29,145 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:30,118 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:30,711 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:30,715 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:31,142 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:31,146 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:32,118 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:32,705 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:32,709 INFO  [consumer-kf:schedule:signal:a-7-thread-18]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:33,142 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:33,146 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:02 start
2018-12-30 18:02:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:02
2018-12-30 18:02:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:02 complete
2018-12-30 18:02:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:02:34,118 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:34,700 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:34,708 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:35,142 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:35,146 INFO  [consumer-kf:schedule:signal:a-7-thread-12]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:36,118 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:36,711 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:36,715 INFO  [consumer-kf:schedule:signal:a-7-thread-2]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:37,142 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:37,146 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:38,118 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:38,705 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:38,709 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:39,143 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:39,150 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:40,118 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:40,755 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:40,760 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:41,142 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:41,146 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:42,118 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:42,720 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:42,724 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:43,143 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:43,147 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:44,118 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:44,756 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:44,760 INFO  [consumer-kf:schedule:signal:a-7-thread-12]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:45,143 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:45,147 INFO  [consumer-kf:schedule:signal:a-7-thread-29]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:46,118 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:46,745 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:46,750 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:47,142 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:47,146 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:48,118 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:48,738 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:48,743 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:49,143 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:49,150 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:50,118 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:50,717 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:50,721 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:51,143 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:51,147 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:52,118 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:52,719 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:52,724 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:53,143 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:53,147 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:02 start
2018-12-30 18:02:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:02
2018-12-30 18:02:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:02 complete
2018-12-30 18:02:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:02:54,118 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:54,728 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:54,733 INFO  [consumer-kf:schedule:signal:a-7-thread-12]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:55,144 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:55,148 INFO  [consumer-kf:schedule:signal:a-7-thread-29]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:55,598 INFO  [kf-webapp-scheduler-pool-10]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:02:55,598 INFO  [kf-webapp-scheduler-pool-10]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:02:56,118 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:56,724 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:56,728 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:57,143 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:57,147 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:02:58,118 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:02:58,385 INFO  [agentconnection-pubsub-32]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent b3888ccb-4415-4918-ac5f-4eee97f9c2f7 connection expired, workstate Online
2018-12-30 18:02:58,387 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"15acf410-0c1a-11e9-a292-6545d8976b8d","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164178386,"body":{"source":{},"timestamp":1546164178385,"actor":null,"version":"1.1","tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userPK":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7"},"agentUser":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-12-25 17:30:04","lastUpdateDateTime":"2018-12-30 16:02:57","firstLoginTimeOfRecentDay":"2018-12-30 16:02:11","status":"Enable","state":"Online","maxServiceSessionCount":0,"trueName":"","mobilePhone":"","avatar":"","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164178385,"status":"Offline","kickOff":false}} has been send to kafka with in topic events partition 8, current offset is 3331
2018-12-30 18:02:58,388 INFO  [kafka-events-consumer-1-thread-9]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:b3888ccb-4415-4918-ac5f-4eee97f9c2f7,agentState:Offline
2018-12-30 18:02:58,388 INFO  [kafka-events-consumer-1-thread-9]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = b3888ccb-4415-4918-ac5f-4eee97f9c2f7] status changed to Offline
2018-12-30 18:02:58,389 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=15acf410-0c1a-11e9-a292-6545d8976b8d, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164178386, properties={}, body={source={}, timestamp=1546164178385, actor=null, version=1.1, tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7, userPK={tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7}, agentUser={tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7, userType=Agent, userScope=Tenant, nicename=, password=, username=kefutest2018@zking.com, roles=admin,agent, createDateTime=2018-12-25 17:30:04, lastUpdateDateTime=2018-12-30 16:02:57, firstLoginTimeOfRecentDay=2018-12-30 16:02:11, status=Enable, state=Online, maxServiceSessionCount=0, trueName=, mobilePhone=, avatar=, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164178385, status=Offline, kickOff=false}, topic=events, partitionKey=43:b3888ccb-4415-4918-ac5f-4eee97f9c2f7).
2018-12-30 18:02:58,389 INFO  [SimpleAsyncTaskExecutor-4]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:17ae7819-6f27-4b11-91f9-45277434a405 message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164178385,"actor":null,"version":"1.1","tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userPK":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7"},"agentUser":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-12-25 17:30:04","lastUpdateDateTime":"2018-12-30 16:02:57","firstLoginTimeOfRecentDay":"2018-12-30 16:02:11","status":"Enable","state":"Online","maxServiceSessionCount":0,"trueName":"","mobilePhone":"","avatar":"","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164178385,"status":"Offline","kickOff":false}}],"timestamp":1546164178388,"type":null}
2018-12-30 18:02:58,389 INFO  [SimpleAsyncTaskExecutor-4]  c.e.w.n.service.PushDataService - prepare message noticeId:17ae7819-6f27-4b11-91f9-45277434a405 messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:02:58,389 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"15ad694a-0c1a-11e9-99e9-4db6b2f2bc40","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164178388,"body":{"source":{},"timestamp":1546164178388,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164178385,"actor":null,"version":"1.1","tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userPK":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7"},"agentUser":{"tenantId":43,"userId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-12-25 17:30:04","lastUpdateDateTime":"2018-12-30 16:02:57","firstLoginTimeOfRecentDay":"2018-12-30 16:02:11","status":"Enable","state":"Online","maxServiceSessionCount":0,"trueName":"","mobilePhone":"","avatar":"","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164178385,"status":"Offline","kickOff":false}}],"broadcast":true}}} has been send to kafka with in topic events partition 5, current offset is 3236
2018-12-30 18:02:58,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:17ae7819-6f27-4b11-91f9-45277434a405 messageType:AgentUserStateChange
2018-12-30 18:02:58,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:bfbnlzqk noticeId:17ae7819-6f27-4b11-91f9-45277434a405 messageType:AgentUserStateChange
2018-12-30 18:02:58,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:qqwgjyob noticeId:17ae7819-6f27-4b11-91f9-45277434a405 messageType:AgentUserStateChange
2018-12-30 18:02:58,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:bfbnlzqk noticeId:17ae7819-6f27-4b11-91f9-45277434a405
2018-12-30 18:02:58,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:17ae7819-6f27-4b11-91f9-45277434a405
2018-12-30 18:02:58,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:qqwgjyob noticeId:17ae7819-6f27-4b11-91f9-45277434a405
2018-12-30 18:02:58,391 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=15ad694a-0c1a-11e9-99e9-4db6b2f2bc40, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164178388, properties={}, body={source={}, timestamp=1546164178388, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164178385, actor=null, version=1.1, tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7, userPK={tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7}, agentUser={tenantId=43, userId=b3888ccb-4415-4918-ac5f-4eee97f9c2f7, userType=Agent, userScope=Tenant, nicename=, password=, username=kefutest2018@zking.com, roles=admin,agent, createDateTime=2018-12-25 17:30:04, lastUpdateDateTime=2018-12-30 16:02:57, firstLoginTimeOfRecentDay=2018-12-30 16:02:11, status=Enable, state=Online, maxServiceSessionCount=0, trueName=, mobilePhone=, avatar=, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164178385, status=Offline, kickOff=false}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:02:58,420 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"noticeId":"17ae7819-6f27-4b11-91f9-45277434a405"}
2018-12-30 18:02:58,420 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:qqwgjyob noticeId:17ae7819-6f27-4b11-91f9-45277434a405
2018-12-30 18:02:58,420 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"17ae7819-6f27-4b11-91f9-45277434a405"}
2018-12-30 18:02:58,420 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:17ae7819-6f27-4b11-91f9-45277434a405
2018-12-30 18:02:58,473 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"noticeId":"17ae7819-6f27-4b11-91f9-45277434a405"}
2018-12-30 18:02:58,473 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:bfbnlzqk noticeId:17ae7819-6f27-4b11-91f9-45277434a405
2018-12-30 18:02:58,616 INFO  [http-nio-8899-exec-5]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","tenantId":43,"type":"StateChange"}}],"timestamp":1546164178511,"type":null}
2018-12-30 18:02:58,616 INFO  [http-nio-8899-exec-5]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:6b2cbba4-e8fc-4d04-8d4d-c335f379805f message:{"path":"/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"b3888ccb-4415-4918-ac5f-4eee97f9c2f7","tenantId":43,"type":"StateChange"}}],"timestamp":1546164178511,"type":null}
2018-12-30 18:02:58,616 INFO  [http-nio-8899-exec-5]  c.e.w.n.service.PushDataService - prepare message noticeId:6b2cbba4-e8fc-4d04-8d4d-c335f379805f messageType:Daas path:/tenants/43/agents/b3888ccb-4415-4918-ac5f-4eee97f9c2f7
2018-12-30 18:02:58,726 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:02:58,735 INFO  [consumer-kf:schedule:signal:a-7-thread-30]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:02:59,143 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:02:59,150 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:00,119 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:00,732 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:00,736 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:01,143 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:01,147 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:02,119 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:02,741 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:02,745 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:03,144 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:03,148 INFO  [consumer-kf:schedule:signal:a-7-thread-7]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:04,119 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:04,734 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:04,742 INFO  [consumer-kf:schedule:signal:a-7-thread-29]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:05,144 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:05,148 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:06,119 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:06,742 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:06,746 INFO  [consumer-kf:schedule:signal:a-7-thread-35]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:07,145 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:07,149 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:08,119 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:08,742 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:08,746 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:09,144 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:09,148 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:10,119 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:10,743 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:10,747 INFO  [consumer-kf:schedule:signal:a-7-thread-15]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:11,145 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:11,148 INFO  [consumer-kf:schedule:signal:a-7-thread-46]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:12,119 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:12,749 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:12,753 INFO  [consumer-kf:schedule:signal:a-7-thread-7]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:13,145 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:13,148 INFO  [consumer-kf:schedule:signal:a-7-thread-45]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:03 start
2018-12-30 18:03:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:03
2018-12-30 18:03:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:03 complete
2018-12-30 18:03:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:03:14,119 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:14,744 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:14,748 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:15,145 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:15,148 INFO  [consumer-kf:schedule:signal:a-7-thread-4]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:16,119 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:16,754 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:16,759 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:17,144 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:17,148 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:18,118 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:18,748 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:18,752 INFO  [consumer-kf:schedule:signal:a-7-thread-19]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:19,146 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:19,150 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:20,118 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:20,751 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:20,755 INFO  [consumer-kf:schedule:signal:a-7-thread-46]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:21,145 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:21,148 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:22,119 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:22,756 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:22,761 INFO  [consumer-kf:schedule:signal:a-7-thread-45]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:23,147 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:23,151 INFO  [consumer-kf:schedule:signal:a-7-thread-43]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:24,119 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:24,778 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:24,782 INFO  [consumer-kf:schedule:signal:a-7-thread-4]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:25,147 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:25,151 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:26,119 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:26,759 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:26,763 INFO  [consumer-kf:schedule:signal:a-7-thread-38]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:27,146 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:27,149 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:28,120 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:28,761 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:28,766 INFO  [consumer-kf:schedule:signal:a-7-thread-32]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:29,146 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:29,149 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:30,120 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:30,765 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:30,769 INFO  [consumer-kf:schedule:signal:a-7-thread-14]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:31,146 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:31,149 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:32,120 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:32,765 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:32,769 INFO  [consumer-kf:schedule:signal:a-7-thread-43]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:33,146 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:33,150 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:03 start
2018-12-30 18:03:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:03
2018-12-30 18:03:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:03 complete
2018-12-30 18:03:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:03:34,119 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:34,787 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:34,798 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:35,146 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:35,150 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:36,119 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:36,772 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:36,776 INFO  [consumer-kf:schedule:signal:a-7-thread-8]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:37,146 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:37,150 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:38,119 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:38,770 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:bfbnlzqk handleMessage:{"keepalive":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956"}
2018-12-30 18:03:38,776 INFO  [consumer-kf:schedule:signal:a-7-thread-34]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:211 byA:405bb9a2-67e3-42fb-91eb-de5f542c6125 toA:["405bb9a2-67e3-42fb-91eb-de5f542c6125"] s1:[] s2:[]
2018-12-30 18:03:39,146 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:39,150 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:40,121 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:40,482 INFO  [http-nio-8899-exec-9]  c.e.w.n.handler.MainHandler - session closed wsId:bfbnlzqk count:2 path:/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125/1546163914956 token:df19b14b-5823-42ba-9d9c-b76b4106d3bc
2018-12-30 18:03:40,485 INFO  [http-nio-8899-exec-9]  o.s.a.r.l.SimpleMessageListenerContainer - Waiting for workers to finish.
2018-12-30 18:03:41,147 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:41,151 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:41,394 INFO  [http-nio-8899-exec-9]  o.s.a.r.l.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2018-12-30 18:03:41,395 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2f4f9b2a-0c1a-11e9-8726-ab9b14f8b0e8","type":"com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent","timestamp":1546164221394,"body":{"source":{},"timestamp":1546164221394,"actor":null,"version":"1.1","tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userPK":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125"},"agentUser":null,"eventTime":1546164221394,"kickOff":true}} has been send to kafka with in topic events partition 6, current offset is 3867
2018-12-30 18:03:41,397 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=2f4f9b2a-0c1a-11e9-8726-ab9b14f8b0e8, service=null, type=com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent, timestamp=1546164221394, properties={}, body={source={}, timestamp=1546164221394, actor=null, version=1.1, tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125, userPK={tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125}, agentUser=null, eventTime=1546164221394, kickOff=true}, topic=events, partitionKey=43:405bb9a2-67e3-42fb-91eb-de5f542c6125).
2018-12-30 18:03:42,193 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:43,147 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:43,151 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:44,119 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:44,690 INFO  [agentconnection-pubsub-41]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0 connection expired, workstate Hidden
2018-12-30 18:03:44,693 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"3146b030-0c1a-11e9-8e3e-7db83ca7f4ce","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164224691,"body":{"source":{},"timestamp":1546164224691,"actor":null,"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164224691,"status":"Offline","kickOff":false}} has been send to kafka with in topic events partition 1, current offset is 3231
2018-12-30 18:03:44,694 INFO  [kafka-events-consumer-1-thread-7]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0,agentState:Offline
2018-12-30 18:03:44,695 INFO  [kafka-events-consumer-1-thread-7]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0] status changed to Offline
2018-12-30 18:03:44,695 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=3146b030-0c1a-11e9-8e3e-7db83ca7f4ce, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164224691, properties={}, body={source={}, timestamp=1546164224691, actor=null, version=1.1, tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userPK={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0}, agentUser={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userType=Agent, userScope=Tenant, nicename=, password=, username=mawei@zking.com, roles=agent, createDateTime=2018-12-27 01:23:06, lastUpdateDateTime=2018-12-29 17:03:17, firstLoginTimeOfRecentDay=2018-12-27 10:31:05, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164224691, status=Offline, kickOff=false}, topic=events, partitionKey=43:ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0).
2018-12-30 18:03:44,696 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5 message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164224691,"actor":null,"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164224691,"status":"Offline","kickOff":false}}],"timestamp":1546164224695,"type":null}
2018-12-30 18:03:44,696 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - prepare message noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5 messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:03:44,696 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"31474c70-0c1a-11e9-83da-75241d4e4aee","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164224695,"body":{"source":{},"timestamp":1546164224695,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164224691,"actor":null,"version":"1.1","tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userPK":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0"},"agentUser":{"tenantId":43,"userId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"mawei@zking.com","roles":"agent","createDateTime":"2018-12-27 01:23:06","lastUpdateDateTime":"2018-12-29 17:03:17","firstLoginTimeOfRecentDay":"2018-12-27 10:31:05","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164224691,"status":"Offline","kickOff":false}}],"broadcast":true}}} has been send to kafka with in topic events partition 14, current offset is 3600
2018-12-30 18:03:44,696 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5 messageType:AgentUserStateChange
2018-12-30 18:03:44,697 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5
2018-12-30 18:03:44,697 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:qqwgjyob noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5 messageType:AgentUserStateChange
2018-12-30 18:03:44,697 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:qqwgjyob noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5
2018-12-30 18:03:44,697 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=31474c70-0c1a-11e9-83da-75241d4e4aee, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164224695, properties={}, body={source={}, timestamp=1546164224695, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164224691, actor=null, version=1.1, tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userPK={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0}, agentUser={tenantId=43, userId=ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0, userType=Agent, userScope=Tenant, nicename=, password=, username=mawei@zking.com, roles=agent, createDateTime=2018-12-27 01:23:06, lastUpdateDateTime=2018-12-29 17:03:17, firstLoginTimeOfRecentDay=2018-12-27 10:31:05, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/d919d630-a855-427b-b438-123642cdf859MzMucG5n/cutout?arg=0_6_547_547_300_300, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164224691, status=Offline, kickOff=false}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:03:44,726 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"noticeId":"9e00d295-efaf-42fb-84e8-2d0fc46d19d5"}
2018-12-30 18:03:44,726 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:qqwgjyob noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5
2018-12-30 18:03:44,727 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"9e00d295-efaf-42fb-84e8-2d0fc46d19d5"}
2018-12-30 18:03:44,727 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:9e00d295-efaf-42fb-84e8-2d0fc46d19d5
2018-12-30 18:03:44,922 INFO  [http-nio-8899-exec-6]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","tenantId":43,"type":"StateChange"}}],"timestamp":1546164224818,"type":null}
2018-12-30 18:03:44,922 INFO  [http-nio-8899-exec-6]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:e14a4dfd-6b24-432c-a4ad-f2470f3b950d message:{"path":"/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0","tenantId":43,"type":"StateChange"}}],"timestamp":1546164224818,"type":null}
2018-12-30 18:03:44,922 INFO  [http-nio-8899-exec-6]  c.e.w.n.service.PushDataService - prepare message noticeId:e14a4dfd-6b24-432c-a4ad-f2470f3b950d messageType:Daas path:/tenants/43/agents/ffb68053-4d04-4c0c-88b6-3ba4ee6e61a0
2018-12-30 18:03:45,147 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:45,151 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:46,120 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:47,147 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:47,152 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:48,119 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:49,147 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:49,151 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:50,120 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:50,835 INFO  [kf-webapp-scheduler-pool-11]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 1ms
2018-12-30 18:03:51,147 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:51,151 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:52,119 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:53,147 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:53,152 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:03 start
2018-12-30 18:03:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:03
2018-12-30 18:03:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:03 complete
2018-12-30 18:03:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:03:54,119 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:55,147 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:55,151 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:55,599 INFO  [kf-webapp-scheduler-pool-28]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:03:55,600 INFO  [kf-webapp-scheduler-pool-28]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:03:56,120 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:57,147 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:57,152 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:03:58,120 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:03:59,147 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:03:59,152 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:00,120 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:01,148 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:01,153 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:02,120 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:03,148 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:03,152 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:04,121 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:05,148 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:05,157 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:06,120 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:07,148 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:07,152 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:08,120 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:09,148 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:09,152 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:10,120 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:11,148 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:11,153 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:12,120 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:13,148 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:13,152 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:04 start
2018-12-30 18:04:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:04
2018-12-30 18:04:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:04 complete
2018-12-30 18:04:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:04:14,120 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:15,152 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:15,156 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:16,120 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:17,153 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:17,158 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:18,120 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:19,149 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:19,154 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:20,120 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:21,150 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:21,155 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:22,120 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:23,150 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:23,155 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:24,120 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:25,149 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:25,154 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:26,121 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:27,150 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:27,154 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:28,122 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:29,149 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:29,154 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:30,122 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:30,156 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5d2c61e3-6d58-4ff1-8122-6e7672147433 message:{"path":"/tenants/43/agents/_2","key":null,"payload":[{"messageType":"ScheduleTimeout","body":"Schedule:43:226a2e9b-ecbf-4602-9a92-52b9516a42b8:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"timestamp":1546164270156,"type":null}
2018-12-30 18:04:30,156 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.PushDataService - prepare message noticeId:5d2c61e3-6d58-4ff1-8122-6e7672147433 messageType:ScheduleTimeout path:/tenants/43/agents/_2
2018-12-30 18:04:30,156 INFO  [SimpleAsyncTaskExecutor-18]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:aea5b60e-148e-447a-bca1-ba2ee4443427 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"ScheduleTimeout","body":"Schedule:43:226a2e9b-ecbf-4602-9a92-52b9516a42b8:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"timestamp":1546164270156,"type":null}
2018-12-30 18:04:30,156 INFO  [SimpleAsyncTaskExecutor-18]  c.e.w.n.service.PushDataService - prepare message noticeId:aea5b60e-148e-447a-bca1-ba2ee4443427 messageType:ScheduleTimeout path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:30,157 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"4c5ff1b0-0c1a-11e9-94ca-d3e1b0679cb9","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164270155,"body":{"source":{},"timestamp":1546164270155,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"_2"},"messages":[{"messageType":"ScheduleTimeout","body":"Schedule:43:226a2e9b-ecbf-4602-9a92-52b9516a42b8:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"broadcast":false}}} has been send to kafka with in topic events partition 13, current offset is 3085
2018-12-30 18:04:30,157 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"4c6018c0-0c1a-11e9-a960-fd30aba8bd69","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164270156,"body":{"source":{},"timestamp":1546164270156,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"ScheduleTimeout","body":"Schedule:43:226a2e9b-ecbf-4602-9a92-52b9516a42b8:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"broadcast":false}}} has been send to kafka with in topic events partition 4, current offset is 2919
2018-12-30 18:04:30,158 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=4c5ff1b0-0c1a-11e9-94ca-d3e1b0679cb9, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164270155, properties={}, body={source={}, timestamp=1546164270155, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=_2}, messages=[{messageType=ScheduleTimeout, body=Schedule:43:226a2e9b-ecbf-4602-9a92-52b9516a42b8:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:04:30,159 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=4c6018c0-0c1a-11e9-a960-fd30aba8bd69, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164270156, properties={}, body={source={}, timestamp=1546164270156, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=ScheduleTimeout, body=Schedule:43:226a2e9b-ecbf-4602-9a92-52b9516a42b8:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:04:31,150 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:31,154 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:32,121 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:33,151 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:33,155 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:04 start
2018-12-30 18:04:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:04
2018-12-30 18:04:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:04 complete
2018-12-30 18:04:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:04:34,121 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:35,150 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:35,159 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:36,122 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:37,150 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:37,154 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:38,121 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:39,152 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:39,156 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:40,121 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:41,007 INFO  [agentconnection-pubsub-35]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent 405bb9a2-67e3-42fb-91eb-de5f542c6125 connection expired, workstate Online
2018-12-30 18:04:41,009 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"52d7fb00-0c1a-11e9-b881-d50458d6d28b","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164281008,"body":{"source":{},"timestamp":1546164281008,"actor":null,"version":"1.1","tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userPK":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125"},"agentUser":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userType":"Agent","userScope":"Tenant","nicename":"Admin","password":"","username":"kefu1216@zking.com","roles":"admin,agent","createDateTime":"2018-12-16 21:25:41","lastUpdateDateTime":"2018-12-28 20:01:08","firstLoginTimeOfRecentDay":"2018-12-28 20:01:08","status":"Enable","state":"Online","maxServiceSessionCount":1,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/7980aa22-7d24-456c-9831-ff80ec0f5638MzMucG5n/cutout?arg=0_34_530_530_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164281008,"status":"Offline","kickOff":false}} has been send to kafka with in topic events partition 6, current offset is 3868
2018-12-30 18:04:41,010 INFO  [kafka-events-consumer-1-thread-6]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:405bb9a2-67e3-42fb-91eb-de5f542c6125,agentState:Offline
2018-12-30 18:04:41,010 INFO  [kafka-events-consumer-1-thread-6]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = 405bb9a2-67e3-42fb-91eb-de5f542c6125] status changed to Offline
2018-12-30 18:04:41,011 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=52d7fb00-0c1a-11e9-b881-d50458d6d28b, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164281008, properties={}, body={source={}, timestamp=1546164281008, actor=null, version=1.1, tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125, userPK={tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125}, agentUser={tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125, userType=Agent, userScope=Tenant, nicename=Admin, password=, username=kefu1216@zking.com, roles=admin,agent, createDateTime=2018-12-16 21:25:41, lastUpdateDateTime=2018-12-28 20:01:08, firstLoginTimeOfRecentDay=2018-12-28 20:01:08, status=Enable, state=Online, maxServiceSessionCount=1, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/7980aa22-7d24-456c-9831-ff80ec0f5638MzMucG5n/cutout?arg=0_34_530_530_300_300, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164281008, status=Offline, kickOff=false}, topic=events, partitionKey=43:405bb9a2-67e3-42fb-91eb-de5f542c6125).
2018-12-30 18:04:41,011 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:3a300768-0522-4f1e-9631-65279eabaea5 message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164281008,"actor":null,"version":"1.1","tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userPK":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125"},"agentUser":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userType":"Agent","userScope":"Tenant","nicename":"Admin","password":"","username":"kefu1216@zking.com","roles":"admin,agent","createDateTime":"2018-12-16 21:25:41","lastUpdateDateTime":"2018-12-28 20:01:08","firstLoginTimeOfRecentDay":"2018-12-28 20:01:08","status":"Enable","state":"Online","maxServiceSessionCount":1,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/7980aa22-7d24-456c-9831-ff80ec0f5638MzMucG5n/cutout?arg=0_34_530_530_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164281008,"status":"Offline","kickOff":false}}],"timestamp":1546164281010,"type":null}
2018-12-30 18:04:41,011 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - prepare message noticeId:3a300768-0522-4f1e-9631-65279eabaea5 messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:04:41,011 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"52d8492a-0c1a-11e9-8a4d-c7669ac4b4dd","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164281010,"body":{"source":{},"timestamp":1546164281010,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164281008,"actor":null,"version":"1.1","tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userPK":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125"},"agentUser":{"tenantId":43,"userId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","userType":"Agent","userScope":"Tenant","nicename":"Admin","password":"","username":"kefu1216@zking.com","roles":"admin,agent","createDateTime":"2018-12-16 21:25:41","lastUpdateDateTime":"2018-12-28 20:01:08","firstLoginTimeOfRecentDay":"2018-12-28 20:01:08","status":"Enable","state":"Online","maxServiceSessionCount":1,"trueName":"","mobilePhone":"","avatar":"//kefurobot.zking.com/v1/tenants/43/mediafiles/7980aa22-7d24-456c-9831-ff80ec0f5638MzMucG5n/cutout?arg=0_34_530_530_300_300","bizId":"43","scope":"Tenant","currentOnLineState":"Online","onLineState":"Online"},"eventTime":1546164281008,"status":"Offline","kickOff":false}}],"broadcast":true}}} has been send to kafka with in topic events partition 7, current offset is 2835
2018-12-30 18:04:41,012 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:3a300768-0522-4f1e-9631-65279eabaea5 messageType:AgentUserStateChange
2018-12-30 18:04:41,012 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:qqwgjyob noticeId:3a300768-0522-4f1e-9631-65279eabaea5 messageType:AgentUserStateChange
2018-12-30 18:04:41,012 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:3a300768-0522-4f1e-9631-65279eabaea5
2018-12-30 18:04:41,012 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:qqwgjyob noticeId:3a300768-0522-4f1e-9631-65279eabaea5
2018-12-30 18:04:41,013 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=52d8492a-0c1a-11e9-8a4d-c7669ac4b4dd, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164281010, properties={}, body={source={}, timestamp=1546164281010, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164281008, actor=null, version=1.1, tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125, userPK={tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125}, agentUser={tenantId=43, userId=405bb9a2-67e3-42fb-91eb-de5f542c6125, userType=Agent, userScope=Tenant, nicename=Admin, password=, username=kefu1216@zking.com, roles=admin,agent, createDateTime=2018-12-16 21:25:41, lastUpdateDateTime=2018-12-28 20:01:08, firstLoginTimeOfRecentDay=2018-12-28 20:01:08, status=Enable, state=Online, maxServiceSessionCount=1, trueName=, mobilePhone=, avatar=//kefurobot.zking.com/v1/tenants/43/mediafiles/7980aa22-7d24-456c-9831-ff80ec0f5638MzMucG5n/cutout?arg=0_34_530_530_300_300, bizId=43, scope=Tenant, currentOnLineState=Online, onLineState=Online}, eventTime=1546164281008, status=Offline, kickOff=false}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:04:41,042 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"noticeId":"3a300768-0522-4f1e-9631-65279eabaea5"}
2018-12-30 18:04:41,042 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:qqwgjyob noticeId:3a300768-0522-4f1e-9631-65279eabaea5
2018-12-30 18:04:41,042 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"3a300768-0522-4f1e-9631-65279eabaea5"}
2018-12-30 18:04:41,042 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:3a300768-0522-4f1e-9631-65279eabaea5
2018-12-30 18:04:41,153 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:41,158 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:41,238 INFO  [http-nio-8899-exec-14]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","tenantId":43,"type":"StateChange"}}],"timestamp":1546164281134,"type":null}
2018-12-30 18:04:41,238 INFO  [http-nio-8899-exec-14]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:0b1f36e4-b366-4742-8847-28b12b5d872c message:{"path":"/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"405bb9a2-67e3-42fb-91eb-de5f542c6125","tenantId":43,"type":"StateChange"}}],"timestamp":1546164281134,"type":null}
2018-12-30 18:04:41,238 INFO  [http-nio-8899-exec-14]  c.e.w.n.service.PushDataService - prepare message noticeId:0b1f36e4-b366-4742-8847-28b12b5d872c messageType:Daas path:/tenants/43/agents/405bb9a2-67e3-42fb-91eb-de5f542c6125
2018-12-30 18:04:41,918 INFO  [http-nio-8899-exec-9]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/visitors/configs/1276c4f5-fec3-4651-bb2c-52d09f976628
2018-12-30 18:04:42,098 INFO  [http-nio-8899-exec-12]  c.e.w.w.mvc.WebimPluginController - POST /v1/webimplugin/visitors,webimChannel:WebimChannel(tenantName=null, tenantAvatar=null, tenantLogo=null, channelId=0, orgName=easemob-demo, appName=chatdemoui, imServiceNumber=119898, run=false, restDomain=null, xmppServer=null, specifiedUserName=)
2018-12-30 18:04:42,098 INFO  [http-nio-8899-exec-12]  c.e.w.w.s.impl.WebimPluginService - create from user org:easemob-demo app:chatdemoui imServiceNumber:119898 username:webim-visitor-YPHKB3EPCRK2XJRHC6EE
2018-12-30 18:04:42,121 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:42,128 INFO  [http-nio-8899-exec-12]  c.e.w.w.s.impl.WebimPluginService - Succeed to create IM user for webim with username webim-visitor-YPHKB3EPCRK2XJRHC6EE, password VJH68FJE8C, nickname webim-visitor-YPHKB3EPCRK2XJRHC6EE for org:easemob-demo app:chatdemoui imServiceNumber:119898
2018-12-30 18:04:42,264 WARN  [http-nio-8899-exec-3]  o.s.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/v1/webimplugin/tenants/43/info] in DispatcherServlet with name 'dispatcherServlet'
2018-12-30 18:04:42,264 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:42 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:42,265 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:42,265 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:42 CST 2018.
2018-12-30 18:04:42,266 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:42,267 INFO  [http-nio-8899-exec-6]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:42,270 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:42 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:42,270 INFO  [http-nio-8899-exec-14]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:42,270 INFO  [http-nio-8899-exec-14]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:42 CST 2018.
2018-12-30 18:04:42,271 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:42,271 INFO  [http-nio-8899-exec-6]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:42,271 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:42,272 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:42,273 INFO  [http-nio-8899-exec-6]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:04:42,273 INFO  [http-nio-8899-exec-6]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:04:42,284 INFO  [http-nio-8899-exec-9]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:42,287 INFO  [http-nio-8899-exec-9]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:42,287 INFO  [http-nio-8899-exec-4]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:04:42,621 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:42 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:42,622 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:42,622 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:42 CST 2018.
2018-12-30 18:04:42,623 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:42,623 INFO  [http-nio-8899-exec-11]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:42,626 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:42 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:42,627 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:42,627 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:42 CST 2018.
2018-12-30 18:04:42,628 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:42,628 INFO  [http-nio-8899-exec-11]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:42,628 INFO  [http-nio-8899-exec-11]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:42,628 INFO  [http-nio-8899-exec-11]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:42,629 INFO  [http-nio-8899-exec-11]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:04:42,629 INFO  [http-nio-8899-exec-11]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:04:42,636 INFO  [http-nio-8899-exec-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:42,639 INFO  [http-nio-8899-exec-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:42,639 INFO  [http-nio-8899-exec-5]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:04:42,736 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:42 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:42,737 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:42,737 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:42 CST 2018.
2018-12-30 18:04:42,738 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:42,738 INFO  [http-nio-8899-exec-4]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:42,743 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:42 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:42,743 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:42,744 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:42 CST 2018.
2018-12-30 18:04:42,746 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:42,746 INFO  [http-nio-8899-exec-4]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:42,746 INFO  [http-nio-8899-exec-4]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:42,746 INFO  [http-nio-8899-exec-3]  c.e.w.w.m.WebimSkillGroupMenuController - GET /v1/webimplugin/tenants/{tenantId}/skillgroup-menu,tenantId:43
2018-12-30 18:04:42,747 INFO  [http-nio-8899-exec-4]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:42,747 INFO  [http-nio-8899-exec-4]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:04:42,747 INFO  [http-nio-8899-exec-4]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:04:42,753 INFO  [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:42,756 INFO  [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:42,756 INFO  [http-nio-8899-exec-9]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:04:42,762 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Sun, 30 Dec 2018 10:04:42 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@62f25c1e 
2018-12-30 18:04:42,762 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2018-12-30 18:04:42,768 ERROR [http-nio-8899-exec-11]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 43, robotRouteId : 7b721036-5b84-4805-b4e7-4832bb586269
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2018-12-30 18:04:42,769 INFO  [http-nio-8899-exec-11]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 43,  robotId 7b721036-5b84-4805-b4e7-4832bb586269
2018-12-30 18:04:42,769 INFO  [http-nio-8899-exec-11]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 43,  robotId 7b721036-5b84-4805-b4e7-4832bb586269, kefuRobotEnable is false
2018-12-30 18:04:42,769 WARN  [hystrix-KefuLiteWebapp-50]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotWelcomeMsgByTenantId(Integer,String) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Sun, 30 Dec 2018 10:04:42 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@aeffb67 
2018-12-30 18:04:42,769 WARN  [hystrix-KefuLiteWebapp-50]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotWelcomeMsgByTenantId(Integer,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2018-12-30 18:04:42,772 ERROR [http-nio-8899-exec-9]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2018-12-30 18:04:43,156 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:43,160 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:44,121 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:qqwgjyob handleMessage:{"keepalive":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091"}
2018-12-30 18:04:45,150 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:45,155 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:46,377 INFO  [http-nio-8899-exec-2]  c.e.w.n.handler.MainHandler - session closed wsId:qqwgjyob count:1 path:/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120/1546135809091 token:1336ba5a-eb9d-4458-8567-c29b50f93420
2018-12-30 18:04:46,381 INFO  [http-nio-8899-exec-2]  o.s.a.r.l.SimpleMessageListenerContainer - Waiting for workers to finish.
2018-12-30 18:04:47,013 INFO  [http-nio-8899-exec-2]  o.s.a.r.l.SimpleMessageListenerContainer - Successfully waited for workers to finish.
2018-12-30 18:04:47,014 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"566c455a-0c1a-11e9-aacc-bb02244e818b","type":"com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent","timestamp":1546164287013,"body":{"source":{},"timestamp":1546164287013,"actor":null,"version":"1.1","tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userPK":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120"},"agentUser":null,"eventTime":1546164287013,"kickOff":true}} has been send to kafka with in topic events partition 12, current offset is 3343
2018-12-30 18:04:47,016 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=566c455a-0c1a-11e9-aacc-bb02244e818b, service=null, type=com.easemob.weichat.service.events.agent.AgentUserDisconnectedEvent, timestamp=1546164287013, properties={}, body={source={}, timestamp=1546164287013, actor=null, version=1.1, tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120, userPK={tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120}, agentUser=null, eventTime=1546164287013, kickOff=true}, topic=events, partitionKey=43:615deed4-32db-4129-a584-31f9cc582120).
2018-12-30 18:04:47,150 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:47,155 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:49,150 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:49,155 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:51,152 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:51,157 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:53,151 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:53,156 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:04 start
2018-12-30 18:04:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:04
2018-12-30 18:04:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:04 complete
2018-12-30 18:04:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:04:55,152 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:55,156 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:55,601 INFO  [kf-webapp-scheduler-pool-10]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:04:55,601 INFO  [kf-webapp-scheduler-pool-10]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:04:56,671 ERROR [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_3000_VisitorUserProcessor - Can not find visitor user, context MessageContext(channel=ChannelData(tenantId=43, type=IM, id=35, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=, info=easemob-demo#chatdemoui#119898), visitorUser=null, serviceSession=null, message=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={language=zh-CN, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, originType=webim}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM), chatMessage=null, officialAccount=null, serviceSessionRobot=null, routingPolicyType=null, expectedAgentUser=null, tenantId=43, status=NEXT, properties={})
2018-12-30 18:04:56,675 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c2e6c20-0c1a-11e9-92e6-ed931dda408a","type":"com.easemob.weichat.service.events.visitor.VisitorUserCreateEvent","timestamp":1546164296674,"body":{"source":{},"timestamp":1546164296674,"actor":null,"version":"1.1","visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"customerId":null}} has been send to kafka with in topic events partition 16, current offset is 3269
2018-12-30 18:04:56,676 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=5c2e6c20-0c1a-11e9-92e6-ed931dda408a, service=null, type=com.easemob.weichat.service.events.visitor.VisitorUserCreateEvent, timestamp=1546164296674, properties={}, body={source={}, timestamp=1546164296674, actor=null, version=1.1, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164296673, lastUpdateDateTime=1546164296673, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, customerId=null}, topic=events, partitionKey=null)
2018-12-30 18:04:56,690 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:null
2018-12-30 18:04:56,696 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-account-sessions/latest visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:null
2018-12-30 18:04:56,698 ERROR [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_3500_ServiceSessionProcessor - session not fount serviceSessionId:null context:{"channel":{"tenantId":43,"type":"easemob","id":35,"dutyType":"None","timeScheduleId":0,"name":"","info":"easemob-demo#chatdemoui#119898"},"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"message":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"tenantId":43,"properties":{}}
2018-12-30 18:04:56,699 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.WaitingQueueService - getWaitingQueueMaxFromDB(). read waitingQueueMax from DB, tenantId=43 waitingQueueMaxStr=200.
2018-12-30 18:04:56,699 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.WaitingQueueService - getWaitingQueueMaxFromDB(). tenantId=43 current AgentNumber=35
2018-12-30 18:04:56,699 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.WaitingQueueService - getWaitingQueueMax. Save waitingQueueMax value into Redis, tenantId=43 maxWaitingQueue=7000 refreshTime=5min.
2018-12-30 18:04:56,705 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountSession tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,710 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-session body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:04:56,712 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.CreateSessionProcessor - key: webim-visitor-YPHKB3EPCRK2XJRHC6EE, msg: {"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Prepare","chatGroupId":538,"messageSeqId":0,"agentUserType":1,"createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true}, result: true
2018-12-30 18:04:56,713 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), queueId=47, robotId=43, chatRoomId=null, state=Prepare, chatGroupId=538, messageSeqId=0, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2018-12-30 18:04:56,717 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:56 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:56,717 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:56,717 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:56 CST 2018.
2018-12-30 18:04:56,718 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:56,718 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:56,722 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:56 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:56,722 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:56,722 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:56 CST 2018.
2018-12-30 18:04:56,723 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:56,723 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:04:56,723 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:56,723 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:04:56,724 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70, matched robot id is 43
2018-12-30 18:04:56,724 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - ServiceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70,tenantId 43 , get routing result RoutingResult(queueId=47, robotId=43, agentUserId=null)
2018-12-30 18:04:56,730 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:56,733 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:56,733 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session mark delay sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,734 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session state change to wait sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,735 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - publish ServiceSessionCreatedEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,735 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionCreatedEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,735 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.r.s.l.SchedulerListenerForServiceSession - new service session created {"source":{},"timestamp":1546164296735,"actor":null,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Wait","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserType":6,"createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentCallback":false,"userPK":{"tenantId":43},"easemobMessage":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"channelData":{"tenantId":43,"type":"easemob","id":35,"dutyType":"None","timeScheduleId":0,"name":"","info":"easemob-demo#chatdemoui#119898"},"routingPolicyType":"Channel","kickOff":true}
2018-12-30 18:04:56,736 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c37baf0-0c1a-11e9-963c-cd2abf35ae8e","type":"com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent","timestamp":1546164296735,"body":{"source":{},"timestamp":1546164296735,"actor":null,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Wait","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserType":6,"createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentCallback":false,"userPK":{"tenantId":43},"easemobMessage":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"channelData":{"tenantId":43,"type":"easemob","id":35,"dutyType":"None","timeScheduleId":0,"name":"","info":"easemob-demo#chatdemoui#119898"},"routingPolicyType":"Channel","kickOff":true}} has been send to kafka with in topic events partition 10, current offset is 5181
2018-12-30 18:04:56,736 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.ServiceSessionTransferManager - schedule answer for schedule tenantId:43 agentUserId:c4fb2422-cc1c-4264-ad25-2fe937d00df1 serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 transferToAgent:false force:true scheduleId:null fromQueueId:null toQueueId:null time:null finishAck:true
2018-12-30 18:04:56,737 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionCreatedEvent ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=43, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), channelData=ChannelData(tenantId=43, type=IM, id=35, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=, info=easemob-demo#chatdemoui#119898), routingPolicyType=Channel)
2018-12-30 18:04:56,738 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionOpenedEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,738 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,739 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c383020-0c1a-11e9-b690-8d4d90e256c7","type":"com.easemob.weichat.service.events.session.ServiceSessionOpenedEvent","timestamp":1546164296738,"body":{"source":{},"timestamp":1546164296738,"actor":null,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Processing","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"scheduleId":null,"kickOff":true}} has been send to kafka with in topic events partition 10, current offset is 5182
2018-12-30 18:04:56,739 INFO  [SimpleAsyncTaskExecutor-49112]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionOpenedEvent, sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,739 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,740 INFO  [SimpleAsyncTaskExecutor-49113]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionOpenedEvent event:agent user [tenantId = 43scheduleId=null, userId = c4fb2422-cc1c-4264-ad25-2fe937d00df1] opened servicesession f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,740 INFO  [SimpleAsyncTaskExecutor-49115]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log : service session f5b5a7f4-c200-4e91-b13e-bdc528a5de70 opened to agent c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,741 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.r.s.l.SchedulerListenerForServiceSession - new service session created and auto dispatched sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,742 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingSessionTimerService - Save timer for service session f5b5a7f4-c200-4e91-b13e-bdc528a5de70 into redis, notifyTime = Sun Dec 30 18:07:56 CST 2018 notifyCount = 1 notifyInterval = 180 closeTime = null closeInterval = 0 closeNotifyTime = null closeNotifyCount = 0 closeNotifyInterval = 0
2018-12-30 18:04:56,742 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.l.ServiceSessionRelatedEventListener - Succeed to create service session queue timer for created servicesession f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,742 INFO  [SimpleAsyncTaskExecutor-49120]  c.e.w.r.s.l.ServiceSessionCreatedEventListener - expectedType is ServiceSessionCreatedEvent , event:ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=43, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat=KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), channelData=ChannelData(tenantId=43, type=IM, id=35, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=, info=easemob-demo#chatdemoui#119898), routingPolicyType=Channel)
2018-12-30 18:04:56,742 INFO  [SimpleAsyncTaskExecutor-49120]  c.e.w.r.s.l.ServiceSessionCreatedEventListener - ServiceSessionCreatedEventHandler | getKefuExt or visitor is null. message.getKefuExt():KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)
2018-12-30 18:04:56,742 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionCreatedEvent serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70,queueId:47
2018-12-30 18:04:56,742 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2018-12-30 18:04:56,742 INFO  [SimpleAsyncTaskExecutor-19]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:199c51d9-4712-4575-92e4-c6bf3ad62787 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","newSession":true,"fromUser":{"tenantId":0,"userType":"Visitor","userScope":"Tenant","roles":"","bizId":"0","scope":"Tenant","status":"Disable"}}}],"timestamp":1546164296741,"type":null}
2018-12-30 18:04:56,742 INFO  [SimpleAsyncTaskExecutor-19]  c.e.w.n.service.PushDataService - prepare message noticeId:199c51d9-4712-4575-92e4-c6bf3ad62787 messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,742 INFO  [SimpleAsyncTaskExecutor-49121]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionCreatedEvent, sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,742 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionCreatedEventHandler - systemMessage get ServiceSessionCreatedEvent,serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,742 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getQueueOption] ---> GET http://KefuLiteWebapp/v5/tenants/43/skillgroups/47/options/timeScheduleId HTTP/1.1
2018-12-30 18:04:56,742 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c38a550-0c1a-11e9-a2a7-adbc215dfea7","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164296741,"body":{"source":{},"timestamp":1546164296741,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","newSession":true,"fromUser":{"tenantId":0,"userType":"Visitor","userScope":"Tenant","roles":"","bizId":"0","scope":"Tenant","status":"Disable"}}}],"broadcast":false}}} has been send to kafka with in topic events partition 1, current offset is 3232
2018-12-30 18:04:56,742 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,747 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=5c38a550-0c1a-11e9-a2a7-adbc215dfea7, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164296741, properties={}, body={source={}, timestamp=1546164296741, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, newSession=true, fromUser={tenantId=0, userType=Visitor, userScope=Tenant, roles=, bizId=0, scope=Tenant, status=Disable}}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:04:56,747 INFO  [SimpleAsyncTaskExecutor-49112]  c.e.w.s.p.h.ServiceSessionEventHandler - updated session ProcessingSession(tenantId=43, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, skillGroupId=47, state=Processing, chatGroupId=538, createDateTime=Sun Dec 30 18:04:56 CST 2018, startDateTime=Sun Dec 30 18:04:56 CST 2018, originType=webim, fromAgentCallback=false, channelId=35, channelType=easemob, channelName=null, agentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentNickName=, agentType=6, visitorId=64c1a71d-fa70-46db-9942-cd23424a758b, visitorNickName=webim-visitor-YPHKB3EPCRK2XJRHC6EE, visitorUserName=webim-visitor-YPHKB3EPCRK2XJRHC6EE, customerId=0cec3ac0-ef4c-4082-ad61-2b2fa26087f3, customerNickName=webim-visitor-YPHKB3EPCRK2XJRHC6EE, customerTrueName=null) when got ServiceSessionOpenedEvent.
2018-12-30 18:04:56,747 INFO  [SimpleAsyncTaskExecutor-49112]  c.e.w.s.p.h.ServiceSessionEventHandler - begin to persist customer 0cec3ac0-ef4c-4082-ad61-2b2fa26087f3 tags from crm for session f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,748 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.q.s.WaitingSessionTimerService - Save timer for service session f5b5a7f4-c200-4e91-b13e-bdc528a5de70 into redis, notifyTime = Sun Dec 30 18:07:56 CST 2018 notifyCount = 1 notifyInterval = 180 closeTime = null closeInterval = 0 closeNotifyTime = null closeNotifyCount = 0 closeNotifyInterval = 0
2018-12-30 18:04:56,748 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.q.l.ServiceSessionRelatedEventListener - Succeed to create service session queue timer for created servicesession f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,748 INFO  [SimpleAsyncTaskExecutor-49122]  c.e.w.h.l.ServiceSessionHistoryListener - handle ServiceSessionCreatedEvent, start, serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,748 INFO  [SimpleAsyncTaskExecutor-49122]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=43, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat=KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), channelData=ChannelData(tenantId=43, type=IM, id=35, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=, info=easemob-demo#chatdemoui#119898), routingPolicyType=Channel)
2018-12-30 18:04:56,751 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - send serviceRequest f5b5a7f4-c200-4e91-b13e-bdc528a5de70 from processor
2018-12-30 18:04:56,752 INFO  [SimpleAsyncTaskExecutor-49113]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:agent user [tenantId = 43scheduleId=null, userId = c4fb2422-cc1c-4264-ad25-2fe937d00df1] opened servicesession f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,752 INFO  [SimpleAsyncTaskExecutor-49121]  c.e.w.s.p.h.ServiceSessionEventHandler - saved session ProcessingSession(tenantId=43, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, skillGroupId=47, state=Processing, chatGroupId=538, createDateTime=Sun Dec 30 18:04:56 CST 2018, startDateTime=Sun Dec 30 18:04:56 CST 2018, originType=webim, fromAgentCallback=false, channelId=35, channelType=easemob, channelName=, agentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentNickName=, agentType=6, visitorId=64c1a71d-fa70-46db-9942-cd23424a758b, visitorNickName=webim-visitor-YPHKB3EPCRK2XJRHC6EE, visitorUserName=webim-visitor-YPHKB3EPCRK2XJRHC6EE, customerId=0cec3ac0-ef4c-4082-ad61-2b2fa26087f3, customerNickName=webim-visitor-YPHKB3EPCRK2XJRHC6EE, customerTrueName=null) when got ServiceSessionCreatedEvent.
2018-12-30 18:04:56,753 ERROR [SimpleAsyncTaskExecutor-49121]  o.h.e.jdbc.spi.SqlExceptionHelper - Duplicate entry 'f5b5a7f4-c200-4e91-b13e-bdc528a5de70' for key 'PRIMARY'
2018-12-30 18:04:56,753 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getQueueOption] <--- HTTP/1.1 200 (11ms)
2018-12-30 18:04:56,754 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] ---> GET http://KefuLiteWebapp/v5/tenants/43/istimeoffduty?scheduleId=0&dateTime=2018-12-30+18%3A04%3A56 HTTP/1.1
2018-12-30 18:04:56,754 ERROR [SimpleAsyncTaskExecutor-49121]  o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected error occurred invoking async method 'public void com.easemob.weichat.service.processing.handlers.ServiceSessionEventHandler.onEvent(com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent)'.
org.springframework.dao.DataIntegrityViolationException: could not execute statement; SQL [n/a]; constraint [PRIMARY]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:278)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:521)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:761)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:730)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:504)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:292)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor$1.call(AsyncExecutionInterceptor.java:115)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:59)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:42)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:109)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:95)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:207)
	at org.hibernate.engine.jdbc.batch.internal.NonBatchingBatch.addToBatch(NonBatchingBatch.java:45)
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2949)
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3449)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:89)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:582)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:456)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:337)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1282)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:465)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2963)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2339)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:485)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:147)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.access$100(JdbcResourceLocalTransactionCoordinatorImpl.java:38)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:231)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:65)
	at org.hibernate.jpa.internal.TransactionImpl.commit(TransactionImpl.java:61)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:517)
	... 9 common frames omitted
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry 'f5b5a7f4-c200-4e91-b13e-bdc528a5de70' for key 'PRIMARY'
	at sun.reflect.GeneratedConstructorAccessor339.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:935)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2490)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.executeUpdateInternal(PreparedStatement.java:2079)
	at com.mysql.jdbc.PreparedStatement.executeUpdateInternal(PreparedStatement.java:2013)
	at com.mysql.jdbc.PreparedStatement.executeLargeUpdate(PreparedStatement.java:5104)
	at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1998)
	at sun.reflect.GeneratedMethodAccessor476.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.tomcat.jdbc.pool.StatementFacade$StatementProxy.invoke(StatementFacade.java:114)
	at com.sun.proxy.$Proxy467.executeUpdate(Unknown Source)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:204)
	... 28 common frames omitted
2018-12-30 18:04:56,754 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - serviceRequest f5b5a7f4-c200-4e91-b13e-bdc528a5de70 sended from processor
2018-12-30 18:04:56,755 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.ServiceSessionTransferManager - schedule answer for pre-schedule tenantId:43 agentUserId:c4fb2422-cc1c-4264-ad25-2fe937d00df1 serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 transferToAgent:false force:false scheduleId:null fromQueueId:null toQueueId:null time:null finishAck:false
2018-12-30 18:04:56,755 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionPreScheduleEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,755 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3aa120-0c1a-11e9-8cd9-69e4139a514b","type":"com.easemob.weichat.service.events.servicerequest.PublishServiceRequestEvent","timestamp":1546164296754,"body":{"source":{},"timestamp":1546164296754,"actor":null,"version":"1.1","serviceRequest":{"id":null,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","originType":"webim","channel":{"id":35,"name":"","type":"easemob"},"skillGroup":{"id":210,"name":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","type":"QueueTemp"},"visitorUser":{"id":"64c1a71d-fa70-46db-9942-cd23424a758b","nickname":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","isVip":0},"specifiedDateTime":1546164296734},"skipRouting":false,"useSpecifiedTime":true}} has been send to kafka with in topic events partition 10, current offset is 5183
2018-12-30 18:04:56,755 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3ac830-0c1a-11e9-a891-3b22ec70c0d7","type":"com.easemob.weichat.service.events.session.ServiceSessionPreScheduleEvent","timestamp":1546164296755,"body":{"source":{},"timestamp":1546164296755,"actor":null,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Processing","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"easemobMessage":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"preScheduleData":{"scheduleType":"Schedule","serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Processing","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","toAgentUserType":"Robot","toAgentQueueId":null,"easemobMessage":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""}}}} has been send to kafka with in topic events partition 10, current offset is 5184
2018-12-30 18:04:56,756 INFO  [SimpleAsyncTaskExecutor-12]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:7a50acf5-0c89-46a0-9463-e3119a3066f8 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"Schedule","body":{"scheduleType":"Schedule","serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Processing","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","toAgentUserType":"Robot","toAgentQueueId":null,"easemobMessage":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""}}}],"timestamp":1546164296755,"type":null}
2018-12-30 18:04:56,756 INFO  [SimpleAsyncTaskExecutor-12]  c.e.w.n.service.PushDataService - prepare message noticeId:7a50acf5-0c89-46a0-9463-e3119a3066f8 messageType:Schedule path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,756 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3ac83a-0c1a-11e9-bbf7-7f06f0d31738","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164296755,"body":{"source":{},"timestamp":1546164296755,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"Schedule","body":{"scheduleType":"Schedule","serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Processing","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","toAgentUserType":"Robot","toAgentQueueId":null,"easemobMessage":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""}}}],"broadcast":false}}} has been send to kafka with in topic events partition 19, current offset is 3089
2018-12-30 18:04:56,756 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session clear delay sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,757 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=5c3ac83a-0c1a-11e9-bbf7-7f06f0d31738, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164296755, properties={}, body={source={}, timestamp=1546164296755, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=Schedule, body={scheduleType=Schedule, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=43, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, toAgentUserType=Robot, toAgentQueueId=null, easemobMessage={bodies=[{msg=, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:04:56,758 INFO  [http-nio-8899-exec-4]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:04:56 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:04:56,759 INFO  [http-nio-8899-exec-4]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:04:56,759 INFO  [http-nio-8899-exec-4]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:04:56 CST 2018.
2018-12-30 18:04:56,761 INFO  [http-nio-8899-exec-4]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:04:56,761 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] <--- HTTP/1.1 200 (7ms)
2018-12-30 18:04:56,762 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 43 , serviceSessionId : f5b5a7f4-c200-4e91-b13e-bdc528a5de70,agentUserId : c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,762 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/43/messages HTTP/1.1
2018-12-30 18:04:56,763 INFO  [SimpleAsyncTaskExecutor-49124]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Sun Dec 30 18:04:56 CST 2018, lastUpdateDateTime=Sun Dec 30 18:04:56 CST 2018, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat=KefuExtMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=), msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296757, createMicroTimestamp=1546164296757000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), queueId=47, robotId=43, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:56,763 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:64c1a71d-fa70-46db-9942-cd23424a758b to 1546164296757 driven by message 8b5a3413-3be5-441e-9a09-0fa4e8ce1793
2018-12-30 18:04:56,763 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3bd9a0-0c1a-11e9-9ee1-af3e962ae98d","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164296762,"body":{"timestamp":1546164296762,"version":"1.1","tenantId":43,"message":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":""},"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":1,"sessionServiceSeqId":1,"createDateTime":1546164296757,"timestamp":1546164296757,"createMicroTimestamp":1546164296757000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":43,"state":"Processing","chatGroupId":538,"messageSeqId":0,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5185
2018-12-30 18:04:56,767 WARN  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - clear robot timeout notify count key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 has something wrong
2018-12-30 18:04:56,767 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/43/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"to":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","roles":"","bizId":"43","scope":"Tenant","status":"Disable"},"officialAccountId":null,"messageRequest":{"msg":"ServiceSessionCreatedEvent","type":"cmd","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":"ServiceSessionCreatedEvent","ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","mediaFileUrl":null,"tenantId":43,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","saveMessage":true}
2018-12-30 18:04:56,767 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3c75e0-0c1a-11e9-b5c6-2745c9fed028","type":"com.easemob.weichat.service.timeout.event.TimeoutClearEvent","timestamp":1546164296766,"body":{"source":{},"timestamp":1546164296766,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164296766,"duration":0,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":1,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296757,"timestamp":1546164296000,"createMicroTimestamp":1546164296757000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1070
2018-12-30 18:04:56,767 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - tenantId 43 message handle by robotmessageProcess
2018-12-30 18:04:56,768 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3c9cf0-0c1a-11e9-9b57-b378073e2206","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164296767,"body":{"source":{},"timestamp":1546164296767,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":1,"sessionServiceSeqId":1,"createDateTime":1546164296757,"timestamp":1546164296757,"createMicroTimestamp":1546164296757000}}],"broadcast":false}}} has been send to kafka with in topic events partition 9, current offset is 2991
2018-12-30 18:04:56,768 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:efda962f-012f-44d4-a2d1-a217ead46073 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":1,"sessionServiceSeqId":1,"createDateTime":1546164296757,"timestamp":1546164296757,"createMicroTimestamp":1546164296757000}}],"timestamp":1546164296767,"type":null}
2018-12-30 18:04:56,768 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - prepare message noticeId:efda962f-012f-44d4-a2d1-a217ead46073 messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,768 INFO  [http-nio-8899-exec-15]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:43 officialAccountId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,773 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:56,773 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - agent is robot and chatMessage is ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Sun Dec 30 18:04:56 CST 2018, lastUpdateDateTime=Sun Dec 30 18:04:56 CST 2018, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat=KefuExtMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296757, createMicroTimestamp=1546164296757000) ___________ serviceSession is ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296000, createMicroTimestamp=1546164296757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2018-12-30 18:04:56,773 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=5c3c9cf0-0c1a-11e9-9b57-b378073e2206, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164296767, properties={}, body={source={}, timestamp=1546164296767, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164296673, lastUpdateDateTime=1546164296673, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=1546164296757, timestamp=1546164296757, createMicroTimestamp=1546164296757000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:04:56,775 INFO  [SimpleAsyncTaskExecutor-49122]  c.e.w.h.client.RemoteCustomerClient -  findByTenantIdAndVisitorId use CrmApiClient , query: tenantId=43,visitorId=64c1a71d-fa70-46db-9942-cd23424a758b 
2018-12-30 18:04:56,776 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:56,776 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - tenantId 43 message reply by robot,serviceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,776 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - get answer by robot route tenantid 43 and msg is 
2018-12-30 18:04:56,776 INFO  [http-nio-8899-exec-11]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/sessions/f5b5a7f4-c200-4e91-b13e-bdc528a5de70/official-accounts
2018-12-30 18:04:56,780 INFO  [http-nio-8899-exec-15]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:e09b6fa1-122d-41ca-8ac6-85f3625c066c
2018-12-30 18:04:56,785 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:04:56,788 INFO  [SimpleAsyncTaskExecutor-49122]  c.e.w.h.l.ServiceSessionHistoryListener - handle ServiceSessionCreatedEvent, end, serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,788 INFO  [SimpleAsyncTaskExecutor-49127]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat=KefuExtMessage(msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=2, sessionServiceSeqId=2, createDateTime=2018-12-30 18:04:56.767, timestamp=1546164296767, createMicroTimestamp=1546164296767000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296000, createMicroTimestamp=1546164296757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:56,788 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c3fd140-0c1a-11e9-9686-a50b50fcaff1","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164296788,"body":{"timestamp":1546164296787,"version":"1.1","tenantId":43,"message":{"msgId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":2,"sessionServiceSeqId":2,"createDateTime":1546164296767,"timestamp":1546164296767,"createMicroTimestamp":1546164296767000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":1,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296757,"timestamp":1546164296000,"createMicroTimestamp":1546164296757000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5186
2018-12-30 18:04:56,789 INFO  [http-nio-8899-exec-15]  c.e.w.s.t.SendTimeoutEventService - this message {"msgId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":2,"sessionServiceSeqId":2,"createDateTime":1546164296767,"timestamp":1546164296767,"createMicroTimestamp":1546164296767000} is cmd Message .
2018-12-30 18:04:56,789 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (26ms)
2018-12-30 18:04:56,790 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c37baf0-0c1a-11e9-963c-cd2abf35ae8e, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent, timestamp=1546164296735, properties={}, body={source={}, timestamp=1546164296735, actor=null, version=1.1, tenantId=43, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=43, state=Wait, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserType=6, createDatetime=2018-12-30 18:04:56, techChannelType=easemob, originType=webim, expire=true}, fromAgentCallback=false, userPK={tenantId=43}, easemobMessage={bodies=[{msg=, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, channelData={tenantId=43, type=easemob, id=35, dutyType=None, timeScheduleId=0, name=, info=easemob-demo#chatdemoui#119898}, routingPolicyType=Channel, kickOff=true}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:56,796 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session f5b5a7f4-c200-4e91-b13e-bdc528a5de70.
2018-12-30 18:04:56,796 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionOpenedEvent serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70,queueId:47
2018-12-30 18:04:56,796 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2018-12-30 18:04:56,796 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionOpenedEventHandler - systemMessage get ServiceSessionOpenedEvent serviceSessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,798 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.s.t.TransferedSessionNoPerceptionRedisService - redis key agent.greeting.number.f5b5a7f4-c200-4e91-b13e-bdc528a5de70 set value = 1 ,expire day-time 1
2018-12-30 18:04:56,798 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 43 , serviceSessionId : f5b5a7f4-c200-4e91-b13e-bdc528a5de70,agentUserId : c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,798 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/43/messages HTTP/1.1
2018-12-30 18:04:56,803 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/43/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"to":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","roles":"","bizId":"43","scope":"Tenant","status":"Disable"},"officialAccountId":null,"messageRequest":{"msg":"ServiceSessionOpenedEvent","type":"cmd","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":"ServiceSessionOpenedEvent","ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","mediaFileUrl":null,"tenantId":43,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","saveMessage":true}
2018-12-30 18:04:56,804 INFO  [http-nio-8899-exec-14]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:43 officialAccountId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:56,808 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/sessions/f5b5a7f4-c200-4e91-b13e-bdc528a5de70/official-accounts
2018-12-30 18:04:56,811 INFO  [http-nio-8899-exec-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:7e9af4bb-2f14-4d5d-ab0a-a7d886905967
2018-12-30 18:04:56,815 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:04:56,817 INFO  [SimpleAsyncTaskExecutor-49130]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat=KefuExtMessage(msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=3, sessionServiceSeqId=3, createDateTime=2018-12-30 18:04:56.803, timestamp=1546164296803, createMicroTimestamp=1546164296803000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=2, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.767, timestamp=1546164296000, createMicroTimestamp=1546164296767000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:56,817 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c443e10-0c1a-11e9-8003-5302a2784acb","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164296817,"body":{"timestamp":1546164296816,"version":"1.1","tenantId":43,"message":{"msgId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":3,"sessionServiceSeqId":3,"createDateTime":1546164296803,"timestamp":1546164296803,"createMicroTimestamp":1546164296803000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":2,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"e09b6fa1-122d-41ca-8ac6-85f3625c066c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296767,"timestamp":1546164296000,"createMicroTimestamp":1546164296767000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5187
2018-12-30 18:04:56,818 INFO  [http-nio-8899-exec-14]  c.e.w.s.t.SendTimeoutEventService - this message {"msgId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":3,"sessionServiceSeqId":3,"createDateTime":1546164296803,"timestamp":1546164296803,"createMicroTimestamp":1546164296803000} is cmd Message .
2018-12-30 18:04:56,818 DEBUG [hystrix-KefuLiteWebapp-50]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (19ms)
2018-12-30 18:04:56,819 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c383020-0c1a-11e9-b690-8d4d90e256c7, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionOpenedEvent, timestamp=1546164296738, properties={}, body={source={}, timestamp=1546164296738, actor=null, version=1.1, tenantId=43, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=43, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, techChannelType=easemob, originType=webim, expire=true}, userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, scheduleId=null, kickOff=true}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:56,821 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=5c3aa120-0c1a-11e9-8cd9-69e4139a514b, service=null, type=com.easemob.weichat.service.events.servicerequest.PublishServiceRequestEvent, timestamp=1546164296754, properties={}, body={source={}, timestamp=1546164296754, actor=null, version=1.1, serviceRequest={id=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, originType=webim, channel={id=35, name=, type=easemob}, skillGroup={id=210, name=c4fb2422-cc1c-4264-ad25-2fe937d00df1, type=QueueTemp}, visitorUser={id=64c1a71d-fa70-46db-9942-cd23424a758b, nickname=webim-visitor-YPHKB3EPCRK2XJRHC6EE, isVip=0}, specifiedDateTime=1546164296734}, skipRouting=false, useSpecifiedTime=true}, topic=events, partitionKey=null)
2018-12-30 18:04:56,822 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296757, createMicroTimestamp=1546164296757000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Sun Dec 30 18:04:57 CST 2018, lastUpdateDateTime=Sun Dec 30 18:04:57 CST 2018, sendMessageCount=0), queueId=47, robotId=43, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:56,822 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c3ac830-0c1a-11e9-a891-3b22ec70c0d7, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionPreScheduleEvent, timestamp=1546164296755, properties={}, body={source={}, timestamp=1546164296755, actor=null, version=1.1, tenantId=43, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=43, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, techChannelType=easemob, originType=webim, expire=true}, easemobMessage={bodies=[{msg=, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, preScheduleData={scheduleType=Schedule, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=43, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, toAgentUserType=Robot, toAgentQueueId=null, easemobMessage={bodies=[{msg=, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:56,822 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 43 , serviceSessionId : f5b5a7f4-c200-4e91-b13e-bdc528a5de70,agentUserId : c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:56,823 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c3bd9a0-0c1a-11e9-9ee1-af3e962ae98d, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164296762, properties={}, body={timestamp=1546164296762, version=1.1, tenantId=43, message={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164296673, lastUpdateDateTime=1546164296673, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=1546164296757, timestamp=1546164296757, createMicroTimestamp=1546164296757000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=43, state=Processing, chatGroupId=538, messageSeqId=0, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:56,826 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=2, sessionServiceSeqId=2, createDateTime=2018-12-30 18:04:56.767, timestamp=1546164296767, createMicroTimestamp=1546164296767000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296000, createMicroTimestamp=1546164296757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:56,826 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c3fd140-0c1a-11e9-9686-a50b50fcaff1, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164296788, properties={}, body={timestamp=1546164296787, version=1.1, tenantId=43, message={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionCreatedEvent, type=cmd}], ext={weichat={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=2, sessionServiceSeqId=2, createDateTime=1546164296767, timestamp=1546164296767, createMicroTimestamp=1546164296767000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164296757, timestamp=1546164296000, createMicroTimestamp=1546164296757000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:56,829 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=3, sessionServiceSeqId=3, createDateTime=2018-12-30 18:04:56.803, timestamp=1546164296803, createMicroTimestamp=1546164296803000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=2, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.767, timestamp=1546164296000, createMicroTimestamp=1546164296767000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:56,830 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c443e10-0c1a-11e9-8003-5302a2784acb, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164296817, properties={}, body={timestamp=1546164296816, version=1.1, tenantId=43, message={msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionOpenedEvent, type=cmd}], ext={weichat={msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=3, sessionServiceSeqId=3, createDateTime=1546164296803, timestamp=1546164296803, createMicroTimestamp=1546164296803000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=2, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionCreatedEvent, type=cmd}], ext={weichat={msgId=e09b6fa1-122d-41ca-8ac6-85f3625c066c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164296767, timestamp=1546164296000, createMicroTimestamp=1546164296767000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:57,031 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - askRobotIntegrationForAnswer feign client success, tenantId : 43, robotId : QuestionInfo(tenantId=43, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, askUserId=64c1a71d-fa70-46db-9942-cd23424a758b, robotId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, questionId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, question=, userLocation=null, userLocale=zh-CN, robotAppParam={"zabx":{"service_id":"119898"}}, strategyTransData={"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}, questionType=null), questionInfo : EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat=KefuExtMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), easemobMessage : ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296000, createMicroTimestamp=1546164296757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), serviceSession RobotAnswer(enableSilence=false, answerType=BESTMATCH, type=1, content={"transferToKf":false,"content":{"mid":"92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","type":"image/png","name":".png","objectMeta":{"width":928,"height":547}},"type":"img"}, similarity=null, words=null, answerDataType=null)
2018-12-30 18:04:57,031 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied serviceSession {"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":1,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296757,"timestamp":1546164296000,"createMicroTimestamp":1546164296757000},"techChannelType":"easemob","originType":"webim","expire":true} ,RobotAnswer is {"enableSilence":false,"type":1,"content":"{\"transferToKf\":false,\"content\":{\"mid\":\"92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==\",\"type\":\"image/png\",\"name\":\".png\",\"objectMeta\":{\"width\":928,\"height\":547}},\"type\":\"img\"}","similarity":null,"words":null,"answerType":null} ,ServiceSessionRobot is {"id":764,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","robotId":43,"createdAt":"2018-12-30 18:04:56","updatedAt":"2018-12-30 18:04:56"}
2018-12-30 18:04:57,031 INFO  [http-nio-8899-exec-4]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","tenantId":43,"type":"StateChange"}}],"timestamp":1546164296927,"type":null}
2018-12-30 18:04:57,031 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied RobotAnswer(enableSilence=false, answerType=BESTMATCH, type=1, content={"transferToKf":false,"content":{"mid":"92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","type":"image/png","name":".png","objectMeta":{"width":928,"height":547}},"type":"img"}, similarity=null, words=null, answerDataType=null) to visitor for question ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Sun Dec 30 18:04:56 CST 2018, lastUpdateDateTime=Sun Dec 30 18:04:56 CST 2018, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat=KefuExtMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296757, createMicroTimestamp=1546164296757000)
2018-12-30 18:04:57,031 INFO  [http-nio-8899-exec-4]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:a107394d-4956-4017-b016-526aa2f93906 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","tenantId":43,"type":"StateChange"}}],"timestamp":1546164296927,"type":null}
2018-12-30 18:04:57,031 INFO  [http-nio-8899-exec-4]  c.e.w.n.service.PushDataService - prepare message noticeId:a107394d-4956-4017-b016-526aa2f93906 messageType:Daas path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:57,035 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:57,037 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:57,040 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotAgentIdFromIntegration feign client success, tenantId : 43, robotAgentId : c4fb2422-cc1c-4264-ad25-2fe937d00df1, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:57,040 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:43 officialAccountId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:04:57,044 INFO  [http-nio-8899-exec-11]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/sessions/f5b5a7f4-c200-4e91-b13e-bdc528a5de70/official-accounts
2018-12-30 18:04:57,049 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa
2018-12-30 18:04:57,054 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:04:57,057 INFO  [SimpleAsyncTaskExecutor-49133]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobImageMessageBody@2e46621b], ext={weichat=KefuExtMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=4, sessionServiceSeqId=2, createDateTime=2018-12-30 18:04:57.04, timestamp=1546164297040, createMicroTimestamp=1546164297040000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296000, createMicroTimestamp=1546164296757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:57,059 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c68dd10-0c1a-11e9-a193-8dc6bf24359c","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164297057,"body":{"timestamp":1546164297057,"version":"1.1","tenantId":43,"message":{"msgId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"7b721036-5b84-4805-b4e7-4832bb586269","userType":"Robot","userScope":"Tenant","nicename":"","robotId":"7b721036-5b84-4805-b4e7-4832bb586269","type":0,"active":false,"rule":0,"enableMenu":false,"enableGreeting":false,"enableSimilarQuestionTransfer":false,"enableNoAnswerTransfer":false,"enableFreeChat":false,"currentServiceSessionCount":0,"maxServiceSessionCount":0,"timeout":180,"robotRouteId":"43","robotAgentId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","digitalMenu":false,"roles":"robot","username":"7b721036-5b84-4805-b4e7-4832bb586269","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"url":"/v1/Tenant/43/MediaFiles/92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","secret":"","filename":".png","size":{"width":928,"height":547},"mediaId":"92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","thumbSecret":"","type":"img"}],"ext":{"weichat":{"msgId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":4,"sessionServiceSeqId":2,"createDateTime":1546164297040,"timestamp":1546164297040,"createMicroTimestamp":1546164297040000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":1,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296757,"timestamp":1546164296000,"createMicroTimestamp":1546164296757000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5188
2018-12-30 18:04:57,061 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=43, userId=7b721036-5b84-4805-b4e7-4832bb586269, userType=Robot, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobImageMessageBody@6502c36], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=4, sessionServiceSeqId=2, createDateTime=2018-12-30 18:04:57.04, timestamp=1546164297040, createMicroTimestamp=1546164297040000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7102115], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:04:56 CST 2018, msgId=552330605514195348, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:56.757, timestamp=1546164296000, createMicroTimestamp=1546164296757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:04:57,062 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=5c68dd10-0c1a-11e9-a193-8dc6bf24359c, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164297057, properties={}, body={timestamp=1546164297057, version=1.1, tenantId=43, message={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=7b721036-5b84-4805-b4e7-4832bb586269, userType=Robot, userScope=Tenant, nicename=, robotId=7b721036-5b84-4805-b4e7-4832bb586269, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false, roles=robot, username=7b721036-5b84-4805-b4e7-4832bb586269, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{url=/v1/Tenant/43/MediaFiles/92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==, secret=, filename=.png, size={width=928, height=547}, mediaId=92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==, thumbSecret=, type=img}], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=4, sessionServiceSeqId=2, createDateTime=1546164297040, timestamp=1546164297040, createMicroTimestamp=1546164297040000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=1, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164296757, timestamp=1546164296000, createMicroTimestamp=1546164296757000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:04:57,063 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:57,066 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:04:57,066 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - robot timeout is 180 from sendRobotTimeoutFirstStartEvent
2018-12-30 18:04:57,066 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - set robot timeout notify count key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 for serviceSession f5b5a7f4-c200-4e91-b13e-bdc528a5de70 notify count is 1 , value is 2
2018-12-30 18:04:57,066 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.service.message.Processor - tenantId is 43 send toVisitorMessage is ChatMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobImageMessageBody@2e46621b], ext={weichat=KefuExtMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=4, sessionServiceSeqId=2, createDateTime=2018-12-30 18:04:57.04, timestamp=1546164297040, createMicroTimestamp=1546164297040000)
2018-12-30 18:04:57,066 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c6a3ca0-0c1a-11e9-885c-cd51d8ea7e8d","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546164297066,"body":{"source":{},"timestamp":1546164297066,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164297066,"duration":180,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":1,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296757,"timestamp":1546164296000,"createMicroTimestamp":1546164296757000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1071
2018-12-30 18:04:57,067 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5c6a3caa-0c1a-11e9-823b-198d1d11587d","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164297066,"body":{"source":{},"timestamp":1546164297066,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":1,"sessionServiceSeqId":1,"createDateTime":1546164296757,"timestamp":1546164296757,"createMicroTimestamp":1546164296757000}}],"broadcast":false}}} has been send to kafka with in topic events partition 18, current offset is 2890
2018-12-30 18:04:57,067 INFO  [SimpleAsyncTaskExecutor-16]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:3559333a-3770-4ad3-9926-d8bbf990c8a3 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164296673,"lastUpdateDateTime":1546164296673,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"8b5a3413-3be5-441e-9a09-0fa4e8ce1793","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164296661,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330605514195348","channel_id":35,"channel_name":""},"chatGroupSeqId":1,"sessionServiceSeqId":1,"createDateTime":1546164296757,"timestamp":1546164296757,"createMicroTimestamp":1546164296757000}}],"timestamp":1546164297066,"type":null}
2018-12-30 18:04:57,067 INFO  [SimpleAsyncTaskExecutor-16]  c.e.w.n.service.PushDataService - prepare message noticeId:3559333a-3770-4ad3-9926-d8bbf990c8a3 messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:04:57,068 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=5c6a3caa-0c1a-11e9-823b-198d1d11587d, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164297066, properties={}, body={source={}, timestamp=1546164297066, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164296673, lastUpdateDateTime=1546164296673, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=8b5a3413-3be5-441e-9a09-0fa4e8ce1793, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164296661, tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330605514195348, channel_id=35, channel_name=}, chatGroupSeqId=1, sessionServiceSeqId=1, createDateTime=1546164296757, timestamp=1546164296757, createMicroTimestamp=1546164296757000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:04:57,152 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:57,156 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:04:59,152 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:04:59,157 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:00,013 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:00,013 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:01,152 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:01,156 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:03,016 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:03,016 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:03,151 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:03,156 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:05,151 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:05,161 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:06,019 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:06,019 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:07,152 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:07,156 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:09,022 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:09,022 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:09,156 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:09,161 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:10,309 INFO  [http-nio-8899-exec-5]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/visitors/configs/1276c4f5-fec3-4651-bb2c-52d09f976628
2018-12-30 18:05:10,744 INFO  [http-nio-8899-exec-12]  c.e.w.w.mvc.WebimPluginController - GET /v1/webimplugin/visitors/password2 orgName:easemob-demo appName:chatdemoui imServiceNumber:119898 username:webim-visitor-YPHKB3EPCRK2XJRHC6EE
2018-12-30 18:05:10,745 INFO  [http-nio-8899-exec-12]  c.e.w.w.s.impl.WebimPluginService - isReadIMUserNew is true,getWebimFromUser from new table return is {"id":0,"userId":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","userPassword":"VJH68FJE8C"},orgName:easemob-demo,appName:chatdemoui,imServiceNumber:119898
2018-12-30 18:05:10,857 INFO  [http-nio-8899-exec-11]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:10 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:10,857 INFO  [http-nio-8899-exec-11]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:10,858 INFO  [http-nio-8899-exec-11]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:10 CST 2018.
2018-12-30 18:05:10,858 WARN  [http-nio-8899-exec-4]  o.s.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/v1/webimplugin/tenants/43/info] in DispatcherServlet with name 'dispatcherServlet'
2018-12-30 18:05:10,858 INFO  [http-nio-8899-exec-11]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:10,859 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:10,862 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:10 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:10,863 INFO  [http-nio-8899-exec-9]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:10,863 INFO  [http-nio-8899-exec-9]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:10 CST 2018.
2018-12-30 18:05:10,864 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:10,864 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:10,864 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:10,864 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:10,865 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:05:10,865 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:05:10,875 INFO  [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:10,878 INFO  [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:10,878 INFO  [http-nio-8899-exec-2]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:05:11,019 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:11 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:11,019 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:11,019 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:11 CST 2018.
2018-12-30 18:05:11,020 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:11,021 INFO  [http-nio-8899-exec-6]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:11,024 INFO  [http-nio-8899-exec-4]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:11 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:11,024 INFO  [http-nio-8899-exec-4]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:11,024 INFO  [http-nio-8899-exec-4]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:11 CST 2018.
2018-12-30 18:05:11,025 INFO  [http-nio-8899-exec-4]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:11,026 INFO  [http-nio-8899-exec-6]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:11,026 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:11,026 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:11,026 INFO  [http-nio-8899-exec-6]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:05:11,026 INFO  [http-nio-8899-exec-6]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:05:11,034 INFO  [http-nio-8899-exec-9]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:11,036 INFO  [http-nio-8899-exec-9]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:11,037 INFO  [http-nio-8899-exec-5]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:05:11,092 INFO  [http-nio-8899-exec-15]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccounts tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b page:0 size:100
2018-12-30 18:05:11,096 INFO  [http-nio-8899-exec-2]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/visitors/64c1a71d-fa70-46db-9942-cd23424a758b/official-accounts page:0 size:100
2018-12-30 18:05:11,153 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:11,157 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:11,209 INFO  [http-nio-8899-exec-12]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:11,213 INFO  [http-nio-8899-exec-4]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/visitors/64c1a71d-fa70-46db-9942-cd23424a758b/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages startId:null direction:before size:10
2018-12-30 18:05:11,214 INFO  [http-nio-8899-exec-11]  c.e.w.w.s.i.WebimOfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:11,217 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-account-sessions/latest visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:12,026 ERROR [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  c.e.w.s.s.impl.BaiduApiIpLookUp - ipToRegion error ip:183.210.86.131
org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://apis.baidu.com/apistore/iplookupservice/iplookup": Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out; nested exception is org.apache.http.conn.ConnectTimeoutException: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:666)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:613)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:531)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.ipToRegion(BaiduApiIpLookUp.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.lookUp(BaiduApiIpLookUp.java:39)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.buildRegion(IpServiceSessionAttributeProcessor.java:59)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.processServiceSessionAttribute(IpServiceSessionAttributeProcessor.java:47)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesManager.saveServiceSessionAttributes(ServiceSessionAttributesManager.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesCreationWorker.run(ServiceSessionAttributesCreationWorker.java:43)
	at com.easemob.weichat.service.message.BlockingRedisMessageConsumer$InternalQueueConsumer.run(BlockingRedisMessageConsumer.java:187)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.http.conn.ConnectTimeoutException: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:143)
	at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:353)
	at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:380)
	at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)
	at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)
	at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:88)
	at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)
	at org.apache.http.impl.execchain.ServiceUnavailableRetryExec.execute(ServiceUnavailableRetryExec.java:84)
	at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:55)
	at org.springframework.http.client.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:89)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:53)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:652)
	... 14 common frames omitted
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.http.conn.socket.PlainConnectionSocketFactory.connectSocket(PlainConnectionSocketFactory.java:74)
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:134)
	... 28 common frames omitted
2018-12-30 18:05:12,029 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-16]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionAttributesUpdateEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:12,030 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"655568d0-0c1a-11e9-9337-6f5dfa0e97ac","type":"com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent","timestamp":1546164312029,"body":{"timestamp":1546164312029,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":3,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"7e9af4bb-2f14-4d5d-ab0a-a7d886905967","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentType":6,"sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164296803,"timestamp":1546164296000,"createMicroTimestamp":1546164296803000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5189
2018-12-30 18:05:12,030 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"655568da-0c1a-11e9-b437-dd2576eefcaf","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164312029,"body":{"source":{},"timestamp":1546164312029,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"ServiceSessionAttributesChange","body":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}],"broadcast":false}}} has been send to kafka with in topic events partition 12, current offset is 3344
2018-12-30 18:05:12,030 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:18ec9465-f7e8-4252-ae95-96510c4076d3 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"ServiceSessionAttributesChange","body":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}],"timestamp":1546164312029,"type":null}
2018-12-30 18:05:12,030 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - prepare message noticeId:18ec9465-f7e8-4252-ae95-96510c4076d3 messageType:ServiceSessionAttributesChange path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:12,031 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=655568da-0c1a-11e9-b437-dd2576eefcaf, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164312029, properties={}, body={source={}, timestamp=1546164312029, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=ServiceSessionAttributesChange, body=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:12,032 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=655568d0-0c1a-11e9-9337-6f5dfa0e97ac, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent, timestamp=1546164312029, properties={}, body={timestamp=1546164312029, version=1.1, tenantId=43, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=3, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionOpenedEvent, type=cmd}], ext={weichat={msgId=7e9af4bb-2f14-4d5d-ab0a-a7d886905967, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentType=6, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164296803, timestamp=1546164296000, createMicroTimestamp=1546164296803000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:13,153 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:13,157 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:05 start
2018-12-30 18:05:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:05
2018-12-30 18:05:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:05 complete
2018-12-30 18:05:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:05:14,412 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:14,412 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:15,153 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:15,157 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:17,153 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:17,158 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:17,415 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:17,415 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:19,153 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:19,158 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:20,419 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:20,419 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:21,066 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:21,071 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-account-sessions/latest visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:21,072 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccount tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:21,076 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:21,077 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=4, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobImageMessageBody@2f8739e4], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:57.04, timestamp=1546164297000, createMicroTimestamp=1546164297040000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2018-12-30 18:05:21,079 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:a2290fe1-e9c9-439b-a861-f25d29a42cab
2018-12-30 18:05:21,085 INFO  [http-nio-8899-exec-14]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:05:21,088 INFO  [SimpleAsyncTaskExecutor-49137]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat=KefuExtMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=), msgIdForAck=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321077, createMicroTimestamp=1546164321077000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=4, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobImageMessageBody@2f8739e4], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:57.04, timestamp=1546164297000, createMicroTimestamp=1546164297040000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:21,089 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:64c1a71d-fa70-46db-9942-cd23424a758b to 1546164321077 driven by message a2290fe1-e9c9-439b-a861-f25d29a42cab
2018-12-30 18:05:21,089 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6abbb400-0c1a-11e9-b9c9-7385bcf49063","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164321088,"body":{"timestamp":1546164321088,"version":"1.1","tenantId":43,"message":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":""},"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":5,"sessionServiceSeqId":5,"createDateTime":1546164321077,"timestamp":1546164321077,"createMicroTimestamp":1546164321077000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":4,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"url":"/v1/Tenant/43/MediaFiles/92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","secret":"","filename":".png","size":{"width":928,"height":547},"mediaId":"92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","thumbSecret":"","type":"img"}],"ext":{"weichat":{"msgId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164297040,"timestamp":1546164297000,"createMicroTimestamp":1546164297040000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5190
2018-12-30 18:05:21,091 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6abc0220-0c1a-11e9-8282-53008d994ac2","type":"com.easemob.weichat.service.timeout.event.TimeoutClearEvent","timestamp":1546164321090,"body":{"source":{},"timestamp":1546164321090,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164321090,"duration":0,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":5,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164321077,"timestamp":1546164321000,"createMicroTimestamp":1546164321077000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1072
2018-12-30 18:05:21,091 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - clear robot timeout notify count key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:21,091 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - tenantId 43 message handle by robotmessageProcess
2018-12-30 18:05:21,091 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321077, createMicroTimestamp=1546164321077000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Sun Dec 30 18:04:57 CST 2018, lastUpdateDateTime=Sun Dec 30 18:04:57 CST 2018, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=4, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobImageMessageBody@44a61b6e], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:04:57.04, timestamp=1546164297000, createMicroTimestamp=1546164297040000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:21,091 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 43 , serviceSessionId : f5b5a7f4-c200-4e91-b13e-bdc528a5de70,agentUserId : c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:21,092 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6abc293a-0c1a-11e9-8448-cfcc3b0e244e","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164321091,"body":{"source":{},"timestamp":1546164321091,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":5,"sessionServiceSeqId":5,"createDateTime":1546164321077,"timestamp":1546164321077,"createMicroTimestamp":1546164321077000}}],"broadcast":false}}} has been send to kafka with in topic events partition 3, current offset is 2830
2018-12-30 18:05:21,092 INFO  [SimpleAsyncTaskExecutor-14]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5866845e-55fa-49fd-8fdc-35db8d7e7439 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":5,"sessionServiceSeqId":5,"createDateTime":1546164321077,"timestamp":1546164321077,"createMicroTimestamp":1546164321077000}}],"timestamp":1546164321091,"type":null}
2018-12-30 18:05:21,092 INFO  [SimpleAsyncTaskExecutor-14]  c.e.w.n.service.PushDataService - prepare message noticeId:5866845e-55fa-49fd-8fdc-35db8d7e7439 messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:21,092 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=6abbb400-0c1a-11e9-b9c9-7385bcf49063, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164321088, properties={}, body={timestamp=1546164321088, version=1.1, tenantId=43, message={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164321053, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330710233383316, channel_id=35, channel_name=}, chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=1546164321077, timestamp=1546164321077, createMicroTimestamp=1546164321077000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=4, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{url=/v1/Tenant/43/MediaFiles/92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==, secret=, filename=.png, size={width=928, height=547}, mediaId=92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==, thumbSecret=, type=img}], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164297040, timestamp=1546164297000, createMicroTimestamp=1546164297040000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:21,093 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=6abc293a-0c1a-11e9-8448-cfcc3b0e244e, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164321091, properties={}, body={source={}, timestamp=1546164321091, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164321053, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330710233383316, channel_id=35, channel_name=}, chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=1546164321077, timestamp=1546164321077, createMicroTimestamp=1546164321077000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:21,095 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,095 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - agent is robot and chatMessage is ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat=KefuExtMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321077, createMicroTimestamp=1546164321077000) ___________ serviceSession is ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=5, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321000, createMicroTimestamp=1546164321077000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2018-12-30 18:05:21,098 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,098 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - tenantId 43 message reply by robot,serviceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:21,098 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - get answer by robot route tenantid 43 and msg is 
2018-12-30 18:05:21,153 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:21,156 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:21,348 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - askRobotIntegrationForAnswer feign client success, tenantId : 43, robotId : QuestionInfo(tenantId=43, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, askUserId=64c1a71d-fa70-46db-9942-cd23424a758b, robotId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, questionId=a2290fe1-e9c9-439b-a861-f25d29a42cab, question=, userLocation=null, userLocale=zh-CN, robotAppParam={"zabx":{"service_id":"119898"}}, strategyTransData={"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}, questionType=null), questionInfo : EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat=KefuExtMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), easemobMessage : ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=5, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321000, createMicroTimestamp=1546164321077000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), serviceSession RobotAnswer(enableSilence=false, answerType=BESTMATCH, type=1, content={"transferToKf":false,"content":""}, similarity=null, words=null, answerDataType=null)
2018-12-30 18:05:21,348 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied serviceSession {"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":5,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164321077,"timestamp":1546164321000,"createMicroTimestamp":1546164321077000},"techChannelType":"easemob","originType":"webim","expire":true} ,RobotAnswer is {"enableSilence":false,"type":1,"content":"{\"transferToKf\":false,\"content\":\"\"}","similarity":null,"words":null,"answerType":null} ,ServiceSessionRobot is {"id":764,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","robotId":43,"createdAt":"2018-12-30 18:04:56","updatedAt":"2018-12-30 18:04:56"}
2018-12-30 18:05:21,348 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied RobotAnswer(enableSilence=false, answerType=BESTMATCH, type=1, content={"transferToKf":false,"content":""}, similarity=null, words=null, answerDataType=null) to visitor for question ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat=KefuExtMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321077, createMicroTimestamp=1546164321077000)
2018-12-30 18:05:21,351 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,354 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,357 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotAgentIdFromIntegration feign client success, tenantId : 43, robotAgentId : c4fb2422-cc1c-4264-ad25-2fe937d00df1, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,357 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:43 officialAccountId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:21,362 INFO  [http-nio-8899-exec-4]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/sessions/f5b5a7f4-c200-4e91-b13e-bdc528a5de70/official-accounts
2018-12-30 18:05:21,367 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0
2018-12-30 18:05:21,371 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:05:21,374 INFO  [SimpleAsyncTaskExecutor-49140]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a2e2bcaf], ext={weichat=KefuExtMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=), msgIdForAck=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=6, sessionServiceSeqId=6, createDateTime=2018-12-30 18:05:21.357, timestamp=1546164321357, createMicroTimestamp=1546164321357000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=5, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321000, createMicroTimestamp=1546164321077000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:21,375 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6ae730d0-0c1a-11e9-a4ac-83d363a90e7d","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164321373,"body":{"timestamp":1546164321373,"version":"1.1","tenantId":43,"message":{"msgId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"7b721036-5b84-4805-b4e7-4832bb586269","userType":"Robot","userScope":"Tenant","nicename":"","robotId":"7b721036-5b84-4805-b4e7-4832bb586269","type":0,"active":false,"rule":0,"enableMenu":false,"enableGreeting":false,"enableSimilarQuestionTransfer":false,"enableNoAnswerTransfer":false,"enableFreeChat":false,"currentServiceSessionCount":0,"maxServiceSessionCount":0,"timeout":180,"robotRouteId":"43","robotAgentId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","digitalMenu":false,"roles":"robot","username":"7b721036-5b84-4805-b4e7-4832bb586269","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":6,"sessionServiceSeqId":6,"createDateTime":1546164321357,"timestamp":1546164321357,"createMicroTimestamp":1546164321357000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":5,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164321077,"timestamp":1546164321000,"createMicroTimestamp":1546164321077000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5191
2018-12-30 18:05:21,377 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=43, userId=7b721036-5b84-4805-b4e7-4832bb586269, userType=Robot, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a2e2bcaf], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=6, sessionServiceSeqId=6, createDateTime=2018-12-30 18:05:21.357, timestamp=1546164321357, createMicroTimestamp=1546164321357000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=5, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4373bd93], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:21 CST 2018, msgId=552330710233383316, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.077, timestamp=1546164321000, createMicroTimestamp=1546164321077000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:21,378 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=6ae730d0-0c1a-11e9-a4ac-83d363a90e7d, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164321373, properties={}, body={timestamp=1546164321373, version=1.1, tenantId=43, message={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=7b721036-5b84-4805-b4e7-4832bb586269, userType=Robot, userScope=Tenant, nicename=, robotId=7b721036-5b84-4805-b4e7-4832bb586269, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false, roles=robot, username=7b721036-5b84-4805-b4e7-4832bb586269, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=6, sessionServiceSeqId=6, createDateTime=1546164321357, timestamp=1546164321357, createMicroTimestamp=1546164321357000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=5, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164321053, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330710233383316, channel_id=35, channel_name=}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164321077, timestamp=1546164321000, createMicroTimestamp=1546164321077000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:21,378 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,381 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:21,381 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - robot timeout is 180 from sendRobotTimeoutFirstStartEvent
2018-12-30 18:05:21,382 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - set robot timeout notify count key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 for serviceSession f5b5a7f4-c200-4e91-b13e-bdc528a5de70 notify count is 1 , value is 2
2018-12-30 18:05:21,382 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.service.message.Processor - tenantId is 43 send toVisitorMessage is ChatMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a2e2bcaf], ext={weichat=KefuExtMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=6, sessionServiceSeqId=6, createDateTime=2018-12-30 18:05:21.357, timestamp=1546164321357, createMicroTimestamp=1546164321357000)
2018-12-30 18:05:21,382 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6ae86950-0c1a-11e9-b630-954db1895c3b","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546164321381,"body":{"source":{},"timestamp":1546164321381,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164321381,"duration":180,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":5,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164321077,"timestamp":1546164321000,"createMicroTimestamp":1546164321077000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1073
2018-12-30 18:05:21,383 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6ae89060-0c1a-11e9-af54-a16c426988e0","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164321382,"body":{"source":{},"timestamp":1546164321382,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":5,"sessionServiceSeqId":5,"createDateTime":1546164321077,"timestamp":1546164321077,"createMicroTimestamp":1546164321077000}}],"broadcast":false}}} has been send to kafka with in topic events partition 15, current offset is 5815
2018-12-30 18:05:21,383 INFO  [SimpleAsyncTaskExecutor-17]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:0fc0026e-9d86-48fd-8f87-4615e07c5130 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a2290fe1-e9c9-439b-a861-f25d29a42cab","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164321053,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330710233383316","channel_id":35,"channel_name":""},"chatGroupSeqId":5,"sessionServiceSeqId":5,"createDateTime":1546164321077,"timestamp":1546164321077,"createMicroTimestamp":1546164321077000}}],"timestamp":1546164321382,"type":null}
2018-12-30 18:05:21,383 INFO  [SimpleAsyncTaskExecutor-17]  c.e.w.n.service.PushDataService - prepare message noticeId:0fc0026e-9d86-48fd-8f87-4615e07c5130 messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:21,385 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=6ae89060-0c1a-11e9-af54-a16c426988e0, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164321382, properties={}, body={source={}, timestamp=1546164321382, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=a2290fe1-e9c9-439b-a861-f25d29a42cab, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164321053, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330710233383316, channel_id=35, channel_name=}, chatGroupSeqId=5, sessionServiceSeqId=5, createDateTime=1546164321077, timestamp=1546164321077, createMicroTimestamp=1546164321077000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:23,153 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:23,158 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:23,422 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:23,422 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:25,154 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:25,158 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:26,426 ERROR [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  c.e.w.s.s.impl.BaiduApiIpLookUp - ipToRegion error ip:183.210.86.131
org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://apis.baidu.com/apistore/iplookupservice/iplookup": Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out; nested exception is org.apache.http.conn.ConnectTimeoutException: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:666)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:613)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:531)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.ipToRegion(BaiduApiIpLookUp.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.lookUp(BaiduApiIpLookUp.java:39)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.buildRegion(IpServiceSessionAttributeProcessor.java:59)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.processServiceSessionAttribute(IpServiceSessionAttributeProcessor.java:47)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesManager.saveServiceSessionAttributes(ServiceSessionAttributesManager.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesCreationWorker.run(ServiceSessionAttributesCreationWorker.java:43)
	at com.easemob.weichat.service.message.BlockingRedisMessageConsumer$InternalQueueConsumer.run(BlockingRedisMessageConsumer.java:187)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.http.conn.ConnectTimeoutException: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:143)
	at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:353)
	at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:380)
	at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)
	at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)
	at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:88)
	at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)
	at org.apache.http.impl.execchain.ServiceUnavailableRetryExec.execute(ServiceUnavailableRetryExec.java:84)
	at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:55)
	at org.springframework.http.client.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:89)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:53)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:652)
	... 14 common frames omitted
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.http.conn.socket.PlainConnectionSocketFactory.connectSocket(PlainConnectionSocketFactory.java:74)
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:134)
	... 28 common frames omitted
2018-12-30 18:05:26,428 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-1]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionAttributesUpdateEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:26,429 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6dea85c0-0c1a-11e9-b11e-d51e6404e729","type":"com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent","timestamp":1546164326428,"body":{"timestamp":1546164326428,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":4,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"url":"/v1/Tenant/43/MediaFiles/92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","secret":"","filename":".png","size":{"width":928,"height":547},"mediaId":"92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==","thumbSecret":"","type":"img"}],"ext":{"weichat":{"msgId":"5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1c317424-ad7d-4ca2-b572-ec3f22e06a55","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164297040,"timestamp":1546164297000,"createMicroTimestamp":1546164297040000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5192
2018-12-30 18:05:26,429 INFO  [SimpleAsyncTaskExecutor-11]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5bf54c65-4fad-47a3-8fd8-19df330b83d3 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"ServiceSessionAttributesChange","body":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}],"timestamp":1546164326429,"type":null}
2018-12-30 18:05:26,429 INFO  [SimpleAsyncTaskExecutor-11]  c.e.w.n.service.PushDataService - prepare message noticeId:5bf54c65-4fad-47a3-8fd8-19df330b83d3 messageType:ServiceSessionAttributesChange path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:26,429 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"6dea85ca-0c1a-11e9-aa4f-0d48c534e452","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164326428,"body":{"source":{},"timestamp":1546164326428,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"ServiceSessionAttributesChange","body":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}],"broadcast":false}}} has been send to kafka with in topic events partition 6, current offset is 3869
2018-12-30 18:05:26,431 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=6dea85ca-0c1a-11e9-aa4f-0d48c534e452, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164326428, properties={}, body={source={}, timestamp=1546164326428, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=ServiceSessionAttributesChange, body=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:26,432 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=6dea85c0-0c1a-11e9-b11e-d51e6404e729, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent, timestamp=1546164326428, properties={}, body={timestamp=1546164326428, version=1.1, tenantId=43, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=4, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{url=/v1/Tenant/43/MediaFiles/92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==, secret=, filename=.png, size={width=928, height=547}, mediaId=92343ded-c3e3-4fc7-87aa-80433c04d9b45oSP5YGl6Zmp55CG6LWU6LWE5paZLnBuZw==, thumbSecret=, type=img}], ext={weichat={msgId=5e19e080-8cc1-4bc4-9533-ddc7fcfad9fa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1c317424-ad7d-4ca2-b572-ec3f22e06a55, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164297040, timestamp=1546164297000, createMicroTimestamp=1546164297040000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:27,154 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:27,158 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:29,154 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:29,159 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:29,793 INFO  [http-nio-8899-exec-12]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/visitors/configs/1276c4f5-fec3-4651-bb2c-52d09f976628
2018-12-30 18:05:29,923 INFO  [http-nio-8899-exec-2]  c.e.w.w.mvc.WebimPluginController - GET /v1/webimplugin/visitors/password2 orgName:easemob-demo appName:chatdemoui imServiceNumber:119898 username:webim-visitor-YPHKB3EPCRK2XJRHC6EE
2018-12-30 18:05:29,924 INFO  [http-nio-8899-exec-2]  c.e.w.w.s.impl.WebimPluginService - isReadIMUserNew is true,getWebimFromUser from new table return is {"id":0,"userId":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","userPassword":"VJH68FJE8C"},orgName:easemob-demo,appName:chatdemoui,imServiceNumber:119898
2018-12-30 18:05:30,003 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:30 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:30,004 WARN  [http-nio-8899-exec-9]  o.s.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/v1/webimplugin/tenants/43/info] in DispatcherServlet with name 'dispatcherServlet'
2018-12-30 18:05:30,005 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:30,005 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:30 CST 2018.
2018-12-30 18:05:30,006 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:30,006 INFO  [http-nio-8899-exec-11]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:30,010 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:30 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:30,010 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:30,010 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:30 CST 2018.
2018-12-30 18:05:30,011 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:30,011 INFO  [http-nio-8899-exec-11]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:30,011 INFO  [http-nio-8899-exec-11]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:30,012 INFO  [http-nio-8899-exec-11]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:30,012 INFO  [http-nio-8899-exec-11]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:05:30,012 INFO  [http-nio-8899-exec-11]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:05:30,025 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:30,029 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:30,029 INFO  [http-nio-8899-exec-4]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:05:30,175 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:30 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:30,175 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:30,176 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:30 CST 2018.
2018-12-30 18:05:30,176 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:30,177 INFO  [http-nio-8899-exec-14]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:30,181 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Sun Dec 30 18:05:30 CST 2018 is timeoffduty for tenant 43, schedule 0.
2018-12-30 18:05:30,182 INFO  [http-nio-8899-exec-9]  c.e.w.service.impl.ScheduleService - tenant 43 schedule 0 is not legal, will use system schedule:43
2018-12-30 18:05:30,183 INFO  [http-nio-8899-exec-9]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:43, schedule:43, zoneDate:Sun Dec 30 18:05:30 CST 2018.
2018-12-30 18:05:30,183 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 43 schedule 0 istimeoffduty result:true
2018-12-30 18:05:30,184 INFO  [http-nio-8899-exec-14]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:43,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:true
2018-12-30 18:05:30,184 INFO  [http-nio-8899-exec-14]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get origin bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:30,184 INFO  [http-nio-8899-exec-14]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 43 ,get tech channel  bind result RoutingResult(queueId=null, robotId=43, agentUserId=null)
2018-12-30 18:05:30,185 INFO  [http-nio-8899-exec-14]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 43, matched queeue id is 47, ServiceSessionId null, matched robot id is 43
2018-12-30 18:05:30,185 INFO  [http-nio-8899-exec-14]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=47,robotId=43,agentUserId=null
2018-12-30 18:05:30,192 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:30,195 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:30,195 INFO  [http-nio-8899-exec-15]  c.e.w.w.s.impl.WebimPluginService - get robotuser RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false)
2018-12-30 18:05:30,241 INFO  [http-nio-8899-exec-11]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccounts tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b page:0 size:100
2018-12-30 18:05:30,245 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/visitors/64c1a71d-fa70-46db-9942-cd23424a758b/official-accounts page:0 size:100
2018-12-30 18:05:30,544 INFO  [http-nio-8899-exec-4]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:30,544 INFO  [http-nio-8899-exec-2]  c.e.w.w.s.i.WebimOfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:30,548 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-account-sessions/latest visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:30,548 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/visitors/64c1a71d-fa70-46db-9942-cd23424a758b/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages startId:null direction:before size:10
2018-12-30 18:05:31,154 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:31,158 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:33,158 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:33,163 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:05 start
2018-12-30 18:05:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:05
2018-12-30 18:05:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:05 complete
2018-12-30 18:05:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:05:33,605 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:33,605 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:35,154 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:35,164 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:36,609 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:36,609 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:36,799 INFO  [agentconnection-pubsub-29]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent 615deed4-32db-4129-a584-31f9cc582120 connection expired, workstate Hidden
2018-12-30 18:05:36,800 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"741902f0-0c1a-11e9-888b-c1b4f3c08634","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546164336799,"body":{"source":{},"timestamp":1546164336799,"actor":null,"version":"1.1","tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userPK":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120"},"agentUser":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"wangjuan003@zking.com","roles":"agent","createDateTime":"2018-12-27 01:21:09","lastUpdateDateTime":"2018-12-30 10:10:09","firstLoginTimeOfRecentDay":"2018-12-30 08:01:10","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164336799,"status":"Offline","kickOff":false}} has been send to kafka with in topic events partition 12, current offset is 3345
2018-12-30 18:05:36,801 INFO  [kafka-events-consumer-1-thread-1]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:615deed4-32db-4129-a584-31f9cc582120,agentState:Offline
2018-12-30 18:05:36,802 INFO  [kafka-events-consumer-1-thread-1]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 43, userId = 615deed4-32db-4129-a584-31f9cc582120] status changed to Offline
2018-12-30 18:05:36,802 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=741902f0-0c1a-11e9-888b-c1b4f3c08634, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546164336799, properties={}, body={source={}, timestamp=1546164336799, actor=null, version=1.1, tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120, userPK={tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120}, agentUser={tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120, userType=Agent, userScope=Tenant, nicename=, password=, username=wangjuan003@zking.com, roles=agent, createDateTime=2018-12-27 01:21:09, lastUpdateDateTime=2018-12-30 10:10:09, firstLoginTimeOfRecentDay=2018-12-30 08:01:10, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164336799, status=Offline, kickOff=false}, topic=events, partitionKey=43:615deed4-32db-4129-a584-31f9cc582120).
2018-12-30 18:05:36,802 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"74197820-0c1a-11e9-bbed-352e81becd17","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164336802,"body":{"source":{},"timestamp":1546164336802,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164336799,"actor":null,"version":"1.1","tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userPK":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120"},"agentUser":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"wangjuan003@zking.com","roles":"agent","createDateTime":"2018-12-27 01:21:09","lastUpdateDateTime":"2018-12-30 10:10:09","firstLoginTimeOfRecentDay":"2018-12-30 08:01:10","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164336799,"status":"Offline","kickOff":false}}],"broadcast":true}}} has been send to kafka with in topic events partition 0, current offset is 3042
2018-12-30 18:05:36,803 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:ac7060d5-5dd9-4f00-89c1-489edc1b6577 message:{"path":"/tenants/43/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546164336799,"actor":null,"version":"1.1","tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userPK":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120"},"agentUser":{"tenantId":43,"userId":"615deed4-32db-4129-a584-31f9cc582120","userType":"Agent","userScope":"Tenant","nicename":"","password":"","username":"wangjuan003@zking.com","roles":"agent","createDateTime":"2018-12-27 01:21:09","lastUpdateDateTime":"2018-12-30 10:10:09","firstLoginTimeOfRecentDay":"2018-12-30 08:01:10","status":"Enable","state":"Hidden","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"","bizId":"43","scope":"Tenant","currentOnLineState":"Hidden","onLineState":"Hidden"},"eventTime":1546164336799,"status":"Offline","kickOff":false}}],"timestamp":1546164336802,"type":null}
2018-12-30 18:05:36,803 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - prepare message noticeId:ac7060d5-5dd9-4f00-89c1-489edc1b6577 messageType:AgentUserStateChange path:/tenants/43/agents
2018-12-30 18:05:36,803 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:2zdz3nv2 noticeId:ac7060d5-5dd9-4f00-89c1-489edc1b6577 messageType:AgentUserStateChange
2018-12-30 18:05:36,804 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:2zdz3nv2 noticeId:ac7060d5-5dd9-4f00-89c1-489edc1b6577
2018-12-30 18:05:36,804 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=74197820-0c1a-11e9-bbed-352e81becd17, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164336802, properties={}, body={source={}, timestamp=1546164336802, actor=null, version=1.1, queueMessageData={userPK={tenantId=43}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546164336799, actor=null, version=1.1, tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120, userPK={tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120}, agentUser={tenantId=43, userId=615deed4-32db-4129-a584-31f9cc582120, userType=Agent, userScope=Tenant, nicename=, password=, username=wangjuan003@zking.com, roles=agent, createDateTime=2018-12-27 01:21:09, lastUpdateDateTime=2018-12-30 10:10:09, firstLoginTimeOfRecentDay=2018-12-30 08:01:10, status=Enable, state=Hidden, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=, bizId=43, scope=Tenant, currentOnLineState=Hidden, onLineState=Hidden}, eventTime=1546164336799, status=Offline, kickOff=false}}], broadcast=true}}, topic=events, partitionKey=null)
2018-12-30 18:05:36,834 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"noticeId":"ac7060d5-5dd9-4f00-89c1-489edc1b6577"}
2018-12-30 18:05:36,834 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:2zdz3nv2 noticeId:ac7060d5-5dd9-4f00-89c1-489edc1b6577
2018-12-30 18:05:37,028 INFO  [http-nio-8899-exec-12]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"615deed4-32db-4129-a584-31f9cc582120","tenantId":43,"type":"StateChange"}}],"timestamp":1546164336924,"type":null}
2018-12-30 18:05:37,028 INFO  [http-nio-8899-exec-12]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:c8c14344-406e-4ca3-a231-4860144a04d5 message:{"path":"/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"615deed4-32db-4129-a584-31f9cc582120","tenantId":43,"type":"StateChange"}}],"timestamp":1546164336924,"type":null}
2018-12-30 18:05:37,028 INFO  [http-nio-8899-exec-12]  c.e.w.n.service.PushDataService - prepare message noticeId:c8c14344-406e-4ca3-a231-4860144a04d5 messageType:Daas path:/tenants/43/agents/615deed4-32db-4129-a584-31f9cc582120
2018-12-30 18:05:37,154 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:37,159 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:39,154 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:39,159 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:39,612 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:39,612 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:41,154 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:41,159 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:42,615 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - I/O exception (org.apache.http.conn.ConnectTimeoutException) caught when processing request to {}->http://apis.baidu.com:80: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
2018-12-30 18:05:42,615 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  o.a.http.impl.execchain.RetryExec - Retrying request to {}->http://apis.baidu.com:80
2018-12-30 18:05:43,155 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:43,159 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:45,155 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:45,160 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:45,617 ERROR [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  c.e.w.s.s.impl.BaiduApiIpLookUp - ipToRegion error ip:183.210.86.131
org.springframework.web.client.ResourceAccessException: I/O error on GET request for "http://apis.baidu.com/apistore/iplookupservice/iplookup": Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out; nested exception is org.apache.http.conn.ConnectTimeoutException: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:666)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:613)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:531)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.ipToRegion(BaiduApiIpLookUp.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.lookUp(BaiduApiIpLookUp.java:39)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.buildRegion(IpServiceSessionAttributeProcessor.java:59)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.processServiceSessionAttribute(IpServiceSessionAttributeProcessor.java:47)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesManager.saveServiceSessionAttributes(ServiceSessionAttributesManager.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesCreationWorker.run(ServiceSessionAttributesCreationWorker.java:43)
	at com.easemob.weichat.service.message.BlockingRedisMessageConsumer$InternalQueueConsumer.run(BlockingRedisMessageConsumer.java:187)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.http.conn.ConnectTimeoutException: Connect to apis.baidu.com:80 [apis.baidu.com/180.149.144.74] failed: connect timed out
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:143)
	at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:353)
	at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:380)
	at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)
	at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:184)
	at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:88)
	at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)
	at org.apache.http.impl.execchain.ServiceUnavailableRetryExec.execute(ServiceUnavailableRetryExec.java:84)
	at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:55)
	at org.springframework.http.client.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:89)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:53)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:652)
	... 14 common frames omitted
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.http.conn.socket.PlainConnectionSocketFactory.connectSocket(PlainConnectionSocketFactory.java:74)
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:134)
	... 28 common frames omitted
2018-12-30 18:05:45,620 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionAttributesUpdateEvent sessionId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:45,621 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"795afd40-0c1a-11e9-9f7d-71811dacf35b","type":"com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent","timestamp":1546164345620,"body":{"timestamp":1546164345620,"version":"1.1","tenantId":43,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":6,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164321357,"timestamp":1546164321000,"createMicroTimestamp":1546164321357000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5193
2018-12-30 18:05:45,621 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"795afd4a-0c1a-11e9-87d6-f99f66b6e871","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164345620,"body":{"source":{},"timestamp":1546164345620,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"ServiceSessionAttributesChange","body":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}],"broadcast":false}}} has been send to kafka with in topic events partition 8, current offset is 3332
2018-12-30 18:05:45,621 INFO  [SimpleAsyncTaskExecutor-8]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:fca12e66-aefa-49d0-bef9-f0bc36748c13 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"ServiceSessionAttributesChange","body":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}],"timestamp":1546164345621,"type":null}
2018-12-30 18:05:45,621 INFO  [SimpleAsyncTaskExecutor-8]  c.e.w.n.service.PushDataService - prepare message noticeId:fca12e66-aefa-49d0-bef9-f0bc36748c13 messageType:ServiceSessionAttributesChange path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:45,623 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=795afd40-0c1a-11e9-9f7d-71811dacf35b, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent, timestamp=1546164345620, properties={}, body={timestamp=1546164345620, version=1.1, tenantId=43, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=6, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164321357, timestamp=1546164321000, createMicroTimestamp=1546164321357000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:45,623 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=795afd4a-0c1a-11e9-87d6-f99f66b6e871, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164345620, properties={}, body={source={}, timestamp=1546164345620, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=ServiceSessionAttributesChange, body=f5b5a7f4-c200-4e91-b13e-bdc528a5de70}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:47,155 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:47,160 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:49,155 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:49,159 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:50,556 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:43 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:50,561 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-account-sessions/latest visitorId:64c1a71d-fa70-46db-9942-cd23424a758b officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:50,562 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccount tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:50,568 INFO  [http-nio-8899-exec-4]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462
2018-12-30 18:05:50,569 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=6, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a2e2bcaf], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.357, timestamp=1546164321000, createMicroTimestamp=1546164321357000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2018-12-30 18:05:50,572 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:70ad3b0f-9ec8-4154-9371-32ad4035c02f
2018-12-30 18:05:50,577 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:05:50,580 INFO  [SimpleAsyncTaskExecutor-49145]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat=KefuExtMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=), msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350569, createMicroTimestamp=1546164350569000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=6, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a2e2bcaf], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.357, timestamp=1546164321000, createMicroTimestamp=1546164321357000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:50,580 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:64c1a71d-fa70-46db-9942-cd23424a758b to 1546164350569 driven by message 70ad3b0f-9ec8-4154-9371-32ad4035c02f
2018-12-30 18:05:50,580 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"7c4fac30-0c1a-11e9-bf0f-43becaf303b8","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164350579,"body":{"timestamp":1546164350579,"version":"1.1","tenantId":43,"message":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":""},"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":7,"sessionServiceSeqId":7,"createDateTime":1546164350569,"timestamp":1546164350569,"createMicroTimestamp":1546164350569000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":6,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4195ba3a-f97c-4f65-9dcc-b119e2e417aa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164321357,"timestamp":1546164321000,"createMicroTimestamp":1546164321357000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5194
2018-12-30 18:05:50,582 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - clear robot timeout notify count key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:50,582 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"7c4ffa50-0c1a-11e9-aef3-c39a994e0112","type":"com.easemob.weichat.service.timeout.event.TimeoutClearEvent","timestamp":1546164350581,"body":{"source":{},"timestamp":1546164350581,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164350581,"duration":0,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":7,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350569,"timestamp":1546164350000,"createMicroTimestamp":1546164350569000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1074
2018-12-30 18:05:50,582 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - tenantId 43 message handle by robotmessageProcess
2018-12-30 18:05:50,582 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350569, createMicroTimestamp=1546164350569000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Sun Dec 30 18:04:57 CST 2018, lastUpdateDateTime=Sun Dec 30 18:04:57 CST 2018, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=6, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a2e2bcaf], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:21.357, timestamp=1546164321000, createMicroTimestamp=1546164321357000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:50,583 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 43 , serviceSessionId : f5b5a7f4-c200-4e91-b13e-bdc528a5de70,agentUserId : c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:50,583 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"7c502160-0c1a-11e9-91dd-2b8fb9e3346f","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164350582,"body":{"source":{},"timestamp":1546164350582,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":7,"sessionServiceSeqId":7,"createDateTime":1546164350569,"timestamp":1546164350569,"createMicroTimestamp":1546164350569000}}],"broadcast":false}}} has been send to kafka with in topic events partition 17, current offset is 3032
2018-12-30 18:05:50,583 INFO  [SimpleAsyncTaskExecutor-3]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:17a3bce6-3b16-4cba-8e81-3fb5aa2e052b message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":7,"sessionServiceSeqId":7,"createDateTime":1546164350569,"timestamp":1546164350569,"createMicroTimestamp":1546164350569000}}],"timestamp":1546164350582,"type":null}
2018-12-30 18:05:50,583 INFO  [SimpleAsyncTaskExecutor-3]  c.e.w.n.service.PushDataService - prepare message noticeId:17a3bce6-3b16-4cba-8e81-3fb5aa2e052b messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:50,584 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=7c4fac30-0c1a-11e9-bf0f-43becaf303b8, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164350579, properties={}, body={timestamp=1546164350579, version=1.1, tenantId=43, message={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164350544, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330814356980116, channel_id=35, channel_name=}, chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=1546164350569, timestamp=1546164350569, createMicroTimestamp=1546164350569000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=6, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=5dfe49f8-f342-4bd2-ad14-2d7b198e6ed0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4195ba3a-f97c-4f65-9dcc-b119e2e417aa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164321357, timestamp=1546164321000, createMicroTimestamp=1546164321357000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:50,584 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=7c502160-0c1a-11e9-91dd-2b8fb9e3346f, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164350582, properties={}, body={source={}, timestamp=1546164350582, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164350544, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330814356980116, channel_id=35, channel_name=}, chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=1546164350569, timestamp=1546164350569, createMicroTimestamp=1546164350569000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:50,586 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,587 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - agent is robot and chatMessage is ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat=KefuExtMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350569, createMicroTimestamp=1546164350569000) ___________ serviceSession is ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=7, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350000, createMicroTimestamp=1546164350569000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2018-12-30 18:05:50,589 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,589 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - tenantId 43 message reply by robot,serviceSessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:50,589 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - get answer by robot route tenantid 43 and msg is 
2018-12-30 18:05:50,749 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - askRobotIntegrationForAnswer feign client success, tenantId : 43, robotId : QuestionInfo(tenantId=43, sessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, askUserId=64c1a71d-fa70-46db-9942-cd23424a758b, robotId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, questionId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, question=, userLocation=null, userLocale=zh-CN, robotAppParam={"zabx":{"service_id":"119898"}}, strategyTransData={"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}, questionType=null), questionInfo : EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat=KefuExtMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), easemobMessage : ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=7, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350000, createMicroTimestamp=1546164350569000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), serviceSession RobotAnswer(enableSilence=false, answerType=BESTMATCH, type=1, content={"transferToKf":true,"content":""}, similarity=null, words=null, answerDataType=null)
2018-12-30 18:05:50,749 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied serviceSession {"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":7,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350569,"timestamp":1546164350000,"createMicroTimestamp":1546164350569000},"techChannelType":"easemob","originType":"webim","expire":true} ,RobotAnswer is {"enableSilence":false,"type":1,"content":"{\"transferToKf\":true,\"content\":\"\"}","similarity":null,"words":null,"answerType":null} ,ServiceSessionRobot is {"id":764,"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","robotId":43,"createdAt":"2018-12-30 18:04:56","updatedAt":"2018-12-30 18:04:56"}
2018-12-30 18:05:50,749 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied RobotAnswer(enableSilence=false, answerType=BESTMATCH, type=1, content={"transferToKf":true,"content":""}, similarity=null, words=null, answerDataType=null) to visitor for question ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, uri=null, chatGroupId=538, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-30 18:04:57.0, lastUpdateDateTime=2018-12-30 18:04:57.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat=KefuExtMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350569, createMicroTimestamp=1546164350569000)
2018-12-30 18:05:50,752 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,754 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,754 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.service.message.Processor - tenantid is 43 Label is zh-CN
2018-12-30 18:05:50,755 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.service.message.Processor - tenantid is 43  locale is zh-CN and weichatExt is KefuExtMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs=RobotServiceSessionTransfer(id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=), event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)
2018-12-30 18:05:50,757 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotAgentIdFromIntegration feign client success, tenantId : 43, robotAgentId : c4fb2422-cc1c-4264-ad25-2fe937d00df1, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,757 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:43 officialAccountId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:05:50,763 INFO  [http-nio-8899-exec-11]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/sessions/f5b5a7f4-c200-4e91-b13e-bdc528a5de70/official-accounts
2018-12-30 18:05:50,767 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:5c7bf05f-dfda-4d8a-9000-381e2ba68853
2018-12-30 18:05:50,773 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:05:50,780 INFO  [SimpleAsyncTaskExecutor-49148]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2649b54d], ext={weichat=KefuExtMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=), msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=8, sessionServiceSeqId=8, createDateTime=2018-12-30 18:05:50.757, timestamp=1546164350757, createMicroTimestamp=1546164350757000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=7, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350000, createMicroTimestamp=1546164350569000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:50,780 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"7c6e30b0-0c1a-11e9-9122-b99993f7cba1","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164350779,"body":{"timestamp":1546164350779,"version":"1.1","tenantId":43,"message":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"7b721036-5b84-4805-b4e7-4832bb586269","userType":"Robot","userScope":"Tenant","nicename":"","robotId":"7b721036-5b84-4805-b4e7-4832bb586269","type":0,"active":false,"rule":0,"enableMenu":false,"enableGreeting":false,"enableSimilarQuestionTransfer":false,"enableNoAnswerTransfer":false,"enableFreeChat":false,"currentServiceSessionCount":0,"maxServiceSessionCount":0,"timeout":180,"robotRouteId":"43","robotAgentId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","digitalMenu":false,"roles":"robot","username":"7b721036-5b84-4805-b4e7-4832bb586269","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":""},"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":8,"sessionServiceSeqId":8,"createDateTime":1546164350757,"timestamp":1546164350757,"createMicroTimestamp":1546164350757000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":7,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350569,"timestamp":1546164350000,"createMicroTimestamp":1546164350569000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5195
2018-12-30 18:05:50,784 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,786 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=43, userId=7b721036-5b84-4805-b4e7-4832bb586269, userType=Robot, userScope=Tenant, nicename=), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2649b54d], ext={weichat={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=8, sessionServiceSeqId=8, createDateTime=2018-12-30 18:05:50.757, timestamp=1546164350757, createMicroTimestamp=1546164350757000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=7, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@8cdbfd88], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Sun Dec 30 18:05:50 CST 2018, msgId=552330814356980116, channelId=35, channelName=, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:50.569, timestamp=1546164350000, createMicroTimestamp=1546164350569000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:05:50,787 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:05:50,787 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - robot timeout is 180 from sendRobotTimeoutFirstStartEvent
2018-12-30 18:05:50,787 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=7c6e30b0-0c1a-11e9-9122-b99993f7cba1, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164350779, properties={}, body={timestamp=1546164350779, version=1.1, tenantId=43, message={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=7b721036-5b84-4805-b4e7-4832bb586269, userType=Robot, userScope=Tenant, nicename=, robotId=7b721036-5b84-4805-b4e7-4832bb586269, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false, roles=robot, username=7b721036-5b84-4805-b4e7-4832bb586269, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=8, sessionServiceSeqId=8, createDateTime=1546164350757, timestamp=1546164350757, createMicroTimestamp=1546164350757000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=7, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164350544, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330814356980116, channel_id=35, channel_name=}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164350569, timestamp=1546164350000, createMicroTimestamp=1546164350569000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:05:50,787 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.s.t.SendTimeoutEventService - set robot timeout notify count key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 for serviceSession f5b5a7f4-c200-4e91-b13e-bdc528a5de70 notify count is 1 , value is 2
2018-12-30 18:05:50,787 INFO  [kafka-kf_msg_in-consumer-4-thread-1]  c.e.w.service.message.Processor - tenantId is 43 send toVisitorMessage is ChatMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=RobotUser(robotId=7b721036-5b84-4805-b4e7-4832bb586269, tenantId=43, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=180, createdTime=null, lastUpdatedTime=null, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2649b54d], ext={weichat=KefuExtMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=8, sessionServiceSeqId=8, createDateTime=2018-12-30 18:05:50.757, timestamp=1546164350757, createMicroTimestamp=1546164350757000)
2018-12-30 18:05:50,787 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"7c6f6930-0c1a-11e9-9849-6547ff158ae4","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546164350787,"body":{"source":{},"timestamp":1546164350787,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164350787,"duration":180,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":7,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350569,"timestamp":1546164350000,"createMicroTimestamp":1546164350569000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1075
2018-12-30 18:05:50,788 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"7c6f693a-0c1a-11e9-8221-61fecd355316","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164350787,"body":{"source":{},"timestamp":1546164350787,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":7,"sessionServiceSeqId":7,"createDateTime":1546164350569,"timestamp":1546164350569,"createMicroTimestamp":1546164350569000}}],"broadcast":false}}} has been send to kafka with in topic events partition 11, current offset is 2957
2018-12-30 18:05:50,788 INFO  [SimpleAsyncTaskExecutor-2]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:bb964aeb-4ec8-4a18-973c-e2f2b2e24d97 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","username":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","techChannelType":"easemob","techChannelId":35,"techChannelInfo":"easemob-demo#chatdemoui#119898","chatGroupId":538,"sex":0,"createDateTime":1546164297000,"lastUpdateDateTime":1546164297000,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":7,"sessionServiceSeqId":7,"createDateTime":1546164350569,"timestamp":1546164350569,"createMicroTimestamp":1546164350569000}}],"timestamp":1546164350787,"type":null}
2018-12-30 18:05:50,788 INFO  [SimpleAsyncTaskExecutor-2]  c.e.w.n.service.PushDataService - prepare message noticeId:bb964aeb-4ec8-4a18-973c-e2f2b2e24d97 messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:05:50,790 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=7c6f693a-0c1a-11e9-8221-61fecd355316, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164350787, properties={}, body={source={}, timestamp=1546164350787, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, username=webim-visitor-YPHKB3EPCRK2XJRHC6EE, techChannelType=easemob, techChannelId=35, techChannelInfo=easemob-demo#chatdemoui#119898, chatGroupId=538, sex=0, createDateTime=1546164297000, lastUpdateDateTime=1546164297000, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=70ad3b0f-9ec8-4154-9371-32ad4035c02f, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-YPHKB3EPCRK2XJRHC6EE, to=119898, channelType=easemob, timestamp=1546164350544, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, to_jid=easemob-demo#chatdemoui_119898@easemob.com, msg_id=552330814356980116, channel_id=35, channel_name=}, chatGroupSeqId=7, sessionServiceSeqId=7, createDateTime=1546164350569, timestamp=1546164350569, createMicroTimestamp=1546164350569000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:05:50,837 INFO  [kf-webapp-scheduler-pool-15]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 1ms
2018-12-30 18:05:51,155 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:51,159 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:53,155 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:53,160 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:05 start
2018-12-30 18:05:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:05
2018-12-30 18:05:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:05 complete
2018-12-30 18:05:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:05:55,155 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:55,159 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:55,602 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:05:55,602 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:05:57,155 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:57,160 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:05:59,156 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:05:59,161 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:01,156 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:01,161 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:03,156 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:03,163 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:05,156 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:05,165 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:07,156 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:07,160 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:09,156 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:09,161 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:11,157 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:11,162 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:13,156 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:13,161 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:06 start
2018-12-30 18:06:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:06
2018-12-30 18:06:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:06 complete
2018-12-30 18:06:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:06:15,156 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:15,161 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:17,158 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:17,163 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:19,157 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:19,161 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:21,158 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:21,163 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:23,157 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:23,162 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:25,158 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:25,162 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:27,158 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:27,162 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:29,158 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:29,163 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:31,157 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:31,162 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:33,157 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:33,162 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:06 start
2018-12-30 18:06:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:06
2018-12-30 18:06:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:06 complete
2018-12-30 18:06:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:06:35,158 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:35,168 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:37,158 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:37,163 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:39,158 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:39,162 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:41,159 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:41,164 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:43,159 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:43,163 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:45,158 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:45,163 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:47,158 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:47,163 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:49,158 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:49,163 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:51,159 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:51,163 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:53,158 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:53,164 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:06 start
2018-12-30 18:06:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:06
2018-12-30 18:06:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:06 complete
2018-12-30 18:06:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:06:53,222 INFO  [http-nio-8899-exec-11]  c.e.w.a.rest.AuthController - authenticateBySession, session:3874264b-147f-4bfb-a084-46b8be352b7b, response:{"status":true,"entity":{"tenantId":43,"userId":"0fd687f3-09be-4919-b533-3d89c613590e","roles":"agent"}}, cost:{"total":284}
2018-12-30 18:06:53,228 INFO  [http-nio-8899-exec-6]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, userResourceData : UserResourceData(method=GET, url=/waitings)
2018-12-30 18:06:53,235 INFO  [http-nio-8899-exec-6]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 43, userId : 0fd687f3-09be-4919-b533-3d89c613590e, hasPermission : true
2018-12-30 18:06:53,237 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.a.v.WaitingsApiV0Controller - /waitings tenantId:43 query:WaitingQuery(page=0, size=10)
2018-12-30 18:06:53,238 ERROR [hystrix-SmsServer-50]  c.e.w.c.f.SmsFeignClient$HystrixClientFallback - SMS server findSmsTechChannelByTenantId fallback,tenantId:43
2018-12-30 18:06:53,240 ERROR [hystrix-GatewaySlackRouteway-50]  c.e.w.c.f.SlackFeignClient$HystrixClientFallback - slackgateway server findSlackTechChannelByTenantId fallback,tenantId:43
2018-12-30 18:06:55,159 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:55,164 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:55,603 INFO  [kf-webapp-scheduler-pool-19]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:06:55,603 INFO  [kf-webapp-scheduler-pool-19]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:06:57,164 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:57,168 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:06:59,160 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:06:59,165 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:01,160 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:01,164 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:03,160 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:03,164 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:05,159 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:05,170 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:07,159 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:07,164 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:07,919 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:272a3dad-22c1-4671-ae2f-caefbefd20d0 message:{"path":"/tenants/43/agents/_2","key":null,"payload":[{"messageType":"ScheduleTimeout","body":"Schedule:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"timestamp":1546164427919,"type":null}
2018-12-30 18:07:07,919 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:aaaaf5f2-3f74-4cd9-acb8-217fd16760e8 message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"ScheduleTimeout","body":"Schedule:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"timestamp":1546164427919,"type":null}
2018-12-30 18:07:07,920 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - prepare message noticeId:aaaaf5f2-3f74-4cd9-acb8-217fd16760e8 messageType:ScheduleTimeout path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:07:07,919 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - prepare message noticeId:272a3dad-22c1-4671-ae2f-caefbefd20d0 messageType:ScheduleTimeout path:/tenants/43/agents/_2
2018-12-30 18:07:07,920 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"aa68d1f0-0c1a-11e9-a67d-65090417e6d0","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164427919,"body":{"source":{},"timestamp":1546164427919,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"ScheduleTimeout","body":"Schedule:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"broadcast":false}}} has been send to kafka with in topic events partition 5, current offset is 3237
2018-12-30 18:07:07,920 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"aa68aae0-0c1a-11e9-9fc3-d35c9a6dd66b","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164427918,"body":{"source":{},"timestamp":1546164427918,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"_2"},"messages":[{"messageType":"ScheduleTimeout","body":"Schedule:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot"}],"broadcast":false}}} has been send to kafka with in topic events partition 2, current offset is 3521
2018-12-30 18:07:07,921 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=aa68d1f0-0c1a-11e9-a67d-65090417e6d0, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164427919, properties={}, body={source={}, timestamp=1546164427919, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=ScheduleTimeout, body=Schedule:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:07:07,921 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=aa68aae0-0c1a-11e9-9fc3-d35c9a6dd66b, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164427918, properties={}, body={source={}, timestamp=1546164427918, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=_2}, messages=[{messageType=ScheduleTimeout, body=Schedule:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70:_2:c4fb2422-cc1c-4264-ad25-2fe937d00df1:Robot}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:07:09,160 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:09,164 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:11,160 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:11,165 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:13,160 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:13,165 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:07 start
2018-12-30 18:07:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:07
2018-12-30 18:07:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:07 complete
2018-12-30 18:07:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:07:15,161 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:15,165 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:17,163 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:17,168 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:19,161 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:19,165 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:21,161 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:21,165 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:23,162 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:23,167 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:25,161 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:25,165 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:27,161 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:27,165 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:29,161 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:29,166 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:31,163 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:31,168 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:33,162 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:33,167 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:07 start
2018-12-30 18:07:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:07
2018-12-30 18:07:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:07 complete
2018-12-30 18:07:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:07:35,162 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:35,175 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:37,162 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:37,166 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:39,162 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:39,167 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:41,162 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:41,167 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:43,162 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:43,166 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:45,163 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:45,168 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:47,162 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:47,167 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:49,163 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:49,168 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:50,838 INFO  [kf-webapp-scheduler-pool-2]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 1ms
2018-12-30 18:07:51,164 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:51,168 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:53,164 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:07 start
2018-12-30 18:07:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:07
2018-12-30 18:07:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:07 complete
2018-12-30 18:07:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:07:53,174 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:55,163 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:55,167 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:55,604 INFO  [kf-webapp-scheduler-pool-29]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:07:55,604 INFO  [kf-webapp-scheduler-pool-29]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:07:57,163 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:57,168 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:07:59,163 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:07:59,168 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:01,163 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:01,168 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:03,164 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:03,169 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:05,164 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:05,175 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:07,164 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:07,168 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:09,166 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:09,170 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:11,164 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:11,175 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:13,164 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:13,168 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:08 start
2018-12-30 18:08:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:08
2018-12-30 18:08:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:08 complete
2018-12-30 18:08:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:08:15,164 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:15,168 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:17,164 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:17,169 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:19,165 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:19,172 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:21,165 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:21,170 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:23,165 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:23,170 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:25,166 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:25,170 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:27,166 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:27,170 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:29,166 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:29,172 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:31,165 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:31,170 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:33,166 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:33,170 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:08 start
2018-12-30 18:08:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:08
2018-12-30 18:08:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:08 complete
2018-12-30 18:08:33,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:08:35,166 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:35,177 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:37,166 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:37,170 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:39,167 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:39,171 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:41,167 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:41,172 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:43,167 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:43,171 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:45,167 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:45,171 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:47,169 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:47,174 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:49,166 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:49,171 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:50,790 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"e7b98950-0c1a-11e9-a727-0b9970cdd45c","type":"com.easemob.weichat.service.timeout.event.TimeoutNotifyEvent","timestamp":1546164530789,"body":{"source":{},"timestamp":1546164530789,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164350787,"duration":180,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":7,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"70ad3b0f-9ec8-4154-9371-32ad4035c02f","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","to":"119898","channelType":"easemob","timestamp":1546164350544,"tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"552330814356980116","channel_id":35,"channel_name":""},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350569,"timestamp":1546164350000,"createMicroTimestamp":1546164350569000},"techChannelType":"easemob","originType":"webim","expire":true},"notifyCount":0,"endTime":1546164530789}} has been send to kafka with in topic timeout-events-out partition 0, current offset is 182
2018-12-30 18:08:50,793 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.r.t.l.TimeoutNotifyEventListener - RobotTimeoutNotification is got by TimeoutNotifyEventListener, TimeoutNotifyEvent is {"source":{},"timestamp":1546164530792,"actor":null,"version":"1.1","topic":"timeout-events-out","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164350787,"duration":180,"endTime":1546164530789,"deviation":0.002,"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":8,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350757,"timestamp":1546164350000,"createMicroTimestamp":1546164350757000},"techChannelType":"easemob","originType":"webim","expire":true}}
2018-12-30 18:08:50,793 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.t.SendTimeoutNotificationService - get notifyCount 1 from redis key kf:robot:timeout:session.notify.count:43:f5b5a7f4-c200-4e91-b13e-bdc528a5de70 from SendRobotTimeoutNotification
2018-12-30 18:08:50,798 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:08:50,801 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 43, robotRouteId : 43, robotData : RobotData(id=6, tenantId=43, robotId=7b721036-5b84-4805-b4e7-4832bb586269, name=, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=180, robotRouteId=43, robotAgentId=c4fb2422-cc1c-4264-ad25-2fe937d00df1)
2018-12-30 18:08:50,805 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:43 officialAccountId:f5b5a7f4-c200-4e91-b13e-bdc528a5de70
2018-12-30 18:08:50,811 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/43/sessions/f5b5a7f4-c200-4e91-b13e-bdc528a5de70/official-accounts
2018-12-30 18:08:50,816 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:43 officialAccountId:1787e4f3-5cd6-4b6b-9a28-741fbee05462 visitorId:64c1a71d-fa70-46db-9942-cd23424a758b messageId:57e0868d-686f-4443-873f-554b21509f06
2018-12-30 18:08:50,821 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/43/official-accounts/1787e4f3-5cd6-4b6b-9a28-741fbee05462/official-account-messages body:{"visitorId":"64c1a71d-fa70-46db-9942-cd23424a758b","messageId":"57e0868d-686f-4443-873f-554b21509f06","sessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70"}
2018-12-30 18:08:50,823 INFO  [SimpleAsyncTaskExecutor-49151]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=57e0868d-686f-4443-873f-554b21509f06, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=), toUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat=KefuExtMessage(msgId=57e0868d-686f-4443-873f-554b21509f06, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=null, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=/), msgIdForAck=11b42ab7-8c27-423c-bc0f-873b91b042e0, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=9, sessionServiceSeqId=9, createDateTime=2018-12-30 18:08:50.805, timestamp=1546164530805, createMicroTimestamp=1546164530805000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=8, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56.737, stopDateTime=null, createDatetime=2018-12-30 18:04:56.734, lastChatMessage=ChatMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2649b54d], ext={weichat={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:50.757, timestamp=1546164350000, createMicroTimestamp=1546164350757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:08:50,824 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"e7beb970-0c1a-11e9-9226-e774429ee8e8","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546164530823,"body":{"timestamp":1546164530823,"version":"1.1","tenantId":43,"message":{"msgId":"57e0868d-686f-4443-873f-554b21509f06","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"/","type":"txt"}],"ext":{"weichat":{"msgId":"57e0868d-686f-4443-873f-554b21509f06","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"/"},"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":9,"sessionServiceSeqId":9,"createDateTime":1546164530805,"timestamp":1546164530805,"createMicroTimestamp":1546164530805000},"serviceSession":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":8,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350757,"timestamp":1546164350000,"createMicroTimestamp":1546164350757000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 10, current offset is 5196
2018-12-30 18:08:50,824 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.t.SendTimeoutNotificationService - send remindMsg / of Robot with ServiceSession {"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":8,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350757,"timestamp":1546164350000,"createMicroTimestamp":1546164350757000},"techChannelType":"easemob","originType":"webim","expire":true}
2018-12-30 18:08:50,825 INFO  [kafka-timeout-events-out-consumer-5-thread-10]  c.e.w.s.t.SendTimeoutNotificationService - send visitor timeout reminder with robot to visitor for sessionId f5b5a7f4-c200-4e91-b13e-bdc528a5de70 increment is 1 with CloseDuration
2018-12-30 18:08:50,825 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"e7bee080-0c1a-11e9-9cf1-1919f5bd3618","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546164530824,"body":{"source":{},"timestamp":1546164530824,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":43,"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"57e0868d-686f-4443-873f-554b21509f06","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"/","type":"txt"}],"ext":{"weichat":{"msgId":"57e0868d-686f-4443-873f-554b21509f06","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":9,"sessionServiceSeqId":9,"createDateTime":1546164530805,"timestamp":1546164530805,"createMicroTimestamp":1546164530805000}}],"broadcast":false}}} has been send to kafka with in topic events partition 14, current offset is 3601
2018-12-30 18:08:50,825 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:8de3de36-02ed-4874-9c16-7c99f03b983f message:{"path":"/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"57e0868d-686f-4443-873f-554b21509f06","tenantId":43,"chatGroupId":538,"sessionServiceId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"","roles":"","bizId":"0","scope":"Tenant","status":"Disable"},"toUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"/","type":"txt"}],"ext":{"weichat":{"msgId":"57e0868d-686f-4443-873f-554b21509f06","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"/"},"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":9,"sessionServiceSeqId":9,"createDateTime":1546164530805,"timestamp":1546164530805,"createMicroTimestamp":1546164530805000}}],"timestamp":1546164530824,"type":null}
2018-12-30 18:08:50,825 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - prepare message noticeId:8de3de36-02ed-4874-9c16-7c99f03b983f messageType:NewChatMessage path:/tenants/43/agents/c4fb2422-cc1c-4264-ad25-2fe937d00df1
2018-12-30 18:08:50,825 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"e7bee08a-0c1a-11e9-97c3-45fb8e53bc06","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546164530824,"body":{"source":{},"timestamp":1546164530824,"actor":null,"version":"1.1","key":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","type":"ROBOT","startTime":1546164530824,"duration":60,"businessObj":{"tenantId":43,"serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","techChannelId":35,"visitorUser":{"tenantId":43,"userId":"64c1a71d-fa70-46db-9942-cd23424a758b","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","sex":0,"sendMessageCount":0,"roles":"visitor","bizId":"43","scope":"Tenant","status":"Disable"},"queueId":47,"robotId":0,"state":"Processing","chatGroupId":538,"messageSeqId":8,"agentUserId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"","agentUserType":6,"startDateTime":"2018-12-30 18:04:56","createDatetime":"2018-12-30 18:04:56","lastChatMessage":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","tenantId":43,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"5c7bf05f-dfda-4d8a-9000-381e2ba68853","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"04e8376e-3566-4309-930a-a8c1974272af","serviceSessionId":"f5b5a7f4-c200-4e91-b13e-bdc528a5de70","label":""},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"11b42ab7-8c27-423c-bc0f-873b91b042e0","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"","to":"webim-visitor-YPHKB3EPCRK2XJRHC6EE","channelType":"easemob","tenantId":43,"visitorUserId":"64c1a71d-fa70-46db-9942-cd23424a758b","originType":"webim","channel_id":35},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546164350757,"timestamp":1546164350000,"createMicroTimestamp":1546164350757000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 0, current offset is 1076
2018-12-30 18:08:50,826 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=57e0868d-686f-4443-873f-554b21509f06, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=), toUser=User(tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=57e0868d-686f-4443-873f-554b21509f06, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=/}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=9, sessionServiceSeqId=9, createDateTime=2018-12-30 18:08:50.805, timestamp=1546164530805, createMicroTimestamp=1546164530805000), serviceSession=ServiceSession(tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=47, robotId=0, chatRoomId=null, state=Processing, chatGroupId=538, messageSeqId=8, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=Sun Dec 30 18:04:56 CST 2018, stopDateTime=null, createDatetime=Sun Dec 30 18:04:56 CST 2018, lastChatMessage=ChatMessage(msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2649b54d], ext={weichat={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2018-12-30 18:05:50.757, timestamp=1546164350000, createMicroTimestamp=1546164350757000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2018-12-30 18:08:50,827 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=e7bee080-0c1a-11e9-9cf1-1919f5bd3618, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546164530824, properties={}, body={source={}, timestamp=1546164530824, actor=null, version=1.1, queueMessageData={userPK={tenantId=43, userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1}, messages=[{messageType=NewChatMessage, body={msgId=57e0868d-686f-4443-873f-554b21509f06, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=/, type=txt}], ext={weichat={msgId=57e0868d-686f-4443-873f-554b21509f06, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=/}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=9, sessionServiceSeqId=9, createDateTime=1546164530805, timestamp=1546164530805, createMicroTimestamp=1546164530805000}}], broadcast=false}}, topic=events, partitionKey=null)
2018-12-30 18:08:50,827 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 43. event BaseEvent(id=e7beb970-0c1a-11e9-9226-e774429ee8e8, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546164530823, properties={}, body={timestamp=1546164530823, version=1.1, tenantId=43, message={msgId=57e0868d-686f-4443-873f-554b21509f06, tenantId=43, chatGroupId=538, sessionServiceId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=, roles=, bizId=0, scope=Tenant, status=Disable}, toUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, contentType=application/easemob-msg, body={bodies=[{msg=/, type=txt}], ext={weichat={msgId=57e0868d-686f-4443-873f-554b21509f06, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=/}, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=9, sessionServiceSeqId=9, createDateTime=1546164530805, timestamp=1546164530805, createMicroTimestamp=1546164530805000}, serviceSession={tenantId=43, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, techChannelId=35, visitorUser={tenantId=43, userId=64c1a71d-fa70-46db-9942-cd23424a758b, userType=Visitor, userScope=Tenant, nicename=webim-visitor-YPHKB3EPCRK2XJRHC6EE, sex=0, sendMessageCount=0, roles=visitor, bizId=43, scope=Tenant, status=Disable}, queueId=47, robotId=0, state=Processing, chatGroupId=538, messageSeqId=8, agentUserId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=, agentUserType=6, startDateTime=2018-12-30 18:04:56, createDatetime=2018-12-30 18:04:56, lastChatMessage={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, tenantId=43, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=, type=txt}], ext={weichat={msgId=5c7bf05f-dfda-4d8a-9000-381e2ba68853, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=04e8376e-3566-4309-930a-a8c1974272af, serviceSessionId=f5b5a7f4-c200-4e91-b13e-bdc528a5de70, label=}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=11b42ab7-8c27-423c-bc0f-873b91b042e0, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/ee37eb6f-c65d-4c22-8385-627a6c21678eMzMucG5n/cutout?arg=0_13_571_571_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=, to=webim-visitor-YPHKB3EPCRK2XJRHC6EE, channelType=easemob, tenantId=43, visitorUserId=64c1a71d-fa70-46db-9942-cd23424a758b, originType=webim, channel_id=35}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546164350757, timestamp=1546164350000, createMicroTimestamp=1546164350757000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=f5b5a7f4-c200-4e91-b13e-bdc528a5de70).
2018-12-30 18:08:51,167 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:51,171 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:53,167 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:53,172 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:08 start
2018-12-30 18:08:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:08
2018-12-30 18:08:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:08 complete
2018-12-30 18:08:53,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:08:55,167 INFO  [http-nio-8899-exec-11]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:55,172 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:55,605 INFO  [kf-webapp-scheduler-pool-19]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2018-12-30 18:08:55,606 INFO  [kf-webapp-scheduler-pool-19]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2018-12-30 18:08:57,168 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:57,172 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:08:59,168 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:08:59,173 INFO  [consumer-kf:schedule:signal:a-7-thread-23]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:01,168 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:01,172 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:03,168 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:03,172 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:05,168 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:05,180 INFO  [consumer-kf:schedule:signal:a-7-thread-44]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:07,168 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:07,172 INFO  [consumer-kf:schedule:signal:a-7-thread-17]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:09,168 INFO  [http-nio-8899-exec-4]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:09,172 INFO  [consumer-kf:schedule:signal:a-7-thread-28]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:11,168 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:11,173 INFO  [consumer-kf:schedule:signal:a-7-thread-27]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:13,169 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:09 start
2018-12-30 18:09:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:30 18:09
2018-12-30 18:09:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 30 18:09 complete
2018-12-30 18:09:13,173 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2018-12-30 18:09:13,174 INFO  [consumer-kf:schedule:signal:a-7-thread-10]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
2018-12-30 18:09:15,168 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:2zdz3nv2 handleMessage:{"keepalive":"/tenants/43/agents/0fd687f3-09be-4919-b533-3d89c613590e/1546164061788"}
2018-12-30 18:09:15,174 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:43 queueId:47 byA:0fd687f3-09be-4919-b533-3d89c613590e toA:["0fd687f3-09be-4919-b533-3d89c613590e"] s1:[] s2:[]
