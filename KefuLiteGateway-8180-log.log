2018-12-27 15:00:01,267 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551169698037760404' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-FKQ4W8B76TYYMXYFH9JP&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;交强险保单遗失，如何补办？&quot;}],&quot;ext&quot;:{&quot;msgtype&quot;:{&quot;choice&quot;:{&quot;menuid&quot;:&quot;633eed9a-3397-4dfe-98b9-550e212e27bb&quot;}},&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;17b850e2-89d3-43b6-b693-3a55c6078e8c&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:01,268 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551169698037760404' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-FKQ4W8B76TYYMXYFH9JP&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;交强险保单遗失，如何补办？&quot;}],&quot;ext&quot;:{&quot;msgtype&quot;:{&quot;choice&quot;:{&quot;menuid&quot;:&quot;633eed9a-3397-4dfe-98b9-550e212e27bb&quot;}},&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;17b850e2-89d3-43b6-b693-3a55c6078e8c&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:01,268 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2904' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551169698037760404'/></message>.
2018-12-27 15:00:01,270 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","to":"119898","bodies":[{"type":"txt","msg":"交强险保单遗失，如何补办？"}],"ext":{"msgtype":{"choice":{"menuid":"633eed9a-3397-4dfe-98b9-550e212e27bb"}},"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"17b850e2-89d3-43b6-b693-3a55c6078e8c","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169698037760404","channel_id":35,"channelType":"easemob","timestamp":1545894001268,"tenantId":43,"originType":"webim"}].
2018-12-27 15:00:01,270 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@da36e88c], ext={msgtype={choice={menuid=633eed9a-3397-4dfe-98b9-550e212e27bb}}, weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=17b850e2-89d3-43b6-b693-3a55c6078e8c, originType=webim}}, from=webim-visitor-FKQ4W8B76TYYMXYFH9JP, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:01 CST 2018, msgId=551169698037760404, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:00:01,270 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=17b850e2-89d3-43b6-b693-3a55c6078e8c, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:00:01,270 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"17b850e2-89d3-43b6-b693-3a55c6078e8c","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:00:01,271 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"17b850e2-89d3-43b6-b693-3a55c6078e8c","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:00:01,271 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=17b850e2-89d3-43b6-b693-3a55c6078e8c, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:01,273 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@da36e88c], ext={msgtype={choice={menuid=633eed9a-3397-4dfe-98b9-550e212e27bb}}, weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=17b850e2-89d3-43b6-b693-3a55c6078e8c, originType=webim}}, from=webim-visitor-FKQ4W8B76TYYMXYFH9JP, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:01 CST 2018, msgId=551169698037760404, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:00:01,274 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=17b850e2-89d3-43b6-b693-3a55c6078e8c, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:00:01,275 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"交强险保单遗失，如何补办？","type":"txt"}],"ext":{"msgtype":{"choice":{"menuid":"633eed9a-3397-4dfe-98b9-550e212e27bb"}},"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"17b850e2-89d3-43b6-b693-3a55c6078e8c","originType":"webim"}},"from":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","to":"119898","channelType":"easemob","timestamp":1545894001268,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169698037760404","channel_id":35} has been send to kafka with in topic kf_msg_in partition 6, current offset is 68
2018-12-27 15:00:01,278 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=17b850e2-89d3-43b6-b693-3a55c6078e8c, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545893995587,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:50 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:55 GMT]}>
2018-12-27 15:00:01,278 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545893995587,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:50 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:55 GMT]}>
2018-12-27 15:00:01,279 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545893995587,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:50 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:55 GMT]}>
2018-12-27 15:00:01,517 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；\n若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。","type":"txt"}],"ext":{"weichat":{"msgId":"268667f4-dcb2-4c4e-a2bd-ebd5d130e2ba","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；\n若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。"},"msg_id_for_ack":"17b850e2-89d3-43b6-b693-3a55c6078e8c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:01,517 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@72320485], ext={weichat={msgId=268667f4-dcb2-4c4e-a2bd-ebd5d130e2ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；
若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。}, msg_id_for_ack=17b850e2-89d3-43b6-b693-3a55c6078e8c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:01,517 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@72320485], ext={weichat={msgId=268667f4-dcb2-4c4e-a2bd-ebd5d130e2ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；
若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。}, msg_id_for_ack=17b850e2-89d3-43b6-b693-3a55c6078e8c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to partner server for visitor webim-visitor-FKQ4W8B76TYYMXYFH9JP
2018-12-27 15:00:01,519 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；\n若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。","type":"txt"}],"ext":{"weichat":{"msgId":"268667f4-dcb2-4c4e-a2bd-ebd5d130e2ba","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；\n若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。"},"msg_id_for_ack":"17b850e2-89d3-43b6-b693-3a55c6078e8c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-FKQ4W8B76TYYMXYFH9JP.
2018-12-27 15:00:01,522 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@72320485], ext={weichat={msgId=268667f4-dcb2-4c4e-a2bd-ebd5d130e2ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；
若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。}, msg_id_for_ack=17b850e2-89d3-43b6-b693-3a55c6078e8c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:00:01,526 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@72320485, from=119898, ext={weichat={msgId=268667f4-dcb2-4c4e-a2bd-ebd5d130e2ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=您好，1）交强险抄件补办：提供行驶证、身份证（企业提供营业执照），我司可提供保单抄件加盖保单专用章；2）交强险正本补办：携带行驶证、身份证（企业提供营业执照）至柜面办理，5个工作日内完成补办；
若投保人≠被保险人（个人客户），保单补办时，原则上须提供投保人的相关信息，无法提供投保人信息的，需跟当地承保机构联系处理。}, msg_id_for_ack=17b850e2-89d3-43b6-b693-3a55c6078e8c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545893991008,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:51 GMT]}>
2018-12-27 15:00:01,526 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545893991008,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:51 GMT]}>
2018-12-27 15:00:01,526 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545893991008,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:51 GMT]}>
2018-12-27 15:00:02,478 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:00:09,438 INFO  [qtp1063823352-602]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-FKQ4W8B76TYYMXYFH9JP.
2018-12-27 15:00:09,905 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-7EF2GY8YB93CW6WFPY9K.
2018-12-27 15:00:10,295 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551169736814100884' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-wmg66b9bt6kry9xfcey8@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-WMG66B9BT6KRY9XFCEY8&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;1111&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;cfb452a0-fc05-48f8-981c-65827de91bc7&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:10,295 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551169736814100884' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-wmg66b9bt6kry9xfcey8@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-WMG66B9BT6KRY9XFCEY8&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;1111&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;cfb452a0-fc05-48f8-981c-65827de91bc7&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:10,295 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2905' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-wmg66b9bt6kry9xfcey8@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551169736814100884'/></message>.
2018-12-27 15:00:10,297 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-WMG66B9BT6KRY9XFCEY8","to":"119898","bodies":[{"type":"txt","msg":"1111"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169736814100884","channel_id":35,"channelType":"easemob","timestamp":1545894010295,"tenantId":43,"originType":"webim"}].
2018-12-27 15:00:10,297 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@170440], ext={weichat={language=zh-CN, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, originType=webim}}, from=webim-visitor-WMG66B9BT6KRY9XFCEY8, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:10 CST 2018, msgId=551169736814100884, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:00:10,297 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=cfb452a0-fc05-48f8-981c-65827de91bc7, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:00:10,297 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"cfb452a0-fc05-48f8-981c-65827de91bc7","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:00:10,297 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"cfb452a0-fc05-48f8-981c-65827de91bc7","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:00:10,298 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=cfb452a0-fc05-48f8-981c-65827de91bc7, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:10,300 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@170440], ext={weichat={language=zh-CN, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, originType=webim}}, from=webim-visitor-WMG66B9BT6KRY9XFCEY8, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:10 CST 2018, msgId=551169736814100884, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:00:10,301 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"1111","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","originType":"webim"}},"from":"webim-visitor-WMG66B9BT6KRY9XFCEY8","to":"119898","channelType":"easemob","timestamp":1545894010295,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169736814100884","channel_id":35} has been send to kafka with in topic kf_msg_in partition 1, current offset is 212
2018-12-27 15:00:10,311 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=cfb452a0-fc05-48f8-981c-65827de91bc7, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:00:10,322 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=cfb452a0-fc05-48f8-981c-65827de91bc7, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004630,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,322 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004630,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,322 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004630,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"31616f23-5479-4dd7-b055-51f75958729c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:10,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=31616f23-5479-4dd7-b055-51f75958729c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:10,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=31616f23-5479-4dd7-b055-51f75958729c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to partner server for visitor webim-visitor-WMG66B9BT6KRY9XFCEY8
2018-12-27 15:00:10,432 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"31616f23-5479-4dd7-b055-51f75958729c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WMG66B9BT6KRY9XFCEY8.
2018-12-27 15:00:10,435 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=31616f23-5479-4dd7-b055-51f75958729c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:00:10,438 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=31616f23-5479-4dd7-b055-51f75958729c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545893999920,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:59 GMT]}>
2018-12-27 15:00:10,438 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545893999920,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:59 GMT]}>
2018-12-27 15:00:10,438 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545893999920,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:59 GMT]}>
2018-12-27 15:00:10,452 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"4d8daf24-e33d-4367-a500-23ed68983e19","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"5ba53bad-1d13-451e-a2c8-a52bbe31e631"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:10,452 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=4d8daf24-e33d-4367-a500-23ed68983e19, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:10,452 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=4d8daf24-e33d-4367-a500-23ed68983e19, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to partner server for visitor webim-visitor-WMG66B9BT6KRY9XFCEY8
2018-12-27 15:00:10,453 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"4d8daf24-e33d-4367-a500-23ed68983e19","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"5ba53bad-1d13-451e-a2c8-a52bbe31e631"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WMG66B9BT6KRY9XFCEY8.
2018-12-27 15:00:10,456 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=4d8daf24-e33d-4367-a500-23ed68983e19, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:00:10,460 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=4d8daf24-e33d-4367-a500-23ed68983e19, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004768,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,460 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004768,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,460 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004768,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,482 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"e8d0c13b-5ee5-4848-969d-d28eaa043f9a","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"5ba53bad-1d13-451e-a2c8-a52bbe31e631"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:10,482 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=e8d0c13b-5ee5-4848-969d-d28eaa043f9a, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:10,482 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=e8d0c13b-5ee5-4848-969d-d28eaa043f9a, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to partner server for visitor webim-visitor-WMG66B9BT6KRY9XFCEY8
2018-12-27 15:00:10,483 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"e8d0c13b-5ee5-4848-969d-d28eaa043f9a","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"5ba53bad-1d13-451e-a2c8-a52bbe31e631"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WMG66B9BT6KRY9XFCEY8.
2018-12-27 15:00:10,486 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=e8d0c13b-5ee5-4848-969d-d28eaa043f9a, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:00:10,489 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=e8d0c13b-5ee5-4848-969d-d28eaa043f9a, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=5ba53bad-1d13-451e-a2c8-a52bbe31e631}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545893999971,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:59 GMT]}>
2018-12-27 15:00:10,489 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545893999971,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:59 GMT]}>
2018-12-27 15:00:10,489 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545893999971,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 06:59:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 06:59:59 GMT]}>
2018-12-27 15:00:10,571 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"4c58aedc-9a00-4048-a3b6-79d388ae1560","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:10,571 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=4c58aedc-9a00-4048-a3b6-79d388ae1560, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:10,571 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=4c58aedc-9a00-4048-a3b6-79d388ae1560, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to partner server for visitor webim-visitor-WMG66B9BT6KRY9XFCEY8
2018-12-27 15:00:10,573 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"4c58aedc-9a00-4048-a3b6-79d388ae1560","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WMG66B9BT6KRY9XFCEY8.
2018-12-27 15:00:10,576 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=4c58aedc-9a00-4048-a3b6-79d388ae1560, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:00:10,579 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=4c58aedc-9a00-4048-a3b6-79d388ae1560, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004887,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,579 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004887,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:10,579 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894004887,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:04 GMT]}>
2018-12-27 15:00:28,076 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551169813204959636' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-FKQ4W8B76TYYMXYFH9JP&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;[(F)][(F)][(D)]&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;97fd2dd6-a579-401f-8ab3-4400567ab5ca&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:28,076 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551169813204959636' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-FKQ4W8B76TYYMXYFH9JP&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;[(F)][(F)][(D)]&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;97fd2dd6-a579-401f-8ab3-4400567ab5ca&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:28,076 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2906' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551169813204959636'/></message>.
2018-12-27 15:00:28,079 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","to":"119898","bodies":[{"type":"txt","msg":"[(F)][(F)][(D)]"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"97fd2dd6-a579-401f-8ab3-4400567ab5ca","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169813204959636","channel_id":35,"channelType":"easemob","timestamp":1545894028076,"tenantId":43,"originType":"webim"}].
2018-12-27 15:00:28,079 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4b090a2b], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=97fd2dd6-a579-401f-8ab3-4400567ab5ca, originType=webim}}, from=webim-visitor-FKQ4W8B76TYYMXYFH9JP, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:28 CST 2018, msgId=551169813204959636, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:00:28,079 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=97fd2dd6-a579-401f-8ab3-4400567ab5ca, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:00:28,079 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"97fd2dd6-a579-401f-8ab3-4400567ab5ca","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:00:28,080 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"97fd2dd6-a579-401f-8ab3-4400567ab5ca","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:00:28,080 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=97fd2dd6-a579-401f-8ab3-4400567ab5ca, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:28,082 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=97fd2dd6-a579-401f-8ab3-4400567ab5ca, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:00:28,083 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@4b090a2b], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=97fd2dd6-a579-401f-8ab3-4400567ab5ca, originType=webim}}, from=webim-visitor-FKQ4W8B76TYYMXYFH9JP, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:28 CST 2018, msgId=551169813204959636, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:00:28,084 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"[(F)][(F)][(D)]","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"97fd2dd6-a579-401f-8ab3-4400567ab5ca","originType":"webim"}},"from":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","to":"119898","channelType":"easemob","timestamp":1545894028076,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169813204959636","channel_id":35} has been send to kafka with in topic kf_msg_in partition 6, current offset is 69
2018-12-27 15:00:28,093 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=97fd2dd6-a579-401f-8ab3-4400567ab5ca, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894017576,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:17 GMT]}>
2018-12-27 15:00:28,094 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894017576,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:17 GMT]}>
2018-12-27 15:00:28,094 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894017576,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:17 GMT]}>
2018-12-27 15:00:28,312 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"84870515-2459-4c57-86fb-60aa4b8b65b7","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"97fd2dd6-a579-401f-8ab3-4400567ab5ca","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:28,313 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=84870515-2459-4c57-86fb-60aa4b8b65b7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=97fd2dd6-a579-401f-8ab3-4400567ab5ca, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:28,313 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=84870515-2459-4c57-86fb-60aa4b8b65b7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=97fd2dd6-a579-401f-8ab3-4400567ab5ca, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to partner server for visitor webim-visitor-FKQ4W8B76TYYMXYFH9JP
2018-12-27 15:00:28,315 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"84870515-2459-4c57-86fb-60aa4b8b65b7","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"97fd2dd6-a579-401f-8ab3-4400567ab5ca","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-FKQ4W8B76TYYMXYFH9JP.
2018-12-27 15:00:28,319 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=84870515-2459-4c57-86fb-60aa4b8b65b7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=97fd2dd6-a579-401f-8ab3-4400567ab5ca, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:00:28,323 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=84870515-2459-4c57-86fb-60aa4b8b65b7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=97fd2dd6-a579-401f-8ab3-4400567ab5ca, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894022631,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:22 GMT]}>
2018-12-27 15:00:28,323 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894022631,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:22 GMT]}>
2018-12-27 15:00:28,323 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894022631,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:22 GMT]}>
2018-12-27 15:00:31,529 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:00:39,221 INFO  [qtp1063823352-472]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:39,222 INFO  [qtp1063823352-472]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=49,jid=9900181206048576#kefuchannelapp7_kefuchannelimid_840361@easemob.com
2018-12-27 15:00:39,224 INFO  [qtp1063823352-586]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:39,225 INFO  [qtp1063823352-586]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=1,jid=easemob-demo#chatdemoui_111219@easemob.com
2018-12-27 15:00:40,161 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551169865101083028' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-FKQ4W8B76TYYMXYFH9JP&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;给你点赞哦&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;42e6b77f-6903-43d8-82fa-1865ca5fbd5e&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:40,161 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551169865101083028' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-FKQ4W8B76TYYMXYFH9JP&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;给你点赞哦&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;42e6b77f-6903-43d8-82fa-1865ca5fbd5e&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:00:40,161 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2907' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-fkq4w8b76tyymxyfh9jp@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551169865101083028'/></message>.
2018-12-27 15:00:40,163 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","to":"119898","bodies":[{"type":"txt","msg":"给你点赞哦"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169865101083028","channel_id":35,"channelType":"easemob","timestamp":1545894040161,"tenantId":43,"originType":"webim"}].
2018-12-27 15:00:40,164 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2150f8ba], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, originType=webim}}, from=webim-visitor-FKQ4W8B76TYYMXYFH9JP, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:40 CST 2018, msgId=551169865101083028, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:00:40,164 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:00:40,164 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:00:40,164 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:00:40,164 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:40,166 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@2150f8ba], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, originType=webim}}, from=webim-visitor-FKQ4W8B76TYYMXYFH9JP, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:00:40 CST 2018, msgId=551169865101083028, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:00:40,167 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:00:40,167 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"给你点赞哦","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","originType":"webim"}},"from":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","to":"119898","channelType":"easemob","timestamp":1545894040161,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551169865101083028","channel_id":35} has been send to kafka with in topic kf_msg_in partition 6, current offset is 70
2018-12-27 15:00:40,173 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894029655,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:29 GMT]}>
2018-12-27 15:00:40,173 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894029655,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:29 GMT]}>
2018-12-27 15:00:40,173 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894029655,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:29 GMT]}>
2018-12-27 15:00:40,421 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"5c0e22c1-4cb2-4a7d-9b16-ce607299db5e","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:40,421 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=5c0e22c1-4cb2-4a7d-9b16-ce607299db5e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:40,421 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=5c0e22c1-4cb2-4a7d-9b16-ce607299db5e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to partner server for visitor webim-visitor-FKQ4W8B76TYYMXYFH9JP
2018-12-27 15:00:40,423 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"5c0e22c1-4cb2-4a7d-9b16-ce607299db5e","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-FKQ4W8B76TYYMXYFH9JP.
2018-12-27 15:00:40,425 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:00:40,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=5c0e22c1-4cb2-4a7d-9b16-ce607299db5e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:00:40,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=5c0e22c1-4cb2-4a7d-9b16-ce607299db5e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894034739,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:34 GMT]}>
2018-12-27 15:00:40,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894034739,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:34 GMT]}>
2018-12-27 15:00:40,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894034739,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:34 GMT]}>
2018-12-27 15:00:40,690 INFO  [qtp1063823352-472]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:00:41,324 INFO  [qtp1063823352-602]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:41,326 INFO  [qtp1063823352-602]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=49,jid=9900181206048576#kefuchannelapp7_kefuchannelimid_840361@easemob.com
2018-12-27 15:00:41,327 INFO  [qtp1063823352-547]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:41,328 INFO  [qtp1063823352-547]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=1,jid=easemob-demo#chatdemoui_111219@easemob.com
2018-12-27 15:00:42,124 INFO  [qtp1063823352-472]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:42,125 INFO  [qtp1063823352-472]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=49,jid=9900181206048576#kefuchannelapp7_kefuchannelimid_840361@easemob.com
2018-12-27 15:00:42,127 INFO  [qtp1063823352-602]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:42,128 INFO  [qtp1063823352-602]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=1,jid=easemob-demo#chatdemoui_111219@easemob.com
2018-12-27 15:00:50,690 INFO  [qtp1063823352-547]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:50,692 INFO  [qtp1063823352-547]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=49,jid=9900181206048576#kefuchannelapp7_kefuchannelimid_840361@easemob.com
2018-12-27 15:00:50,693 INFO  [qtp1063823352-602]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:00:50,695 INFO  [qtp1063823352-602]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=1,jid=easemob-demo#chatdemoui_111219@easemob.com
2018-12-27 15:00:54,285 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"939a040c-c0d9-49ff-bd4b-7c895a70daa3","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-QCTM9EJKYBBEWEFTHPVR","channelType":"easemob","tenantId":43,"visitorUserId":"908e5dd9-2cd7-4c47-afc4-629e5f02b442","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:00:54,286 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=939a040c-c0d9-49ff-bd4b-7c895a70daa3, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QCTM9EJKYBBEWEFTHPVR, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=908e5dd9-2cd7-4c47-afc4-629e5f02b442, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:00:54,286 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=939a040c-c0d9-49ff-bd4b-7c895a70daa3, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QCTM9EJKYBBEWEFTHPVR, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=908e5dd9-2cd7-4c47-afc4-629e5f02b442, originType=WEBIM) to partner server for visitor webim-visitor-QCTM9EJKYBBEWEFTHPVR
2018-12-27 15:00:54,288 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"939a040c-c0d9-49ff-bd4b-7c895a70daa3","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-QCTM9EJKYBBEWEFTHPVR","channelType":"easemob","tenantId":43,"visitorUserId":"908e5dd9-2cd7-4c47-afc4-629e5f02b442","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QCTM9EJKYBBEWEFTHPVR.
2018-12-27 15:00:54,291 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=939a040c-c0d9-49ff-bd4b-7c895a70daa3, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-QCTM9EJKYBBEWEFTHPVR, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=908e5dd9-2cd7-4c47-afc4-629e5f02b442, originType=WEBIM) to user webim-visitor-QCTM9EJKYBBEWEFTHPVR 
2018-12-27 15:00:54,296 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-QCTM9EJKYBBEWEFTHPVR], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=939a040c-c0d9-49ff-bd4b-7c895a70daa3, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QCTM9EJKYBBEWEFTHPVR" : "success"
  },
  "timestamp" : 1545894043778,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:43 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:43 GMT]}>
2018-12-27 15:00:54,296 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QCTM9EJKYBBEWEFTHPVR" : "success"
  },
  "timestamp" : 1545894043778,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:43 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:43 GMT]}>
2018-12-27 15:00:54,296 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QCTM9EJKYBBEWEFTHPVR" : "success"
  },
  "timestamp" : 1545894043778,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:00:43 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:00:43 GMT]}>
2018-12-27 15:01:02,483 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:01:03,844 WARN  [qtp1063823352-602]  o.e.jetty.servlet.ServletHandler - 
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.NullPointerException
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:981)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:860)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:845)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:848)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1772)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:207)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:176)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
	at org.eclipse.jetty.server.Server.handle(Server.java:534)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)
	at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException: null
	at com.easemob.weichat.gateway.rest.WechatMessageController.getPreauthcode(WechatMessageController.java:52)
	at sun.reflect.GeneratedMethodAccessor372.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:110)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:814)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:737)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:959)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:893)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:969)
	... 45 common frames omitted
2018-12-27 15:01:10,269 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-7EF2GY8YB93CW6WFPY9K.
2018-12-27 15:01:10,617 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"233a954f-bf3f-4b7a-a49e-c94b6c507af4","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:01:10,617 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=233a954f-bf3f-4b7a-a49e-c94b6c507af4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:10,617 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=233a954f-bf3f-4b7a-a49e-c94b6c507af4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to partner server for visitor webim-visitor-WMG66B9BT6KRY9XFCEY8
2018-12-27 15:01:10,620 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"233a954f-bf3f-4b7a-a49e-c94b6c507af4","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"cfb452a0-fc05-48f8-981c-65827de91bc7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WMG66B9BT6KRY9XFCEY8.
2018-12-27 15:01:10,624 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=233a954f-bf3f-4b7a-a49e-c94b6c507af4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:01:10,629 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28, from=119898, ext={weichat={msgId=233a954f-bf3f-4b7a-a49e-c94b6c507af4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=cfb452a0-fc05-48f8-981c-65827de91bc7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894064937,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:04 GMT]}>
2018-12-27 15:01:10,629 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894064937,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:04 GMT]}>
2018-12-27 15:01:10,629 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894064937,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:04 GMT]}>
2018-12-27 15:01:16,003 WARN  [qtp1063823352-602]  o.e.jetty.servlet.ServletHandler - 
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.NullPointerException
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:981)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:860)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:845)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:848)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1772)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:207)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:176)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
	at org.eclipse.jetty.server.Server.handle(Server.java:534)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)
	at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException: null
	at com.easemob.weichat.gateway.rest.WechatMessageController.getPreauthcode(WechatMessageController.java:52)
	at sun.reflect.GeneratedMethodAccessor372.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:110)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:814)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:737)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:959)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:893)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:969)
	... 45 common frames omitted
2018-12-27 15:01:22,131 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170045363880340' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-jmj7mj9cb3x9xb676jpy@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-JMJ7MJ9CB3X9XB676JPY&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;您好&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;2bbf6da5-4525-4ecd-80df-d466fa76530b&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:01:22,131 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170045363880340' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-jmj7mj9cb3x9xb676jpy@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-JMJ7MJ9CB3X9XB676JPY&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;您好&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;2bbf6da5-4525-4ecd-80df-d466fa76530b&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:01:22,131 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2908' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-jmj7mj9cb3x9xb676jpy@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170045363880340'/></message>.
2018-12-27 15:01:22,133 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","to":"119898","bodies":[{"type":"txt","msg":"您好"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170045363880340","channel_id":35,"channelType":"easemob","timestamp":1545894082131,"tenantId":43,"originType":"webim"}].
2018-12-27 15:01:22,134 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@c0dd5], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, originType=webim}}, from=webim-visitor-JMJ7MJ9CB3X9XB676JPY, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:01:22 CST 2018, msgId=551170045363880340, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:01:22,134 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=2bbf6da5-4525-4ecd-80df-d466fa76530b, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:01:22,134 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"2bbf6da5-4525-4ecd-80df-d466fa76530b","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:01:22,134 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"2bbf6da5-4525-4ecd-80df-d466fa76530b","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:01:22,134 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=2bbf6da5-4525-4ecd-80df-d466fa76530b, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:22,136 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@c0dd5], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, originType=webim}}, from=webim-visitor-JMJ7MJ9CB3X9XB676JPY, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:01:22 CST 2018, msgId=551170045363880340, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:01:22,137 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=2bbf6da5-4525-4ecd-80df-d466fa76530b, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:01:22,137 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"您好","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","originType":"webim"}},"from":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","to":"119898","channelType":"easemob","timestamp":1545894082131,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170045363880340","channel_id":35} has been send to kafka with in topic kf_msg_in partition 1, current offset is 213
2018-12-27 15:01:22,141 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=2bbf6da5-4525-4ecd-80df-d466fa76530b, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071623,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,141 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071623,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,141 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071623,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,251 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"95f82cee-1987-4cd7-b597-b970242bcca0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？"},"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:01:22,251 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=95f82cee-1987-4cd7-b597-b970242bcca0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？}, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:22,251 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=95f82cee-1987-4cd7-b597-b970242bcca0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？}, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to partner server for visitor webim-visitor-JMJ7MJ9CB3X9XB676JPY
2018-12-27 15:01:22,253 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"95f82cee-1987-4cd7-b597-b970242bcca0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？"},"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:01:22,255 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=95f82cee-1987-4cd7-b597-b970242bcca0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？}, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:01:22,259 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=95f82cee-1987-4cd7-b597-b970242bcca0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？}, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894076567,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:16 GMT]}>
2018-12-27 15:01:22,259 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894076567,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:16 GMT]}>
2018-12-27 15:01:22,259 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894076567,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:16 GMT]}>
2018-12-27 15:01:22,272 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"3079dd91-edfa-46b3-a52e-b38225bf1a7d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:01:22,272 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=3079dd91-edfa-46b3-a52e-b38225bf1a7d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:22,272 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=3079dd91-edfa-46b3-a52e-b38225bf1a7d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to partner server for visitor webim-visitor-JMJ7MJ9CB3X9XB676JPY
2018-12-27 15:01:22,274 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"3079dd91-edfa-46b3-a52e-b38225bf1a7d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:01:22,277 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=3079dd91-edfa-46b3-a52e-b38225bf1a7d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:01:22,281 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=3079dd91-edfa-46b3-a52e-b38225bf1a7d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071763,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,281 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071763,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,281 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071763,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,304 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"33aa954f-408f-45f4-9047-44f242280e51","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:01:22,304 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=33aa954f-408f-45f4-9047-44f242280e51, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:22,304 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=33aa954f-408f-45f4-9047-44f242280e51, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to partner server for visitor webim-visitor-JMJ7MJ9CB3X9XB676JPY
2018-12-27 15:01:22,306 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"33aa954f-408f-45f4-9047-44f242280e51","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:01:22,308 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=33aa954f-408f-45f4-9047-44f242280e51, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:01:22,311 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=33aa954f-408f-45f4-9047-44f242280e51, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=356a4b52-8ce0-48a0-b1bf-7bfcebf51a4f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894076619,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:16 GMT]}>
2018-12-27 15:01:22,311 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894076619,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:16 GMT]}>
2018-12-27 15:01:22,311 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894076619,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:16 GMT]}>
2018-12-27 15:01:22,429 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好！亲，有什么能帮助您的么？","type":"txt"}],"ext":{"weichat":{"msgId":"4d20a4a1-d05b-43e1-bc0c-06b6378dc2b2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:01:22,429 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20], ext={weichat={msgId=4d20a4a1-d05b-43e1-bc0c-06b6378dc2b2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:22,429 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20], ext={weichat={msgId=4d20a4a1-d05b-43e1-bc0c-06b6378dc2b2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to partner server for visitor webim-visitor-JMJ7MJ9CB3X9XB676JPY
2018-12-27 15:01:22,431 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好！亲，有什么能帮助您的么？","type":"txt"}],"ext":{"weichat":{"msgId":"4d20a4a1-d05b-43e1-bc0c-06b6378dc2b2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:01:22,434 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20], ext={weichat={msgId=4d20a4a1-d05b-43e1-bc0c-06b6378dc2b2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:01:22,437 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20, from=119898, ext={weichat={msgId=4d20a4a1-d05b-43e1-bc0c-06b6378dc2b2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071919,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,437 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071919,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:22,437 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894071919,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:11 GMT]}>
2018-12-27 15:01:25,963 WARN  [qtp1063823352-586]  o.e.jetty.servlet.ServletHandler - 
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.NullPointerException
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:981)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:860)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:845)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:848)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1772)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:207)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:176)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
	at org.eclipse.jetty.server.Server.handle(Server.java:534)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)
	at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException: null
	at com.easemob.weichat.gateway.rest.WechatMessageController.getPreauthcode(WechatMessageController.java:52)
	at sun.reflect.GeneratedMethodAccessor372.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:110)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:814)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:737)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:959)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:893)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:969)
	... 45 common frames omitted
2018-12-27 15:01:30,252 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:01:40,418 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:01:40,464 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"fcb8366c-4e9a-4241-9d06-ba9cc07a6354","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:01:40,464 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=fcb8366c-4e9a-4241-9d06-ba9cc07a6354, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:01:40,464 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=fcb8366c-4e9a-4241-9d06-ba9cc07a6354, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to partner server for visitor webim-visitor-FKQ4W8B76TYYMXYFH9JP
2018-12-27 15:01:40,466 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"fcb8366c-4e9a-4241-9d06-ba9cc07a6354","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"42e6b77f-6903-43d8-82fa-1865ca5fbd5e","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-FKQ4W8B76TYYMXYFH9JP.
2018-12-27 15:01:40,470 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=fcb8366c-4e9a-4241-9d06-ba9cc07a6354, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:01:40,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28, from=119898, ext={weichat={msgId=fcb8366c-4e9a-4241-9d06-ba9cc07a6354, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=42e6b77f-6903-43d8-82fa-1865ca5fbd5e, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894094782,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:34 GMT]}>
2018-12-27 15:01:40,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894094782,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:34 GMT]}>
2018-12-27 15:01:40,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894094782,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:01:29 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:01:34 GMT]}>
2018-12-27 15:01:40,714 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:02:02,481 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:02:10,263 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-7EF2GY8YB93CW6WFPY9K.
2018-12-27 15:02:10,685 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"7179ecb0-bd70-4358-a55e-ec4e4368d75b","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:10,685 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=7179ecb0-bd70-4358-a55e-ec4e4368d75b, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:10,686 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=7179ecb0-bd70-4358-a55e-ec4e4368d75b, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to partner server for visitor webim-visitor-WMG66B9BT6KRY9XFCEY8
2018-12-27 15:02:10,688 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"7179ecb0-bd70-4358-a55e-ec4e4368d75b","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-WMG66B9BT6KRY9XFCEY8","channelType":"easemob","tenantId":43,"visitorUserId":"33b3852d-b442-4ba8-a509-dbce9b3f7caa","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WMG66B9BT6KRY9XFCEY8.
2018-12-27 15:02:10,691 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=7179ecb0-bd70-4358-a55e-ec4e4368d75b, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-WMG66B9BT6KRY9XFCEY8, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=33b3852d-b442-4ba8-a509-dbce9b3f7caa, originType=WEBIM) to user webim-visitor-WMG66B9BT6KRY9XFCEY8 
2018-12-27 15:02:10,695 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-WMG66B9BT6KRY9XFCEY8], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=7179ecb0-bd70-4358-a55e-ec4e4368d75b, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894120177,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:00 GMT]}>
2018-12-27 15:02:10,695 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894120177,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:00 GMT]}>
2018-12-27 15:02:10,695 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-WMG66B9BT6KRY9XFCEY8" : "success"
  },
  "timestamp" : 1545894120177,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:00 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:00 GMT]}>
2018-12-27 15:02:12,314 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:02:12,687 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170241795719572' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-g387tvm7xgjggpepj6ex@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-G387TVM7XGJGGPEPJ6EX&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;[:D][:D][;)][:D][):][):][):]&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;9a82671c-8b07-4221-a6ec-da4518c8c6ce&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:12,687 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170241795719572' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-g387tvm7xgjggpepj6ex@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-G387TVM7XGJGGPEPJ6EX&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;[:D][:D][;)][:D][):][):][):]&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;9a82671c-8b07-4221-a6ec-da4518c8c6ce&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:12,687 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2915' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-g387tvm7xgjggpepj6ex@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170241795719572'/></message>.
2018-12-27 15:02:12,689 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-G387TVM7XGJGGPEPJ6EX","to":"119898","bodies":[{"type":"txt","msg":"[:D][:D][;)][:D][):][):][):]"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170241795719572","channel_id":35,"channelType":"easemob","timestamp":1545894132687,"tenantId":43,"originType":"webim"}].
2018-12-27 15:02:12,689 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@1a369c8f], ext={weichat={language=zh-CN, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, originType=webim}}, from=webim-visitor-G387TVM7XGJGGPEPJ6EX, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:12 CST 2018, msgId=551170241795719572, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:02:12,689 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=9a82671c-8b07-4221-a6ec-da4518c8c6ce, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:02:12,689 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:02:12,689 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:02:12,690 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=9a82671c-8b07-4221-a6ec-da4518c8c6ce, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:12,692 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@1a369c8f], ext={weichat={language=zh-CN, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, originType=webim}}, from=webim-visitor-G387TVM7XGJGGPEPJ6EX, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:12 CST 2018, msgId=551170241795719572, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:02:12,693 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"[:D][:D][;)][:D][):][):][):]","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","originType":"webim"}},"from":"webim-visitor-G387TVM7XGJGGPEPJ6EX","to":"119898","channelType":"easemob","timestamp":1545894132687,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170241795719572","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 117
2018-12-27 15:02:12,693 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=9a82671c-8b07-4221-a6ec-da4518c8c6ce, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:12,696 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=9a82671c-8b07-4221-a6ec-da4518c8c6ce, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127004,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,697 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127004,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,697 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127004,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,807 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"4e45b457-903b-4424-8be6-f9236ac75822","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:12,808 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=4e45b457-903b-4424-8be6-f9236ac75822, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:12,808 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=4e45b457-903b-4424-8be6-f9236ac75822, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:02:12,809 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"4e45b457-903b-4424-8be6-f9236ac75822","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:02:12,812 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=4e45b457-903b-4424-8be6-f9236ac75822, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:12,815 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=4e45b457-903b-4424-8be6-f9236ac75822, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894122297,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:02 GMT]}>
2018-12-27 15:02:12,815 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894122297,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:02 GMT]}>
2018-12-27 15:02:12,815 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894122297,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:02 GMT]}>
2018-12-27 15:02:12,830 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"69afef23-0071-4011-a9b5-26d881f3ace9","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"894a2c48-2e7f-43be-b931-e53d583ab7db"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:12,830 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=69afef23-0071-4011-a9b5-26d881f3ace9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:12,830 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=69afef23-0071-4011-a9b5-26d881f3ace9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:02:12,833 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"69afef23-0071-4011-a9b5-26d881f3ace9","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"894a2c48-2e7f-43be-b931-e53d583ab7db"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:02:12,835 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=69afef23-0071-4011-a9b5-26d881f3ace9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:12,839 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=69afef23-0071-4011-a9b5-26d881f3ace9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127147,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,839 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127147,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,839 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127147,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,863 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"151ef558-b805-42c4-a5ef-ebe2f3303efa","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"894a2c48-2e7f-43be-b931-e53d583ab7db"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:12,864 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=151ef558-b805-42c4-a5ef-ebe2f3303efa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:12,864 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=151ef558-b805-42c4-a5ef-ebe2f3303efa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:02:12,865 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"151ef558-b805-42c4-a5ef-ebe2f3303efa","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"894a2c48-2e7f-43be-b931-e53d583ab7db"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:02:12,868 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=151ef558-b805-42c4-a5ef-ebe2f3303efa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:12,871 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=151ef558-b805-42c4-a5ef-ebe2f3303efa, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=894a2c48-2e7f-43be-b931-e53d583ab7db}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894122353,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:02 GMT]}>
2018-12-27 15:02:12,871 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894122353,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:02 GMT]}>
2018-12-27 15:02:12,871 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894122353,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:02 GMT]}>
2018-12-27 15:02:12,983 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"634735f3-5837-4185-8c07-41d824dd1c57","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:12,983 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=634735f3-5837-4185-8c07-41d824dd1c57, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:12,984 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=634735f3-5837-4185-8c07-41d824dd1c57, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:02:12,985 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"634735f3-5837-4185-8c07-41d824dd1c57","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"9a82671c-8b07-4221-a6ec-da4518c8c6ce","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:02:12,988 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=634735f3-5837-4185-8c07-41d824dd1c57, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:12,992 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=634735f3-5837-4185-8c07-41d824dd1c57, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=9a82671c-8b07-4221-a6ec-da4518c8c6ce, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127300,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,992 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127300,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:12,992 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894127300,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:07 GMT]}>
2018-12-27 15:02:22,471 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f6f9ac03-a7db-4a83-a722-74f7a38a30ad","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:22,471 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f6f9ac03-a7db-4a83-a722-74f7a38a30ad, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:22,471 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f6f9ac03-a7db-4a83-a722-74f7a38a30ad, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to partner server for visitor webim-visitor-JMJ7MJ9CB3X9XB676JPY
2018-12-27 15:02:22,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f6f9ac03-a7db-4a83-a722-74f7a38a30ad","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"2bbf6da5-4525-4ecd-80df-d466fa76530b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:02:22,476 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f6f9ac03-a7db-4a83-a722-74f7a38a30ad, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:02:22,481 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28, from=119898, ext={weichat={msgId=f6f9ac03-a7db-4a83-a722-74f7a38a30ad, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=2bbf6da5-4525-4ecd-80df-d466fa76530b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894131963,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:11 GMT]}>
2018-12-27 15:02:22,481 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894131963,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:11 GMT]}>
2018-12-27 15:02:22,481 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894131963,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:11 GMT]}>
2018-12-27 15:02:27,577 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170305758855572' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-g387tvm7xgjggpepj6ex@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-G387TVM7XGJGGPEPJ6EX&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;[(u)][(u)][(u)]&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:27,577 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170305758855572' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-g387tvm7xgjggpepj6ex@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-G387TVM7XGJGGPEPJ6EX&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;[(u)][(u)][(u)]&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:27,577 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2916' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-g387tvm7xgjggpepj6ex@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170305758855572'/></message>.
2018-12-27 15:02:27,579 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-G387TVM7XGJGGPEPJ6EX","to":"119898","bodies":[{"type":"txt","msg":"[(u)][(u)][(u)]"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170305758855572","channel_id":35,"channelType":"easemob","timestamp":1545894147577,"tenantId":43,"originType":"webim"}].
2018-12-27 15:02:27,579 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@276f30bc], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, originType=webim}}, from=webim-visitor-G387TVM7XGJGGPEPJ6EX, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:27 CST 2018, msgId=551170305758855572, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:02:27,579 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:02:27,579 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:02:27,580 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:02:27,580 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:27,582 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@276f30bc], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, originType=webim}}, from=webim-visitor-G387TVM7XGJGGPEPJ6EX, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:27 CST 2018, msgId=551170305758855572, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:02:27,582 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:27,582 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"[(u)][(u)][(u)]","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","originType":"webim"}},"from":"webim-visitor-G387TVM7XGJGGPEPJ6EX","to":"119898","channelType":"easemob","timestamp":1545894147577,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170305758855572","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 118
2018-12-27 15:02:27,587 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894141895,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:21 GMT]}>
2018-12-27 15:02:27,587 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894141895,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:21 GMT]}>
2018-12-27 15:02:27,587 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894141895,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:21 GMT]}>
2018-12-27 15:02:27,795 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"5bff8f58-9312-4eaa-ba97-d58b4b7223ca","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:27,795 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=5bff8f58-9312-4eaa-ba97-d58b4b7223ca, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:27,795 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=5bff8f58-9312-4eaa-ba97-d58b4b7223ca, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:02:27,797 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"5bff8f58-9312-4eaa-ba97-d58b4b7223ca","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:02:27,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=5bff8f58-9312-4eaa-ba97-d58b4b7223ca, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:02:27,804 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=5bff8f58-9312-4eaa-ba97-d58b4b7223ca, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894137286,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:17 GMT]}>
2018-12-27 15:02:27,805 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894137286,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:17 GMT]}>
2018-12-27 15:02:27,805 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894137286,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:17 GMT]}>
2018-12-27 15:02:30,177 INFO  [qtp1063823352-472]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:02:36,152 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170342534513044' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;草泥马&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;msg_id_for_ack&quot;:&quot;134613a1-fdbe-4b96-848d-f9befe7114f7&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:36,152 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170342534513044' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;草泥马&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;msg_id_for_ack&quot;:&quot;134613a1-fdbe-4b96-848d-f9befe7114f7&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:36,152 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2917' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170342534513044'/></message>.
2018-12-27 15:02:36,154 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"草泥马"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","msg_id_for_ack":"134613a1-fdbe-4b96-848d-f9befe7114f7","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170342534513044","channel_id":35,"channelType":"easemob","timestamp":1545894156152,"tenantId":43,"originType":"webim"}].
2018-12-27 15:02:36,154 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@1fa9f30], ext={weichat={language=zh-CN, queueName=test, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:36 CST 2018, msgId=551170342534513044, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:02:36,154 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=134613a1-fdbe-4b96-848d-f9befe7114f7, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:02:36,154 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"134613a1-fdbe-4b96-848d-f9befe7114f7","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:02:36,155 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"134613a1-fdbe-4b96-848d-f9befe7114f7","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:02:36,155 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=134613a1-fdbe-4b96-848d-f9befe7114f7, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:36,157 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@1fa9f30], ext={weichat={language=zh-CN, queueName=test, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:36 CST 2018, msgId=551170342534513044, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:02:36,157 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=134613a1-fdbe-4b96-848d-f9befe7114f7, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:36,158 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"草泥马","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","msg_id_for_ack":"134613a1-fdbe-4b96-848d-f9befe7114f7","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894156152,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170342534513044","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 119
2018-12-27 15:02:36,162 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=134613a1-fdbe-4b96-848d-f9befe7114f7, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150470,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,162 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150470,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,162 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150470,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,290 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"86d6aebb-e2b9-4085-84b4-cd22531d655c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"134613a1-fdbe-4b96-848d-f9befe7114f7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:36,290 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=86d6aebb-e2b9-4085-84b4-cd22531d655c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:36,290 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=86d6aebb-e2b9-4085-84b4-cd22531d655c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:02:36,292 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"86d6aebb-e2b9-4085-84b4-cd22531d655c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"134613a1-fdbe-4b96-848d-f9befe7114f7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:02:36,295 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=86d6aebb-e2b9-4085-84b4-cd22531d655c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:36,299 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=86d6aebb-e2b9-4085-84b4-cd22531d655c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894145780,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:25 GMT]}>
2018-12-27 15:02:36,299 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894145780,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:25 GMT]}>
2018-12-27 15:02:36,299 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894145780,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:25 GMT]}>
2018-12-27 15:02:36,312 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"915bcef4-a028-4a2f-ac52-4265c7045840","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"7663550f-23e6-4f10-8726-5cd1bbeff8fc"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:36,312 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=915bcef4-a028-4a2f-ac52-4265c7045840, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:36,312 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=915bcef4-a028-4a2f-ac52-4265c7045840, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:02:36,314 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"915bcef4-a028-4a2f-ac52-4265c7045840","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"7663550f-23e6-4f10-8726-5cd1bbeff8fc"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:02:36,317 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=915bcef4-a028-4a2f-ac52-4265c7045840, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:36,320 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=915bcef4-a028-4a2f-ac52-4265c7045840, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150628,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,320 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150628,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,320 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150628,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,342 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"65c61103-be62-4843-bd5d-f83288fe0ba2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"7663550f-23e6-4f10-8726-5cd1bbeff8fc"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:36,342 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=65c61103-be62-4843-bd5d-f83288fe0ba2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:36,342 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=65c61103-be62-4843-bd5d-f83288fe0ba2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:02:36,345 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"65c61103-be62-4843-bd5d-f83288fe0ba2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"7663550f-23e6-4f10-8726-5cd1bbeff8fc"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:02:36,348 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=65c61103-be62-4843-bd5d-f83288fe0ba2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:36,351 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=65c61103-be62-4843-bd5d-f83288fe0ba2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=7663550f-23e6-4f10-8726-5cd1bbeff8fc}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894145833,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:25 GMT]}>
2018-12-27 15:02:36,351 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894145833,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:25 GMT]}>
2018-12-27 15:02:36,351 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894145833,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:25 GMT]}>
2018-12-27 15:02:36,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好，您的问题不是很恰当，请重新提问其他问题。","type":"txt"}],"ext":{"weichat":{"msgId":"679c541d-3bc8-40a0-821e-9872133a47ef","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"134613a1-fdbe-4b96-848d-f9befe7114f7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:36,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=679c541d-3bc8-40a0-821e-9872133a47ef, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:36,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=679c541d-3bc8-40a0-821e-9872133a47ef, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:02:36,430 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好，您的问题不是很恰当，请重新提问其他问题。","type":"txt"}],"ext":{"weichat":{"msgId":"679c541d-3bc8-40a0-821e-9872133a47ef","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"134613a1-fdbe-4b96-848d-f9befe7114f7","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:02:36,433 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=679c541d-3bc8-40a0-821e-9872133a47ef, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:36,436 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00, from=119898, ext={weichat={msgId=679c541d-3bc8-40a0-821e-9872133a47ef, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134613a1-fdbe-4b96-848d-f9befe7114f7, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150744,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,436 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150744,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:36,436 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894150744,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:25 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:40,419 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:02:40,519 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"84273b73-adee-4c39-aec4-a0b30670148f","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:40,519 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=84273b73-adee-4c39-aec4-a0b30670148f, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:40,519 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=84273b73-adee-4c39-aec4-a0b30670148f, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to partner server for visitor webim-visitor-FKQ4W8B76TYYMXYFH9JP
2018-12-27 15:02:40,522 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"84273b73-adee-4c39-aec4-a0b30670148f","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-FKQ4W8B76TYYMXYFH9JP","channelType":"easemob","tenantId":43,"visitorUserId":"4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-FKQ4W8B76TYYMXYFH9JP.
2018-12-27 15:02:40,525 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=84273b73-adee-4c39-aec4-a0b30670148f, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-FKQ4W8B76TYYMXYFH9JP, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=4c8be06e-c00b-45fb-9b05-ad66cb8ff2f3, originType=WEBIM) to user webim-visitor-FKQ4W8B76TYYMXYFH9JP 
2018-12-27 15:02:40,529 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-FKQ4W8B76TYYMXYFH9JP], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=84273b73-adee-4c39-aec4-a0b30670148f, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894150011,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:30 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:40,529 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894150011,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:30 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:40,529 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-FKQ4W8B76TYYMXYFH9JP" : "success"
  },
  "timestamp" : 1545894150011,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:30 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:30 GMT]}>
2018-12-27 15:02:40,674 INFO  [qtp1063823352-641]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:02:50,791 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170405444878740' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;我想当国家领导人&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;ce4b002a-b425-49c4-8970-b72e90febca9&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:50,791 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170405444878740' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;我想当国家领导人&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;ce4b002a-b425-49c4-8970-b72e90febca9&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:02:50,791 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2918' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170405444878740'/></message>.
2018-12-27 15:02:50,793 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"我想当国家领导人"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"ce4b002a-b425-49c4-8970-b72e90febca9","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170405444878740","channel_id":35,"channelType":"easemob","timestamp":1545894170791,"tenantId":43,"originType":"webim"}].
2018-12-27 15:02:50,793 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@45b4465a], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=ce4b002a-b425-49c4-8970-b72e90febca9, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:50 CST 2018, msgId=551170405444878740, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:02:50,793 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=ce4b002a-b425-49c4-8970-b72e90febca9, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:02:50,793 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"ce4b002a-b425-49c4-8970-b72e90febca9","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:02:50,794 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"ce4b002a-b425-49c4-8970-b72e90febca9","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:02:50,794 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=ce4b002a-b425-49c4-8970-b72e90febca9, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:50,796 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@45b4465a], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=ce4b002a-b425-49c4-8970-b72e90febca9, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:02:50 CST 2018, msgId=551170405444878740, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:02:50,796 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=ce4b002a-b425-49c4-8970-b72e90febca9, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:50,796 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"我想当国家领导人","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"ce4b002a-b425-49c4-8970-b72e90febca9","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894170791,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170405444878740","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 120
2018-12-27 15:02:50,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=ce4b002a-b425-49c4-8970-b72e90febca9, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894165109,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:45 GMT]}>
2018-12-27 15:02:50,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894165109,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:45 GMT]}>
2018-12-27 15:02:50,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894165109,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:45 GMT]}>
2018-12-27 15:02:51,060 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"91766d92-35e5-4ee6-8d14-6e7e65d0edb1","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"ce4b002a-b425-49c4-8970-b72e90febca9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:02:51,060 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=91766d92-35e5-4ee6-8d14-6e7e65d0edb1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=ce4b002a-b425-49c4-8970-b72e90febca9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:02:51,060 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=91766d92-35e5-4ee6-8d14-6e7e65d0edb1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=ce4b002a-b425-49c4-8970-b72e90febca9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:02:51,062 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"91766d92-35e5-4ee6-8d14-6e7e65d0edb1","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"ce4b002a-b425-49c4-8970-b72e90febca9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:02:51,065 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=91766d92-35e5-4ee6-8d14-6e7e65d0edb1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=ce4b002a-b425-49c4-8970-b72e90febca9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:02:51,070 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=91766d92-35e5-4ee6-8d14-6e7e65d0edb1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=ce4b002a-b425-49c4-8970-b72e90febca9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894160552,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:40 GMT]}>
2018-12-27 15:02:51,070 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894160552,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:40 GMT]}>
2018-12-27 15:02:51,070 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894160552,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:40 GMT]}>
2018-12-27 15:03:02,480 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:03:04,506 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170464278380948' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;你们紫金授权给我个人行使权利&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;5c71cf22-9d25-4330-9c16-86db3b0a70fa&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:04,506 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170464278380948' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;你们紫金授权给我个人行使权利&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;5c71cf22-9d25-4330-9c16-86db3b0a70fa&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:04,506 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2919' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170464278380948'/></message>.
2018-12-27 15:03:04,508 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"你们紫金授权给我个人行使权利"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"5c71cf22-9d25-4330-9c16-86db3b0a70fa","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170464278380948","channel_id":35,"channelType":"easemob","timestamp":1545894184506,"tenantId":43,"originType":"webim"}].
2018-12-27 15:03:04,509 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@14362b2e], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=5c71cf22-9d25-4330-9c16-86db3b0a70fa, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:04 CST 2018, msgId=551170464278380948, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:03:04,509 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=5c71cf22-9d25-4330-9c16-86db3b0a70fa, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:03:04,509 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"5c71cf22-9d25-4330-9c16-86db3b0a70fa","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:03:04,509 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"5c71cf22-9d25-4330-9c16-86db3b0a70fa","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:03:04,510 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=5c71cf22-9d25-4330-9c16-86db3b0a70fa, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:04,512 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@14362b2e], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=5c71cf22-9d25-4330-9c16-86db3b0a70fa, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:04 CST 2018, msgId=551170464278380948, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:03:04,512 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=5c71cf22-9d25-4330-9c16-86db3b0a70fa, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:03:04,513 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"你们紫金授权给我个人行使权利","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"5c71cf22-9d25-4330-9c16-86db3b0a70fa","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894184506,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170464278380948","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 121
2018-12-27 15:03:04,517 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=5c71cf22-9d25-4330-9c16-86db3b0a70fa, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894178825,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:53 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:58 GMT]}>
2018-12-27 15:03:04,517 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894178825,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:53 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:58 GMT]}>
2018-12-27 15:03:04,517 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894178825,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:53 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:58 GMT]}>
2018-12-27 15:03:04,792 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好，您的问题不是很恰当，请重新提问其他问题。","type":"txt"}],"ext":{"weichat":{"msgId":"86b6796f-3a91-477c-ab3b-8115130693d1","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"5c71cf22-9d25-4330-9c16-86db3b0a70fa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:04,793 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=86b6796f-3a91-477c-ab3b-8115130693d1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=5c71cf22-9d25-4330-9c16-86db3b0a70fa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:04,793 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=86b6796f-3a91-477c-ab3b-8115130693d1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=5c71cf22-9d25-4330-9c16-86db3b0a70fa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:03:04,795 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好，您的问题不是很恰当，请重新提问其他问题。","type":"txt"}],"ext":{"weichat":{"msgId":"86b6796f-3a91-477c-ab3b-8115130693d1","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"5c71cf22-9d25-4330-9c16-86db3b0a70fa","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:03:04,798 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=86b6796f-3a91-477c-ab3b-8115130693d1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=5c71cf22-9d25-4330-9c16-86db3b0a70fa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:03:04,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00, from=119898, ext={weichat={msgId=86b6796f-3a91-477c-ab3b-8115130693d1, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=5c71cf22-9d25-4330-9c16-86db3b0a70fa, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894174283,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:54 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:54 GMT]}>
2018-12-27 15:03:04,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894174283,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:54 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:54 GMT]}>
2018-12-27 15:03:04,801 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894174283,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:54 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:54 GMT]}>
2018-12-27 15:03:09,813 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170507886559636' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-4P22TRRTKCTRXVC8FT3T&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;2&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;07de577a-9c36-4aae-b3b1-a07600a0a428&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:09,813 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170507886559636' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-4P22TRRTKCTRXVC8FT3T&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;2&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;07de577a-9c36-4aae-b3b1-a07600a0a428&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:09,814 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2920' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170507886559636'/></message>.
2018-12-27 15:03:09,815 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-4P22TRRTKCTRXVC8FT3T","to":"119898","bodies":[{"type":"txt","msg":"2"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"07de577a-9c36-4aae-b3b1-a07600a0a428","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170507886559636","channel_id":35,"channelType":"easemob","timestamp":1545894189813,"tenantId":43,"originType":"webim"}].
2018-12-27 15:03:09,816 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@32], ext={weichat={language=zh-CN, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, originType=webim}}, from=webim-visitor-4P22TRRTKCTRXVC8FT3T, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:09 CST 2018, msgId=551170507886559636, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:03:09,816 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=07de577a-9c36-4aae-b3b1-a07600a0a428, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:03:09,816 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"07de577a-9c36-4aae-b3b1-a07600a0a428","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:03:09,816 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"07de577a-9c36-4aae-b3b1-a07600a0a428","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:03:09,816 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=07de577a-9c36-4aae-b3b1-a07600a0a428, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:09,818 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@32], ext={weichat={language=zh-CN, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, originType=webim}}, from=webim-visitor-4P22TRRTKCTRXVC8FT3T, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:09 CST 2018, msgId=551170507886559636, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:03:09,818 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=07de577a-9c36-4aae-b3b1-a07600a0a428, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:09,819 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"2","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"07de577a-9c36-4aae-b3b1-a07600a0a428","originType":"webim"}},"from":"webim-visitor-4P22TRRTKCTRXVC8FT3T","to":"119898","channelType":"easemob","timestamp":1545894189813,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170507886559636","channel_id":35} has been send to kafka with in topic kf_msg_in partition 8, current offset is 266
2018-12-27 15:03:09,823 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=07de577a-9c36-4aae-b3b1-a07600a0a428, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184131,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:09,823 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184131,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:09,823 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184131,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:09,959 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"05d01af0-6c12-4e75-b55c-6b82ec2575a7","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"07de577a-9c36-4aae-b3b1-a07600a0a428","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:09,959 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=05d01af0-6c12-4e75-b55c-6b82ec2575a7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:09,959 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=05d01af0-6c12-4e75-b55c-6b82ec2575a7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:03:09,961 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"05d01af0-6c12-4e75-b55c-6b82ec2575a7","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"07de577a-9c36-4aae-b3b1-a07600a0a428","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:03:09,964 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=05d01af0-6c12-4e75-b55c-6b82ec2575a7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:09,967 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=05d01af0-6c12-4e75-b55c-6b82ec2575a7, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894179449,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:59 GMT]}>
2018-12-27 15:03:09,967 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894179449,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:59 GMT]}>
2018-12-27 15:03:09,967 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894179449,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:59 GMT]}>
2018-12-27 15:03:09,981 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"c2966d3c-23f5-4c6c-90ca-5dabefe48ba4","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"0737dc07-2b7b-4eb3-b87c-99ae48f7f42f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:09,981 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=c2966d3c-23f5-4c6c-90ca-5dabefe48ba4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:09,981 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=c2966d3c-23f5-4c6c-90ca-5dabefe48ba4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:03:09,983 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"c2966d3c-23f5-4c6c-90ca-5dabefe48ba4","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"0737dc07-2b7b-4eb3-b87c-99ae48f7f42f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:03:09,986 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=c2966d3c-23f5-4c6c-90ca-5dabefe48ba4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:09,989 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=c2966d3c-23f5-4c6c-90ca-5dabefe48ba4, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184297,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:09,989 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184297,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:09,989 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184297,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:10,014 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"249a83ff-a142-47f0-a207-d61a5e64e5dc","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"0737dc07-2b7b-4eb3-b87c-99ae48f7f42f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:10,014 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=249a83ff-a142-47f0-a207-d61a5e64e5dc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:10,014 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=249a83ff-a142-47f0-a207-d61a5e64e5dc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:03:10,016 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"249a83ff-a142-47f0-a207-d61a5e64e5dc","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"0737dc07-2b7b-4eb3-b87c-99ae48f7f42f"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:03:10,019 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=249a83ff-a142-47f0-a207-d61a5e64e5dc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:10,023 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=249a83ff-a142-47f0-a207-d61a5e64e5dc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=0737dc07-2b7b-4eb3-b87c-99ae48f7f42f}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894179505,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:59 GMT]}>
2018-12-27 15:03:10,023 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894179505,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:59 GMT]}>
2018-12-27 15:03:10,023 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894179505,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:02:59 GMT]}>
2018-12-27 15:03:10,126 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"2d8e46fc-079d-44f9-bf8e-8b66d2fb85d0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"07de577a-9c36-4aae-b3b1-a07600a0a428","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:10,126 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=2d8e46fc-079d-44f9-bf8e-8b66d2fb85d0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:10,127 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=2d8e46fc-079d-44f9-bf8e-8b66d2fb85d0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:03:10,129 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"2d8e46fc-079d-44f9-bf8e-8b66d2fb85d0","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"07de577a-9c36-4aae-b3b1-a07600a0a428","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:03:10,132 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=2d8e46fc-079d-44f9-bf8e-8b66d2fb85d0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:10,135 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=2d8e46fc-079d-44f9-bf8e-8b66d2fb85d0, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=07de577a-9c36-4aae-b3b1-a07600a0a428, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184443,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:10,135 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184443,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:10,135 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894184443,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:02:59 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:04 GMT]}>
2018-12-27 15:03:10,281 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-7EF2GY8YB93CW6WFPY9K.
2018-12-27 15:03:12,905 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170500408115604' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;我要当国家领导人&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;4a556af6-82b8-4f54-8c75-37f3d8886076&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:12,905 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170500408115604' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;我要当国家领导人&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;4a556af6-82b8-4f54-8c75-37f3d8886076&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:12,905 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2921' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170500408115604'/></message>.
2018-12-27 15:03:12,907 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"我要当国家领导人"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"4a556af6-82b8-4f54-8c75-37f3d8886076","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170500408115604","channel_id":35,"channelType":"easemob","timestamp":1545894192905,"tenantId":43,"originType":"webim"}].
2018-12-27 15:03:12,908 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@96ab4c68], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=4a556af6-82b8-4f54-8c75-37f3d8886076, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:12 CST 2018, msgId=551170500408115604, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:03:12,908 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=4a556af6-82b8-4f54-8c75-37f3d8886076, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:03:12,908 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"4a556af6-82b8-4f54-8c75-37f3d8886076","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:03:12,908 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"4a556af6-82b8-4f54-8c75-37f3d8886076","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:03:12,908 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=4a556af6-82b8-4f54-8c75-37f3d8886076, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:12,910 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@96ab4c68], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=4a556af6-82b8-4f54-8c75-37f3d8886076, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:12 CST 2018, msgId=551170500408115604, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:03:12,911 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=4a556af6-82b8-4f54-8c75-37f3d8886076, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:03:12,911 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"我要当国家领导人","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"4a556af6-82b8-4f54-8c75-37f3d8886076","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894192905,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170500408115604","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 122
2018-12-27 15:03:12,915 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=4a556af6-82b8-4f54-8c75-37f3d8886076, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894182397,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:02 GMT]}>
2018-12-27 15:03:12,915 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894182397,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:02 GMT]}>
2018-12-27 15:03:12,915 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894182397,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:02 GMT]}>
2018-12-27 15:03:13,153 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好，您的问题不是很恰当，请重新提问其他问题。","type":"txt"}],"ext":{"weichat":{"msgId":"e932de77-3540-4c7b-b048-728de3f8e0c6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4a556af6-82b8-4f54-8c75-37f3d8886076","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:13,154 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=e932de77-3540-4c7b-b048-728de3f8e0c6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4a556af6-82b8-4f54-8c75-37f3d8886076, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:13,154 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=e932de77-3540-4c7b-b048-728de3f8e0c6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4a556af6-82b8-4f54-8c75-37f3d8886076, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:03:13,156 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好，您的问题不是很恰当，请重新提问其他问题。","type":"txt"}],"ext":{"weichat":{"msgId":"e932de77-3540-4c7b-b048-728de3f8e0c6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"4a556af6-82b8-4f54-8c75-37f3d8886076","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:03:13,158 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00], ext={weichat={msgId=e932de77-3540-4c7b-b048-728de3f8e0c6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4a556af6-82b8-4f54-8c75-37f3d8886076, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:03:13,163 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@b8cbfc00, from=119898, ext={weichat={msgId=e932de77-3540-4c7b-b048-728de3f8e0c6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=4a556af6-82b8-4f54-8c75-37f3d8886076, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894187471,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:07 GMT]}>
2018-12-27 15:03:13,163 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894187471,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:07 GMT]}>
2018-12-27 15:03:13,163 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894187471,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:02 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:07 GMT]}>
2018-12-27 15:03:22,529 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"c824a640-0aaa-41bc-a79b-50a229dfe05a","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:22,529 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=c824a640-0aaa-41bc-a79b-50a229dfe05a, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:22,529 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=c824a640-0aaa-41bc-a79b-50a229dfe05a, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to partner server for visitor webim-visitor-JMJ7MJ9CB3X9XB676JPY
2018-12-27 15:03:22,531 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"c824a640-0aaa-41bc-a79b-50a229dfe05a","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-JMJ7MJ9CB3X9XB676JPY","channelType":"easemob","tenantId":43,"visitorUserId":"3e24dd6c-ae6c-4ad7-9906-ce08db6145b4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-JMJ7MJ9CB3X9XB676JPY.
2018-12-27 15:03:22,535 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=c824a640-0aaa-41bc-a79b-50a229dfe05a, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-JMJ7MJ9CB3X9XB676JPY, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=3e24dd6c-ae6c-4ad7-9906-ce08db6145b4, originType=WEBIM) to user webim-visitor-JMJ7MJ9CB3X9XB676JPY 
2018-12-27 15:03:22,540 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-JMJ7MJ9CB3X9XB676JPY], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=c824a640-0aaa-41bc-a79b-50a229dfe05a, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894192022,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:12 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:12 GMT]}>
2018-12-27 15:03:22,540 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894192022,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:12 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:12 GMT]}>
2018-12-27 15:03:22,540 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-JMJ7MJ9CB3X9XB676JPY" : "success"
  },
  "timestamp" : 1545894192022,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:12 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:12 GMT]}>
2018-12-27 15:03:27,846 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"03b1fd01-2224-4dba-8100-e34383b39635","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:27,846 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=03b1fd01-2224-4dba-8100-e34383b39635, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:27,846 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=03b1fd01-2224-4dba-8100-e34383b39635, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:03:27,848 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"03b1fd01-2224-4dba-8100-e34383b39635","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:03:27,851 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=03b1fd01-2224-4dba-8100-e34383b39635, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:03:27,855 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28, from=119898, ext={weichat={msgId=03b1fd01-2224-4dba-8100-e34383b39635, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=12e7e4b2-aec4-4fd0-8adc-e20c4097bfd4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894202164,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:22 GMT]}>
2018-12-27 15:03:27,855 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894202164,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:22 GMT]}>
2018-12-27 15:03:27,856 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894202164,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:22 GMT]}>
2018-12-27 15:03:30,067 INFO  [qtp1063823352-641]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:03:30,103 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170595002253716' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-4P22TRRTKCTRXVC8FT3T&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;保单丢了&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;aca5dae1-7068-4ac7-b901-8dcb2f4528b6&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:30,103 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170595002253716' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-4P22TRRTKCTRXVC8FT3T&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;保单丢了&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;aca5dae1-7068-4ac7-b901-8dcb2f4528b6&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:30,103 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2922' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170595002253716'/></message>.
2018-12-27 15:03:30,105 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-4P22TRRTKCTRXVC8FT3T","to":"119898","bodies":[{"type":"txt","msg":"保单丢了"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"aca5dae1-7068-4ac7-b901-8dcb2f4528b6","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170595002253716","channel_id":35,"channelType":"easemob","timestamp":1545894210103,"tenantId":43,"originType":"webim"}].
2018-12-27 15:03:30,105 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@25905dbc], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, originType=webim}}, from=webim-visitor-4P22TRRTKCTRXVC8FT3T, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:30 CST 2018, msgId=551170595002253716, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:03:30,105 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:03:30,105 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"aca5dae1-7068-4ac7-b901-8dcb2f4528b6","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:03:30,106 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"aca5dae1-7068-4ac7-b901-8dcb2f4528b6","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:03:30,106 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:30,108 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@25905dbc], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, originType=webim}}, from=webim-visitor-4P22TRRTKCTRXVC8FT3T, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:30 CST 2018, msgId=551170595002253716, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:03:30,108 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:30,110 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"保单丢了","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"aca5dae1-7068-4ac7-b901-8dcb2f4528b6","originType":"webim"}},"from":"webim-visitor-4P22TRRTKCTRXVC8FT3T","to":"119898","channelType":"easemob","timestamp":1545894210103,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170595002253716","channel_id":35} has been send to kafka with in topic kf_msg_in partition 8, current offset is 267
2018-12-27 15:03:30,113 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894199595,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:19 GMT]}>
2018-12-27 15:03:30,113 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894199595,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:19 GMT]}>
2018-12-27 15:03:30,113 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894199595,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:19 GMT]}>
2018-12-27 15:03:30,357 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"42fdae34-8ab8-4eea-8880-4f58a9a3b674","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"aca5dae1-7068-4ac7-b901-8dcb2f4528b6","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null},"msgtype":{"choice":{"list":["交强险保单遗失，如何补办？","商业险保单遗失，如何补办？","天津商业险保单补办需要哪些资料？","网上买的保单找不到了，在哪补办？","没有纸质保单，如何审车？"],"items":[{"id":"633eed9a-3397-4dfe-98b9-550e212e27bb","name":"交强险保单遗失，如何补办？"},{"id":"c14cb43e-3869-4073-ad06-67774024ed77","name":"商业险保单遗失，如何补办？"},{"id":"d6c36f7f-3808-4eb7-a49a-2bd78bda03fc","name":"天津商业险保单补办需要哪些资料？"},{"id":"b0c34594-ff7b-4ec3-9967-5ca5ac9cc330","name":"网上买的保单找不到了，在哪补办？"},{"id":"533edd43-fc37-4f5c-badd-f4b7f801e99c","name":"没有纸质保单，如何审车？"}],"title":"您是不是要咨询以下问题："}}},"from":"小紫","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:30,357 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=42fdae34-8ab8-4eea-8880-4f58a9a3b674, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[交强险保单遗失，如何补办？, 商业险保单遗失，如何补办？, 天津商业险保单补办需要哪些资料？, 网上买的保单找不到了，在哪补办？, 没有纸质保单，如何审车？], items=[{id=633eed9a-3397-4dfe-98b9-550e212e27bb, name=交强险保单遗失，如何补办？}, {id=c14cb43e-3869-4073-ad06-67774024ed77, name=商业险保单遗失，如何补办？}, {id=d6c36f7f-3808-4eb7-a49a-2bd78bda03fc, name=天津商业险保单补办需要哪些资料？}, {id=b0c34594-ff7b-4ec3-9967-5ca5ac9cc330, name=网上买的保单找不到了，在哪补办？}, {id=533edd43-fc37-4f5c-badd-f4b7f801e99c, name=没有纸质保单，如何审车？}], title=您是不是要咨询以下问题：}}}, from=小紫, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:30,358 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=42fdae34-8ab8-4eea-8880-4f58a9a3b674, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[交强险保单遗失，如何补办？, 商业险保单遗失，如何补办？, 天津商业险保单补办需要哪些资料？, 网上买的保单找不到了，在哪补办？, 没有纸质保单，如何审车？], items=[{id=633eed9a-3397-4dfe-98b9-550e212e27bb, name=交强险保单遗失，如何补办？}, {id=c14cb43e-3869-4073-ad06-67774024ed77, name=商业险保单遗失，如何补办？}, {id=d6c36f7f-3808-4eb7-a49a-2bd78bda03fc, name=天津商业险保单补办需要哪些资料？}, {id=b0c34594-ff7b-4ec3-9967-5ca5ac9cc330, name=网上买的保单找不到了，在哪补办？}, {id=533edd43-fc37-4f5c-badd-f4b7f801e99c, name=没有纸质保单，如何审车？}], title=您是不是要咨询以下问题：}}}, from=小紫, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:03:30,359 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"42fdae34-8ab8-4eea-8880-4f58a9a3b674","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"aca5dae1-7068-4ac7-b901-8dcb2f4528b6","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null},"msgtype":{"choice":{"list":["交强险保单遗失，如何补办？","商业险保单遗失，如何补办？","天津商业险保单补办需要哪些资料？","网上买的保单找不到了，在哪补办？","没有纸质保单，如何审车？"],"items":[{"id":"633eed9a-3397-4dfe-98b9-550e212e27bb","name":"交强险保单遗失，如何补办？"},{"id":"c14cb43e-3869-4073-ad06-67774024ed77","name":"商业险保单遗失，如何补办？"},{"id":"d6c36f7f-3808-4eb7-a49a-2bd78bda03fc","name":"天津商业险保单补办需要哪些资料？"},{"id":"b0c34594-ff7b-4ec3-9967-5ca5ac9cc330","name":"网上买的保单找不到了，在哪补办？"},{"id":"533edd43-fc37-4f5c-badd-f4b7f801e99c","name":"没有纸质保单，如何审车？"}],"title":"您是不是要咨询以下问题："}}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:03:30,364 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=42fdae34-8ab8-4eea-8880-4f58a9a3b674, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[交强险保单遗失，如何补办？, 商业险保单遗失，如何补办？, 天津商业险保单补办需要哪些资料？, 网上买的保单找不到了，在哪补办？, 没有纸质保单，如何审车？], items=[{id=633eed9a-3397-4dfe-98b9-550e212e27bb, name=交强险保单遗失，如何补办？}, {id=c14cb43e-3869-4073-ad06-67774024ed77, name=商业险保单遗失，如何补办？}, {id=d6c36f7f-3808-4eb7-a49a-2bd78bda03fc, name=天津商业险保单补办需要哪些资料？}, {id=b0c34594-ff7b-4ec3-9967-5ca5ac9cc330, name=网上买的保单找不到了，在哪补办？}, {id=533edd43-fc37-4f5c-badd-f4b7f801e99c, name=没有纸质保单，如何审车？}], title=您是不是要咨询以下问题：}}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:30,367 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@0, from=119898, ext={weichat={msgId=42fdae34-8ab8-4eea-8880-4f58a9a3b674, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=aca5dae1-7068-4ac7-b901-8dcb2f4528b6, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[交强险保单遗失，如何补办？, 商业险保单遗失，如何补办？, 天津商业险保单补办需要哪些资料？, 网上买的保单找不到了，在哪补办？, 没有纸质保单，如何审车？], items=[{id=633eed9a-3397-4dfe-98b9-550e212e27bb, name=交强险保单遗失，如何补办？}, {id=c14cb43e-3869-4073-ad06-67774024ed77, name=商业险保单遗失，如何补办？}, {id=d6c36f7f-3808-4eb7-a49a-2bd78bda03fc, name=天津商业险保单补办需要哪些资料？}, {id=b0c34594-ff7b-4ec3-9967-5ca5ac9cc330, name=网上买的保单找不到了，在哪补办？}, {id=533edd43-fc37-4f5c-badd-f4b7f801e99c, name=没有纸质保单，如何审车？}], title=您是不是要咨询以下问题：}}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894204675,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:24 GMT]}>
2018-12-27 15:03:30,367 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894204675,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:24 GMT]}>
2018-12-27 15:03:30,367 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894204675,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:24 GMT]}>
2018-12-27 15:03:32,074 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:03:40,420 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:03:40,689 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:03:47,259 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170668666814868' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-4P22TRRTKCTRXVC8FT3T&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;怎么买保险&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;57655bb5-de6c-4928-836a-98ba55dd0cb8&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:47,259 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170668666814868' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-4P22TRRTKCTRXVC8FT3T&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;怎么买保险&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;57655bb5-de6c-4928-836a-98ba55dd0cb8&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:03:47,259 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2923' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-4p22trrtkctrxvc8ft3t@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170668666814868'/></message>.
2018-12-27 15:03:47,261 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-4P22TRRTKCTRXVC8FT3T","to":"119898","bodies":[{"type":"txt","msg":"怎么买保险"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"57655bb5-de6c-4928-836a-98ba55dd0cb8","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170668666814868","channel_id":35,"channelType":"easemob","timestamp":1545894227259,"tenantId":43,"originType":"webim"}].
2018-12-27 15:03:47,261 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@6e5c0a62], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, originType=webim}}, from=webim-visitor-4P22TRRTKCTRXVC8FT3T, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:47 CST 2018, msgId=551170668666814868, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:03:47,261 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=57655bb5-de6c-4928-836a-98ba55dd0cb8, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:03:47,261 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"57655bb5-de6c-4928-836a-98ba55dd0cb8","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:03:47,261 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"57655bb5-de6c-4928-836a-98ba55dd0cb8","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:03:47,262 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=57655bb5-de6c-4928-836a-98ba55dd0cb8, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:47,263 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@6e5c0a62], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, originType=webim}}, from=webim-visitor-4P22TRRTKCTRXVC8FT3T, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:03:47 CST 2018, msgId=551170668666814868, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:03:47,264 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=57655bb5-de6c-4928-836a-98ba55dd0cb8, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:47,265 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"怎么买保险","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"57655bb5-de6c-4928-836a-98ba55dd0cb8","originType":"webim"}},"from":"webim-visitor-4P22TRRTKCTRXVC8FT3T","to":"119898","channelType":"easemob","timestamp":1545894227259,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170668666814868","channel_id":35} has been send to kafka with in topic kf_msg_in partition 8, current offset is 268
2018-12-27 15:03:47,268 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=57655bb5-de6c-4928-836a-98ba55dd0cb8, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894216750,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:36 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:36 GMT]}>
2018-12-27 15:03:47,269 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894216750,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:36 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:36 GMT]}>
2018-12-27 15:03:47,269 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894216750,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:36 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:36 GMT]}>
2018-12-27 15:03:47,498 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好，可以微信关注紫金保险的公众号，依次点击进入个性主页、热门险种中的宠物犬主责任保险购买。","type":"txt"}],"ext":{"weichat":{"msgId":"744eeab2-00df-4b8b-8e26-116611b46f3e","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"57655bb5-de6c-4928-836a-98ba55dd0cb8","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:03:47,498 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@bc6d6bb0], ext={weichat={msgId=744eeab2-00df-4b8b-8e26-116611b46f3e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:03:47,499 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@bc6d6bb0], ext={weichat={msgId=744eeab2-00df-4b8b-8e26-116611b46f3e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:03:47,501 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好，可以微信关注紫金保险的公众号，依次点击进入个性主页、热门险种中的宠物犬主责任保险购买。","type":"txt"}],"ext":{"weichat":{"msgId":"744eeab2-00df-4b8b-8e26-116611b46f3e","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"57655bb5-de6c-4928-836a-98ba55dd0cb8","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:03:47,503 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@bc6d6bb0], ext={weichat={msgId=744eeab2-00df-4b8b-8e26-116611b46f3e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:03:47,507 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@bc6d6bb0, from=119898, ext={weichat={msgId=744eeab2-00df-4b8b-8e26-116611b46f3e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894221815,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:36 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:41 GMT]}>
2018-12-27 15:03:47,507 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894221815,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:36 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:41 GMT]}>
2018-12-27 15:03:47,507 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894221815,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:36 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:41 GMT]}>
2018-12-27 15:04:01,975 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170711155114388' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;毛泽东&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;de03a513-563a-4e32-a48b-4e5fe7e5b735&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:01,975 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170711155114388' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;毛泽东&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;de03a513-563a-4e32-a48b-4e5fe7e5b735&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:01,975 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2924' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170711155114388'/></message>.
2018-12-27 15:04:01,978 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"毛泽东"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"de03a513-563a-4e32-a48b-4e5fe7e5b735","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170711155114388","channel_id":35,"channelType":"easemob","timestamp":1545894241975,"tenantId":43,"originType":"webim"}].
2018-12-27 15:04:01,978 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@1a261da], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=de03a513-563a-4e32-a48b-4e5fe7e5b735, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:01 CST 2018, msgId=551170711155114388, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:04:01,978 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=de03a513-563a-4e32-a48b-4e5fe7e5b735, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:04:01,978 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"de03a513-563a-4e32-a48b-4e5fe7e5b735","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:04:01,979 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"de03a513-563a-4e32-a48b-4e5fe7e5b735","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:04:01,979 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=de03a513-563a-4e32-a48b-4e5fe7e5b735, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:01,981 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@1a261da], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=de03a513-563a-4e32-a48b-4e5fe7e5b735, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:01 CST 2018, msgId=551170711155114388, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:04:01,981 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=de03a513-563a-4e32-a48b-4e5fe7e5b735, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:01,982 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"毛泽东","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"de03a513-563a-4e32-a48b-4e5fe7e5b735","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894241975,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170711155114388","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 123
2018-12-27 15:04:01,986 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=de03a513-563a-4e32-a48b-4e5fe7e5b735, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894231467,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:51 GMT]}>
2018-12-27 15:04:01,986 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894231467,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:51 GMT]}>
2018-12-27 15:04:01,986 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894231467,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:51 GMT]}>
2018-12-27 15:04:02,197 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"aa913387-54a3-46f9-8a36-48ed06602c59","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"de03a513-563a-4e32-a48b-4e5fe7e5b735","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:02,197 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=aa913387-54a3-46f9-8a36-48ed06602c59, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=de03a513-563a-4e32-a48b-4e5fe7e5b735, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:02,197 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=aa913387-54a3-46f9-8a36-48ed06602c59, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=de03a513-563a-4e32-a48b-4e5fe7e5b735, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:04:02,199 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"aa913387-54a3-46f9-8a36-48ed06602c59","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"de03a513-563a-4e32-a48b-4e5fe7e5b735","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:04:02,203 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=aa913387-54a3-46f9-8a36-48ed06602c59, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=de03a513-563a-4e32-a48b-4e5fe7e5b735, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:02,207 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=aa913387-54a3-46f9-8a36-48ed06602c59, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=de03a513-563a-4e32-a48b-4e5fe7e5b735, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894236515,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:56 GMT]}>
2018-12-27 15:04:02,207 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894236515,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:56 GMT]}>
2018-12-27 15:04:02,207 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894236515,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:51 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:56 GMT]}>
2018-12-27 15:04:02,480 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:04:05,985 WARN  [qtp1063823352-600]  o.e.jetty.servlet.ServletHandler - 
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.NullPointerException
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:981)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:871)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:845)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:848)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1772)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:207)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:176)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
	at org.eclipse.jetty.server.Server.handle(Server.java:534)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)
	at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException: null
	at com.easemob.weichat.service.techchannel.wechat.WechatOpenService.processComponentVerifyTicket(WechatOpenService.java:173)
	at com.easemob.weichat.service.techchannel.wechat.WechatOpenService.processAuthorizationEvent(WechatOpenService.java:445)
	at com.easemob.weichat.service.techchannel.wechat.WechatOpenService.processAuthorizeEvent(WechatOpenService.java:402)
	at com.easemob.weichat.gateway.rest.WechatMessageController.acceptAuthorizeEvent(WechatMessageController.java:119)
	at sun.reflect.GeneratedMethodAccessor307.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:110)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:814)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:737)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:959)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:893)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:969)
	... 45 common frames omitted
2018-12-27 15:04:06,655 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170731287773588' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;毛泽东、&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;67785fb7-99cc-4741-9b93-5c540333fcd3&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:06,655 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170731287773588' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;毛泽东、&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;67785fb7-99cc-4741-9b93-5c540333fcd3&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:06,655 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2925' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170731287773588'/></message>.
2018-12-27 15:04:06,657 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"毛泽东、"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"67785fb7-99cc-4741-9b93-5c540333fcd3","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170731287773588","channel_id":35,"channelType":"easemob","timestamp":1545894246655,"tenantId":43,"originType":"webim"}].
2018-12-27 15:04:06,657 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@32aa0967], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=67785fb7-99cc-4741-9b93-5c540333fcd3, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:06 CST 2018, msgId=551170731287773588, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:04:06,657 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=67785fb7-99cc-4741-9b93-5c540333fcd3, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:04:06,657 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"67785fb7-99cc-4741-9b93-5c540333fcd3","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:04:06,658 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"67785fb7-99cc-4741-9b93-5c540333fcd3","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:04:06,658 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=67785fb7-99cc-4741-9b93-5c540333fcd3, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:06,660 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@32aa0967], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=67785fb7-99cc-4741-9b93-5c540333fcd3, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:06 CST 2018, msgId=551170731287773588, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:04:06,660 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=67785fb7-99cc-4741-9b93-5c540333fcd3, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:06,661 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"毛泽东、","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"67785fb7-99cc-4741-9b93-5c540333fcd3","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894246655,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170731287773588","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 124
2018-12-27 15:04:06,667 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=67785fb7-99cc-4741-9b93-5c540333fcd3, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894236148,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:56 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:56 GMT]}>
2018-12-27 15:04:06,667 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894236148,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:56 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:56 GMT]}>
2018-12-27 15:04:06,667 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894236148,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:56 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:03:56 GMT]}>
2018-12-27 15:04:06,878 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"40043698-6bf0-4809-82c2-d082ad0b370d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"67785fb7-99cc-4741-9b93-5c540333fcd3","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:06,878 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=40043698-6bf0-4809-82c2-d082ad0b370d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=67785fb7-99cc-4741-9b93-5c540333fcd3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:06,878 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=40043698-6bf0-4809-82c2-d082ad0b370d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=67785fb7-99cc-4741-9b93-5c540333fcd3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:04:06,881 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"40043698-6bf0-4809-82c2-d082ad0b370d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"67785fb7-99cc-4741-9b93-5c540333fcd3","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:04:06,884 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=40043698-6bf0-4809-82c2-d082ad0b370d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=67785fb7-99cc-4741-9b93-5c540333fcd3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:06,888 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=40043698-6bf0-4809-82c2-d082ad0b370d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=67785fb7-99cc-4741-9b93-5c540333fcd3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894241196,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:56 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:01 GMT]}>
2018-12-27 15:04:06,888 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894241196,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:56 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:01 GMT]}>
2018-12-27 15:04:06,888 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894241196,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:03:56 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:01 GMT]}>
2018-12-27 15:04:10,282 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-7EF2GY8YB93CW6WFPY9K.
2018-12-27 15:04:14,496 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170764884148628' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;周恩来&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;1b23855f-f5df-43c9-bf3c-c323419e8850&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:14,496 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170764884148628' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;周恩来&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;1b23855f-f5df-43c9-bf3c-c323419e8850&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:14,496 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2926' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170764884148628'/></message>.
2018-12-27 15:04:14,498 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"周恩来"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"1b23855f-f5df-43c9-bf3c-c323419e8850","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170764884148628","channel_id":35,"channelType":"easemob","timestamp":1545894254496,"tenantId":43,"originType":"webim"}].
2018-12-27 15:04:14,499 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@148ee84], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=1b23855f-f5df-43c9-bf3c-c323419e8850, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:14 CST 2018, msgId=551170764884148628, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:04:14,499 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=1b23855f-f5df-43c9-bf3c-c323419e8850, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:04:14,499 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"1b23855f-f5df-43c9-bf3c-c323419e8850","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:04:14,499 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"1b23855f-f5df-43c9-bf3c-c323419e8850","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:04:14,499 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=1b23855f-f5df-43c9-bf3c-c323419e8850, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:14,501 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@148ee84], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=1b23855f-f5df-43c9-bf3c-c323419e8850, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:14 CST 2018, msgId=551170764884148628, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:04:14,502 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=1b23855f-f5df-43c9-bf3c-c323419e8850, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:14,503 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"周恩来","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"1b23855f-f5df-43c9-bf3c-c323419e8850","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894254496,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170764884148628","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 125
2018-12-27 15:04:14,506 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=1b23855f-f5df-43c9-bf3c-c323419e8850, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894243988,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:03 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:03 GMT]}>
2018-12-27 15:04:14,507 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894243988,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:03 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:03 GMT]}>
2018-12-27 15:04:14,507 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894243988,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:03 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:03 GMT]}>
2018-12-27 15:04:14,747 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"781f1210-200c-4887-8222-ea8bcd797176","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1b23855f-f5df-43c9-bf3c-c323419e8850","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:14,747 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=781f1210-200c-4887-8222-ea8bcd797176, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1b23855f-f5df-43c9-bf3c-c323419e8850, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:14,748 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=781f1210-200c-4887-8222-ea8bcd797176, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1b23855f-f5df-43c9-bf3c-c323419e8850, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:04:14,751 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"781f1210-200c-4887-8222-ea8bcd797176","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1b23855f-f5df-43c9-bf3c-c323419e8850","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:04:14,754 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=781f1210-200c-4887-8222-ea8bcd797176, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1b23855f-f5df-43c9-bf3c-c323419e8850, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:14,758 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=781f1210-200c-4887-8222-ea8bcd797176, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1b23855f-f5df-43c9-bf3c-c323419e8850, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894249066,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:04 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:09 GMT]}>
2018-12-27 15:04:14,758 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894249066,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:04 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:09 GMT]}>
2018-12-27 15:04:14,758 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894249066,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:04 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:09 GMT]}>
2018-12-27 15:04:21,880 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170796660195732' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;朱镕基&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;c6022628-642f-49a5-8967-672a110094c4&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:21,880 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170796660195732' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;朱镕基&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;c6022628-642f-49a5-8967-672a110094c4&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:21,880 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2927' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170796660195732'/></message>.
2018-12-27 15:04:21,883 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"朱镕基"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"c6022628-642f-49a5-8967-672a110094c4","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170796660195732","channel_id":35,"channelType":"easemob","timestamp":1545894261880,"tenantId":43,"originType":"webim"}].
2018-12-27 15:04:21,883 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@195cc36], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=c6022628-642f-49a5-8967-672a110094c4, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:21 CST 2018, msgId=551170796660195732, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:04:21,883 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=c6022628-642f-49a5-8967-672a110094c4, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:04:21,883 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"c6022628-642f-49a5-8967-672a110094c4","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:04:21,883 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"c6022628-642f-49a5-8967-672a110094c4","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:04:21,884 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=c6022628-642f-49a5-8967-672a110094c4, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:21,886 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@195cc36], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=c6022628-642f-49a5-8967-672a110094c4, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:21 CST 2018, msgId=551170796660195732, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:04:21,886 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=c6022628-642f-49a5-8967-672a110094c4, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:21,887 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"朱镕基","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"c6022628-642f-49a5-8967-672a110094c4","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894261880,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170796660195732","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 126
2018-12-27 15:04:21,891 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=c6022628-642f-49a5-8967-672a110094c4, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894251372,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:11 GMT]}>
2018-12-27 15:04:21,891 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894251372,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:11 GMT]}>
2018-12-27 15:04:21,891 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894251372,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:11 GMT]}>
2018-12-27 15:04:22,106 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"51d11056-a739-45cf-a128-9644bceaf03f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"c6022628-642f-49a5-8967-672a110094c4","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:22,106 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=51d11056-a739-45cf-a128-9644bceaf03f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=c6022628-642f-49a5-8967-672a110094c4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:22,106 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=51d11056-a739-45cf-a128-9644bceaf03f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=c6022628-642f-49a5-8967-672a110094c4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:04:22,108 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"51d11056-a739-45cf-a128-9644bceaf03f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"c6022628-642f-49a5-8967-672a110094c4","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:04:22,111 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=51d11056-a739-45cf-a128-9644bceaf03f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=c6022628-642f-49a5-8967-672a110094c4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:22,115 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=51d11056-a739-45cf-a128-9644bceaf03f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=c6022628-642f-49a5-8967-672a110094c4, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894256423,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:16 GMT]}>
2018-12-27 15:04:22,115 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894256423,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:16 GMT]}>
2018-12-27 15:04:22,115 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894256423,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:11 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:16 GMT]}>
2018-12-27 15:04:27,901 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"4fb896bb-4cd8-4060-8d81-17946d309051","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:27,901 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=4fb896bb-4cd8-4060-8d81-17946d309051, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:27,901 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=4fb896bb-4cd8-4060-8d81-17946d309051, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to partner server for visitor webim-visitor-G387TVM7XGJGGPEPJ6EX
2018-12-27 15:04:27,903 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"4fb896bb-4cd8-4060-8d81-17946d309051","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-G387TVM7XGJGGPEPJ6EX","channelType":"easemob","tenantId":43,"visitorUserId":"77568049-f736-4e35-b786-afed820f054a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-G387TVM7XGJGGPEPJ6EX.
2018-12-27 15:04:27,906 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=4fb896bb-4cd8-4060-8d81-17946d309051, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-G387TVM7XGJGGPEPJ6EX, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=77568049-f736-4e35-b786-afed820f054a, originType=WEBIM) to user webim-visitor-G387TVM7XGJGGPEPJ6EX 
2018-12-27 15:04:27,910 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-G387TVM7XGJGGPEPJ6EX], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=4fb896bb-4cd8-4060-8d81-17946d309051, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894257392,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:17 GMT]}>
2018-12-27 15:04:27,910 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894257392,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:17 GMT]}>
2018-12-27 15:04:27,911 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-G387TVM7XGJGGPEPJ6EX" : "success"
  },
  "timestamp" : 1545894257392,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:17 GMT]}>
2018-12-27 15:04:28,821 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:04:29,868 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551170830965408148' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;习近平&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;134015ad-bed4-48b9-9033-a7e0a30648d2&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:29,868 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551170830965408148' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-3Y8TG4983J6TRXHE3XJT&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;习近平&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;queueName&quot;:&quot;test&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;134015ad-bed4-48b9-9033-a7e0a30648d2&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:04:29,868 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2928' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-3y8tg4983j6trxhe3xjt@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551170830965408148'/></message>.
2018-12-27 15:04:29,870 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","bodies":[{"type":"txt","msg":"习近平"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"134015ad-bed4-48b9-9033-a7e0a30648d2","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170830965408148","channel_id":35,"channelType":"easemob","timestamp":1545894269868,"tenantId":43,"originType":"webim"}].
2018-12-27 15:04:29,871 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@137ff22], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:29 CST 2018, msgId=551170830965408148, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:04:29,871 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=134015ad-bed4-48b9-9033-a7e0a30648d2, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:04:29,871 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"134015ad-bed4-48b9-9033-a7e0a30648d2","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:04:29,871 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"134015ad-bed4-48b9-9033-a7e0a30648d2","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:04:29,871 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=134015ad-bed4-48b9-9033-a7e0a30648d2, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:29,873 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@137ff22], ext={weichat={language=zh-CN, queueName=test, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, originType=webim}}, from=webim-visitor-3Y8TG4983J6TRXHE3XJT, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:04:29 CST 2018, msgId=551170830965408148, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:04:29,875 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"习近平","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","queueName":"test","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"134015ad-bed4-48b9-9033-a7e0a30648d2","originType":"webim"}},"from":"webim-visitor-3Y8TG4983J6TRXHE3XJT","to":"119898","channelType":"easemob","timestamp":1545894269868,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551170830965408148","channel_id":35} has been send to kafka with in topic kf_msg_in partition 9, current offset is 127
2018-12-27 15:04:29,877 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=134015ad-bed4-48b9-9033-a7e0a30648d2, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:29,881 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=134015ad-bed4-48b9-9033-a7e0a30648d2, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894264189,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:24 GMT]}>
2018-12-27 15:04:29,881 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894264189,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:24 GMT]}>
2018-12-27 15:04:29,881 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894264189,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:24 GMT]}>
2018-12-27 15:04:30,081 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"6063279a-68bf-4028-96d7-d18a2001e0cf","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"134015ad-bed4-48b9-9033-a7e0a30648d2","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:30,081 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=6063279a-68bf-4028-96d7-d18a2001e0cf, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:30,081 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=6063279a-68bf-4028-96d7-d18a2001e0cf, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:04:30,083 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"6063279a-68bf-4028-96d7-d18a2001e0cf","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"134015ad-bed4-48b9-9033-a7e0a30648d2","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:04:30,087 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=6063279a-68bf-4028-96d7-d18a2001e0cf, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:04:30,090 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=6063279a-68bf-4028-96d7-d18a2001e0cf, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894259572,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:19 GMT]}>
2018-12-27 15:04:30,090 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894259572,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:19 GMT]}>
2018-12-27 15:04:30,090 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894259572,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:19 GMT]}>
2018-12-27 15:04:40,419 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:04:40,676 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:04:47,539 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"b18e15a9-4375-4dbf-934b-3af83a018d77","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"57655bb5-de6c-4928-836a-98ba55dd0cb8","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:04:47,540 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=b18e15a9-4375-4dbf-934b-3af83a018d77, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:04:47,540 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=b18e15a9-4375-4dbf-934b-3af83a018d77, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:04:47,543 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"b18e15a9-4375-4dbf-934b-3af83a018d77","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"57655bb5-de6c-4928-836a-98ba55dd0cb8","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:04:47,546 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=b18e15a9-4375-4dbf-934b-3af83a018d77, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:04:47,551 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28, from=119898, ext={weichat={msgId=b18e15a9-4375-4dbf-934b-3af83a018d77, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=57655bb5-de6c-4928-836a-98ba55dd0cb8, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894281859,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:37 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:41 GMT]}>
2018-12-27 15:04:47,551 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894281859,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:37 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:41 GMT]}>
2018-12-27 15:04:47,551 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894281859,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:04:37 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:04:41 GMT]}>
2018-12-27 15:05:02,479 INFO  [qtp1063823352-472]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:05:06,048 WARN  [qtp1063823352-414]  o.e.jetty.servlet.ServletHandler - 
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.NullPointerException
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:981)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:860)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:687)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:845)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:848)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1772)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:207)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:176)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
	at org.eclipse.jetty.server.Server.handle(Server.java:534)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)
	at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)
	at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException: null
	at com.easemob.weichat.gateway.rest.WechatMessageController.getPreauthcode(WechatMessageController.java:52)
	at sun.reflect.GeneratedMethodAccessor372.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:110)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:814)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:737)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:959)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:893)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:969)
	... 45 common frames omitted
2018-12-27 15:05:15,948 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:05:22,985 INFO  [qtp1063823352-643]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:05:22,987 INFO  [qtp1063823352-643]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=47,jid=9900181220049084#kefuchannelapp43_kefuchannelimid_276436@easemob.com
2018-12-27 15:05:22,988 INFO  [qtp1063823352-641]  c.e.w.g.rest.IMChannelController - isRun channel status
2018-12-27 15:05:22,990 INFO  [qtp1063823352-641]  c.e.w.g.i.i.IMChannelRestServiceImpl - channel is broken, channelId=35,jid=easemob-demo#chatdemoui_119898@easemob.com
2018-12-27 15:05:28,107 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:05:30,143 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"7ac05561-b67f-4fa1-afec-ab4ee192ac7e","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"134015ad-bed4-48b9-9033-a7e0a30648d2","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:30,143 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=7ac05561-b67f-4fa1-afec-ab4ee192ac7e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:30,144 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=7ac05561-b67f-4fa1-afec-ab4ee192ac7e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:05:30,146 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"7ac05561-b67f-4fa1-afec-ab4ee192ac7e","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":"test","agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"134015ad-bed4-48b9-9033-a7e0a30648d2","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:05:30,149 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=7ac05561-b67f-4fa1-afec-ab4ee192ac7e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:05:30,154 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28, from=119898, ext={weichat={msgId=7ac05561-b67f-4fa1-afec-ab4ee192ac7e, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=test, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=134015ad-bed4-48b9-9033-a7e0a30648d2, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894319635,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:19 GMT]}>
2018-12-27 15:05:30,154 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894319635,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:19 GMT]}>
2018-12-27 15:05:30,154 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894319635,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:19 GMT]}>
2018-12-27 15:05:40,423 INFO  [qtp1063823352-414]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:05:40,658 INFO  [qtp1063823352-643]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:05:43,200 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551171166635557268' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bx8v72hrf2h9yctvyk7f@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-BX8V72HRF2H9YCTVYK7F&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;你好，帮我查一下粤E1619M车定损价格&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;f0374497-291e-4346-8b75-05d1590c2ea3&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:05:43,200 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551171166635557268' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bx8v72hrf2h9yctvyk7f@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-BX8V72HRF2H9YCTVYK7F&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;你好，帮我查一下粤E1619M车定损价格&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;f0374497-291e-4346-8b75-05d1590c2ea3&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:05:43,200 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2935' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bx8v72hrf2h9yctvyk7f@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551171166635557268'/></message>.
2018-12-27 15:05:43,202 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-BX8V72HRF2H9YCTVYK7F","to":"119898","bodies":[{"type":"txt","msg":"你好，帮我查一下粤E1619M车定损价格"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"f0374497-291e-4346-8b75-05d1590c2ea3","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171166635557268","channel_id":35,"channelType":"easemob","timestamp":1545894343200,"tenantId":43,"originType":"webim"}].
2018-12-27 15:05:43,202 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7580f04f], ext={weichat={language=zh-CN, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, originType=webim}}, from=webim-visitor-BX8V72HRF2H9YCTVYK7F, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:05:43 CST 2018, msgId=551171166635557268, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:05:43,202 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=f0374497-291e-4346-8b75-05d1590c2ea3, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:05:43,202 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"f0374497-291e-4346-8b75-05d1590c2ea3","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:05:43,203 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"f0374497-291e-4346-8b75-05d1590c2ea3","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:05:43,203 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=f0374497-291e-4346-8b75-05d1590c2ea3, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:43,204 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@7580f04f], ext={weichat={language=zh-CN, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, originType=webim}}, from=webim-visitor-BX8V72HRF2H9YCTVYK7F, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:05:43 CST 2018, msgId=551171166635557268, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:05:43,205 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=f0374497-291e-4346-8b75-05d1590c2ea3, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-BX8V72HRF2H9YCTVYK7F 
2018-12-27 15:05:43,206 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"你好，帮我查一下粤E1619M车定损价格","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"f0374497-291e-4346-8b75-05d1590c2ea3","originType":"webim"}},"from":"webim-visitor-BX8V72HRF2H9YCTVYK7F","to":"119898","channelType":"easemob","timestamp":1545894343200,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171166635557268","channel_id":35} has been send to kafka with in topic kf_msg_in partition 0, current offset is 147
2018-12-27 15:05:43,209 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BX8V72HRF2H9YCTVYK7F], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=f0374497-291e-4346-8b75-05d1590c2ea3, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337517,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,209 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337517,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,209 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337517,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,337 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"bab6382d-6d61-4ad8-9d7f-3bf6042338ba","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"f0374497-291e-4346-8b75-05d1590c2ea3","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:43,337 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=bab6382d-6d61-4ad8-9d7f-3bf6042338ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:43,337 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=bab6382d-6d61-4ad8-9d7f-3bf6042338ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to partner server for visitor webim-visitor-BX8V72HRF2H9YCTVYK7F
2018-12-27 15:05:43,339 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"bab6382d-6d61-4ad8-9d7f-3bf6042338ba","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"f0374497-291e-4346-8b75-05d1590c2ea3","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BX8V72HRF2H9YCTVYK7F.
2018-12-27 15:05:43,342 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=bab6382d-6d61-4ad8-9d7f-3bf6042338ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to user webim-visitor-BX8V72HRF2H9YCTVYK7F 
2018-12-27 15:05:43,345 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BX8V72HRF2H9YCTVYK7F], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=bab6382d-6d61-4ad8-9d7f-3bf6042338ba, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894332827,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:32 GMT]}>
2018-12-27 15:05:43,345 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894332827,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:32 GMT]}>
2018-12-27 15:05:43,345 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894332827,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:32 GMT]}>
2018-12-27 15:05:43,360 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"34425358-1e8f-4e15-8647-0d695413a54f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d16bb776-792b-45c4-b6e7-34b6c17abc64"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:43,360 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=34425358-1e8f-4e15-8647-0d695413a54f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:43,360 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=34425358-1e8f-4e15-8647-0d695413a54f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to partner server for visitor webim-visitor-BX8V72HRF2H9YCTVYK7F
2018-12-27 15:05:43,362 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"34425358-1e8f-4e15-8647-0d695413a54f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d16bb776-792b-45c4-b6e7-34b6c17abc64"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BX8V72HRF2H9YCTVYK7F.
2018-12-27 15:05:43,365 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=34425358-1e8f-4e15-8647-0d695413a54f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to user webim-visitor-BX8V72HRF2H9YCTVYK7F 
2018-12-27 15:05:43,368 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BX8V72HRF2H9YCTVYK7F], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=34425358-1e8f-4e15-8647-0d695413a54f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337676,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,368 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337676,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,368 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337676,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,391 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"5e5cf101-0119-43d7-9141-27ea651b9ffc","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d16bb776-792b-45c4-b6e7-34b6c17abc64"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:43,391 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=5e5cf101-0119-43d7-9141-27ea651b9ffc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:43,391 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=5e5cf101-0119-43d7-9141-27ea651b9ffc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to partner server for visitor webim-visitor-BX8V72HRF2H9YCTVYK7F
2018-12-27 15:05:43,393 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"5e5cf101-0119-43d7-9141-27ea651b9ffc","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d16bb776-792b-45c4-b6e7-34b6c17abc64"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BX8V72HRF2H9YCTVYK7F.
2018-12-27 15:05:43,396 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=5e5cf101-0119-43d7-9141-27ea651b9ffc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to user webim-visitor-BX8V72HRF2H9YCTVYK7F 
2018-12-27 15:05:43,400 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BX8V72HRF2H9YCTVYK7F], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=5e5cf101-0119-43d7-9141-27ea651b9ffc, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d16bb776-792b-45c4-b6e7-34b6c17abc64}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894332881,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:32 GMT]}>
2018-12-27 15:05:43,400 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894332881,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:32 GMT]}>
2018-12-27 15:05:43,400 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894332881,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:32 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:32 GMT]}>
2018-12-27 15:05:43,566 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"d3cb245a-bb32-46f2-aa82-f57560d06bfd","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"f0374497-291e-4346-8b75-05d1590c2ea3","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null},"msgtype":{"choice":{"list":["如何申请车险定损？","车险案件定损需要多久？","如何查询理赔进度？","投保进度查询。","如何查询车辆年检时间？"],"items":[{"id":"3287495b-d8c4-41de-8dbe-4e3e3137b227","name":"如何申请车险定损？"},{"id":"7c57b1bb-08af-4bf9-84b8-a95545cd28b4","name":"车险案件定损需要多久？"},{"id":"f02a4d5d-adbe-439d-a34b-35c57f78841b","name":"如何查询理赔进度？"},{"id":"61939af3-0298-4351-93a1-f6c495ff34df","name":"投保进度查询。"},{"id":"ecb7c751-57a1-47fb-9447-68fc9e5d88a6","name":"如何查询车辆年检时间？"}],"title":"您是不是要咨询以下问题："}}},"from":"小紫","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:43,566 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=d3cb245a-bb32-46f2-aa82-f57560d06bfd, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何申请车险定损？, 车险案件定损需要多久？, 如何查询理赔进度？, 投保进度查询。, 如何查询车辆年检时间？], items=[{id=3287495b-d8c4-41de-8dbe-4e3e3137b227, name=如何申请车险定损？}, {id=7c57b1bb-08af-4bf9-84b8-a95545cd28b4, name=车险案件定损需要多久？}, {id=f02a4d5d-adbe-439d-a34b-35c57f78841b, name=如何查询理赔进度？}, {id=61939af3-0298-4351-93a1-f6c495ff34df, name=投保进度查询。}, {id=ecb7c751-57a1-47fb-9447-68fc9e5d88a6, name=如何查询车辆年检时间？}], title=您是不是要咨询以下问题：}}}, from=小紫, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:43,567 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=d3cb245a-bb32-46f2-aa82-f57560d06bfd, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何申请车险定损？, 车险案件定损需要多久？, 如何查询理赔进度？, 投保进度查询。, 如何查询车辆年检时间？], items=[{id=3287495b-d8c4-41de-8dbe-4e3e3137b227, name=如何申请车险定损？}, {id=7c57b1bb-08af-4bf9-84b8-a95545cd28b4, name=车险案件定损需要多久？}, {id=f02a4d5d-adbe-439d-a34b-35c57f78841b, name=如何查询理赔进度？}, {id=61939af3-0298-4351-93a1-f6c495ff34df, name=投保进度查询。}, {id=ecb7c751-57a1-47fb-9447-68fc9e5d88a6, name=如何查询车辆年检时间？}], title=您是不是要咨询以下问题：}}}, from=小紫, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to partner server for visitor webim-visitor-BX8V72HRF2H9YCTVYK7F
2018-12-27 15:05:43,568 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"d3cb245a-bb32-46f2-aa82-f57560d06bfd","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"f0374497-291e-4346-8b75-05d1590c2ea3","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null},"msgtype":{"choice":{"list":["如何申请车险定损？","车险案件定损需要多久？","如何查询理赔进度？","投保进度查询。","如何查询车辆年检时间？"],"items":[{"id":"3287495b-d8c4-41de-8dbe-4e3e3137b227","name":"如何申请车险定损？"},{"id":"7c57b1bb-08af-4bf9-84b8-a95545cd28b4","name":"车险案件定损需要多久？"},{"id":"f02a4d5d-adbe-439d-a34b-35c57f78841b","name":"如何查询理赔进度？"},{"id":"61939af3-0298-4351-93a1-f6c495ff34df","name":"投保进度查询。"},{"id":"ecb7c751-57a1-47fb-9447-68fc9e5d88a6","name":"如何查询车辆年检时间？"}],"title":"您是不是要咨询以下问题："}}},"from":"119898","to":"webim-visitor-BX8V72HRF2H9YCTVYK7F","channelType":"easemob","tenantId":43,"visitorUserId":"46a4447d-8597-4790-bb08-207960875835","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BX8V72HRF2H9YCTVYK7F.
2018-12-27 15:05:43,573 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=d3cb245a-bb32-46f2-aa82-f57560d06bfd, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何申请车险定损？, 车险案件定损需要多久？, 如何查询理赔进度？, 投保进度查询。, 如何查询车辆年检时间？], items=[{id=3287495b-d8c4-41de-8dbe-4e3e3137b227, name=如何申请车险定损？}, {id=7c57b1bb-08af-4bf9-84b8-a95545cd28b4, name=车险案件定损需要多久？}, {id=f02a4d5d-adbe-439d-a34b-35c57f78841b, name=如何查询理赔进度？}, {id=61939af3-0298-4351-93a1-f6c495ff34df, name=投保进度查询。}, {id=ecb7c751-57a1-47fb-9447-68fc9e5d88a6, name=如何查询车辆年检时间？}], title=您是不是要咨询以下问题：}}}, from=119898, to=webim-visitor-BX8V72HRF2H9YCTVYK7F, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=46a4447d-8597-4790-bb08-207960875835, originType=WEBIM) to user webim-visitor-BX8V72HRF2H9YCTVYK7F 
2018-12-27 15:05:43,576 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BX8V72HRF2H9YCTVYK7F], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@0, from=119898, ext={weichat={msgId=d3cb245a-bb32-46f2-aa82-f57560d06bfd, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=f0374497-291e-4346-8b75-05d1590c2ea3, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何申请车险定损？, 车险案件定损需要多久？, 如何查询理赔进度？, 投保进度查询。, 如何查询车辆年检时间？], items=[{id=3287495b-d8c4-41de-8dbe-4e3e3137b227, name=如何申请车险定损？}, {id=7c57b1bb-08af-4bf9-84b8-a95545cd28b4, name=车险案件定损需要多久？}, {id=f02a4d5d-adbe-439d-a34b-35c57f78841b, name=如何查询理赔进度？}, {id=61939af3-0298-4351-93a1-f6c495ff34df, name=投保进度查询。}, {id=ecb7c751-57a1-47fb-9447-68fc9e5d88a6, name=如何查询车辆年检时间？}], title=您是不是要咨询以下问题：}}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337884,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:33 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,576 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337884,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:33 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:43,576 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BX8V72HRF2H9YCTVYK7F" : "success"
  },
  "timestamp" : 1545894337884,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:33 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:47,595 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"fb0e967a-c030-4b9a-924c-4556f0dee8df","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:47,595 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=fb0e967a-c030-4b9a-924c-4556f0dee8df, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:47,596 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=fb0e967a-c030-4b9a-924c-4556f0dee8df, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to partner server for visitor webim-visitor-4P22TRRTKCTRXVC8FT3T
2018-12-27 15:05:47,597 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"fb0e967a-c030-4b9a-924c-4556f0dee8df","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-4P22TRRTKCTRXVC8FT3T","channelType":"easemob","tenantId":43,"visitorUserId":"83632e23-93aa-40de-a5eb-91f2c52ed0c0","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-4P22TRRTKCTRXVC8FT3T.
2018-12-27 15:05:47,600 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=fb0e967a-c030-4b9a-924c-4556f0dee8df, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-4P22TRRTKCTRXVC8FT3T, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=83632e23-93aa-40de-a5eb-91f2c52ed0c0, originType=WEBIM) to user webim-visitor-4P22TRRTKCTRXVC8FT3T 
2018-12-27 15:05:47,605 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-4P22TRRTKCTRXVC8FT3T], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=fb0e967a-c030-4b9a-924c-4556f0dee8df, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894337086,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:37 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:47,605 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894337086,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:37 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:47,605 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-4P22TRRTKCTRXVC8FT3T" : "success"
  },
  "timestamp" : 1545894337086,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:37 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:37 GMT]}>
2018-12-27 15:05:51,345 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551171180858442132' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-qyvqx8mxr42m7h4meq7g@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-QYVQX8MXR42M7H4MEQ7G&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;好&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;73c2214b-8bb7-4e20-8cea-b50fb8352186&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:05:51,345 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551171180858442132' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-qyvqx8mxr42m7h4meq7g@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-QYVQX8MXR42M7H4MEQ7G&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;好&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;73c2214b-8bb7-4e20-8cea-b50fb8352186&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:05:51,345 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2936' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-qyvqx8mxr42m7h4meq7g@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551171180858442132'/></message>.
2018-12-27 15:05:51,347 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","to":"119898","bodies":[{"type":"txt","msg":"好"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"73c2214b-8bb7-4e20-8cea-b50fb8352186","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171180858442132","channel_id":35,"channelType":"easemob","timestamp":1545894351345,"tenantId":43,"originType":"webim"}].
2018-12-27 15:05:51,347 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@597d], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, originType=webim}}, from=webim-visitor-QYVQX8MXR42M7H4MEQ7G, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:05:51 CST 2018, msgId=551171180858442132, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:05:51,347 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=73c2214b-8bb7-4e20-8cea-b50fb8352186, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:05:51,347 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"73c2214b-8bb7-4e20-8cea-b50fb8352186","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:05:51,347 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"73c2214b-8bb7-4e20-8cea-b50fb8352186","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:05:51,347 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=73c2214b-8bb7-4e20-8cea-b50fb8352186, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:51,349 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@597d], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, originType=webim}}, from=webim-visitor-QYVQX8MXR42M7H4MEQ7G, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:05:51 CST 2018, msgId=551171180858442132, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:05:51,350 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=73c2214b-8bb7-4e20-8cea-b50fb8352186, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-QYVQX8MXR42M7H4MEQ7G 
2018-12-27 15:05:51,350 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"好","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"73c2214b-8bb7-4e20-8cea-b50fb8352186","originType":"webim"}},"from":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","to":"119898","channelType":"easemob","timestamp":1545894351345,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171180858442132","channel_id":35} has been send to kafka with in topic kf_msg_in partition 7, current offset is 47
2018-12-27 15:05:51,354 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-QYVQX8MXR42M7H4MEQ7G], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=73c2214b-8bb7-4e20-8cea-b50fb8352186, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345662,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,354 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345662,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,354 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345662,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,449 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"87b41bd3-3ff1-47eb-8187-a28e03c7e36f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"73c2214b-8bb7-4e20-8cea-b50fb8352186","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:51,449 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=87b41bd3-3ff1-47eb-8187-a28e03c7e36f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:51,449 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=87b41bd3-3ff1-47eb-8187-a28e03c7e36f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to partner server for visitor webim-visitor-QYVQX8MXR42M7H4MEQ7G
2018-12-27 15:05:51,451 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"87b41bd3-3ff1-47eb-8187-a28e03c7e36f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"73c2214b-8bb7-4e20-8cea-b50fb8352186","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:05:51,454 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=87b41bd3-3ff1-47eb-8187-a28e03c7e36f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to user webim-visitor-QYVQX8MXR42M7H4MEQ7G 
2018-12-27 15:05:51,457 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-QYVQX8MXR42M7H4MEQ7G], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=87b41bd3-3ff1-47eb-8187-a28e03c7e36f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894340939,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:40 GMT]}>
2018-12-27 15:05:51,457 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894340939,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:40 GMT]}>
2018-12-27 15:05:51,457 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894340939,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:40 GMT]}>
2018-12-27 15:05:51,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"5e0d45f7-b158-44bd-8b08-d4fb68f3d6c8","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d633b3cf-db78-4fc3-ae18-0594fd1250a9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:51,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=5e0d45f7-b158-44bd-8b08-d4fb68f3d6c8, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:51,474 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=5e0d45f7-b158-44bd-8b08-d4fb68f3d6c8, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to partner server for visitor webim-visitor-QYVQX8MXR42M7H4MEQ7G
2018-12-27 15:05:51,476 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"5e0d45f7-b158-44bd-8b08-d4fb68f3d6c8","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d633b3cf-db78-4fc3-ae18-0594fd1250a9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:05:51,479 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=5e0d45f7-b158-44bd-8b08-d4fb68f3d6c8, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to user webim-visitor-QYVQX8MXR42M7H4MEQ7G 
2018-12-27 15:05:51,482 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-QYVQX8MXR42M7H4MEQ7G], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=5e0d45f7-b158-44bd-8b08-d4fb68f3d6c8, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345790,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,482 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345790,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,482 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345790,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,506 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"2542d5c9-1a69-4a9f-8aad-f782277e4c82","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d633b3cf-db78-4fc3-ae18-0594fd1250a9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:51,506 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=2542d5c9-1a69-4a9f-8aad-f782277e4c82, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:51,506 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=2542d5c9-1a69-4a9f-8aad-f782277e4c82, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to partner server for visitor webim-visitor-QYVQX8MXR42M7H4MEQ7G
2018-12-27 15:05:51,508 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"2542d5c9-1a69-4a9f-8aad-f782277e4c82","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"d633b3cf-db78-4fc3-ae18-0594fd1250a9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:05:51,511 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=2542d5c9-1a69-4a9f-8aad-f782277e4c82, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to user webim-visitor-QYVQX8MXR42M7H4MEQ7G 
2018-12-27 15:05:51,513 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-QYVQX8MXR42M7H4MEQ7G], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=2542d5c9-1a69-4a9f-8aad-f782277e4c82, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=d633b3cf-db78-4fc3-ae18-0594fd1250a9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894340995,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:40 GMT]}>
2018-12-27 15:05:51,513 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894340995,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:40 GMT]}>
2018-12-27 15:05:51,514 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894340995,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:40 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:40 GMT]}>
2018-12-27 15:05:51,626 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"eed0e168-b1d2-4cdb-8e31-eec32566e0c2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"73c2214b-8bb7-4e20-8cea-b50fb8352186","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:05:51,626 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=eed0e168-b1d2-4cdb-8e31-eec32566e0c2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:05:51,626 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=eed0e168-b1d2-4cdb-8e31-eec32566e0c2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to partner server for visitor webim-visitor-QYVQX8MXR42M7H4MEQ7G
2018-12-27 15:05:51,628 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"eed0e168-b1d2-4cdb-8e31-eec32566e0c2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"73c2214b-8bb7-4e20-8cea-b50fb8352186","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-QYVQX8MXR42M7H4MEQ7G","channelType":"easemob","tenantId":43,"visitorUserId":"63de6f64-40f9-4856-a060-1b9b17de93ec","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:05:51,631 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=eed0e168-b1d2-4cdb-8e31-eec32566e0c2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-QYVQX8MXR42M7H4MEQ7G, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=63de6f64-40f9-4856-a060-1b9b17de93ec, originType=WEBIM) to user webim-visitor-QYVQX8MXR42M7H4MEQ7G 
2018-12-27 15:05:51,634 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-QYVQX8MXR42M7H4MEQ7G], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=eed0e168-b1d2-4cdb-8e31-eec32566e0c2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=73c2214b-8bb7-4e20-8cea-b50fb8352186, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345942,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:41 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,634 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345942,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:41 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:51,634 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-QYVQX8MXR42M7H4MEQ7G" : "success"
  },
  "timestamp" : 1545894345942,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:05:41 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:05:45 GMT]}>
2018-12-27 15:05:57,703 INFO  [qtp1063823352-643]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-CBTM3XXXJPR68BHYK4JG.
2018-12-27 15:06:02,477 INFO  [qtp1063823352-586]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:06:03,833 INFO  [qtp1063823352-641]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BX8V72HRF2H9YCTVYK7F.
2018-12-27 15:06:14,774 INFO  [qtp1063823352-472]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:06:24,055 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551171342121042324' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bfrv827xc9vh8vq7h4vq@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-BFRV827XC9VH8VQ7H4VQ&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;买八年&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;1cfad114-8078-4263-a8ed-e152b002a6ed&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:06:24,055 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551171342121042324' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bfrv827xc9vh8vq7h4vq@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-BFRV827XC9VH8VQ7H4VQ&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;买八年&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;1cfad114-8078-4263-a8ed-e152b002a6ed&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:06:24,055 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2937' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bfrv827xc9vh8vq7h4vq@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551171342121042324'/></message>.
2018-12-27 15:06:24,060 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","to":"119898","bodies":[{"type":"txt","msg":"买八年"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"1cfad114-8078-4263-a8ed-e152b002a6ed","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171342121042324","channel_id":35,"channelType":"easemob","timestamp":1545894384055,"tenantId":43,"originType":"webim"}].
2018-12-27 15:06:24,060 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@130acd9], ext={weichat={language=zh-CN, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, originType=webim}}, from=webim-visitor-BFRV827XC9VH8VQ7H4VQ, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:06:24 CST 2018, msgId=551171342121042324, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:06:24,060 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=1cfad114-8078-4263-a8ed-e152b002a6ed, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:06:24,060 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"1cfad114-8078-4263-a8ed-e152b002a6ed","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:06:24,061 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"1cfad114-8078-4263-a8ed-e152b002a6ed","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:06:24,061 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=1cfad114-8078-4263-a8ed-e152b002a6ed, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:24,064 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=1cfad114-8078-4263-a8ed-e152b002a6ed, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:24,064 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@130acd9], ext={weichat={language=zh-CN, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, originType=webim}}, from=webim-visitor-BFRV827XC9VH8VQ7H4VQ, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:06:24 CST 2018, msgId=551171342121042324, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:06:24,065 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"买八年","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"1cfad114-8078-4263-a8ed-e152b002a6ed","originType":"webim"}},"from":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","to":"119898","channelType":"easemob","timestamp":1545894384055,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171342121042324","channel_id":35} has been send to kafka with in topic kf_msg_in partition 3, current offset is 172
2018-12-27 15:06:24,068 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=1cfad114-8078-4263-a8ed-e152b002a6ed, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373549,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,068 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373549,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,069 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373549,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,212 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"cfaa17ff-289c-4e23-82d0-6223e144641b","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1cfad114-8078-4263-a8ed-e152b002a6ed","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:24,212 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=cfaa17ff-289c-4e23-82d0-6223e144641b, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:24,212 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=cfaa17ff-289c-4e23-82d0-6223e144641b, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to partner server for visitor webim-visitor-BFRV827XC9VH8VQ7H4VQ
2018-12-27 15:06:24,214 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"cfaa17ff-289c-4e23-82d0-6223e144641b","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"1cfad114-8078-4263-a8ed-e152b002a6ed","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BFRV827XC9VH8VQ7H4VQ.
2018-12-27 15:06:24,220 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=cfaa17ff-289c-4e23-82d0-6223e144641b, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:24,225 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=cfaa17ff-289c-4e23-82d0-6223e144641b, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378532,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:24,225 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378532,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:24,225 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378532,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:24,236 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"80ba51bc-3a84-4605-8df2-1dc7a1d4b486","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"e38eedc6-9dc6-4847-96d1-66740de585b9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:24,236 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=80ba51bc-3a84-4605-8df2-1dc7a1d4b486, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:24,237 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=80ba51bc-3a84-4605-8df2-1dc7a1d4b486, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to partner server for visitor webim-visitor-BFRV827XC9VH8VQ7H4VQ
2018-12-27 15:06:24,239 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"80ba51bc-3a84-4605-8df2-1dc7a1d4b486","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"e38eedc6-9dc6-4847-96d1-66740de585b9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BFRV827XC9VH8VQ7H4VQ.
2018-12-27 15:06:24,242 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=80ba51bc-3a84-4605-8df2-1dc7a1d4b486, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:24,245 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=80ba51bc-3a84-4605-8df2-1dc7a1d4b486, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373726,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,245 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373726,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,245 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373726,
  "duration" : 1,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,267 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"0e483fb7-c8a5-42b6-b326-90b38371ec63","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"e38eedc6-9dc6-4847-96d1-66740de585b9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:24,267 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=0e483fb7-c8a5-42b6-b326-90b38371ec63, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:24,267 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=0e483fb7-c8a5-42b6-b326-90b38371ec63, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to partner server for visitor webim-visitor-BFRV827XC9VH8VQ7H4VQ
2018-12-27 15:06:24,269 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"0e483fb7-c8a5-42b6-b326-90b38371ec63","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"e38eedc6-9dc6-4847-96d1-66740de585b9"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BFRV827XC9VH8VQ7H4VQ.
2018-12-27 15:06:24,272 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=0e483fb7-c8a5-42b6-b326-90b38371ec63, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:24,275 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=0e483fb7-c8a5-42b6-b326-90b38371ec63, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=e38eedc6-9dc6-4847-96d1-66740de585b9}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378583,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:24,276 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378583,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:24,276 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378583,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:24,419 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"8ef01210-9528-4038-8ca4-79a6e45cbb4c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"1cfad114-8078-4263-a8ed-e152b002a6ed","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:24,419 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=8ef01210-9528-4038-8ca4-79a6e45cbb4c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:24,420 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=8ef01210-9528-4038-8ca4-79a6e45cbb4c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to partner server for visitor webim-visitor-BFRV827XC9VH8VQ7H4VQ
2018-12-27 15:06:24,422 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。","type":"txt"}],"ext":{"weichat":{"msgId":"8ef01210-9528-4038-8ca4-79a6e45cbb4c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。"},"msg_id_for_ack":"1cfad114-8078-4263-a8ed-e152b002a6ed","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BFRV827XC9VH8VQ7H4VQ.
2018-12-27 15:06:24,424 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8], ext={weichat={msgId=8ef01210-9528-4038-8ca4-79a6e45cbb4c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:24,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@55719ac8, from=119898, ext={weichat={msgId=8ef01210-9528-4038-8ca4-79a6e45cbb4c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=很抱歉，这个问题有点深奥，小紫建议您输入“转人工”，小紫会安排人工客服为您服务哦。}, msg_id_for_ack=1cfad114-8078-4263-a8ed-e152b002a6ed, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373908,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373908,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:24,427 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894373908,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:13 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:13 GMT]}>
2018-12-27 15:06:25,092 INFO  [qtp1063823352-643]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
2018-12-27 15:06:28,415 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551171360810860948' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bfrv827xc9vh8vq7h4vq@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-BFRV827XC9VH8VQ7H4VQ&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;买保险&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;792dd4f2-f5e9-45bf-8d06-e502f82b0c93&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:06:28,415 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551171360810860948' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bfrv827xc9vh8vq7h4vq@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-BFRV827XC9VH8VQ7H4VQ&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;买保险&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;official_account&quot;:{&quot;official_account_id&quot;:&quot;1787e4f3-5cd6-4b6b-9a28-741fbee05462&quot;},&quot;msg_id_for_ack&quot;:&quot;792dd4f2-f5e9-45bf-8d06-e502f82b0c93&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:06:28,415 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2938' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-bfrv827xc9vh8vq7h4vq@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551171360810860948'/></message>.
2018-12-27 15:06:28,418 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","to":"119898","bodies":[{"type":"txt","msg":"买保险"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"792dd4f2-f5e9-45bf-8d06-e502f82b0c93","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171360810860948","channel_id":35,"channelType":"easemob","timestamp":1545894388415,"tenantId":43,"originType":"webim"}].
2018-12-27 15:06:28,419 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@130b49c], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, originType=webim}}, from=webim-visitor-BFRV827XC9VH8VQ7H4VQ, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:06:28 CST 2018, msgId=551171360810860948, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:06:28,419 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:06:28,419 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"792dd4f2-f5e9-45bf-8d06-e502f82b0c93","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:06:28,419 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"792dd4f2-f5e9-45bf-8d06-e502f82b0c93","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:06:28,420 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:28,423 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:28,424 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@130b49c], ext={weichat={language=zh-CN, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462}, msg_id_for_ack=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, originType=webim}}, from=webim-visitor-BFRV827XC9VH8VQ7H4VQ, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:06:28 CST 2018, msgId=551171360810860948, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:06:28,426 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"买保险","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462"},"msg_id_for_ack":"792dd4f2-f5e9-45bf-8d06-e502f82b0c93","originType":"webim"}},"from":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","to":"119898","channelType":"easemob","timestamp":1545894388415,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171360810860948","channel_id":35} has been send to kafka with in topic kf_msg_in partition 3, current offset is 173
2018-12-27 15:06:28,428 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894382736,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:22 GMT]}>
2018-12-27 15:06:28,428 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894382736,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:22 GMT]}>
2018-12-27 15:06:28,428 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894382736,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:17 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:22 GMT]}>
2018-12-27 15:06:28,650 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a45ed4ad-a4a8-4b4d-86a3-a48ba4937e7c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":""},"msg_id_for_ack":"792dd4f2-f5e9-45bf-8d06-e502f82b0c93","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null},"msgtype":{"choice":{"list":["如何购买宠物犬主责任保险？","如何查询保单信息？","购买保险有礼物赠送吗？","购买宠物犬主责任后何时可以生效？","新车购买保险或者续保为什么要验车？"],"items":[{"id":"8f9b3494-a4e1-453c-9c22-c955c30967ae","name":"如何购买宠物犬主责任保险？"},{"id":"18820501-e62b-45e9-9ec5-5532ac0cdb9d","name":"如何查询保单信息？"},{"id":"617b6667-9bda-405b-b5c6-b64b89fa825a","name":"购买保险有礼物赠送吗？"},{"id":"e1a07746-25de-46ca-a39a-db6d60f7203b","name":"购买宠物犬主责任后何时可以生效？"},{"id":"8c582476-9f3f-4058-a775-31a49b0840bf","name":"新车购买保险或者续保为什么要验车？"}],"title":"您是不是要咨询以下问题："}}},"from":"小紫","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:28,650 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=a45ed4ad-a4a8-4b4d-86a3-a48ba4937e7c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何购买宠物犬主责任保险？, 如何查询保单信息？, 购买保险有礼物赠送吗？, 购买宠物犬主责任后何时可以生效？, 新车购买保险或者续保为什么要验车？], items=[{id=8f9b3494-a4e1-453c-9c22-c955c30967ae, name=如何购买宠物犬主责任保险？}, {id=18820501-e62b-45e9-9ec5-5532ac0cdb9d, name=如何查询保单信息？}, {id=617b6667-9bda-405b-b5c6-b64b89fa825a, name=购买保险有礼物赠送吗？}, {id=e1a07746-25de-46ca-a39a-db6d60f7203b, name=购买宠物犬主责任后何时可以生效？}, {id=8c582476-9f3f-4058-a775-31a49b0840bf, name=新车购买保险或者续保为什么要验车？}], title=您是不是要咨询以下问题：}}}, from=小紫, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:28,650 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=a45ed4ad-a4a8-4b4d-86a3-a48ba4937e7c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何购买宠物犬主责任保险？, 如何查询保单信息？, 购买保险有礼物赠送吗？, 购买宠物犬主责任后何时可以生效？, 新车购买保险或者续保为什么要验车？], items=[{id=8f9b3494-a4e1-453c-9c22-c955c30967ae, name=如何购买宠物犬主责任保险？}, {id=18820501-e62b-45e9-9ec5-5532ac0cdb9d, name=如何查询保单信息？}, {id=617b6667-9bda-405b-b5c6-b64b89fa825a, name=购买保险有礼物赠送吗？}, {id=e1a07746-25de-46ca-a39a-db6d60f7203b, name=购买宠物犬主责任后何时可以生效？}, {id=8c582476-9f3f-4058-a775-31a49b0840bf, name=新车购买保险或者续保为什么要验车？}], title=您是不是要咨询以下问题：}}}, from=小紫, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to partner server for visitor webim-visitor-BFRV827XC9VH8VQ7H4VQ
2018-12-27 15:06:28,652 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"","type":"txt"}],"ext":{"weichat":{"msgId":"a45ed4ad-a4a8-4b4d-86a3-a48ba4937e7c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":""},"msg_id_for_ack":"792dd4f2-f5e9-45bf-8d06-e502f82b0c93","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null},"msgtype":{"choice":{"list":["如何购买宠物犬主责任保险？","如何查询保单信息？","购买保险有礼物赠送吗？","购买宠物犬主责任后何时可以生效？","新车购买保险或者续保为什么要验车？"],"items":[{"id":"8f9b3494-a4e1-453c-9c22-c955c30967ae","name":"如何购买宠物犬主责任保险？"},{"id":"18820501-e62b-45e9-9ec5-5532ac0cdb9d","name":"如何查询保单信息？"},{"id":"617b6667-9bda-405b-b5c6-b64b89fa825a","name":"购买保险有礼物赠送吗？"},{"id":"e1a07746-25de-46ca-a39a-db6d60f7203b","name":"购买宠物犬主责任后何时可以生效？"},{"id":"8c582476-9f3f-4058-a775-31a49b0840bf","name":"新车购买保险或者续保为什么要验车？"}],"title":"您是不是要咨询以下问题："}}},"from":"119898","to":"webim-visitor-BFRV827XC9VH8VQ7H4VQ","channelType":"easemob","tenantId":43,"visitorUserId":"66c61022-7e72-4734-b648-80703ff46966","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BFRV827XC9VH8VQ7H4VQ.
2018-12-27 15:06:28,655 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@0], ext={weichat={msgId=a45ed4ad-a4a8-4b4d-86a3-a48ba4937e7c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何购买宠物犬主责任保险？, 如何查询保单信息？, 购买保险有礼物赠送吗？, 购买宠物犬主责任后何时可以生效？, 新车购买保险或者续保为什么要验车？], items=[{id=8f9b3494-a4e1-453c-9c22-c955c30967ae, name=如何购买宠物犬主责任保险？}, {id=18820501-e62b-45e9-9ec5-5532ac0cdb9d, name=如何查询保单信息？}, {id=617b6667-9bda-405b-b5c6-b64b89fa825a, name=购买保险有礼物赠送吗？}, {id=e1a07746-25de-46ca-a39a-db6d60f7203b, name=购买宠物犬主责任后何时可以生效？}, {id=8c582476-9f3f-4058-a775-31a49b0840bf, name=新车购买保险或者续保为什么要验车？}], title=您是不是要咨询以下问题：}}}, from=119898, to=webim-visitor-BFRV827XC9VH8VQ7H4VQ, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=66c61022-7e72-4734-b648-80703ff46966, originType=WEBIM) to user webim-visitor-BFRV827XC9VH8VQ7H4VQ 
2018-12-27 15:06:28,659 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-BFRV827XC9VH8VQ7H4VQ], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@0, from=119898, ext={weichat={msgId=a45ed4ad-a4a8-4b4d-86a3-a48ba4937e7c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=}, msg_id_for_ack=792dd4f2-f5e9-45bf-8d06-e502f82b0c93, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}, msgtype={choice={list=[如何购买宠物犬主责任保险？, 如何查询保单信息？, 购买保险有礼物赠送吗？, 购买宠物犬主责任后何时可以生效？, 新车购买保险或者续保为什么要验车？], items=[{id=8f9b3494-a4e1-453c-9c22-c955c30967ae, name=如何购买宠物犬主责任保险？}, {id=18820501-e62b-45e9-9ec5-5532ac0cdb9d, name=如何查询保单信息？}, {id=617b6667-9bda-405b-b5c6-b64b89fa825a, name=购买保险有礼物赠送吗？}, {id=e1a07746-25de-46ca-a39a-db6d60f7203b, name=购买宠物犬主责任后何时可以生效？}, {id=8c582476-9f3f-4058-a775-31a49b0840bf, name=新车购买保险或者续保为什么要验车？}], title=您是不是要咨询以下问题：}}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378140,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:18 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:28,659 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378140,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:18 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:28,659 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-BFRV827XC9VH8VQ7H4VQ" : "success"
  },
  "timestamp" : 1545894378140,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:18 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:18 GMT]}>
2018-12-27 15:06:30,194 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"884d9b1a-1753-4feb-8a7f-b34cab824fe6","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:30,194 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=884d9b1a-1753-4feb-8a7f-b34cab824fe6, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:30,194 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=884d9b1a-1753-4feb-8a7f-b34cab824fe6, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to partner server for visitor webim-visitor-3Y8TG4983J6TRXHE3XJT
2018-12-27 15:06:30,196 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"884d9b1a-1753-4feb-8a7f-b34cab824fe6","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-3Y8TG4983J6TRXHE3XJT","channelType":"easemob","tenantId":43,"visitorUserId":"0168ca6b-cfaf-4da3-a5e4-5828100cf92a","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:06:30,199 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=884d9b1a-1753-4feb-8a7f-b34cab824fe6, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-3Y8TG4983J6TRXHE3XJT, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=0168ca6b-cfaf-4da3-a5e4-5828100cf92a, originType=WEBIM) to user webim-visitor-3Y8TG4983J6TRXHE3XJT 
2018-12-27 15:06:30,202 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-3Y8TG4983J6TRXHE3XJT], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186, from=119898, ext={weichat={msgId=884d9b1a-1753-4feb-8a7f-b34cab824fe6, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894384510,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:24 GMT]}>
2018-12-27 15:06:30,203 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894384510,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:24 GMT]}>
2018-12-27 15:06:30,203 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-3Y8TG4983J6TRXHE3XJT" : "success"
  },
  "timestamp" : 1545894384510,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:19 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:24 GMT]}>
2018-12-27 15:06:40,423 INFO  [qtp1063823352-600]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-V6FJ84J7Q4744GGPQ3MT.
2018-12-27 15:06:40,662 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-HTMB8JJW8R422W638E9T.
2018-12-27 15:06:52,735 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Receive XMPP packet <message id='551171444587889044' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-cbtm3xxxjpr68bhyk4jg@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-CBTM3XXXJPR68BHYK4JG&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;你好&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;9bf3d35f-4c3b-4a02-bec1-ecf5a606811c&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:06:52,736 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message for received message <message id='551171444587889044' to='easemob-demo#chatdemoui_119898@easemob.com' from='easemob-demo#chatdemoui_webim-visitor-cbtm3xxxjpr68bhyk4jg@easemob.com/webim' type='chat'><body>{&quot;from&quot;:&quot;webim-visitor-CBTM3XXXJPR68BHYK4JG&quot;,&quot;to&quot;:&quot;119898&quot;,&quot;bodies&quot;:[{&quot;type&quot;:&quot;txt&quot;,&quot;msg&quot;:&quot;你好&quot;}],&quot;ext&quot;:{&quot;weichat&quot;:{&quot;language&quot;:&quot;zh-CN&quot;,&quot;msg_id_for_ack&quot;:&quot;9bf3d35f-4c3b-4a02-bec1-ecf5a606811c&quot;,&quot;originType&quot;:&quot;webim&quot;}}}</body></message>.
2018-12-27 15:06:52,736 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send IM ACK message <message id='1jCbd-2939' to='easemob.com' from='easemob-demo#chatdemoui_webim-visitor-cbtm3xxxjpr68bhyk4jg@easemob.com/webim'><received xmlns='urn:xmpp:receipts' id='551171444587889044'/></message>.
2018-12-27 15:06:52,738 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Get message JSON list [{"from":"webim-visitor-CBTM3XXXJPR68BHYK4JG","to":"119898","bodies":[{"type":"txt","msg":"你好"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","originType":"webim"}},"to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171444587889044","channel_id":35,"channelType":"easemob","timestamp":1545894412736,"tenantId":43,"originType":"webim"}].
2018-12-27 15:06:52,738 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message for received message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@9f61d], ext={weichat={language=zh-CN, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, originType=webim}}, from=webim-visitor-CBTM3XXXJPR68BHYK4JG, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:06:52 CST 2018, msgId=551171444587889044, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM).
2018-12-27 15:06:52,738 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send Kefu ACK message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat=KefuExtMessage(msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, recallFlag=null, recallMsgId=null, officialAccount=null, marketing=null, reserveQueue=null, matchFlag=null)}, from=null, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null).
2018-12-27 15:06:52,738 INFO  [Smack Packet Reader (202)]  c.e.w.gateway.im.in.AckMessageSender - The ACK message is: {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"channel_id":35}
2018-12-27 15:06:52,739 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"KF-ACK","type":"cmd"}],"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"channel_id":35} to be sent out.
2018-12-27 15:06:52,739 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:52,740 INFO  [Smack Packet Reader (202)]  c.e.weichat.gateway.im.in.Listener - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@9f61d], ext={weichat={language=zh-CN, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, originType=webim}}, from=webim-visitor-CBTM3XXXJPR68BHYK4JG, to=119898, toJid=easemob-demo#chatdemoui_119898@easemob.com, channelType=IM, timestamp=Thu Dec 27 15:06:52 CST 2018, msgId=551171444587889044, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=WEBIM) to MQ.
2018-12-27 15:06:52,741 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7], ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}, from=null, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=null, originType=null) to user webim-visitor-CBTM3XXXJPR68BHYK4JG 
2018-12-27 15:06:52,742 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.message.MessageProducerKafka - message {"bodies":[{"msg":"你好","type":"txt"}],"ext":{"weichat":{"language":"zh-CN","msg_id_for_ack":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","originType":"webim"}},"from":"webim-visitor-CBTM3XXXJPR68BHYK4JG","to":"119898","channelType":"easemob","timestamp":1545894412736,"tenantId":43,"originType":"webim","to_jid":"easemob-demo#chatdemoui_119898@easemob.com","msg_id":"551171444587889044","channel_id":35} has been send to kafka with in topic kf_msg_in partition 8, current offset is 269
2018-12-27 15:06:52,746 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-CBTM3XXXJPR68BHYK4JG], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@83eb54f7, from=119898, ext={weichat={msgId=null, originType=null, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, recall_flag=null, recall_msg_id=null, official_account=null, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402227,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:52,746 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402227,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:52,746 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402227,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:52,859 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"b3e235c5-5b74-421c-bb4d-c791837cecc5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:52,859 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=b3e235c5-5b74-421c-bb4d-c791837cecc5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:52,859 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=b3e235c5-5b74-421c-bb4d-c791837cecc5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to partner server for visitor webim-visitor-CBTM3XXXJPR68BHYK4JG
2018-12-27 15:06:52,861 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"先生/女士，您好。我是紫金保险的小紫，很高兴为您服务，请问有什么可以帮到您？","type":"txt"}],"ext":{"weichat":{"msgId":"b3e235c5-5b74-421c-bb4d-c791837cecc5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-CBTM3XXXJPR68BHYK4JG.
2018-12-27 15:06:52,863 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776], ext={weichat={msgId=b3e235c5-5b74-421c-bb4d-c791837cecc5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to user webim-visitor-CBTM3XXXJPR68BHYK4JG 
2018-12-27 15:06:52,867 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-CBTM3XXXJPR68BHYK4JG], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@10818776, from=119898, ext={weichat={msgId=b3e235c5-5b74-421c-bb4d-c791837cecc5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894407175,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:47 GMT]}>
2018-12-27 15:06:52,867 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894407175,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:47 GMT]}>
2018-12-27 15:06:52,867 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894407175,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:47 GMT]}>
2018-12-27 15:06:52,880 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"60669cb8-7d37-4fdd-8b48-87169cdc0fd9","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"ba5d716a-a8aa-4217-8b41-4b298f42ab37"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:52,881 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=60669cb8-7d37-4fdd-8b48-87169cdc0fd9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:52,881 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=60669cb8-7d37-4fdd-8b48-87169cdc0fd9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to partner server for visitor webim-visitor-CBTM3XXXJPR68BHYK4JG
2018-12-27 15:06:52,882 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"60669cb8-7d37-4fdd-8b48-87169cdc0fd9","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"ba5d716a-a8aa-4217-8b41-4b298f42ab37"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-CBTM3XXXJPR68BHYK4JG.
2018-12-27 15:06:52,885 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=60669cb8-7d37-4fdd-8b48-87169cdc0fd9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to user webim-visitor-CBTM3XXXJPR68BHYK4JG 
2018-12-27 15:06:52,888 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-CBTM3XXXJPR68BHYK4JG], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973, from=119898, ext={weichat={msgId=60669cb8-7d37-4fdd-8b48-87169cdc0fd9, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402369,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:52,888 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402369,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:52,888 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402369,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:52,910 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"946b9556-c1d1-4276-b42e-377cbb76b07f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"ba5d716a-a8aa-4217-8b41-4b298f42ab37"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"晴晴","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:52,910 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=946b9556-c1d1-4276-b42e-377cbb76b07f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:52,911 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=946b9556-c1d1-4276-b42e-377cbb76b07f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=晴晴, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to partner server for visitor webim-visitor-CBTM3XXXJPR68BHYK4JG
2018-12-27 15:06:52,912 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"946b9556-c1d1-4276-b42e-377cbb76b07f","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"c4fb2422-cc1c-4264-ad25-2fe937d00df1","agentUserNiceName":"小紫","agentType":6,"sessionId":"ba5d716a-a8aa-4217-8b41-4b298f42ab37"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-CBTM3XXXJPR68BHYK4JG.
2018-12-27 15:06:52,915 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=946b9556-c1d1-4276-b42e-377cbb76b07f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to user webim-visitor-CBTM3XXXJPR68BHYK4JG 
2018-12-27 15:06:52,917 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-CBTM3XXXJPR68BHYK4JG], msg=com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0, from=119898, ext={weichat={msgId=946b9556-c1d1-4276-b42e-377cbb76b07f, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=c4fb2422-cc1c-4264-ad25-2fe937d00df1, agentUserNiceName=小紫, agentType=6, sessionId=ba5d716a-a8aa-4217-8b41-4b298f42ab37}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894407225,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:47 GMT]}>
2018-12-27 15:06:52,917 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894407225,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:47 GMT]}>
2018-12-27 15:06:52,917 INFO  [consumer-IM:kf:conn:outmessages-2-thread-1]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894407225,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:47 GMT]}>
2018-12-27 15:06:53,000 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Receive the message {"bodies":[{"msg":"您好！亲，有什么能帮助您的么？","type":"txt"}],"ext":{"weichat":{"msgId":"643681e4-1752-405f-9bc5-51b55cb18422","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"小紫","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to be sent out.
2018-12-27 15:06:53,000 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.message.OutMessageWorker - Will send out message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20], ext={weichat={msgId=643681e4-1752-405f-9bc5-51b55cb18422, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) through channel class com.easemob.weichat.gateway.im.out.EasemobIMChannelMessageService.
2018-12-27 15:06:53,000 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20], ext={weichat={msgId=643681e4-1752-405f-9bc5-51b55cb18422, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=小紫, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to partner server for visitor webim-visitor-CBTM3XXXJPR68BHYK4JG
2018-12-27 15:06:53,001 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Send message {"bodies":[{"msg":"您好！亲，有什么能帮助您的么？","type":"txt"}],"ext":{"weichat":{"msgId":"643681e4-1752-405f-9bc5-51b55cb18422","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":null},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9bf3d35f-4c3b-4a02-bec1-ecf5a606811c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"1787e4f3-5cd6-4b6b-9a28-741fbee05462","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"119898","to":"webim-visitor-CBTM3XXXJPR68BHYK4JG","channelType":"easemob","tenantId":43,"visitorUserId":"16188d65-f148-4f59-bac1-50fee8f434d4","originType":"webim","channel_id":35} to redis with key: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-CBTM3XXXJPR68BHYK4JG.
2018-12-27 15:06:53,004 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.g.i.o.EasemobIMChannelMessageService - Sending message EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20], ext={weichat={msgId=643681e4-1752-405f-9bc5-51b55cb18422, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=119898, to=webim-visitor-CBTM3XXXJPR68BHYK4JG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=35, channelName=null, ignoreExistingCheck=null, tenantId=43, serviceSessionId=null, visitorUserId=16188d65-f148-4f59-bac1-50fee8f434d4, originType=WEBIM) to user webim-visitor-CBTM3XXXJPR68BHYK4JG 
2018-12-27 15:06:53,007 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMWorker - Succeed to call IM REST Message api for IMMessage(targetType=users, target=[webim-visitor-CBTM3XXXJPR68BHYK4JG], msg=com.easemob.weichat.models.message.EasemobTxtMessageBody@31e30c20, from=119898, ext={weichat={msgId=643681e4-1752-405f-9bc5-51b55cb18422, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=null}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9bf3d35f-4c3b-4a02-bec1-ecf5a606811c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=1787e4f3-5cd6-4b6b-9a28-741fbee05462, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobot.zking.com/v1/tenants/43/mediafiles/fd09f449-92ef-4c41-8821-fd081faf213bMTEucG5n/cutout?arg=0_0_350_350_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}) , the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402488,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:53,007 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - The returned result is: <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402488,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:06:53,007 INFO  [consumer-IM:kf:conn:outmessages-2-thread-2]  c.e.w.s.t.easemob.EaseMobIMControl - Succeed to call IM REST Message api, the result is <200 OK,{
  "action" : "post",
  "application" : "9b157c40-f4b3-11e8-8e4e-9908eff61244",
  "path" : "/messages",
  "uri" : "http://a1.zking.com/easemob-demo/chatdemoui/messages",
  "data" : {
    "webim-visitor-CBTM3XXXJPR68BHYK4JG" : "success"
  },
  "timestamp" : 1545894402488,
  "duration" : 0,
  "organization" : "easemob-demo",
  "applicationName" : "chatdemoui"
},{Server=[nginx], Date=[Thu, 27 Dec 2018 07:06:42 GMT], Content-Type=[application/json;charset=UTF-8], Transfer-Encoding=[chunked], Connection=[keep-alive], Vary=[Accept-Encoding], Access-Control-Allow-Origin=[*], Set-Cookie=[rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Wed, 26-Dec-2018 07:06:42 GMT]}>
2018-12-27 15:07:02,475 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-WQC7BGFC397BK33YMJ8J.
2018-12-27 15:07:14,353 INFO  [qtp1063823352-641]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-3Y8TG4983J6TRXHE3XJT.
2018-12-27 15:07:16,151 INFO  [qtp1063823352-547]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-BFRV827XC9VH8VQ7H4VQ.
2018-12-27 15:07:22,730 INFO  [qtp1063823352-641]  c.e.w.g.r.IMRoutewayPartnerController - The key to retrieve message is: appkey:easemob-demo#chatdemoui:easemobId:119898:visitorEasemobId:webim-visitor-QYVQX8MXR42M7H4MEQ7G.
