2019-01-03 15:00:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:00 start
2019-01-03 15:00:02,570 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:00
2019-01-03 15:00:02,571 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:00 complete
2019-01-03 15:00:02,571 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:00:06,589 INFO  [kf-webapp-scheduler-pool-12]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:00:06,591 INFO  [kf-webapp-scheduler-pool-12]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:00:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:00 start
2019-01-03 15:00:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:00
2019-01-03 15:00:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:00 complete
2019-01-03 15:00:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:00:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:00 start
2019-01-03 15:00:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:00
2019-01-03 15:00:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:00 complete
2019-01-03 15:00:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:01:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:01 start
2019-01-03 15:01:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:01
2019-01-03 15:01:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:01 complete
2019-01-03 15:01:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:01:06,597 INFO  [kf-webapp-scheduler-pool-26]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:01:06,598 INFO  [kf-webapp-scheduler-pool-26]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:01:22,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:01 start
2019-01-03 15:01:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:01
2019-01-03 15:01:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:01 complete
2019-01-03 15:01:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:01:27,648 INFO  [kf-webapp-scheduler-pool-14]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 8ms
2019-01-03 15:01:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:01 start
2019-01-03 15:01:42,572 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:01
2019-01-03 15:01:42,572 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:01 complete
2019-01-03 15:01:42,572 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:02:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:02 start
2019-01-03 15:02:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:02
2019-01-03 15:02:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:02 complete
2019-01-03 15:02:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:02:06,604 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:02:06,605 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:02:22,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:02 start
2019-01-03 15:02:22,570 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:02
2019-01-03 15:02:22,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:02 complete
2019-01-03 15:02:22,571 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:02:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:02 start
2019-01-03 15:02:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:02
2019-01-03 15:02:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:02 complete
2019-01-03 15:02:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:03:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:03 start
2019-01-03 15:03:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:03
2019-01-03 15:03:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:03 complete
2019-01-03 15:03:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:03:06,611 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:03:06,613 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:03:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:03 start
2019-01-03 15:03:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:03
2019-01-03 15:03:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:03 complete
2019-01-03 15:03:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:03:27,660 INFO  [kf-webapp-scheduler-pool-13]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 11ms
2019-01-03 15:03:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:03 start
2019-01-03 15:03:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:03
2019-01-03 15:03:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:03 complete
2019-01-03 15:03:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:04:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:04 start
2019-01-03 15:04:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:04
2019-01-03 15:04:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:04 complete
2019-01-03 15:04:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:04:06,619 INFO  [kf-webapp-scheduler-pool-7]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:04:06,620 INFO  [kf-webapp-scheduler-pool-7]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:04:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:04 start
2019-01-03 15:04:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:04
2019-01-03 15:04:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:04 complete
2019-01-03 15:04:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:04:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:04 start
2019-01-03 15:04:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:04
2019-01-03 15:04:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:04 complete
2019-01-03 15:04:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:04:43,151 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.a.s.ScheduledAssignedAgentSessionDataService - the tenantIds for assigned agent session data are empty.
2019-01-03 15:05:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:05 start
2019-01-03 15:05:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:05
2019-01-03 15:05:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:05 complete
2019-01-03 15:05:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:05:06,626 INFO  [kf-webapp-scheduler-pool-3]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:05:06,627 INFO  [kf-webapp-scheduler-pool-3]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:05:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:05 start
2019-01-03 15:05:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:05
2019-01-03 15:05:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:05 complete
2019-01-03 15:05:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:05:27,669 INFO  [kf-webapp-scheduler-pool-14]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 9ms
2019-01-03 15:05:39,985 INFO  [kf-webapp-scheduler-pool-23]  c.e.w.s.q.s.VisitorUserWaittingDataService - the tenantIds for visitoruser waiting data are empty.
2019-01-03 15:05:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:05 start
2019-01-03 15:05:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:05
2019-01-03 15:05:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:05 complete
2019-01-03 15:05:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:06:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:06 start
2019-01-03 15:06:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:06
2019-01-03 15:06:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:06 complete
2019-01-03 15:06:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:06:06,633 INFO  [kf-webapp-scheduler-pool-12]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:06:06,635 INFO  [kf-webapp-scheduler-pool-12]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:06:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:06 start
2019-01-03 15:06:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:06
2019-01-03 15:06:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:06 complete
2019-01-03 15:06:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:06:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:06 start
2019-01-03 15:06:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:06
2019-01-03 15:06:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:06 complete
2019-01-03 15:06:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:07:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:07 start
2019-01-03 15:07:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:07
2019-01-03 15:07:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:07 complete
2019-01-03 15:07:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:07:06,640 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:07:06,641 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:07:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:07 start
2019-01-03 15:07:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:07
2019-01-03 15:07:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:07 complete
2019-01-03 15:07:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:07:27,680 INFO  [kf-webapp-scheduler-pool-16]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 11ms
2019-01-03 15:07:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:07 start
2019-01-03 15:07:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:07
2019-01-03 15:07:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:07 complete
2019-01-03 15:07:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:08:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:08 start
2019-01-03 15:08:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:08
2019-01-03 15:08:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:08 complete
2019-01-03 15:08:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:08:06,653 INFO  [kf-webapp-scheduler-pool-12]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:08:06,654 INFO  [kf-webapp-scheduler-pool-12]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:08:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:08 start
2019-01-03 15:08:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:08
2019-01-03 15:08:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:08 complete
2019-01-03 15:08:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:08:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:08 start
2019-01-03 15:08:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:08
2019-01-03 15:08:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:08 complete
2019-01-03 15:08:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:09:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:09 start
2019-01-03 15:09:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:09
2019-01-03 15:09:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:09 complete
2019-01-03 15:09:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:09:06,660 INFO  [kf-webapp-scheduler-pool-29]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:09:06,662 INFO  [kf-webapp-scheduler-pool-29]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:09:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:09 start
2019-01-03 15:09:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:09
2019-01-03 15:09:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:09 complete
2019-01-03 15:09:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:09:27,689 INFO  [kf-webapp-scheduler-pool-26]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 8ms
2019-01-03 15:09:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:09 start
2019-01-03 15:09:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:09
2019-01-03 15:09:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:09 complete
2019-01-03 15:09:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:10:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:10 start
2019-01-03 15:10:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:10
2019-01-03 15:10:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:10 complete
2019-01-03 15:10:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:10:06,667 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:10:06,669 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:10:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:10 start
2019-01-03 15:10:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:10
2019-01-03 15:10:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:10 complete
2019-01-03 15:10:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:10:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:10 start
2019-01-03 15:10:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:10
2019-01-03 15:10:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:10 complete
2019-01-03 15:10:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:11:02,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:11 start
2019-01-03 15:11:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:11
2019-01-03 15:11:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:11 complete
2019-01-03 15:11:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:11:06,674 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:11:06,676 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:11:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:11 start
2019-01-03 15:11:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:11
2019-01-03 15:11:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:11 complete
2019-01-03 15:11:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:11:27,699 INFO  [kf-webapp-scheduler-pool-26]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 10ms
2019-01-03 15:11:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:11 start
2019-01-03 15:11:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:11
2019-01-03 15:11:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:11 complete
2019-01-03 15:11:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:12:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:12 start
2019-01-03 15:12:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:12
2019-01-03 15:12:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:12 complete
2019-01-03 15:12:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:12:06,681 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:12:06,682 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:12:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:12 start
2019-01-03 15:12:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:12
2019-01-03 15:12:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:12 complete
2019-01-03 15:12:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:12:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:12 start
2019-01-03 15:12:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:12
2019-01-03 15:12:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:12 complete
2019-01-03 15:12:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:13:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:13 start
2019-01-03 15:13:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:13
2019-01-03 15:13:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:13 complete
2019-01-03 15:13:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:13:06,687 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:13:06,688 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:13:17,584 INFO  [http-nio-8899-exec-15]  c.e.w.w.mvc.WebimPluginController - GET /v1/webimplugin/visitors/password2 orgName:easemob-demo appName:chatdemoui imServiceNumber:153895 username:webim-visitor-9V22Q3CFW3WM3JRPEB6J
2019-01-03 15:13:17,606 INFO  [http-nio-8899-exec-15]  c.e.w.w.s.impl.WebimPluginService - isReadIMUserNew is true,getWebimFromUser from new table return is {"id":0,"userId":"webim-visitor-9V22Q3CFW3WM3JRPEB6J","userPassword":"9BQXHTXQ8B"},orgName:easemob-demo,appName:chatdemoui,imServiceNumber:153895
2019-01-03 15:13:17,781 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:13:17,799 WARN  [http-nio-8899-exec-13]  o.s.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/v1/webimplugin/tenants/4/info] in DispatcherServlet with name 'dispatcherServlet'
2019-01-03 15:13:17,816 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:13:17 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:13:17,840 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:13:17,841 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:13:17 CST 2019.
2019-01-03 15:13:17,848 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:13:17,861 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:13:17,903 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:13:17 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:13:17,933 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:13:17,935 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:13:17 CST 2019.
2019-01-03 15:13:17,940 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:13:17,944 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:13:17,944 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:13:17,949 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:13:17,949 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:13:18,733 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:13:18 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@d43476b 
2019-01-03 15:13:19,063 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:13:19,071 ERROR [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:13:19,082 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:13:19,082 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:13:19,085 WARN  [hystrix-KefuLiteWebapp-46]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:13:18 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@2cd001d8 
2019-01-03 15:13:19,086 WARN  [hystrix-KefuLiteWebapp-46]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:13:19,088 ERROR [http-nio-8899-exec-14]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:13:19,200 INFO  [http-nio-8899-exec-2]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:13:19,237 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:13:19 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:13:19,241 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:13:19,242 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:13:19 CST 2019.
2019-01-03 15:13:19,248 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:13:19,252 INFO  [http-nio-8899-exec-2]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:13:19,285 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:13:19 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:13:19,287 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:13:19,288 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:13:19 CST 2019.
2019-01-03 15:13:19,293 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:13:19,295 INFO  [http-nio-8899-exec-2]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:13:19,295 INFO  [http-nio-8899-exec-2]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:13:19,299 INFO  [http-nio-8899-exec-2]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:13:19,300 INFO  [http-nio-8899-exec-2]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:13:19,327 INFO  [http-nio-8899-exec-9]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccounts tenantId:4 visitorId:fe81afe0-b145-485b-80f2-ef15b3b15180 page:0 size:100
2019-01-03 15:13:19,376 INFO  [http-nio-8899-exec-14]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/fe81afe0-b145-485b-80f2-ef15b3b15180/official-accounts page:0 size:100
2019-01-03 15:13:19,420 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:13:18 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@a0cbf3a 
2019-01-03 15:13:19,425 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:13:19,426 ERROR [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:13:19,427 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:13:19,427 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:13:19,429 WARN  [hystrix-KefuLiteWebapp-46]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:13:18 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@a48be2 
2019-01-03 15:13:19,429 WARN  [hystrix-KefuLiteWebapp-46]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:13:19,431 ERROR [http-nio-8899-exec-13]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:13:19,513 INFO  [http-nio-8899-exec-6]  c.e.w.w.s.i.WebimOfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:fe81afe0-b145-485b-80f2-ef15b3b15180 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:13:19,514 INFO  [http-nio-8899-exec-15]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:4 visitorId:fe81afe0-b145-485b-80f2-ef15b3b15180 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:13:19,544 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:fe81afe0-b145-485b-80f2-ef15b3b15180 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:13:19,549 INFO  [http-nio-8899-exec-3]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/fe81afe0-b145-485b-80f2-ef15b3b15180/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages startId:null direction:before size:10
2019-01-03 15:13:19,659 INFO  [http-nio-8899-exec-5]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:13:19,682 INFO  [http-nio-8899-exec-9]  c.e.w.w.m.WebimSkillGroupMenuController - GET /v1/webimplugin/tenants/{tenantId}/skillgroup-menu,tenantId:4
2019-01-03 15:13:19,703 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:13:19 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:13:19,705 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:13:19,707 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:13:19 CST 2019.
2019-01-03 15:13:19,713 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:13:19,715 INFO  [http-nio-8899-exec-5]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:13:19,736 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:13:19 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:13:19,772 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:13:19,773 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:13:19 CST 2019.
2019-01-03 15:13:19,778 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:13:19,780 INFO  [http-nio-8899-exec-5]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:13:19,780 INFO  [http-nio-8899-exec-5]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:13:19,788 INFO  [http-nio-8899-exec-5]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:13:19,788 INFO  [http-nio-8899-exec-5]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:13:19,865 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:13:20 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@7f7f5025 
2019-01-03 15:13:19,867 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:13:19,868 ERROR [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:13:19,874 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:13:19,874 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:13:19,876 WARN  [hystrix-KefuLiteWebapp-46]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:13:18 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@43094010 
2019-01-03 15:13:19,876 WARN  [hystrix-KefuLiteWebapp-46]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:13:19,878 ERROR [http-nio-8899-exec-13]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:13:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:13 start
2019-01-03 15:13:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:13
2019-01-03 15:13:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:13 complete
2019-01-03 15:13:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:13:27,706 INFO  [kf-webapp-scheduler-pool-26]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 6ms
2019-01-03 15:13:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:13 start
2019-01-03 15:13:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:13
2019-01-03 15:13:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:13 complete
2019-01-03 15:13:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:14:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:14 start
2019-01-03 15:14:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:14
2019-01-03 15:14:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:14 complete
2019-01-03 15:14:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:14:06,695 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:14:06,697 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:14:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:14 start
2019-01-03 15:14:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:14
2019-01-03 15:14:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:14 complete
2019-01-03 15:14:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:14:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:14 start
2019-01-03 15:14:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:14
2019-01-03 15:14:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:14 complete
2019-01-03 15:14:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:15:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:15 start
2019-01-03 15:15:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:15
2019-01-03 15:15:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:15 complete
2019-01-03 15:15:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:15:06,703 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:15:06,704 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:15:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:15 start
2019-01-03 15:15:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:15
2019-01-03 15:15:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:15 complete
2019-01-03 15:15:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:15:27,716 INFO  [kf-webapp-scheduler-pool-16]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 9ms
2019-01-03 15:15:39,997 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.VisitorUserWaittingDataService - the tenantIds for visitoruser waiting data are empty.
2019-01-03 15:15:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:15 start
2019-01-03 15:15:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:15
2019-01-03 15:15:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:15 complete
2019-01-03 15:15:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:16:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:16 start
2019-01-03 15:16:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:16
2019-01-03 15:16:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:16 complete
2019-01-03 15:16:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:16:06,710 INFO  [kf-webapp-scheduler-pool-21]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:16:06,711 INFO  [kf-webapp-scheduler-pool-21]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:16:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:16 start
2019-01-03 15:16:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:16
2019-01-03 15:16:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:16 complete
2019-01-03 15:16:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:16:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:16 start
2019-01-03 15:16:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:16
2019-01-03 15:16:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:16 complete
2019-01-03 15:16:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:17:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:17 start
2019-01-03 15:17:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:17
2019-01-03 15:17:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:17 complete
2019-01-03 15:17:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:17:06,717 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:17:06,718 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:17:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:17 start
2019-01-03 15:17:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:17
2019-01-03 15:17:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:17 complete
2019-01-03 15:17:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:17:27,726 INFO  [kf-webapp-scheduler-pool-3]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 9ms
2019-01-03 15:17:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:17 start
2019-01-03 15:17:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:17
2019-01-03 15:17:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:17 complete
2019-01-03 15:17:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:18:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:18 start
2019-01-03 15:18:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:18
2019-01-03 15:18:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:18 complete
2019-01-03 15:18:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:18:06,723 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:18:06,724 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:18:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:18 start
2019-01-03 15:18:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:18
2019-01-03 15:18:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:18 complete
2019-01-03 15:18:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:18:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:18 start
2019-01-03 15:18:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:18
2019-01-03 15:18:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:18 complete
2019-01-03 15:18:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:19:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:19 start
2019-01-03 15:19:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:19
2019-01-03 15:19:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:19 complete
2019-01-03 15:19:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:19:06,730 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:19:06,731 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:19:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:19 start
2019-01-03 15:19:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:19
2019-01-03 15:19:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:19 complete
2019-01-03 15:19:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:19:27,735 INFO  [kf-webapp-scheduler-pool-27]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 9ms
2019-01-03 15:19:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:19 start
2019-01-03 15:19:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:19
2019-01-03 15:19:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:19 complete
2019-01-03 15:19:42,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:20:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:20 start
2019-01-03 15:20:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:20
2019-01-03 15:20:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:20 complete
2019-01-03 15:20:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:20:06,739 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:20:06,741 INFO  [kf-webapp-scheduler-pool-20]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:20:22,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:20 start
2019-01-03 15:20:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:20
2019-01-03 15:20:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:20 complete
2019-01-03 15:20:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:20:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:20 start
2019-01-03 15:20:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:20
2019-01-03 15:20:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:20 complete
2019-01-03 15:20:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:21:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:21 start
2019-01-03 15:21:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:21
2019-01-03 15:21:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:21 complete
2019-01-03 15:21:02,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:21:06,746 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:21:06,748 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:21:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:21 start
2019-01-03 15:21:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:21
2019-01-03 15:21:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:21 complete
2019-01-03 15:21:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:21:27,745 INFO  [kf-webapp-scheduler-pool-3]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 9ms
2019-01-03 15:21:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:21 start
2019-01-03 15:21:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:21
2019-01-03 15:21:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:21 complete
2019-01-03 15:21:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:22:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:22 start
2019-01-03 15:22:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:22
2019-01-03 15:22:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:22 complete
2019-01-03 15:22:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:22:06,753 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:22:06,755 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:22:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:22 start
2019-01-03 15:22:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:22
2019-01-03 15:22:22,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:22 complete
2019-01-03 15:22:22,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:22:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:22 start
2019-01-03 15:22:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:22
2019-01-03 15:22:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:22 complete
2019-01-03 15:22:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:23:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:23 start
2019-01-03 15:23:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:23
2019-01-03 15:23:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:23 complete
2019-01-03 15:23:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:23:06,760 INFO  [kf-webapp-scheduler-pool-17]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:23:06,761 INFO  [kf-webapp-scheduler-pool-17]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:23:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:23 start
2019-01-03 15:23:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:23
2019-01-03 15:23:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:23 complete
2019-01-03 15:23:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:23:27,754 INFO  [kf-webapp-scheduler-pool-29]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 9ms
2019-01-03 15:23:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:23 start
2019-01-03 15:23:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:23
2019-01-03 15:23:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:23 complete
2019-01-03 15:23:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:24:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:24 start
2019-01-03 15:24:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:24
2019-01-03 15:24:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:24 complete
2019-01-03 15:24:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:24:06,767 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:24:06,768 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:24:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:24 start
2019-01-03 15:24:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:24
2019-01-03 15:24:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:24 complete
2019-01-03 15:24:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:24:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:24 start
2019-01-03 15:24:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:24
2019-01-03 15:24:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:24 complete
2019-01-03 15:24:42,569 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:24:43,164 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.a.s.ScheduledAssignedAgentSessionDataService - the tenantIds for assigned agent session data are empty.
2019-01-03 15:25:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:25 start
2019-01-03 15:25:02,570 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:25
2019-01-03 15:25:02,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:25 complete
2019-01-03 15:25:02,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:25:06,774 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:25:06,775 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:25:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:25 start
2019-01-03 15:25:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:25
2019-01-03 15:25:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:25 complete
2019-01-03 15:25:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:25:27,763 INFO  [kf-webapp-scheduler-pool-3]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 8ms
2019-01-03 15:25:40,007 INFO  [kf-webapp-scheduler-pool-18]  c.e.w.s.q.s.VisitorUserWaittingDataService - the tenantIds for visitoruser waiting data are empty.
2019-01-03 15:25:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:25 start
2019-01-03 15:25:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:25
2019-01-03 15:25:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:25 complete
2019-01-03 15:25:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:26:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:26 start
2019-01-03 15:26:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:26
2019-01-03 15:26:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:26 complete
2019-01-03 15:26:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:26:06,784 INFO  [kf-webapp-scheduler-pool-13]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:26:06,786 INFO  [kf-webapp-scheduler-pool-13]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:26:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:26 start
2019-01-03 15:26:22,570 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:26
2019-01-03 15:26:22,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:26 complete
2019-01-03 15:26:22,570 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:26:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:26 start
2019-01-03 15:26:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:26
2019-01-03 15:26:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:26 complete
2019-01-03 15:26:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:27:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:27 start
2019-01-03 15:27:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:27
2019-01-03 15:27:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:27 complete
2019-01-03 15:27:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:27:06,791 INFO  [kf-webapp-scheduler-pool-5]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:27:06,792 INFO  [kf-webapp-scheduler-pool-5]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:27:08,446 INFO  [http-nio-8899-exec-2]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/visitors/configs/c99f9b8b-dc4b-48f2-8d04-34573218a57b
2019-01-03 15:27:08,707 INFO  [http-nio-8899-exec-15]  c.e.w.w.mvc.WebimPluginController - GET /v1/webimplugin/visitors/password2 orgName:9900181204028764 appName:kefuchannelapp4 imServiceNumber:kefuchannelimid_569839 username:webim-visitor-632PMQ9WCH9BHBWP3MPG
2019-01-03 15:27:08,736 INFO  [http-nio-8899-exec-15]  c.e.w.w.s.impl.WebimPluginService - isReadIMUserNew is true,getWebimFromUser from new table return is {"id":0,"userId":"webim-visitor-632PMQ9WCH9BHBWP3MPG","userPassword":"TT4P3HMFVV"},orgName:9900181204028764,appName:kefuchannelapp4,imServiceNumber:kefuchannelimid_569839
2019-01-03 15:27:08,909 WARN  [http-nio-8899-exec-9]  o.s.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/v1/webimplugin/tenants/4/info] in DispatcherServlet with name 'dispatcherServlet'
2019-01-03 15:27:08,923 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:08 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:08,926 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:08,928 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:08 CST 2019.
2019-01-03 15:27:08,938 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:08,943 INFO  [http-nio-8899-exec-12]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:08,976 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:08 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:08,978 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:08,978 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:08 CST 2019.
2019-01-03 15:27:08,982 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:08,984 INFO  [http-nio-8899-exec-12]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:08,984 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=14, robotId=null, agentUserId=null)
2019-01-03 15:27:08,992 INFO  [http-nio-8899-exec-12]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 14, ServiceSessionId null, matched robot id is null
2019-01-03 15:27:08,992 INFO  [http-nio-8899-exec-12]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=14,robotId=null,agentUserId=null
2019-01-03 15:27:09,048 INFO  [http-nio-8899-exec-6]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:09 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:09,050 INFO  [http-nio-8899-exec-6]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:09,051 INFO  [http-nio-8899-exec-6]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:09 CST 2019.
2019-01-03 15:27:09,054 INFO  [http-nio-8899-exec-6]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:09,257 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:09 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:09,260 INFO  [http-nio-8899-exec-9]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:09,261 INFO  [http-nio-8899-exec-9]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:09 CST 2019.
2019-01-03 15:27:09,265 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:09,270 INFO  [http-nio-8899-exec-10]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:09,319 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:09 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:09,321 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:09,322 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:09 CST 2019.
2019-01-03 15:27:09,325 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:09,327 INFO  [http-nio-8899-exec-10]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:09,328 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=14, robotId=null, agentUserId=null)
2019-01-03 15:27:09,333 INFO  [http-nio-8899-exec-10]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 14, ServiceSessionId null, matched robot id is null
2019-01-03 15:27:09,334 INFO  [http-nio-8899-exec-10]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=14,robotId=null,agentUserId=null
2019-01-03 15:27:09,362 INFO  [http-nio-8899-exec-3]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccounts tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 page:0 size:100
2019-01-03 15:27:09,398 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/12e26dbf-dc23-431e-a5b1-526e18d4a399/official-accounts page:0 size:100
2019-01-03 15:27:09,492 INFO  [http-nio-8899-exec-14]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:09,497 INFO  [http-nio-8899-exec-5]  c.e.w.w.s.i.WebimOfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:09,528 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:09,531 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/12e26dbf-dc23-431e-a5b1-526e18d4a399/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages startId:null direction:before size:10
2019-01-03 15:27:09,663 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:09 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:09,665 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:09,666 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:09 CST 2019.
2019-01-03 15:27:09,670 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:09,671 INFO  [http-nio-8899-exec-5]  c.e.w.w.m.WebimSkillGroupMenuController - GET /v1/webimplugin/tenants/{tenantId}/skillgroup-menu,tenantId:4
2019-01-03 15:27:09,673 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:09,728 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:09 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:09,741 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:09,743 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:09 CST 2019.
2019-01-03 15:27:09,747 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:09,749 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:09,749 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=14, robotId=null, agentUserId=null)
2019-01-03 15:27:09,754 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 14, ServiceSessionId null, matched robot id is null
2019-01-03 15:27:09,755 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=14,robotId=null,agentUserId=null
2019-01-03 15:27:11,059 INFO  [http-nio-8899-exec-10]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:11 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:11,061 INFO  [http-nio-8899-exec-10]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:11,062 INFO  [http-nio-8899-exec-10]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:11 CST 2019.
2019-01-03 15:27:11,066 INFO  [http-nio-8899-exec-10]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:11,070 INFO  [http-nio-8899-exec-12]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:11,086 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:11,109 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:11 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:11,111 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:11,111 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:11 CST 2019.
2019-01-03 15:27:11,116 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:11,118 INFO  [http-nio-8899-exec-12]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:11,118 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:11,118 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=14, robotId=null, agentUserId=null)
2019-01-03 15:27:11,124 INFO  [http-nio-8899-exec-12]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 14, ServiceSessionId null, matched robot id is null
2019-01-03 15:27:11,125 INFO  [http-nio-8899-exec-12]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=14,robotId=null,agentUserId=null
2019-01-03 15:27:11,126 ERROR [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.m.p.Kefu_3500_ServiceSessionProcessor - session not fount serviceSessionId:null context:{"channel":{"tenantId":4,"type":"easemob","id":16,"dutyType":"Allday","agentQueueId":14,"timeScheduleId":0,"name":"网站","info":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839"},"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"message":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9b04034a-6ce3-4196-9cf6-68078cface38","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500431091,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774319004549524","channel_id":16,"channel_name":"网站"},"tenantId":4,"properties":{}}
2019-01-03 15:27:11,128 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.m.p.WaitingQueueService - getWaitingQueueMaxFromDB(). read waitingQueueMax from DB, tenantId=4 waitingQueueMaxStr=200.
2019-01-03 15:27:11,131 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.m.p.WaitingQueueService - getWaitingQueueMaxFromDB(). tenantId=4 current AgentNumber=36
2019-01-03 15:27:11,132 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.m.p.WaitingQueueService - getWaitingQueueMax. Save waitingQueueMax value into Redis, tenantId=4 maxWaitingQueue=7200， refreshTime=5min.
2019-01-03 15:27:11,148 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountSession tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,182 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-session body:{"visitorId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}
2019-01-03 15:27:11,204 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.m.p.CreateSessionProcessor - key: webim-visitor-632PMQ9WCH9BHBWP3MPG, msg: {"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":4,"state":"Prepare","chatGroupId":111,"messageSeqId":0,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","techChannelType":"easemob","originType":"webim","expire":true}, result: true
2019-01-03 15:27:11,204 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-27 20:43:53.0, lastUpdateDateTime=2018-12-27 20:43:53.0, sendMessageCount=0), queueId=14, robotId=4, chatRoomId=null, state=Prepare, chatGroupId=111, messageSeqId=0, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:27:11,237 INFO  [http-nio-8899-exec-6]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:11 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:11,238 INFO  [http-nio-8899-exec-6]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:11,239 INFO  [http-nio-8899-exec-6]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:11 CST 2019.
2019-01-03 15:27:11,243 INFO  [http-nio-8899-exec-6]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:11,245 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:11,279 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:11 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:11,281 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:11,282 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:11 CST 2019.
2019-01-03 15:27:11,286 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:11,288 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.t.TechChannelBindingService - TechChannelBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:27:11,288 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId 200175ef-5064-40bf-a836-667a8c2b4050,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=14, robotId=null, agentUserId=null)
2019-01-03 15:27:11,293 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 14, ServiceSessionId 200175ef-5064-40bf-a836-667a8c2b4050, matched robot id is null
2019-01-03 15:27:11,293 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - ServiceSessionId 200175ef-5064-40bf-a836-667a8c2b4050,tenantId 4 , get routing result RoutingResult(queueId=14, robotId=null, agentUserId=null)
2019-01-03 15:27:11,297 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session mark delay sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,301 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session state change to wait sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,301 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - publish ServiceSessionCreatedEvent sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,302 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionCreatedEvent sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,303 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.r.s.l.SchedulerListenerForServiceSession - new service session created {"source":{},"timestamp":1546500431302,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":0,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentCallback":false,"userPK":{"tenantId":4},"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9b04034a-6ce3-4196-9cf6-68078cface38","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500431091,"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774319004549524","channel_id":16,"channel_name":"网站"},"channelData":{"tenantId":4,"type":"easemob","id":16,"dutyType":"Allday","agentQueueId":14,"timeScheduleId":0,"name":"网站","info":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839"},"routingPolicyType":"ChannelData","kickOff":true}
2019-01-03 15:27:11,308 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.r.s.l.SchedulerListenerForServiceSession - new service session created and auto dispatched sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,308 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc084660-0f28-11e9-bad4-63caf1713d50","type":"com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent","timestamp":1546500431302,"body":{"source":{},"timestamp":1546500431302,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":0,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentCallback":false,"userPK":{"tenantId":4},"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9b04034a-6ce3-4196-9cf6-68078cface38","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500431091,"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774319004549524","channel_id":16,"channel_name":"网站"},"channelData":{"tenantId":4,"type":"easemob","id":16,"dutyType":"Allday","agentQueueId":14,"timeScheduleId":0,"name":"网站","info":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839"},"routingPolicyType":"ChannelData","kickOff":true}} has been send to kafka with in topic events partition 11, current offset is 1900
2019-01-03 15:27:11,311 INFO  [SimpleAsyncTaskExecutor-4208]  c.e.w.r.s.l.ServiceSessionCreatedEventListener - expectedType is ServiceSessionCreatedEvent , event:ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=4, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=9b04034a-6ce3-4196-9cf6-68078cface38, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), channelData=ChannelData(tenantId=4, type=IM, id=16, dutyType=Allday, agentQueueId=14, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=网站, info=9900181204028764#kefuchannelapp4#kefuchannelimid_569839), routingPolicyType=ChannelData)
2019-01-03 15:27:11,314 INFO  [SimpleAsyncTaskExecutor-4209]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionCreatedEvent, sessionId:200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:27:11,314 INFO  [SimpleAsyncTaskExecutor-4208]  c.e.w.r.s.l.ServiceSessionCreatedEventListener - ServiceSessionCreatedEventHandler | getKefuExt or visitor is null. message.getKefuExt():KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=9b04034a-6ce3-4196-9cf6-68078cface38, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)
2019-01-03 15:27:11,317 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionCreatedEvent ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=4, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), channelData=ChannelData(tenantId=4, type=IM, id=16, dutyType=Allday, agentQueueId=14, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=网站, info=9900181204028764#kefuchannelapp4#kefuchannelimid_569839), routingPolicyType=ChannelData)
2019-01-03 15:27:11,317 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:27:11,320 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:8f108318-9ceb-4e76-a1c8-0b7a9bbbc611 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431321,"type":null}
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - prepare message noticeId:8f108318-9ceb-4e76-a1c8-0b7a9bbbc611 messageType:VisitUserWaitingListChange path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:559f94d1-acf7-457d-b53e-16a56e17fbd1 message:{"path":"/tenants/4/agents/143780ab-a30c-42f5-9ad8-55c3afade15d","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431323,"type":null}
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:da01956a-ae7e-4e26-aa98-0cb0210d82c5 message:{"path":"/tenants/4/agents/da4dc75e-96c6-4b3b-9811-1fe29a7859f8","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431322,"type":null}
2019-01-03 15:27:11,327 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.q.s.WaitingSessionTimerService - Save timer for service session 200175ef-5064-40bf-a836-667a8c2b4050 into redis, notifyTime = Thu Jan 03 15:30:11 CST 2019 notifyCount = 1 notifyInterval = 180 closeTime = null closeInterval = 0 closeNotifyTime = null closeNotifyCount = 0 closeNotifyInterval = 0
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:c8d78efa-e14d-41f4-b3f2-5cfc77fe3f25 message:{"path":"/tenants/4/agents/779a9b78-8436-4bf2-9d12-361f78710e25","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431324,"type":null}
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:c19f99d5-9538-4740-8af3-acacee651c9f message:{"path":"/tenants/4/agents/436a6dca-bdde-4c31-a0b1-585e97eb5507","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431323,"type":null}
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - prepare message noticeId:559f94d1-acf7-457d-b53e-16a56e17fbd1 messageType:VisitUserWaitingListChange path:/tenants/4/agents/143780ab-a30c-42f5-9ad8-55c3afade15d
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - prepare message noticeId:da01956a-ae7e-4e26-aa98-0cb0210d82c5 messageType:VisitUserWaitingListChange path:/tenants/4/agents/da4dc75e-96c6-4b3b-9811-1fe29a7859f8
2019-01-03 15:27:11,327 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.q.l.ServiceSessionRelatedEventListener - Succeed to create service session queue timer for created servicesession 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:481d0c9f-578a-4fb4-a02f-d67375ef7a4c message:{"path":"/tenants/4/agents/281848c3-2b84-4604-8fd3-09daa5611ef8","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431324,"type":null}
2019-01-03 15:27:11,328 INFO  [SimpleAsyncTaskExecutor-11]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:b8b18b2e-5967-43a3-9ac1-a52943f9250b message:{"path":"/tenants/4/agents/7db8572c-8ec9-4afd-af51-ba12e211a6f3","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431325,"type":null}
2019-01-03 15:27:11,328 INFO  [SimpleAsyncTaskExecutor-11]  c.e.w.n.service.PushDataService - prepare message noticeId:b8b18b2e-5967-43a3-9ac1-a52943f9250b messageType:VisitUserWaitingListChange path:/tenants/4/agents/7db8572c-8ec9-4afd-af51-ba12e211a6f3
2019-01-03 15:27:11,327 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - prepare message noticeId:c8d78efa-e14d-41f4-b3f2-5cfc77fe3f25 messageType:VisitUserWaitingListChange path:/tenants/4/agents/779a9b78-8436-4bf2-9d12-361f78710e25
2019-01-03 15:27:11,328 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - prepare message noticeId:c19f99d5-9538-4740-8af3-acacee651c9f messageType:VisitUserWaitingListChange path:/tenants/4/agents/436a6dca-bdde-4c31-a0b1-585e97eb5507
2019-01-03 15:27:11,328 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - prepare message noticeId:481d0c9f-578a-4fb4-a02f-d67375ef7a4c messageType:VisitUserWaitingListChange path:/tenants/4/agents/281848c3-2b84-4604-8fd3-09daa5611ef8
2019-01-03 15:27:11,329 INFO  [SimpleAsyncTaskExecutor-14]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:b37f9980-77c6-43d9-a62b-37cab559ff0f message:{"path":"/tenants/4/agents/3d75dc9d-145a-49ab-9579-c35e410584a6","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431326,"type":null}
2019-01-03 15:27:11,329 INFO  [SimpleAsyncTaskExecutor-14]  c.e.w.n.service.PushDataService - prepare message noticeId:b37f9980-77c6-43d9-a62b-37cab559ff0f messageType:VisitUserWaitingListChange path:/tenants/4/agents/3d75dc9d-145a-49ab-9579-c35e410584a6
2019-01-03 15:27:11,328 INFO  [SimpleAsyncTaskExecutor-2]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:4711314b-1cb8-4afc-8387-d8b063919409 message:{"path":"/tenants/4/agents/84620ad2-ad5e-42d5-978b-ef76c0c74cf1","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431325,"type":null}
2019-01-03 15:27:11,330 INFO  [SimpleAsyncTaskExecutor-2]  c.e.w.n.service.PushDataService - prepare message noticeId:4711314b-1cb8-4afc-8387-d8b063919409 messageType:VisitUserWaitingListChange path:/tenants/4/agents/84620ad2-ad5e-42d5-978b-ef76c0c74cf1
2019-01-03 15:27:11,330 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5229774c-a1b6-4d50-ae96-b2612b00c605 message:{"path":"/tenants/4/agents/5de7020d-6939-43d8-855e-3e2f887fa707","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431326,"type":null}
2019-01-03 15:27:11,330 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - prepare message noticeId:5229774c-a1b6-4d50-ae96-b2612b00c605 messageType:VisitUserWaitingListChange path:/tenants/4/agents/5de7020d-6939-43d8-855e-3e2f887fa707
2019-01-03 15:27:11,330 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:157026ef-2e46-4af1-b0f5-513653574d80 message:{"path":"/tenants/4/agents/ade55cfb-8328-431a-9b9d-800122e82078","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431326,"type":null}
2019-01-03 15:27:11,331 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - prepare message noticeId:157026ef-2e46-4af1-b0f5-513653574d80 messageType:VisitUserWaitingListChange path:/tenants/4/agents/ade55cfb-8328-431a-9b9d-800122e82078
2019-01-03 15:27:11,330 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0b2c90-0f28-11e9-95a7-9f6659ab8226","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431321,"body":{"source":{},"timestamp":1546500431321,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 0, current offset is 2287
2019-01-03 15:27:11,330 INFO  [SimpleAsyncTaskExecutor-4210]  c.e.w.h.l.ServiceSessionHistoryListener - handle ServiceSessionCreatedEvent, start, serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,330 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingSessionTimerService - Save timer for service session 200175ef-5064-40bf-a836-667a8c2b4050 into redis, notifyTime = Thu Jan 03 15:30:11 CST 2019 notifyCount = 1 notifyInterval = 180 closeTime = null closeInterval = 0 closeNotifyTime = null closeNotifyCount = 0 closeNotifyInterval = 0
2019-01-03 15:27:11,332 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.l.ServiceSessionRelatedEventListener - Succeed to create service session queue timer for created servicesession 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:27:11,332 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - send serviceRequest 200175ef-5064-40bf-a836-667a8c2b4050 from processor
2019-01-03 15:27:11,332 INFO  [SimpleAsyncTaskExecutor-4210]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=4, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=9b04034a-6ce3-4196-9cf6-68078cface38, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), channelData=ChannelData(tenantId=4, type=IM, id=16, dutyType=Allday, agentQueueId=14, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=网站, info=9900181204028764#kefuchannelapp4#kefuchannelimid_569839), routingPolicyType=ChannelData)
2019-01-03 15:27:11,333 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionCreatedEvent serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050,queueId:14
2019-01-03 15:27:11,333 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2019-01-03 15:27:11,334 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0b2c90-0f28-11e9-95a7-9f6659ab8226, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431321, properties={}, body={source={}, timestamp=1546500431321, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,334 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionCreatedEventHandler - systemMessage get ServiceSessionCreatedEvent,serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,346 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0b53a0-0f28-11e9-a779-29b4f4307898","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431322,"body":{"source":{},"timestamp":1546500431322,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"da4dc75e-96c6-4b3b-9811-1fe29a7859f8"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 8, current offset is 2486
2019-01-03 15:27:11,347 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0b7ab0-0f28-11e9-8f2b-cffa0b67c2f8","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431323,"body":{"source":{},"timestamp":1546500431323,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"143780ab-a30c-42f5-9ad8-55c3afade15d"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 17, current offset is 2296
2019-01-03 15:27:11,347 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getQueueOption] ---> GET http://KefuLiteWebapp/v5/tenants/4/skillgroups/14/options/timeScheduleId HTTP/1.1
2019-01-03 15:27:11,347 INFO  [SimpleAsyncTaskExecutor-12]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5a2f5106-0ec1-4d18-9ff7-cfb663265ec3 message:{"path":"/tenants/4/agents/98461a5e-af68-41ce-954e-546ae32b60e2","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431333,"type":null}
2019-01-03 15:27:11,347 INFO  [SimpleAsyncTaskExecutor-12]  c.e.w.n.service.PushDataService - prepare message noticeId:5a2f5106-0ec1-4d18-9ff7-cfb663265ec3 messageType:VisitUserWaitingListChange path:/tenants/4/agents/98461a5e-af68-41ce-954e-546ae32b60e2
2019-01-03 15:27:11,347 INFO  [SimpleAsyncTaskExecutor-3]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:d1ef8e12-b83c-471f-84f0-edf4aa7d744e message:{"path":"/tenants/4/agents/227255c6-abf4-4d0e-9bbd-1bbb55e33709","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500431327,"type":null}
2019-01-03 15:27:11,347 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0b7aba-0f28-11e9-8120-1b6798e84c7b","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431323,"body":{"source":{},"timestamp":1546500431323,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"436a6dca-bdde-4c31-a0b1-585e97eb5507"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 11, current offset is 1901
2019-01-03 15:27:11,347 INFO  [SimpleAsyncTaskExecutor-3]  c.e.w.n.service.PushDataService - prepare message noticeId:d1ef8e12-b83c-471f-84f0-edf4aa7d744e messageType:VisitUserWaitingListChange path:/tenants/4/agents/227255c6-abf4-4d0e-9bbd-1bbb55e33709
2019-01-03 15:27:11,348 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0ba1c0-0f28-11e9-a2cb-03a5e04c5cbb","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431324,"body":{"source":{},"timestamp":1546500431323,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"779a9b78-8436-4bf2-9d12-361f78710e25"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 2, current offset is 2303
2019-01-03 15:27:11,347 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0b53a0-0f28-11e9-a779-29b4f4307898, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431322, properties={}, body={source={}, timestamp=1546500431322, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=da4dc75e-96c6-4b3b-9811-1fe29a7859f8}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,350 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0bc8da-0f28-11e9-a66c-2f3cabe64935","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431325,"body":{"source":{},"timestamp":1546500431325,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"3d75dc9d-145a-49ab-9579-c35e410584a6"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 4, current offset is 1836
2019-01-03 15:27:11,350 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0ba1ca-0f28-11e9-b8b3-d50a5c22d3ea","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431324,"body":{"source":{},"timestamp":1546500431324,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"281848c3-2b84-4604-8fd3-09daa5611ef8"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 5, current offset is 2103
2019-01-03 15:27:11,350 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0befe0-0f28-11e9-992b-431e9c9ff42c","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431326,"body":{"source":{},"timestamp":1546500431326,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"ade55cfb-8328-431a-9b9d-800122e82078"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 7, current offset is 1974
2019-01-03 15:27:11,350 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0bc8d0-0f28-11e9-8e86-dda3818ef4b6","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431325,"body":{"source":{},"timestamp":1546500431325,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"7db8572c-8ec9-4afd-af51-ba12e211a6f3"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 13, current offset is 2025
2019-01-03 15:27:11,351 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0ba1d4-0f28-11e9-abf2-c9d3327e5b56","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431324,"body":{"source":{},"timestamp":1546500431324,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"84620ad2-ad5e-42d5-978b-ef76c0c74cf1"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 14, current offset is 2251
2019-01-03 15:27:11,351 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0befea-0f28-11e9-993d-a52579e235dc","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431326,"body":{"source":{},"timestamp":1546500431326,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"5de7020d-6939-43d8-855e-3e2f887fa707"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 16, current offset is 4024
2019-01-03 15:27:11,351 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0c16f0-0f28-11e9-bcbf-7bb7c0728277","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431327,"body":{"source":{},"timestamp":1546500431326,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"227255c6-abf4-4d0e-9bbd-1bbb55e33709"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 1, current offset is 2319
2019-01-03 15:27:11,354 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc0d0150-0f28-11e9-ad31-dbcbc095339f","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500431333,"body":{"source":{},"timestamp":1546500431332,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"98461a5e-af68-41ce-954e-546ae32b60e2"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 10, current offset is 2118
2019-01-03 15:27:11,357 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0b7ab0-0f28-11e9-8f2b-cffa0b67c2f8, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431323, properties={}, body={source={}, timestamp=1546500431323, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=143780ab-a30c-42f5-9ad8-55c3afade15d}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,357 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0ba1d4-0f28-11e9-abf2-c9d3327e5b56, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431324, properties={}, body={source={}, timestamp=1546500431324, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=84620ad2-ad5e-42d5-978b-ef76c0c74cf1}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,357 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0befea-0f28-11e9-993d-a52579e235dc, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431326, properties={}, body={source={}, timestamp=1546500431326, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=5de7020d-6939-43d8-855e-3e2f887fa707}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,368 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0c16f0-0f28-11e9-bcbf-7bb7c0728277, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431327, properties={}, body={source={}, timestamp=1546500431326, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=227255c6-abf4-4d0e-9bbd-1bbb55e33709}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,357 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0bc8d0-0f28-11e9-8e86-dda3818ef4b6, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431325, properties={}, body={source={}, timestamp=1546500431325, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=7db8572c-8ec9-4afd-af51-ba12e211a6f3}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,369 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0befe0-0f28-11e9-992b-431e9c9ff42c, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431326, properties={}, body={source={}, timestamp=1546500431326, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=ade55cfb-8328-431a-9b9d-800122e82078}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,369 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0ba1ca-0f28-11e9-b8b3-d50a5c22d3ea, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431324, properties={}, body={source={}, timestamp=1546500431324, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=281848c3-2b84-4604-8fd3-09daa5611ef8}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,369 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0bc8da-0f28-11e9-a66c-2f3cabe64935, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431325, properties={}, body={source={}, timestamp=1546500431325, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=3d75dc9d-145a-49ab-9579-c35e410584a6}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,369 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0ba1c0-0f28-11e9-a2cb-03a5e04c5cbb, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431324, properties={}, body={source={}, timestamp=1546500431323, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=779a9b78-8436-4bf2-9d12-361f78710e25}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,433 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0d0150-0f28-11e9-ad31-dbcbc095339f, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431333, properties={}, body={source={}, timestamp=1546500431332, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=98461a5e-af68-41ce-954e-546ae32b60e2}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:11,436 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - serviceRequest 200175ef-5064-40bf-a836-667a8c2b4050 sended from processor
2019-01-03 15:27:11,437 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session clear delay sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,437 INFO  [SimpleAsyncTaskExecutor-4210]  c.e.w.h.client.RemoteCustomerClient -  findByTenantIdAndVisitorId use CrmApiClient , query: tenantId=4,visitorId=12e26dbf-dc23-431e-a5b1-526e18d4a399 
2019-01-03 15:27:11,446 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc1c91b0-0f28-11e9-8641-d1a8b628fb72","type":"com.easemob.weichat.service.events.servicerequest.PublishServiceRequestEvent","timestamp":1546500431435,"body":{"source":{},"timestamp":1546500431435,"actor":null,"version":"1.1","serviceRequest":{"id":null,"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","originType":"webim","channel":{"id":16,"name":"网站","type":"easemob"},"skillGroup":{"id":14,"name":"数据组","type":"QueueNormal"},"visitorUser":{"id":"12e26dbf-dc23-431e-a5b1-526e18d4a399","nickname":"webim-visitor-632PMQ9WCH9BHBWP3MPG","isVip":0},"specifiedDateTime":1546500431298},"skipRouting":false,"useSpecifiedTime":true}} has been send to kafka with in topic events partition 19, current offset is 2013
2019-01-03 15:27:11,448 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc1c91b0-0f28-11e9-8641-d1a8b628fb72, service=null, type=com.easemob.weichat.service.events.servicerequest.PublishServiceRequestEvent, timestamp=1546500431435, properties={}, body={source={}, timestamp=1546500431435, actor=null, version=1.1, serviceRequest={id=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, originType=webim, channel={id=16, name=网站, type=easemob}, skillGroup={id=14, name=数据组, type=QueueNormal}, visitorUser={id=12e26dbf-dc23-431e-a5b1-526e18d4a399, nickname=webim-visitor-632PMQ9WCH9BHBWP3MPG, isVip=0}, specifiedDateTime=1546500431298}, skipRouting=false, useSpecifiedTime=true}, topic=events, partitionKey=null)
2019-01-03 15:27:11,474 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getQueueOption] <--- HTTP/1.1 200 (126ms)
2019-01-03 15:27:11,477 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] ---> GET http://KefuLiteWebapp/v5/tenants/4/istimeoffduty?scheduleId=0&dateTime=2019-01-03+15%3A27%3A11 HTTP/1.1
2019-01-03 15:27:11,477 INFO  [SimpleAsyncTaskExecutor-4212]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-27 20:43:53.0, lastUpdateDateTime=2018-12-27 20:43:53.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=111), msgIdForAck=9b04034a-6ce3-4196-9cf6-68078cface38, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=44, sessionServiceSeqId=1, createDateTime=2019-01-03 15:27:11.438, timestamp=1546500431438, createMicroTimestamp=1546500431438000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-27 20:43:53.0, lastUpdateDateTime=2018-12-27 20:43:53.0, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=0, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:27:11,479 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:12e26dbf-dc23-431e-a5b1-526e18d4a399 to 1546500431438 driven by message 5c82faff-b8d6-414f-bc0a-87c8bfe22c0d
2019-01-03 15:27:11,479 INFO  [SimpleAsyncTaskExecutor-4209]  c.e.w.s.p.h.ServiceSessionEventHandler - saved session ProcessingSession(tenantId=4, sessionId=200175ef-5064-40bf-a836-667a8c2b4050, skillGroupId=14, state=Wait, chatGroupId=111, createDateTime=Thu Jan 03 15:27:11 CST 2019, startDateTime=null, originType=webim, fromAgentCallback=false, channelId=16, channelType=easemob, channelName=网站, agentId=null, agentNickName=null, agentType=1, visitorId=12e26dbf-dc23-431e-a5b1-526e18d4a399, visitorNickName=webim-visitor-632PMQ9WCH9BHBWP3MPG, visitorUserName=webim-visitor-632PMQ9WCH9BHBWP3MPG, customerId=56488882-350f-4fe1-9b02-7a3410094728, customerNickName=webim-visitor-632PMQ9WCH9BHBWP3MPG, customerTrueName=null) when got ServiceSessionCreatedEvent.
2019-01-03 15:27:11,480 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc22ac30-0f28-11e9-b3f8-5777960ff086","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500431475,"body":{"timestamp":1546500431474,"version":"1.1","tenantId":4,"message":{"msgId":"5c82faff-b8d6-414f-bc0a-87c8bfe22c0d","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"5c82faff-b8d6-414f-bc0a-87c8bfe22c0d","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"111"},"msg_id_for_ack":"9b04034a-6ce3-4196-9cf6-68078cface38","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500431091,"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774319004549524","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":44,"sessionServiceSeqId":1,"createDateTime":1546500431438,"timestamp":1546500431438,"createMicroTimestamp":1546500431438000},"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":0,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 11, current offset is 1902
2019-01-03 15:27:11,481 WARN  [SimpleAsyncTaskExecutor-4212]  c.e.w.h.l.ServiceSessionHistoryListener - Service Session:200175ef-5064-40bf-a836-667a8c2b4050 is not exist in ElasticSearch server, save a new Service Session in ElasticSearch server
2019-01-03 15:27:11,492 INFO  [SimpleAsyncTaskExecutor-4210]  c.e.w.h.l.ServiceSessionHistoryListener - handle ServiceSessionCreatedEvent, end, serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,512 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:11 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:11,514 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:11,515 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:11 CST 2019.
2019-01-03 15:27:11,520 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:11,521 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] <--- HTTP/1.1 200 (43ms)
2019-01-03 15:27:11,544 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getTimeOptions] ---> GET http://KefuLiteWebapp/v5/tenants/4/skillgroups/14/time-options HTTP/1.1
2019-01-03 15:27:11,583 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getTimeOptions] <--- HTTP/1.1 200 (38ms)
2019-01-03 15:27:11,585 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] ---> GET http://KefuLiteWebapp/v5/tenants/4/istimeoffduty?scheduleId=0&dateTime=2019-01-03+15%3A27%3A11 HTTP/1.1
2019-01-03 15:27:11,615 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:27:11 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:27:11,617 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:27:11,618 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:27:11 CST 2019.
2019-01-03 15:27:11,622 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:27:11,624 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] <--- HTTP/1.1 200 (38ms)
2019-01-03 15:27:11,630 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/4/messages HTTP/1.1
2019-01-03 15:27:11,668 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/4/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"to":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","status":"Disable","bizId":"4","roles":"","scope":"Tenant"},"officialAccountId":null,"messageRequest":{"msg":"ServiceSessionCreatedEvent","type":"cmd","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":"ServiceSessionCreatedEvent","ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","mediaFileUrl":null,"tenantId":4,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","saveMessage":true}
2019-01-03 15:27:11,674 INFO  [http-nio-8899-exec-9]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:27:11,710 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/200175ef-5064-40bf-a836-667a8c2b4050/official-accounts
2019-01-03 15:27:11,743 INFO  [http-nio-8899-exec-9]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 messageId:cbd74b8a-152d-46ab-b11b-d1781149103d
2019-01-03 15:27:11,768 INFO  [http-nio-8899-exec-3]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","messageId":"cbd74b8a-152d-46ab-b11b-d1781149103d","sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}
2019-01-03 15:27:11,778 INFO  [SimpleAsyncTaskExecutor-4215]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat=KefuExtMessage(msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=45, sessionServiceSeqId=2, createDateTime=2019-01-03 15:27:11.668, timestamp=1546500431668, createMicroTimestamp=1546500431668000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=1, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=2019-01-03 15:27:11.298, lastChatMessage=ChatMessage(msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:11.438, timestamp=1546500431000, createMicroTimestamp=1546500431438000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:27:11,783 INFO  [http-nio-8899-exec-9]  c.e.w.s.t.SendTimeoutEventService - this message {"msgId":"cbd74b8a-152d-46ab-b11b-d1781149103d","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"cbd74b8a-152d-46ab-b11b-d1781149103d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":45,"sessionServiceSeqId":2,"createDateTime":1546500431668,"timestamp":1546500431668,"createMicroTimestamp":1546500431668000} is cmd Message .
2019-01-03 15:27:11,785 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (154ms)
2019-01-03 15:27:11,788 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=fc084660-0f28-11e9-bad4-63caf1713d50, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent, timestamp=1546500431302, properties={}, body={source={}, timestamp=1546500431302, actor=null, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, chatGroupId=111, sex=0, createDateTime=1545914633000, lastUpdateDateTime=1545914633000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=0, agentUserType=1, createDatetime=2019-01-03 15:27:11, techChannelType=easemob, originType=webim, expire=true}, fromAgentCallback=false, userPK={tenantId=4}, easemobMessage={bodies=[{msg=111, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500431091, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774319004549524, channel_id=16, channel_name=网站}, channelData={tenantId=4, type=easemob, id=16, dutyType=Allday, agentQueueId=14, timeScheduleId=0, name=网站, info=9900181204028764#kefuchannelapp4#kefuchannelimid_569839}, routingPolicyType=ChannelData, kickOff=true}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:27:11,796 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"fc509a00-0f28-11e9-a1be-67b30b001b02","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500431776,"body":{"timestamp":1546500431776,"version":"1.1","tenantId":4,"message":{"msgId":"cbd74b8a-152d-46ab-b11b-d1781149103d","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"cbd74b8a-152d-46ab-b11b-d1781149103d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":45,"sessionServiceSeqId":2,"createDateTime":1546500431668,"timestamp":1546500431668,"createMicroTimestamp":1546500431668000},"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":1,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"5c82faff-b8d6-414f-bc0a-87c8bfe22c0d","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"5c82faff-b8d6-414f-bc0a-87c8bfe22c0d","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"9b04034a-6ce3-4196-9cf6-68078cface38","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500431091,"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774319004549524","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500431438,"timestamp":1546500431000,"createMicroTimestamp":1546500431438000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 11, current offset is 1903
2019-01-03 15:27:12,138 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=fc0b7aba-0f28-11e9-8120-1b6798e84c7b, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500431323, properties={}, body={source={}, timestamp=1546500431323, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=436a6dca-bdde-4c31-a0b1-585e97eb5507}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:27:12,141 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=111}, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=44, sessionServiceSeqId=1, createDateTime=2019-01-03 15:27:11.438, timestamp=1546500431438, createMicroTimestamp=1546500431438000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Thu Dec 27 20:43:53 CST 2018, lastUpdateDateTime=Thu Dec 27 20:43:53 CST 2018, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=0, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:27:12,146 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=fc22ac30-0f28-11e9-b3f8-5777960ff086, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500431475, properties={}, body={timestamp=1546500431474, version=1.1, tenantId=4, message={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, chatGroupId=111, sex=0, createDateTime=1545914633000, lastUpdateDateTime=1545914633000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=111}, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500431091, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774319004549524, channel_id=16, channel_name=网站}, chatGroupSeqId=44, sessionServiceSeqId=1, createDateTime=1546500431438, timestamp=1546500431438, createMicroTimestamp=1546500431438000}, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, chatGroupId=111, sex=0, createDateTime=1545914633000, lastUpdateDateTime=1545914633000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=0, agentUserType=1, createDatetime=2019-01-03 15:27:11, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:27:12,155 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=45, sessionServiceSeqId=2, createDateTime=2019-01-03 15:27:11.668, timestamp=1546500431668, createMicroTimestamp=1546500431668000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=1, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=ChatMessage(msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:11 CST 2019, msgId=553774319004549524, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:11.438, timestamp=1546500431000, createMicroTimestamp=1546500431438000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:27:12,165 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=fc509a00-0f28-11e9-a1be-67b30b001b02, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500431776, properties={}, body={timestamp=1546500431776, version=1.1, tenantId=4, message={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionCreatedEvent, type=cmd}], ext={weichat={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=45, sessionServiceSeqId=2, createDateTime=1546500431668, timestamp=1546500431668, createMicroTimestamp=1546500431668000}, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=1, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=5c82faff-b8d6-414f-bc0a-87c8bfe22c0d, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=9b04034a-6ce3-4196-9cf6-68078cface38, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500431091, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774319004549524, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500431438, timestamp=1546500431000, createMicroTimestamp=1546500431438000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:27:17,409 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:17,437 INFO  [http-nio-8899-exec-13]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:17,446 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccount tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:17,481 INFO  [http-nio-8899-exec-10]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:17,483 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-27 20:43:53.0, lastUpdateDateTime=2018-12-27 20:43:53.0, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=2, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=2019-01-03 15:27:11.298, lastChatMessage=ChatMessage(msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:11.668, timestamp=1546500431000, createMicroTimestamp=1546500431668000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:27:17,497 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 messageId:0c031763-d6e9-4d29-9e9c-8e7fe01d67e0
2019-01-03 15:27:17,536 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","messageId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}
2019-01-03 15:27:17,560 INFO  [SimpleAsyncTaskExecutor-4218]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-27 20:43:53.0, lastUpdateDateTime=2018-12-27 20:43:53.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat=KefuExtMessage(msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=北京), msgIdForAck=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:17 CST 2019, msgId=553774346338828692, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=46, sessionServiceSeqId=3, createDateTime=2019-01-03 15:27:17.484, timestamp=1546500437484, createMicroTimestamp=1546500437484000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=2018-12-27 20:43:53.0, lastUpdateDateTime=2018-12-27 20:43:53.0, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=2, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=2019-01-03 15:27:11.298, lastChatMessage=ChatMessage(msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:11.668, timestamp=1546500431000, createMicroTimestamp=1546500431668000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:27:17,562 INFO  [kafka-kf_msg_in-consumer-4-thread-4]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:12e26dbf-dc23-431e-a5b1-526e18d4a399 to 1546500437484 driven by message 0c031763-d6e9-4d29-9e9c-8e7fe01d67e0
2019-01-03 15:27:17,563 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"ffc2dd60-0f28-11e9-90ba-893bbb3cc860","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500437558,"body":{"timestamp":1546500437558,"version":"1.1","tenantId":4,"message":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"北京"},"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":46,"sessionServiceSeqId":3,"createDateTime":1546500437484,"timestamp":1546500437484,"createMicroTimestamp":1546500437484000},"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","username":"webim-visitor-632PMQ9WCH9BHBWP3MPG","techChannelType":"easemob","techChannelId":16,"techChannelInfo":"9900181204028764#kefuchannelapp4#kefuchannelimid_569839","chatGroupId":111,"sex":0,"createDateTime":1545914633000,"lastUpdateDateTime":1545914633000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":2,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"cbd74b8a-152d-46ab-b11b-d1781149103d","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"cbd74b8a-152d-46ab-b11b-d1781149103d","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500431668,"timestamp":1546500431000,"createMicroTimestamp":1546500431668000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 11, current offset is 1904
2019-01-03 15:27:17,568 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=北京}, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:17 CST 2019, msgId=553774346338828692, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=46, sessionServiceSeqId=3, createDateTime=2019-01-03 15:27:17.484, timestamp=1546500437484, createMicroTimestamp=1546500437484000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, uri=null, chatGroupId=111, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=Thu Dec 27 20:43:53 CST 2018, lastUpdateDateTime=Thu Dec 27 20:43:53 CST 2018, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Wait, chatGroupId=111, messageSeqId=2, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=ChatMessage(msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:11.668, timestamp=1546500431000, createMicroTimestamp=1546500431668000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:27:17,572 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=ffc2dd60-0f28-11e9-90ba-893bbb3cc860, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500437558, properties={}, body={timestamp=1546500437558, version=1.1, tenantId=4, message={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, chatGroupId=111, sex=0, createDateTime=1545914633000, lastUpdateDateTime=1545914633000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=北京}, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=46, sessionServiceSeqId=3, createDateTime=1546500437484, timestamp=1546500437484, createMicroTimestamp=1546500437484000}, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, username=webim-visitor-632PMQ9WCH9BHBWP3MPG, techChannelType=easemob, techChannelId=16, techChannelInfo=9900181204028764#kefuchannelapp4#kefuchannelimid_569839, chatGroupId=111, sex=0, createDateTime=1545914633000, lastUpdateDateTime=1545914633000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=2, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionCreatedEvent, type=cmd}], ext={weichat={msgId=cbd74b8a-152d-46ab-b11b-d1781149103d, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500431668, timestamp=1546500431000, createMicroTimestamp=1546500431668000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:27:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:27 start
2019-01-03 15:27:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:27
2019-01-03 15:27:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:27 complete
2019-01-03 15:27:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:27:27,770 INFO  [kf-webapp-scheduler-pool-11]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 7ms
2019-01-03 15:27:29,060 INFO  [http-nio-8899-exec-6]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:29,101 INFO  [http-nio-8899-exec-2]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/12e26dbf-dc23-431e-a5b1-526e18d4a399/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages startId:4783 direction:before size:10
2019-01-03 15:27:30,215 INFO  [http-nio-8899-exec-10]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:4 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:27:30,380 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/12e26dbf-dc23-431e-a5b1-526e18d4a399/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages startId:4749 direction:before size:10
2019-01-03 15:27:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:27 start
2019-01-03 15:27:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:27
2019-01-03 15:27:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:27 complete
2019-01-03 15:27:42,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:27:55,953 WARN  [http-nio-8899-exec-13]  c.e.w.r.m.a.AuthenticationController - cloud not logout because invalid params tenantId:null userId:null fromMobile:false
2019-01-03 15:28:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:28 start
2019-01-03 15:28:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:28
2019-01-03 15:28:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:28 complete
2019-01-03 15:28:02,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:28:03,406 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.a.AuthenticationController - doLoginV6 command:kefutest2018@zking.com
2019-01-03 15:28:03,430 INFO  [http-nio-8899-exec-12]  c.easemob.weichat.rest.util.OrgUtils - checkUseWWW, www:kefurobottest2.zking.com, tenantId:4.
2019-01-03 15:28:03,465 INFO  [SimpleAsyncTaskExecutor-4]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:8d93d28f-31ee-4505-be83-4d1ded9ced71 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"AgentUserLogin","body":{"source":{},"timestamp":1546500483455,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userType":"Agent","userScope":"Tenant","nicename":"测试","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:24:58","lastUpdateDateTime":"2019-01-03 15:28:03","firstLoginTimeOfRecentDay":"2019-01-03 15:28:03","status":"Enable","state":"Online","maxServiceSessionCount":6,"trueName":"测试","mobilePhone":"","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},"eventTime":1546500483455,"ipAddress":"88.0.64.49","loginFromMobile":false,"kickOff":true}}],"timestamp":1546500483460,"type":null}
2019-01-03 15:28:03,465 INFO  [SimpleAsyncTaskExecutor-4]  c.e.w.n.service.PushDataService - prepare message noticeId:8d93d28f-31ee-4505-be83-4d1ded9ced71 messageType:AgentUserLogin path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:03,465 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"1b1e30f0-0f29-11e9-afb2-f937e79e30f7","type":"com.easemob.weichat.service.events.agent.AgentUserLoginEvent","timestamp":1546500483455,"body":{"source":{},"timestamp":1546500483455,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userType":"Agent","userScope":"Tenant","nicename":"测试","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:24:58","lastUpdateDateTime":"2019-01-03 15:28:03","firstLoginTimeOfRecentDay":"2019-01-03 15:28:03","status":"Enable","state":"Online","maxServiceSessionCount":6,"trueName":"测试","mobilePhone":"","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},"eventTime":1546500483455,"ipAddress":"88.0.64.49","loginFromMobile":false,"kickOff":true}} has been send to kafka with in topic events partition 3, current offset is 2940
2019-01-03 15:28:03,468 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"1b1ecd30-0f29-11e9-8839-9b599be4ec09","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500483459,"body":{"source":{},"timestamp":1546500483459,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"AgentUserLogin","body":{"source":{},"timestamp":1546500483455,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userType":"Agent","userScope":"Tenant","nicename":"测试","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:24:58","lastUpdateDateTime":"2019-01-03 15:28:03","firstLoginTimeOfRecentDay":"2019-01-03 15:28:03","status":"Enable","state":"Online","maxServiceSessionCount":6,"trueName":"测试","mobilePhone":"","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},"eventTime":1546500483455,"ipAddress":"88.0.64.49","loginFromMobile":false,"kickOff":true}}],"broadcast":false}}} has been send to kafka with in topic events partition 9, current offset is 2119
2019-01-03 15:28:03,468 INFO  [kafka-events-consumer-1-thread-13]  c.e.w.t.a.h.i.TenantAppAgentUserLoginEventHandler - Agent login NOT from mobile, will remove 4:aee4969c-c4a9-44d9-a1ba-453a07ac137a from Redis.
2019-01-03 15:28:03,469 INFO  [kafka-events-consumer-1-thread-13]  c.e.w.t.a.s.TenantAppMobileAgentService - Redis Doubble Write. Delete value 4:aee4969c-c4a9-44d9-a1ba-453a07ac137a from Redis set kf:tenantapp:agent:from-mobile.
2019-01-03 15:28:03,470 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=1b1e30f0-0f29-11e9-afb2-f937e79e30f7, service=null, type=com.easemob.weichat.service.events.agent.AgentUserLoginEvent, timestamp=1546500483455, properties={}, body={source={}, timestamp=1546500483455, actor=null, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userType=Agent, userScope=Tenant, nicename=测试, password=, username=kefutest2018@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:24:58, lastUpdateDateTime=2019-01-03 15:28:03, firstLoginTimeOfRecentDay=2019-01-03 15:28:03, status=Enable, state=Online, maxServiceSessionCount=6, trueName=测试, mobilePhone=, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, eventTime=1546500483455, ipAddress=88.0.64.49, loginFromMobile=false, kickOff=true}, topic=events, partitionKey=4:aee4969c-c4a9-44d9-a1ba-453a07ac137a).
2019-01-03 15:28:03,471 INFO  [kafka-events-consumer-1-thread-13]  c.e.w.t.a.h.i.TenantAppAgentUserLoginEventHandler - Write 4:aee4969c-c4a9-44d9-a1ba-453a07ac137a into Redis list kf:tenantapp:user:to-create.
2019-01-03 15:28:03,475 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=1b1ecd30-0f29-11e9-8839-9b599be4ec09, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500483459, properties={}, body={source={}, timestamp=1546500483459, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=AgentUserLogin, body={source={}, timestamp=1546500483455, actor=null, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userType=Agent, userScope=Tenant, nicename=测试, password=, username=kefutest2018@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:24:58, lastUpdateDateTime=2019-01-03 15:28:03, firstLoginTimeOfRecentDay=2019-01-03 15:28:03, status=Enable, state=Online, maxServiceSessionCount=6, trueName=测试, mobilePhone=, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, eventTime=1546500483455, ipAddress=88.0.64.49, loginFromMobile=false, kickOff=true}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:04,330 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotAgentIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:04 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@71bd094 
2019-01-03 15:28:04,336 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotAgentIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:04,340 ERROR [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 4, robotAgentId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:04,393 ERROR [http-nio-8899-exec-10]  c.e.w.rest.mvc.agent.HomeController - robotFeignClient getRobotUserById occur exception, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
com.easemob.weichat.models.exception.EasemobException: no available robot
	at com.easemob.weichat.service.robot.KefuRobotIntegrationUtil.getRobotUserById(KefuRobotIntegrationUtil.java:147)
	at com.easemob.weichat.rest.mvc.agent.HomeController.checkRobot(HomeController.java:115)
	at com.easemob.weichat.rest.mvc.agent.HomeController.getInitData(HomeController.java:71)
	at sun.reflect.GeneratedMethodAccessor1480.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:799)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:04,408 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"1baeb120-0f29-11e9-b9bd-d1bd370b139b","type":"com.easemob.weichat.service.events.agent.AgentInitDataEvent","timestamp":1546500484402,"body":{"source":{},"timestamp":1546500484402,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":null,"eventTime":1546500484402,"kickOff":true}} has been send to kafka with in topic events partition 3, current offset is 2941
2019-01-03 15:28:04,411 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=1baeb120-0f29-11e9-b9bd-d1bd370b139b, service=null, type=com.easemob.weichat.service.events.agent.AgentInitDataEvent, timestamp=1546500484402, properties={}, body={source={}, timestamp=1546500484402, actor={bizId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, roles=admin,agent}, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser=null, eventTime=1546500484402, kickOff=true}, topic=events, partitionKey=4:aee4969c-c4a9-44d9-a1ba-453a07ac137a).
2019-01-03 15:28:04,477 INFO  [http-nio-8899-exec-9]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1606}
2019-01-03 15:28:04,512 INFO  [http-nio-8899-exec-5]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, userResourceData : UserResourceData(method=GET, url=/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a)
2019-01-03 15:28:04,535 INFO  [http-nio-8899-exec-5]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, hasPermission : true
2019-01-03 15:28:04,583 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.a.v0.AgentsApiV0Controller - AccountController getAgentInfo start, params: tenantId=4,userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:04,588 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.a.v0.AgentsApiV0Controller - AccountController getAgentInfo end, result: tenantId=4,userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a,agentUserData=AgentUserData(agentId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, nickname=测试, username=kefutest2018@zking.com, trueName=测试, roles=admin,agent, createdAt=2018-11-26 21:24:58.0, updatedAt=2019-01-03 15:28:03.0, mobilePhone=, agentNumber=null, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, status=Enable, userType=Agent, language=zh_CN, timeZone=UTC+8)
2019-01-03 15:28:04,850 WARN  [kf-webapp-scheduler-pool-10]  c.e.w.t.a.s.TenantAppServiceManager - Failed to create IM user for agent user aee4969c-c4a9-44d9-a1ba-453a07ac137a, but don't worry, it will try to create IM user again when user do login next time.
2019-01-03 15:28:04,859 INFO  [http-nio-8899-exec-6]  c.e.w.r.permission.UsersController - queryResourceCategoriesByUser | obtain request, tenantId : 4 , userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:04,861 INFO  [http-nio-8899-exec-6]  c.e.w.r.permission.UsersController - queryResourceCategoriesByUser success, tenantId : 4 , userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, userResourceCategoryData : UserResourceCategoryData(userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, resourceCategories=[admin_team_site_management, admin_settings_routes, admin_statisticsagent, agent_search, admin_tickets_channelemail, agent_phrase, admin_qualityreview, admin_robot_rulai, admin_team_groups, admin_statisticsworkload_queue, admin_activity, agent_activity, admin_robot, agent_sessionhistory, admin_settings_qualitysettings, agent_quality_qualityrecord, admin_statisticsgreylist, admin_monitor_monitor, admin_customerinfo, admin_team_level, admin_settings_callback, admin_channel_weibo, admin_monitor_warningnotice, agent_customer, agent_currentsession, admin_settings_orderinfo, admin_index, admin_sessionhistory_all, admin_channel_slack, admin_tickets_applytickets, admin_settings_phrase, admin_settings_iframe, admin_settings_time_plan, admin_robot_material, admin_channel_rest, admin_tickets, admin_tickets_statistic, admin_currentsession_all, agent_case, admin_team_indivisual, admin_monitor, admin_settings_summary, admin_statisticsvisitor, admin_report, admin_quality, admin_tickets_basicconfig, admin_sessionhistory_crm, admin_member, admin_settings_sso, admin_tickets_channel, admin_tickets_sla, admin_statisticsworkload, admin_settings_questionnaire, agent_export, admin_channel_web, admin_marketing, admin_settings_evaluate, admin_statistic, agent_queue, admin_quality_qualityappeal, admin_voc, agent_statistics, admin_knowledgebase, admin_statisticswait, agent_quality, admin_tickets_status, agent_ticket, agent_agentinfo, admin_channel, admin_tickets_helptopic, agent_knowledgebase, admin_channel_app, admin_options, admin_settings_enterprise, admin_tickets_event, admin_tickets_email, admin_robot_thridparty, admin_quality_randomquality, admin_settings_notes, admin_settings_emoji, admin_grio, admin_search, admin_channel_call, admin_sessionhistory_quality, admin_approval_task, admin_sessionhistory_record, admin_sessionhistory_evaluate, admin_settings_reganswer, admin_monitor_supervision, admin_case, admin_settings_permission, admin_tickets_priority, agent_currentsession_emoji, admin_sessionhistory_iframe, agent_quality_appealrecord, admin_settings_visitors, admin_settings_tag, admin_tickets_forms, admin_tickets_trigger, admin_settings_system, admin_channel_wechat, admin_export, admin_tickets_satisfaction, admin_robot_settings])
2019-01-03 15:28:05,007 INFO  [kf-webapp-scheduler-pool-10]  c.e.w.t.a.d.EaseMobIMControlForOrg - Push certificates need to be uploaded: ios,xiaomi
2019-01-03 15:28:05,007 ERROR [kf-webapp-scheduler-pool-10]  c.e.w.t.a.d.EaseMobIMControlForOrg - Can not get contents of push certificate file.appName:4-app-7W3CVC9R9X,properties:{environment=PRODUCTION, file=/tmp/cert/ios/kefu_pro.p12, provider=APNS, name=push-cert-ios-20160229, passphrase=123456}
2019-01-03 15:28:05,007 WARN  [kf-webapp-scheduler-pool-10]  c.e.w.t.a.s.TenantAppServiceManager - Failed to upload push certificates for app easemobkefu#4-app-7W3CVC9R9X, but don't worry, it will try to upload again when user do login next time.
2019-01-03 15:28:05,142 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.agent.AgentQueueController - /v1/tenants/4/skillgroups page:0, size:null, isIncludeAgents:false
2019-01-03 15:28:05,154 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.agent.AgentQueueController - /v1/tenants/{tenantId}/skillgroups queueName:null,pageObj:Page 1 of 1 containing com.easemob.weichat.models.entity.AgentQueue instances
2019-01-03 15:28:05,196 INFO  [http-nio-8899-exec-10]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1393}
2019-01-03 15:28:05,219 INFO  [http-nio-8899-exec-9]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, userResourceData : UserResourceData(method=GET, url=/tenants/4)
2019-01-03 15:28:05,241 INFO  [http-nio-8899-exec-9]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, hasPermission : true
2019-01-03 15:28:05,291 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.a.v.TenantsApiV0Controller - /tenants/4  GET end: tenantData:TenantData(name=紫金财产保险股份有限公司, description=, phone=+8618625569898, address=江苏省南京市建邺区江东中路371号金融城8号楼紫金保险大厦, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, logo=null, agentMaxNum=0, agentMaxOnlineNum=null, agentMaxEnableNum=null, domain=null, grade=STANDARD, isExperience=null, language=zh_CN, timeZone=UTC+8, status=Enable, createAt=2018-11-20 17:43:21.0, updateAt=2018-12-26 10:29:53.0, agreementExpireTime=null).
2019-01-03 15:28:05,544 INFO  [http-nio-8899-exec-13]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1348}
2019-01-03 15:28:05,804 ERROR [http-nio-8899-exec-12]  o.s.w.s.s.s.DefaultHandshakeHandler - Handshake failed due to invalid Upgrade header: null
2019-01-03 15:28:05,872 INFO  [http-nio-8899-exec-3]  c.e.w.n.handler.MainHandler - session connected wsId:l3w4xfrg count:1
2019-01-03 15:28:06,797 INFO  [kf-webapp-scheduler-pool-13]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:28:06,798 INFO  [kf-webapp-scheduler-pool-13]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:28:06,810 INFO  [http-nio-8899-exec-9]  c.e.w.n.handler.MainHandler - session connected wsId:qlqmrlb0 count:2
2019-01-03 15:28:07,110 INFO  [http-nio-8899-exec-15]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":8653}
2019-01-03 15:28:07,196 INFO  [http-nio-8899-exec-9]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1414}
2019-01-03 15:28:07,206 INFO  [http-nio-8899-exec-3]  c.e.w.r.mvc.tenant.TenantController - TenantController | getExpireData start. tenantId:4
2019-01-03 15:28:07,211 WARN  [hystrix-KFRulai-50]  c.e.w.s.r.u.f.RulaiFeignClient$HystrixClientFallback - RulaiFeignClient method getState with param easemob_4 fallback
2019-01-03 15:28:07,211 INFO  [http-nio-8899-exec-3]  c.e.w.r.mvc.tenant.TenantController - TenantController | getExpireData end. tenantId:4,map:{}
2019-01-03 15:28:07,272 INFO  [http-nio-8899-exec-5]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1361}
2019-01-03 15:28:08,151 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotAgentIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:08 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@10f4a703 
2019-01-03 15:28:08,152 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotAgentIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:08,154 ERROR [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 4, robotAgentId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:08,188 ERROR [http-nio-8899-exec-15]  c.e.w.rest.mvc.agent.HomeController - robotFeignClient getRobotUserById occur exception, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
com.easemob.weichat.models.exception.EasemobException: no available robot
	at com.easemob.weichat.service.robot.KefuRobotIntegrationUtil.getRobotUserById(KefuRobotIntegrationUtil.java:147)
	at com.easemob.weichat.rest.mvc.agent.HomeController.checkRobot(HomeController.java:115)
	at com.easemob.weichat.rest.mvc.agent.HomeController.getInitData(HomeController.java:71)
	at sun.reflect.GeneratedMethodAccessor1480.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:105)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:478)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:799)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:08,205 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"1df1ea60-0f29-11e9-874e-8190c82109ee","type":"com.easemob.weichat.service.events.agent.AgentInitDataEvent","timestamp":1546500488198,"body":{"source":{},"timestamp":1546500488198,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":null,"eventTime":1546500488198,"kickOff":true}} has been send to kafka with in topic events partition 3, current offset is 2942
2019-01-03 15:28:08,207 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=1df1ea60-0f29-11e9-874e-8190c82109ee, service=null, type=com.easemob.weichat.service.events.agent.AgentInitDataEvent, timestamp=1546500488198, properties={}, body={source={}, timestamp=1546500488198, actor={bizId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, roles=admin,agent}, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser=null, eventTime=1546500488198, kickOff=true}, topic=events, partitionKey=4:aee4969c-c4a9-44d9-a1ba-453a07ac137a).
2019-01-03 15:28:08,288 INFO  [http-nio-8899-exec-2]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1334}
2019-01-03 15:28:08,313 INFO  [http-nio-8899-exec-6]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, userResourceData : UserResourceData(method=GET, url=/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a)
2019-01-03 15:28:08,333 INFO  [http-nio-8899-exec-6]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, hasPermission : true
2019-01-03 15:28:08,369 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.a.v0.AgentsApiV0Controller - AccountController getAgentInfo start, params: tenantId=4,userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:08,375 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.a.v0.AgentsApiV0Controller - AccountController getAgentInfo end, result: tenantId=4,userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a,agentUserData=AgentUserData(agentId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, nickname=测试, username=kefutest2018@zking.com, trueName=测试, roles=admin,agent, createdAt=2018-11-26 21:24:58.0, updatedAt=2019-01-03 15:28:03.0, mobilePhone=, agentNumber=null, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, status=Enable, userType=Agent, language=zh_CN, timeZone=UTC+8)
2019-01-03 15:28:08,623 INFO  [http-nio-8899-exec-12]  c.e.w.r.permission.UsersController - queryResourceCategoriesByUser | obtain request, tenantId : 4 , userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:08,625 INFO  [http-nio-8899-exec-12]  c.e.w.r.permission.UsersController - queryResourceCategoriesByUser success, tenantId : 4 , userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, userResourceCategoryData : UserResourceCategoryData(userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, resourceCategories=[admin_team_site_management, admin_settings_routes, admin_statisticsagent, agent_search, admin_tickets_channelemail, agent_phrase, admin_qualityreview, admin_robot_rulai, admin_team_groups, admin_statisticsworkload_queue, admin_activity, agent_activity, admin_robot, agent_sessionhistory, admin_settings_qualitysettings, agent_quality_qualityrecord, admin_statisticsgreylist, admin_monitor_monitor, admin_customerinfo, admin_team_level, admin_settings_callback, admin_channel_weibo, admin_monitor_warningnotice, agent_customer, agent_currentsession, admin_settings_orderinfo, admin_index, admin_sessionhistory_all, admin_channel_slack, admin_tickets_applytickets, admin_settings_phrase, admin_settings_iframe, admin_settings_time_plan, admin_robot_material, admin_channel_rest, admin_tickets, admin_tickets_statistic, admin_currentsession_all, agent_case, admin_team_indivisual, admin_monitor, admin_settings_summary, admin_statisticsvisitor, admin_report, admin_quality, admin_tickets_basicconfig, admin_sessionhistory_crm, admin_member, admin_settings_sso, admin_tickets_channel, admin_tickets_sla, admin_statisticsworkload, admin_settings_questionnaire, agent_export, admin_channel_web, admin_marketing, admin_settings_evaluate, admin_statistic, agent_queue, admin_quality_qualityappeal, admin_voc, agent_statistics, admin_knowledgebase, admin_statisticswait, agent_quality, admin_tickets_status, agent_ticket, agent_agentinfo, admin_channel, admin_tickets_helptopic, agent_knowledgebase, admin_channel_app, admin_options, admin_settings_enterprise, admin_tickets_event, admin_tickets_email, admin_robot_thridparty, admin_quality_randomquality, admin_settings_notes, admin_settings_emoji, admin_grio, admin_search, admin_channel_call, admin_sessionhistory_quality, admin_approval_task, admin_sessionhistory_record, admin_sessionhistory_evaluate, admin_settings_reganswer, admin_monitor_supervision, admin_case, admin_settings_permission, admin_tickets_priority, agent_currentsession_emoji, admin_sessionhistory_iframe, agent_quality_appealrecord, admin_settings_visitors, admin_settings_tag, admin_tickets_forms, admin_tickets_trigger, admin_settings_system, admin_channel_wechat, admin_export, admin_tickets_satisfaction, admin_robot_settings])
2019-01-03 15:28:08,861 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.agent.AgentQueueController - /v1/tenants/4/skillgroups page:0, size:null, isIncludeAgents:false
2019-01-03 15:28:08,870 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.agent.AgentQueueController - /v1/tenants/{tenantId}/skillgroups queueName:null,pageObj:Page 1 of 1 containing com.easemob.weichat.models.entity.AgentQueue instances
2019-01-03 15:28:08,899 INFO  [http-nio-8899-exec-15]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1437}
2019-01-03 15:28:08,919 INFO  [http-nio-8899-exec-2]  c.e.w.r.p.UserInternalController - checkUserResources | obtain request, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, userResourceData : UserResourceData(method=GET, url=/tenants/4)
2019-01-03 15:28:08,937 INFO  [http-nio-8899-exec-2]  c.e.w.r.p.UserInternalController - checkUserResources end, tenantId : 4, userId : aee4969c-c4a9-44d9-a1ba-453a07ac137a, hasPermission : true
2019-01-03 15:28:08,971 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.a.v.TenantsApiV0Controller - /tenants/4  GET end: tenantData:TenantData(name=紫金财产保险股份有限公司, description=, phone=+8618625569898, address=江苏省南京市建邺区江东中路371号金融城8号楼紫金保险大厦, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, logo=null, agentMaxNum=0, agentMaxOnlineNum=null, agentMaxEnableNum=null, domain=null, grade=STANDARD, isExperience=null, language=zh_CN, timeZone=UTC+8, status=Enable, createAt=2018-11-20 17:43:21.0, updateAt=2018-12-26 10:29:53.0, agreementExpireTime=null).
2019-01-03 15:28:09,157 INFO  [http-nio-8899-exec-5]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1309}
2019-01-03 15:28:09,392 ERROR [http-nio-8899-exec-2]  o.s.w.s.s.s.DefaultHandshakeHandler - Handshake failed due to invalid Upgrade header: null
2019-01-03 15:28:09,611 INFO  [http-nio-8899-exec-6]  c.e.w.n.handler.MainHandler - session connected wsId:xlkij3aa count:3
2019-01-03 15:28:09,900 INFO  [http-nio-8899-exec-12]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1304}
2019-01-03 15:28:09,902 INFO  [http-nio-8899-exec-5]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1881}
2019-01-03 15:28:09,904 INFO  [http-nio-8899-exec-10]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1491}
2019-01-03 15:28:09,905 INFO  [http-nio-8899-exec-3]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1463}
2019-01-03 15:28:09,938 INFO  [http-nio-8899-exec-13]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1299}
2019-01-03 15:28:09,991 INFO  [http-nio-8899-exec-14]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1274}
2019-01-03 15:28:09,997 INFO  [http-nio-8899-exec-2]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1269}
2019-01-03 15:28:09,997 INFO  [http-nio-8899-exec-15]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1222}
2019-01-03 15:28:09,998 INFO  [http-nio-8899-exec-6]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1430}
2019-01-03 15:28:10,012 INFO  [http-nio-8899-exec-9]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1340}
2019-01-03 15:28:10,047 INFO  [http-nio-8899-exec-12]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1335}
2019-01-03 15:28:10,086 INFO  [http-nio-8899-exec-5]  c.e.w.a.rest.AuthController - authenticateBySession, session:2cabbc92-1112-4ff5-a10e-99fce8658848, response:{"status":true,"entity":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"}}, cost:{"total":1332}
2019-01-03 15:28:10,376 INFO  [http-nio-8899-exec-10]  c.e.w.n.handler.MainHandler - session connected wsId:nkaummna count:4
2019-01-03 15:28:11,695 INFO  [http-nio-8899-exec-13]  c.e.w.n.handler.MainHandler - session connected wsId:3k4kkqrs count:5
2019-01-03 15:28:11,851 INFO  [http-nio-8899-exec-14]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/tenants/4/configs
2019-01-03 15:28:11,961 INFO  [http-nio-8899-exec-15]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/tenants/4/configs/712e5810-2015-4802-b00e-0f5714ebbad0
2019-01-03 15:28:12,794 INFO  [http-nio-8899-exec-10]  c.e.w.n.handler.MainHandler - session connected wsId:xjpxh544 count:6
2019-01-03 15:28:12,947 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.impl.StrangerSessionFSM - StrangerSessionFSM wsId:xjpxh544 handleMessage:{"token":"2cabbc92-1112-4ff5-a10e-99fce8658848"}
2019-01-03 15:28:13,113 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthenticatedSessionFSM - AuthenticatedSessionFSM wsId:xjpxh544 handleMessage:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:13,116 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.AmqpService - declare queue wsId:xjpxh544 name:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296
2019-01-03 15:28:13,121 INFO  [consumer-kf:pool:agentstate-19-thread-1]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent aee4969c-c4a9-44d9-a1ba-453a07ac137a connected, workstate Online ttl:-2
2019-01-03 15:28:13,121 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"20e07ed0-0f29-11e9-a58a-bfc1abef0f08","type":"com.easemob.weichat.service.events.agent.AgentUserConnectedEvent","timestamp":1546500493117,"body":{"source":{},"timestamp":1546500493117,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":null,"eventTime":1546500493117,"kickOff":true}} has been send to kafka with in topic events partition 3, current offset is 2943
2019-01-03 15:28:13,141 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.AmqpService - declare binding wsId:xjpxh544 queueName:Queue [name=/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296, durable=false, autoDelete=false, exclusive=false, arguments={x-expires=30000}] routingKey:tenants.4.agents
2019-01-03 15:28:13,143 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=20e07ed0-0f29-11e9-a58a-bfc1abef0f08, service=null, type=com.easemob.weichat.service.events.agent.AgentUserConnectedEvent, timestamp=1546500493117, properties={}, body={source={}, timestamp=1546500493117, actor=null, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser=null, eventTime=1546500493117, kickOff=true}, topic=events, partitionKey=4:aee4969c-c4a9-44d9-a1ba-453a07ac137a).
2019-01-03 15:28:13,151 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.AmqpService - declare binding wsId:xjpxh544 queueName:Queue [name=/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296, durable=false, autoDelete=false, exclusive=false, arguments={x-expires=30000}] routingKey:tenants.4.agents.aee4969c-c4a9-44d9-a1ba-453a07ac137a.#
2019-01-03 15:28:13,672 INFO  [http-nio-8899-exec-10]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/tenants/4/configs/b88b97a9-aed6-4b18-ac92-fd566addf0e8
2019-01-03 15:28:14,308 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:14,315 INFO  [consumer-kf:pool:agentstate-19-thread-1]  c.e.w.c.s.a.s.l.AgentConnListener - AgentStateListener log : agent aee4969c-c4a9-44d9-a1ba-453a07ac137a keepalive, workstate Online
2019-01-03 15:28:14,322 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"219772c0-0f29-11e9-b6f6-e310d655f04b","type":"com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent","timestamp":1546500494316,"body":{"source":{},"timestamp":1546500494316,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userType":"Agent","userScope":"Tenant","nicename":"测试","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:24:58","lastUpdateDateTime":"2019-01-03 15:28:03","firstLoginTimeOfRecentDay":"2019-01-03 15:28:03","status":"Enable","state":"Online","maxServiceSessionCount":6,"trueName":"测试","mobilePhone":"","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},"eventTime":1546500494316,"status":"Online","kickOff":true}} has been send to kafka with in topic events partition 3, current offset is 2944
2019-01-03 15:28:14,325 INFO  [kafka-events-consumer-1-thread-13]  c.e.w.s.m.s.i.h.AgentUserStateChangedEventHandler - systemMessage get AgentUserStateChangedEvent,userId:aee4969c-c4a9-44d9-a1ba-453a07ac137a,agentState:Online
2019-01-03 15:28:14,327 INFO  [kafka-events-consumer-1-thread-13]  c.e.w.r.m.AgentUserStateChangedEventConsumer - convert to event AgentUserStateChangedEvent : agent user [tenantId = 4, userId = aee4969c-c4a9-44d9-a1ba-453a07ac137a] status changed to Online
2019-01-03 15:28:14,331 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=219772c0-0f29-11e9-b6f6-e310d655f04b, service=null, type=com.easemob.weichat.service.events.agent.AgentUserStateChangedEvent, timestamp=1546500494316, properties={}, body={source={}, timestamp=1546500494316, actor=null, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userType=Agent, userScope=Tenant, nicename=测试, password=, username=kefutest2018@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:24:58, lastUpdateDateTime=2019-01-03 15:28:03, firstLoginTimeOfRecentDay=2019-01-03 15:28:03, status=Enable, state=Online, maxServiceSessionCount=6, trueName=测试, mobilePhone=, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, eventTime=1546500494316, status=Online, kickOff=true}, topic=events, partitionKey=4:aee4969c-c4a9-44d9-a1ba-453a07ac137a).
2019-01-03 15:28:14,332 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"21992070-0f29-11e9-91a9-2b34ef0b8b57","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500494327,"body":{"source":{},"timestamp":1546500494327,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4},"messages":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546500494316,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userType":"Agent","userScope":"Tenant","nicename":"测试","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:24:58","lastUpdateDateTime":"2019-01-03 15:28:03","firstLoginTimeOfRecentDay":"2019-01-03 15:28:03","status":"Enable","state":"Online","maxServiceSessionCount":6,"trueName":"测试","mobilePhone":"","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},"eventTime":1546500494316,"status":"Online","kickOff":true}}],"broadcast":true}}} has been send to kafka with in topic events partition 18, current offset is 2563
2019-01-03 15:28:14,333 INFO  [SimpleAsyncTaskExecutor-19]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:05d66219-f55f-4196-a465-236926677976 message:{"path":"/tenants/4/agents","key":null,"payload":[{"messageType":"AgentUserStateChange","body":{"source":{},"timestamp":1546500494316,"actor":null,"version":"1.1","tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"agentUser":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","userType":"Agent","userScope":"Tenant","nicename":"测试","password":"","username":"kefutest2018@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:24:58","lastUpdateDateTime":"2019-01-03 15:28:03","firstLoginTimeOfRecentDay":"2019-01-03 15:28:03","status":"Enable","state":"Online","maxServiceSessionCount":6,"trueName":"测试","mobilePhone":"","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},"eventTime":1546500494316,"status":"Online","kickOff":true}}],"timestamp":1546500494328,"type":null}
2019-01-03 15:28:14,333 INFO  [SimpleAsyncTaskExecutor-19]  c.e.w.n.service.PushDataService - prepare message noticeId:05d66219-f55f-4196-a465-236926677976 messageType:AgentUserStateChange path:/tenants/4/agents
2019-01-03 15:28:14,334 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=21992070-0f29-11e9-91a9-2b34ef0b8b57, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500494327, properties={}, body={source={}, timestamp=1546500494327, actor=null, version=1.1, queueMessageData={userPK={tenantId=4}, messages=[{messageType=AgentUserStateChange, body={source={}, timestamp=1546500494316, actor=null, version=1.1, tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, agentUser={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, userType=Agent, userScope=Tenant, nicename=测试, password=, username=kefutest2018@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:24:58, lastUpdateDateTime=2019-01-03 15:28:03, firstLoginTimeOfRecentDay=2019-01-03 15:28:03, status=Enable, state=Online, maxServiceSessionCount=6, trueName=测试, mobilePhone=, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, eventTime=1546500494316, status=Online, kickOff=true}}], broadcast=true}}, topic=events, partitionKey=null)
2019-01-03 15:28:14,337 WARN  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - agent not in skillgroup rank tenantId:4 skillGroupId:14 agentId:aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:14,341 WARN  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - no free agent in skillgroup tenantId:4 skillGroupId:14
2019-01-03 15:28:14,345 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:05d66219-f55f-4196-a465-236926677976 messageType:AgentUserStateChange
2019-01-03 15:28:14,346 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:05d66219-f55f-4196-a465-236926677976
2019-01-03 15:28:14,446 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"05d66219-f55f-4196-a465-236926677976"}
2019-01-03 15:28:14,446 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:05d66219-f55f-4196-a465-236926677976
2019-01-03 15:28:14,578 INFO  [http-nio-8899-exec-9]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","tenantId":4,"type":"StateChange"}}],"timestamp":1546500494560,"type":null}
2019-01-03 15:28:14,578 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:7eeda169-c60a-439e-a80f-65eb1f34ba22 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","tenantId":4,"type":"StateChange"}}],"timestamp":1546500494560,"type":null}
2019-01-03 15:28:14,578 INFO  [http-nio-8899-exec-9]  c.e.w.n.service.PushDataService - prepare message noticeId:7eeda169-c60a-439e-a80f-65eb1f34ba22 messageType:Daas path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:14,581 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:7eeda169-c60a-439e-a80f-65eb1f34ba22 messageType:Daas
2019-01-03 15:28:14,582 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:7eeda169-c60a-439e-a80f-65eb1f34ba22
2019-01-03 15:28:14,662 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"7eeda169-c60a-439e-a80f-65eb1f34ba22"}
2019-01-03 15:28:14,662 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:7eeda169-c60a-439e-a80f-65eb1f34ba22
2019-01-03 15:28:16,327 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:16,363 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[{"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","agentUserId":null}]
2019-01-03 15:28:16,375 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.s.ServiceSessionTransferManager - schedule answer for pre-schedule tenantId:4 agentUserId:aee4969c-c4a9-44d9-a1ba-453a07ac137a serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050 transferToAgent:false force:false scheduleId:null fromQueueId:null toQueueId:null time:null finishAck:false
2019-01-03 15:28:16,376 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionPreScheduleEvent sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,387 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:e0c6d5a1-b9a2-475e-9e64-5527e22a3d1a message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"Schedule","body":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","toAgentUserType":"Agent","toAgentQueueId":null,"easemobMessage":null}}],"timestamp":1546500496381,"type":null}
2019-01-03 15:28:16,387 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.PushDataService - prepare message noticeId:e0c6d5a1-b9a2-475e-9e64-5527e22a3d1a messageType:Schedule path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:16,387 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22d1c780-0f29-11e9-bc6c-a92259b5a13f","type":"com.easemob.weichat.service.events.session.ServiceSessionPreScheduleEvent","timestamp":1546500496376,"body":{"source":{},"timestamp":1546500496375,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"easemobMessage":null,"preScheduleData":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","toAgentUserType":"Agent","toAgentQueueId":null,"easemobMessage":null}}} has been send to kafka with in topic events partition 11, current offset is 1905
2019-01-03 15:28:16,390 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:e0c6d5a1-b9a2-475e-9e64-5527e22a3d1a messageType:Schedule
2019-01-03 15:28:16,393 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22d263c0-0f29-11e9-91d2-f7f93a616855","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496380,"body":{"source":{},"timestamp":1546500496380,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"Schedule","body":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","toAgentUserType":"Agent","toAgentQueueId":null,"easemobMessage":null}}],"broadcast":false}}} has been send to kafka with in topic events partition 12, current offset is 2507
2019-01-03 15:28:16,394 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:e0c6d5a1-b9a2-475e-9e64-5527e22a3d1a
2019-01-03 15:28:16,394 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=22d1c780-0f29-11e9-bc6c-a92259b5a13f, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionPreScheduleEvent, timestamp=1546500496376, properties={}, body={source={}, timestamp=1546500496375, actor=null, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=3, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}, easemobMessage=null, preScheduleData={scheduleType=Schedule, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=3, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, toAgentUserType=Agent, toAgentQueueId=null, easemobMessage=null}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:28:16,399 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22d263c0-0f29-11e9-91d2-f7f93a616855, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496380, properties={}, body={source={}, timestamp=1546500496380, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=Schedule, body={scheduleType=Schedule, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=3, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, toAgentUserType=Agent, toAgentQueueId=null, easemobMessage=null}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,507 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"e0c6d5a1-b9a2-475e-9e64-5527e22a3d1a"}
2019-01-03 15:28:16,508 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:e0c6d5a1-b9a2-475e-9e64-5527e22a3d1a
2019-01-03 15:28:16,532 INFO  [http-nio-8899-exec-12]  c.e.w.s.s.ServiceSessionTransferManager - pre-schedule ack agentUserId:aee4969c-c4a9-44d9-a1ba-453a07ac137a answer:true data:{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","toAgentUserType":"Agent","toAgentQueueId":null,"easemobMessage":null}
2019-01-03 15:28:16,532 INFO  [http-nio-8899-exec-12]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionPreScheduleAckedEvent sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,539 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22e99540-0f29-11e9-8cbc-b72e28353930","type":"com.easemob.weichat.service.events.session.ServiceSessionPreScheduleAckedEvent","timestamp":1546500496532,"body":{"source":{},"timestamp":1546500496532,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"easemobMessage":null,"preScheduleData":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Wait","chatGroupId":111,"messageSeqId":3,"agentUserType":1,"createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","toAgentUserType":"Agent","toAgentQueueId":null,"easemobMessage":null},"answer":true}} has been send to kafka with in topic events partition 11, current offset is 1906
2019-01-03 15:28:16,543 INFO  [http-nio-8899-exec-12]  c.e.w.s.s.ServiceSessionTransferManager - schedule answer for schedule tenantId:4 agentUserId:aee4969c-c4a9-44d9-a1ba-453a07ac137a serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050 transferToAgent:false force:false scheduleId:null fromQueueId:14 toQueueId:null time:null finishAck:true
2019-01-03 15:28:16,545 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=22e99540-0f29-11e9-8cbc-b72e28353930, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionPreScheduleAckedEvent, timestamp=1546500496532, properties={}, body={source={}, timestamp=1546500496532, actor={bizId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, roles=admin,agent}, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=3, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}, easemobMessage=null, preScheduleData={scheduleType=Schedule, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Wait, chatGroupId=111, messageSeqId=3, agentUserType=1, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, toAgentUserType=Agent, toAgentQueueId=null, easemobMessage=null}, answer=true}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:28:16,588 INFO  [http-nio-8899-exec-12]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionOpenedEvent sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,593 INFO  [SimpleAsyncTaskExecutor-4225]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionOpenedEvent, sessionId:200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:28:16,594 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22f220c0-0f29-11e9-ad71-995cdb58ec69","type":"com.easemob.weichat.service.events.session.ServiceSessionOpenedEvent","timestamp":1546500496588,"body":{"source":{},"timestamp":1546500496588,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"scheduleId":null,"kickOff":true}} has been send to kafka with in topic events partition 11, current offset is 1907
2019-01-03 15:28:16,595 INFO  [http-nio-8899-exec-12]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:28:16,595 INFO  [SimpleAsyncTaskExecutor-4225]  c.e.w.s.p.h.ServiceSessionEventHandler - updated session ProcessingSession(tenantId=4, sessionId=200175ef-5064-40bf-a836-667a8c2b4050, skillGroupId=14, state=Processing, chatGroupId=111, createDateTime=2019-01-03 15:27:11.298, startDateTime=Thu Jan 03 15:28:16 CST 2019, originType=webim, fromAgentCallback=false, channelId=16, channelType=easemob, channelName=网站, agentId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentNickName=测试, agentType=1, visitorId=12e26dbf-dc23-431e-a5b1-526e18d4a399, visitorNickName=webim-visitor-632PMQ9WCH9BHBWP3MPG, visitorUserName=webim-visitor-632PMQ9WCH9BHBWP3MPG, customerId=56488882-350f-4fe1-9b02-7a3410094728, customerNickName=webim-visitor-632PMQ9WCH9BHBWP3MPG, customerTrueName=null) when got ServiceSessionOpenedEvent.
2019-01-03 15:28:16,596 INFO  [SimpleAsyncTaskExecutor-4225]  c.e.w.s.p.h.ServiceSessionEventHandler - begin to persist customer 56488882-350f-4fe1-9b02-7a3410094728 tags from crm for session 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:28:16,596 INFO  [SimpleAsyncTaskExecutor-4226]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionOpenedEvent event:agent user [tenantId = 4scheduleId=null, userId = aee4969c-c4a9-44d9-a1ba-453a07ac137a] opened servicesession 200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,600 INFO  [SimpleAsyncTaskExecutor-4228]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log : service session 200175ef-5064-40bf-a836-667a8c2b4050 opened to agent aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:16,667 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22f41c90-0f29-11e9-94ad-d37c4385043b","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496601,"body":{"source":{},"timestamp":1546500496601,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 3, current offset is 2945
2019-01-03 15:28:16,667 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22f443a0-0f29-11e9-b1f5-f761f93ab3ad","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496602,"body":{"source":{},"timestamp":1546500496602,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"da4dc75e-96c6-4b3b-9811-1fe29a7859f8"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 6, current offset is 2176
2019-01-03 15:28:16,667 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22f443aa-0f29-11e9-bc8f-4f97f14dc487","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496602,"body":{"source":{},"timestamp":1546500496602,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"143780ab-a30c-42f5-9ad8-55c3afade15d"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 15, current offset is 2476
2019-01-03 15:28:16,668 INFO  [SimpleAsyncTaskExecutor-8]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5765fea9-2f9f-425b-8d84-0f051f8c2011 message:{"path":"/tenants/4/agents/143780ab-a30c-42f5-9ad8-55c3afade15d","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496602,"type":null}
2019-01-03 15:28:16,668 INFO  [SimpleAsyncTaskExecutor-8]  c.e.w.n.service.PushDataService - prepare message noticeId:5765fea9-2f9f-425b-8d84-0f051f8c2011 messageType:VisitUserWaitingListChange path:/tenants/4/agents/143780ab-a30c-42f5-9ad8-55c3afade15d
2019-01-03 15:28:16,669 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22f41c90-0f29-11e9-94ad-d37c4385043b, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496601, properties={}, body={source={}, timestamp=1546500496601, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,667 INFO  [SimpleAsyncTaskExecutor-17]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:43e3ed28-02f4-4528-bca4-dafca33be5b2 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496601,"type":null}
2019-01-03 15:28:16,667 INFO  [SimpleAsyncTaskExecutor-18]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:75f7a155-7a08-445d-8677-ec314f4c335a message:{"path":"/tenants/4/agents/da4dc75e-96c6-4b3b-9811-1fe29a7859f8","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496602,"type":null}
2019-01-03 15:28:16,669 INFO  [SimpleAsyncTaskExecutor-17]  c.e.w.n.service.PushDataService - prepare message noticeId:43e3ed28-02f4-4528-bca4-dafca33be5b2 messageType:VisitUserWaitingListChange path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:16,668 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22f46ab0-0f29-11e9-a91a-31524fa2cc31","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496603,"body":{"source":{},"timestamp":1546500496603,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"436a6dca-bdde-4c31-a0b1-585e97eb5507"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 0, current offset is 2288
2019-01-03 15:28:16,670 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:b37ca2d3-52d2-4e31-8bf6-f7c0e6eeef6b message:{"path":"/tenants/4/agents/281848c3-2b84-4604-8fd3-09daa5611ef8","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496668,"type":null}
2019-01-03 15:28:16,670 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - prepare message noticeId:b37ca2d3-52d2-4e31-8bf6-f7c0e6eeef6b messageType:VisitUserWaitingListChange path:/tenants/4/agents/281848c3-2b84-4604-8fd3-09daa5611ef8
2019-01-03 15:28:16,668 INFO  [SimpleAsyncTaskExecutor-16]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:0c8ba563-b80c-48b2-b9d8-687526f0e2b8 message:{"path":"/tenants/4/agents/436a6dca-bdde-4c31-a0b1-585e97eb5507","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496603,"type":null}
2019-01-03 15:28:16,668 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 200175ef-5064-40bf-a836-667a8c2b4050.
2019-01-03 15:28:16,670 INFO  [SimpleAsyncTaskExecutor-16]  c.e.w.n.service.PushDataService - prepare message noticeId:0c8ba563-b80c-48b2-b9d8-687526f0e2b8 messageType:VisitUserWaitingListChange path:/tenants/4/agents/436a6dca-bdde-4c31-a0b1-585e97eb5507
2019-01-03 15:28:16,668 WARN  [http-nio-8899-exec-12]  c.e.w.s.t.SendTimeoutEventService - clear silence timeout notify count key kf:silence:timeout:session.notify.count:4:200175ef-5064-40bf-a836-667a8c2b4050 has something wrong
2019-01-03 15:28:16,669 INFO  [SimpleAsyncTaskExecutor-18]  c.e.w.n.service.PushDataService - prepare message noticeId:75f7a155-7a08-445d-8677-ec314f4c335a messageType:VisitUserWaitingListChange path:/tenants/4/agents/da4dc75e-96c6-4b3b-9811-1fe29a7859f8
2019-01-03 15:28:16,670 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:2e5e558c-e8df-4f73-b28d-56d20b8ad792 message:{"path":"/tenants/4/agents/779a9b78-8436-4bf2-9d12-361f78710e25","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496667,"type":null}
2019-01-03 15:28:16,671 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - prepare message noticeId:2e5e558c-e8df-4f73-b28d-56d20b8ad792 messageType:VisitUserWaitingListChange path:/tenants/4/agents/779a9b78-8436-4bf2-9d12-361f78710e25
2019-01-03 15:28:16,671 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22f46aba-0f29-11e9-b187-7195ff492056","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496667,"body":{"source":{},"timestamp":1546500496603,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"779a9b78-8436-4bf2-9d12-361f78710e25"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 8, current offset is 2487
2019-01-03 15:28:16,671 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionOpenedEvent serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050,queueId:14
2019-01-03 15:28:16,672 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2019-01-03 15:28:16,674 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionOpenedEventHandler - systemMessage get ServiceSessionOpenedEvent serviceSessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,674 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fe7cda-0f29-11e9-97d5-2dd3ca0ab878","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496669,"body":{"source":{},"timestamp":1546500496669,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"3d75dc9d-145a-49ab-9579-c35e410584a6"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 5, current offset is 2104
2019-01-03 15:28:16,674 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22f46ab0-0f29-11e9-a91a-31524fa2cc31, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496603, properties={}, body={source={}, timestamp=1546500496603, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=436a6dca-bdde-4c31-a0b1-585e97eb5507}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,675 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fe55ca-0f29-11e9-8e2a-677eac9352ba","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496668,"body":{"source":{},"timestamp":1546500496668,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"84620ad2-ad5e-42d5-978b-ef76c0c74cf1"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 11, current offset is 1908
2019-01-03 15:28:16,675 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fea3e0-0f29-11e9-a9f1-33bb836febcc","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496670,"body":{"source":{},"timestamp":1546500496669,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"ade55cfb-8328-431a-9b9d-800122e82078"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 14, current offset is 2252
2019-01-03 15:28:16,675 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22f46aba-0f29-11e9-b187-7195ff492056, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496667, properties={}, body={source={}, timestamp=1546500496603, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=779a9b78-8436-4bf2-9d12-361f78710e25}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,676 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fe55c0-0f29-11e9-ba74-4104815635aa","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496668,"body":{"source":{},"timestamp":1546500496667,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"281848c3-2b84-4604-8fd3-09daa5611ef8"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 17, current offset is 2297
2019-01-03 15:28:16,675 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22f443aa-0f29-11e9-bc8f-4f97f14dc487, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496602, properties={}, body={source={}, timestamp=1546500496602, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=143780ab-a30c-42f5-9ad8-55c3afade15d}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,675 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22f443a0-0f29-11e9-b1f5-f761f93ab3ad, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496602, properties={}, body={source={}, timestamp=1546500496602, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=da4dc75e-96c6-4b3b-9811-1fe29a7859f8}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,676 INFO  [http-nio-8899-exec-12]  c.e.w.s.t.SendTimeoutEventService - set silence timeout notify count key kf:silence:timeout:session.notify.count:4:200175ef-5064-40bf-a836-667a8c2b4050 for serviceSession 200175ef-5064-40bf-a836-667a8c2b4050 notify count is 1 , value is 2
2019-01-03 15:28:16,677 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fe7cd0-0f29-11e9-87b8-29da3acedbbb","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496669,"body":{"source":{},"timestamp":1546500496668,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"7db8572c-8ec9-4afd-af51-ba12e211a6f3"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 2, current offset is 2304
2019-01-03 15:28:16,679 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fea3ea-0f29-11e9-9dbb-31ebb162dbe5","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496670,"body":{"source":{},"timestamp":1546500496670,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"5de7020d-6939-43d8-855e-3e2f887fa707"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 13, current offset is 2026
2019-01-03 15:28:16,680 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.s.t.TransferedSessionNoPerceptionRedisService - redis key agent.greeting.number.200175ef-5064-40bf-a836-667a8c2b4050 set value = 1 ,expire day-time 1
2019-01-03 15:28:16,681 INFO  [http-nio-8899-exec-12]  c.e.w.r.s.l.InactiveSessionTimeoutEventListener - Create inactive session timer driven by ServiceSessionOpenedEvent {"source":{},"timestamp":1546500496588,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"scheduleId":null,"kickOff":true}
2019-01-03 15:28:16,682 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 4 , serviceSessionId : 200175ef-5064-40bf-a836-667a8c2b4050,agentUserId : aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:16,683 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:61cdfffe-9170-403d-a418-156c7404c2f1 message:{"path":"/tenants/4/agents/84620ad2-ad5e-42d5-978b-ef76c0c74cf1","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496668,"type":null}
2019-01-03 15:28:16,683 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - prepare message noticeId:61cdfffe-9170-403d-a418-156c7404c2f1 messageType:VisitUserWaitingListChange path:/tenants/4/agents/84620ad2-ad5e-42d5-978b-ef76c0c74cf1
2019-01-03 15:28:16,683 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:43e3ed28-02f4-4528-bca4-dafca33be5b2 messageType:VisitUserWaitingListChange
2019-01-03 15:28:16,684 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:3273f709-9567-4dff-be94-baa2d5cf8aac message:{"path":"/tenants/4/agents/3d75dc9d-145a-49ab-9579-c35e410584a6","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496669,"type":null}
2019-01-03 15:28:16,684 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - prepare message noticeId:3273f709-9567-4dff-be94-baa2d5cf8aac messageType:VisitUserWaitingListChange path:/tenants/4/agents/3d75dc9d-145a-49ab-9579-c35e410584a6
2019-01-03 15:28:16,684 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:929ace40-76b9-4f2d-9831-3498036f6ea9 message:{"path":"/tenants/4/agents/7db8572c-8ec9-4afd-af51-ba12e211a6f3","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496669,"type":null}
2019-01-03 15:28:16,685 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - prepare message noticeId:929ace40-76b9-4f2d-9831-3498036f6ea9 messageType:VisitUserWaitingListChange path:/tenants/4/agents/7db8572c-8ec9-4afd-af51-ba12e211a6f3
2019-01-03 15:28:16,685 INFO  [SimpleAsyncTaskExecutor-14]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:a6de7f65-4643-4ee9-ae2a-5d39152af074 message:{"path":"/tenants/4/agents/98461a5e-af68-41ce-954e-546ae32b60e2","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496672,"type":null}
2019-01-03 15:28:16,685 INFO  [SimpleAsyncTaskExecutor-14]  c.e.w.n.service.PushDataService - prepare message noticeId:a6de7f65-4643-4ee9-ae2a-5d39152af074 messageType:VisitUserWaitingListChange path:/tenants/4/agents/98461a5e-af68-41ce-954e-546ae32b60e2
2019-01-03 15:28:16,685 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fe55c0-0f29-11e9-ba74-4104815635aa, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496668, properties={}, body={source={}, timestamp=1546500496667, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=281848c3-2b84-4604-8fd3-09daa5611ef8}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,684 INFO  [SimpleAsyncTaskExecutor-2]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:d24234d5-235d-494c-b259-56dbe374faaa message:{"path":"/tenants/4/agents/5de7020d-6939-43d8-855e-3e2f887fa707","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496670,"type":null}
2019-01-03 15:28:16,700 INFO  [SimpleAsyncTaskExecutor-2]  c.e.w.n.service.PushDataService - prepare message noticeId:d24234d5-235d-494c-b259-56dbe374faaa messageType:VisitUserWaitingListChange path:/tenants/4/agents/5de7020d-6939-43d8-855e-3e2f887fa707
2019-01-03 15:28:16,684 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:43e3ed28-02f4-4528-bca4-dafca33be5b2
2019-01-03 15:28:16,684 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:8b7fbfa2-e56f-491b-8713-724bccb7f76b message:{"path":"/tenants/4/agents/ade55cfb-8328-431a-9b9d-800122e82078","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496670,"type":null}
2019-01-03 15:28:16,686 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fe7cd0-0f29-11e9-87b8-29da3acedbbb, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496669, properties={}, body={source={}, timestamp=1546500496668, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=7db8572c-8ec9-4afd-af51-ba12e211a6f3}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,686 INFO  [SimpleAsyncTaskExecutor-11]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:d45ba6d8-aca0-4afd-8307-c8fde11463b4 message:{"path":"/tenants/4/agents/227255c6-abf4-4d0e-9bbd-1bbb55e33709","key":null,"payload":[{"messageType":"VisitUserWaitingListChange"}],"timestamp":1546500496671,"type":null}
2019-01-03 15:28:16,701 INFO  [SimpleAsyncTaskExecutor-11]  c.e.w.n.service.PushDataService - prepare message noticeId:d45ba6d8-aca0-4afd-8307-c8fde11463b4 messageType:VisitUserWaitingListChange path:/tenants/4/agents/227255c6-abf4-4d0e-9bbd-1bbb55e33709
2019-01-03 15:28:16,702 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:7d7d5aa5-db81-489a-ba19-235b65dbdc42 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"NewChatMessage","body":{"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","newSession":true,"fromUser":{"tenantId":0,"userType":"Visitor","userScope":"Tenant","status":"Disable","bizId":"0","roles":"","scope":"Tenant"}}}],"timestamp":1546500496684,"type":null}
2019-01-03 15:28:16,686 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fea3e0-0f29-11e9-a9f1-33bb836febcc, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496670, properties={}, body={source={}, timestamp=1546500496669, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=ade55cfb-8328-431a-9b9d-800122e82078}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,686 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fea3ea-0f29-11e9-9dbb-31ebb162dbe5, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496670, properties={}, body={source={}, timestamp=1546500496670, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=5de7020d-6939-43d8-855e-3e2f887fa707}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,698 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fecafa-0f29-11e9-9f8d-579eb95ec6f6","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496671,"body":{"source":{},"timestamp":1546500496671,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"227255c6-abf4-4d0e-9bbd-1bbb55e33709"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 4, current offset is 1837
2019-01-03 15:28:16,700 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - prepare message noticeId:8b7fbfa2-e56f-491b-8713-724bccb7f76b messageType:VisitUserWaitingListChange path:/tenants/4/agents/ade55cfb-8328-431a-9b9d-800122e82078
2019-01-03 15:28:16,701 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fe7cda-0f29-11e9-97d5-2dd3ca0ab878, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496669, properties={}, body={source={}, timestamp=1546500496669, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=3d75dc9d-145a-49ab-9579-c35e410584a6}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,702 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:f59165f8-8713-4dd3-9411-1f08c81b5c24 message:{"path":"/tenants/4/agents/_2","key":null,"payload":[{"messageType":"ScheduleAccept","body":"Schedule:4:200175ef-5064-40bf-a836-667a8c2b4050:_2:aee4969c-c4a9-44d9-a1ba-453a07ac137a:Agent"}],"timestamp":1546500496685,"type":null}
2019-01-03 15:28:16,702 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/4/messages HTTP/1.1
2019-01-03 15:28:16,701 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fecafa-0f29-11e9-9f8d-579eb95ec6f6, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496671, properties={}, body={source={}, timestamp=1546500496671, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=227255c6-abf4-4d0e-9bbd-1bbb55e33709}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,702 INFO  [SimpleAsyncTaskExecutor-5]  c.e.w.n.service.PushDataService - prepare message noticeId:7d7d5aa5-db81-489a-ba19-235b65dbdc42 messageType:NewChatMessage path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:16,704 INFO  [SimpleAsyncTaskExecutor-7]  c.e.w.n.service.PushDataService - prepare message noticeId:f59165f8-8713-4dd3-9411-1f08c81b5c24 messageType:ScheduleAccept path:/tenants/4/agents/_2
2019-01-03 15:28:16,704 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fecaf0-0f29-11e9-a51d-c9eb9147c04b","type":"com.easemob.weichat.service.timeout.event.TimeoutClearEvent","timestamp":1546500496671,"body":{"source":{},"timestamp":1546500496671,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","key":"200175ef-5064-40bf-a836-667a8c2b4050","type":"SILENCE","startTime":1546500496671,"duration":0,"businessObj":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic timeout-events-in partition 11, current offset is 178
2019-01-03 15:28:16,705 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"22fef200-0f29-11e9-8f7d-8734ecf7dd7f","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496672,"body":{"source":{},"timestamp":1546500496672,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"98461a5e-af68-41ce-954e-546ae32b60e2"},"messages":[{"messageType":"VisitUserWaitingListChange"}],"broadcast":false}}} has been send to kafka with in topic events partition 7, current offset is 1975
2019-01-03 15:28:16,706 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"23000370-0f29-11e9-beef-07143b8eac6c","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546500496679,"body":{"source":{},"timestamp":1546500496679,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","key":"200175ef-5064-40bf-a836-667a8c2b4050","type":"SILENCE","startTime":1546500496679,"duration":300,"businessObj":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 11, current offset is 179
2019-01-03 15:28:16,706 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2300c6c0-0f29-11e9-af61-3dc134e5db95","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496684,"body":{"source":{},"timestamp":1546500496683,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"NewChatMessage","body":{"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","newSession":true,"fromUser":{"tenantId":0,"userType":"Visitor","userScope":"Tenant","status":"Disable","bizId":"0","roles":"","scope":"Tenant"}}}],"broadcast":false}}} has been send to kafka with in topic events partition 16, current offset is 4025
2019-01-03 15:28:16,707 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fef200-0f29-11e9-8f7d-8734ecf7dd7f, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496672, properties={}, body={source={}, timestamp=1546500496672, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=98461a5e-af68-41ce-954e-546ae32b60e2}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,707 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:7d7d5aa5-db81-489a-ba19-235b65dbdc42 messageType:NewChatMessage
2019-01-03 15:28:16,707 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2300c6c0-0f29-11e9-af61-3dc134e5db95, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496684, properties={}, body={source={}, timestamp=1546500496683, actor={bizId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, roles=admin,agent}, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=NewChatMessage, body={sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, newSession=true, fromUser={tenantId=0, userType=Visitor, userScope=Tenant, status=Disable, bizId=0, roles=, scope=Tenant}}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,708 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:7d7d5aa5-db81-489a-ba19-235b65dbdc42
2019-01-03 15:28:16,711 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2300edd0-0f29-11e9-96f9-1b380b8f8746, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496685, properties={}, body={source={}, timestamp=1546500496684, actor={bizId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, roles=admin,agent}, version=1.1, queueMessageData={userPK={tenantId=4, userId=_2}, messages=[{messageType=ScheduleAccept, body=Schedule:4:200175ef-5064-40bf-a836-667a8c2b4050:_2:aee4969c-c4a9-44d9-a1ba-453a07ac137a:Agent}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:16,718 INFO  [SimpleAsyncTaskExecutor-4226]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:agent user [tenantId = 4scheduleId=null, userId = aee4969c-c4a9-44d9-a1ba-453a07ac137a] opened servicesession 200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,721 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"230337c0-0f29-11e9-8c84-75181684bebb","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546500496700,"body":{"source":{},"timestamp":1546500496699,"actor":null,"version":"1.1","key":"200175ef-5064-40bf-a836-667a8c2b4050","type":"AGENT","startTime":1546500496699,"duration":180,"businessObj":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 11, current offset is 180
2019-01-03 15:28:16,721 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2300edd0-0f29-11e9-96f9-1b380b8f8746","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500496685,"body":{"source":{},"timestamp":1546500496684,"actor":{"bizId":"4","userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","roles":"admin,agent"},"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"_2"},"messages":[{"messageType":"ScheduleAccept","body":"Schedule:4:200175ef-5064-40bf-a836-667a8c2b4050:_2:aee4969c-c4a9-44d9-a1ba-453a07ac137a:Agent"}],"broadcast":false}}} has been send to kafka with in topic events partition 1, current offset is 2320
2019-01-03 15:28:16,879 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/4/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"to":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","status":"Disable","bizId":"4","roles":"","scope":"Tenant"},"officialAccountId":null,"messageRequest":{"msg":"ServiceSessionOpenedEvent","type":"cmd","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":"ServiceSessionOpenedEvent","ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","agentType":1,"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","mediaFileUrl":null,"tenantId":4,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","saveMessage":true}
2019-01-03 15:28:16,886 INFO  [http-nio-8899-exec-14]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:16,889 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"43e3ed28-02f4-4528-bca4-dafca33be5b2"}
2019-01-03 15:28:16,889 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:43e3ed28-02f4-4528-bca4-dafca33be5b2
2019-01-03 15:28:16,902 INFO  [http-nio-8899-exec-13]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","tenantId":4,"type":"StateChange"}}],"timestamp":1546500496888,"type":null}
2019-01-03 15:28:16,903 INFO  [http-nio-8899-exec-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:38bb8556-f61e-42bd-aa4a-bd8ce088ce32 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","tenantId":4,"type":"StateChange"}}],"timestamp":1546500496888,"type":null}
2019-01-03 15:28:16,903 INFO  [http-nio-8899-exec-13]  c.e.w.n.service.PushDataService - prepare message noticeId:38bb8556-f61e-42bd-aa4a-bd8ce088ce32 messageType:Daas path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:16,906 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:38bb8556-f61e-42bd-aa4a-bd8ce088ce32 messageType:Daas
2019-01-03 15:28:16,906 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:38bb8556-f61e-42bd-aa4a-bd8ce088ce32
2019-01-03 15:28:16,913 INFO  [http-nio-8899-exec-2]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/200175ef-5064-40bf-a836-667a8c2b4050/official-accounts
2019-01-03 15:28:16,948 INFO  [http-nio-8899-exec-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 messageId:083cb5f3-8d6f-47a8-9000-b7acc2fbcce5
2019-01-03 15:28:16,980 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","messageId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}
2019-01-03 15:28:16,985 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"7d7d5aa5-db81-489a-ba19-235b65dbdc42"}
2019-01-03 15:28:16,985 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:7d7d5aa5-db81-489a-ba19-235b65dbdc42
2019-01-03 15:28:17,013 INFO  [SimpleAsyncTaskExecutor-4232]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat=KefuExtMessage(msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=47, sessionServiceSeqId=4, createDateTime=2019-01-03 15:28:16.881, timestamp=1546500496881, createMicroTimestamp=1546500496881000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Processing, chatGroupId=111, messageSeqId=3, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=2019-01-03 15:28:16.547, stopDateTime=null, createDatetime=2019-01-03 15:27:11.298, lastChatMessage=ChatMessage(msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:17 CST 2019, msgId=553774346338828692, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:17.484, timestamp=1546500437000, createMicroTimestamp=1546500437484000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:17,020 INFO  [http-nio-8899-exec-14]  c.e.w.s.t.SendTimeoutEventService - this message {"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","agentType":1,"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":47,"sessionServiceSeqId":4,"createDateTime":1546500496881,"timestamp":1546500496881,"createMicroTimestamp":1546500496881000} is cmd Message .
2019-01-03 15:28:17,020 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2332ac30-0f29-11e9-94a0-e58beae5510d","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500497011,"body":{"timestamp":1546500497011,"version":"1.1","tenantId":4,"message":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","agentType":1,"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":47,"sessionServiceSeqId":4,"createDateTime":1546500496881,"timestamp":1546500496881,"createMicroTimestamp":1546500496881000},"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 11, current offset is 1909
2019-01-03 15:28:17,022 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (317ms)
2019-01-03 15:28:17,026 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=22f220c0-0f29-11e9-ad71-995cdb58ec69, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionOpenedEvent, timestamp=1546500496588, properties={}, body={source={}, timestamp=1546500496588, actor={bizId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, roles=admin,agent}, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Processing, chatGroupId=111, messageSeqId=3, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=2019-01-03 15:28:16, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}, userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, scheduleId=null, kickOff=true}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:28:17,039 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=22fe55ca-0f29-11e9-8e2a-677eac9352ba, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500496668, properties={}, body={source={}, timestamp=1546500496668, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=84620ad2-ad5e-42d5-978b-ef76c0c74cf1}, messages=[{messageType=VisitUserWaitingListChange}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:17,042 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=47, sessionServiceSeqId=4, createDateTime=2019-01-03 15:28:16.881, timestamp=1546500496881, createMicroTimestamp=1546500496881000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Processing, chatGroupId=111, messageSeqId=3, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=Thu Jan 03 15:28:16 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=ChatMessage(msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, toJid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:27:17 CST 2019, msgId=553774346338828692, channelId=16, channelName=网站, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:27:17.484, timestamp=1546500437000, createMicroTimestamp=1546500437484000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:17,046 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2332ac30-0f29-11e9-94a0-e58beae5510d, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500497011, properties={}, body={timestamp=1546500497011, version=1.1, tenantId=4, message={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionOpenedEvent, type=cmd}], ext={weichat={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=47, sessionServiceSeqId=4, createDateTime=1546500496881, timestamp=1546500496881, createMicroTimestamp=1546500496881000}, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Processing, chatGroupId=111, messageSeqId=3, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=2019-01-03 15:28:16, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=0c031763-d6e9-4d29-9e9c-8e7fe01d67e0, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-632PMQ9WCH9BHBWP3MPG, to=kefuchannelimid_569839, channelType=easemob, timestamp=1546500437462, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, to_jid=9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com, msg_id=553774346338828692, channel_id=16, channel_name=网站}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500437484, timestamp=1546500437000, createMicroTimestamp=1546500437484000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:28:17,090 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"38bb8556-f61e-42bd-aa4a-bd8ce088ce32"}
2019-01-03 15:28:17,090 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:38bb8556-f61e-42bd-aa4a-bd8ce088ce32
2019-01-03 15:28:17,452 ERROR [consumer-kf_msg_in:session:attribute:topic-10-thread-3]  c.e.w.s.s.impl.BaiduApiIpLookUp - ipToRegion error ip:88.0.64.48
com.fasterxml.jackson.core.JsonParseException: Unexpected character ('<' (code 60)): expected a valid value (number, String, array, object, 'true', 'false' or 'null')
 at [Source: <!DOCTYPE html>
<!--STATUS OK-->
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta content="always" name="referrer">
    <script src="https://ss1.bdstatic.com/5eN1bjq8AAUYm2zgoY3K/r/www/nocache/imgdata/seErrorRec.js"></script>
    <title>é¡µé¢ä¸å­å¨_ç¾åº¦æç´¢</title>
    <style data-for="result">
        body {color: #333; background: #fff; padding: 0; margin: 0; position: relative; min-width: 700px; font-family: arial; font-size: 12px }
        p, form, ol, ul, li, dl, dt, dd, h3 {margin: 0; padding: 0; list-style: none }
        input {padding-top: 0; padding-bottom: 0; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box } img {border: none; }
        .logo {width: 117px; height: 38px; cursor: pointer }
         #wrapper {_zoom: 1 }
        #head {padding-left: 35px; margin-bottom: 20px; width: 900px }
        .fm {clear: both; position: relative; z-index: 297 }
        .btn, #more {font-size: 14px } 
        .s_btn {width: 95px; height: 32px; padding-top: 2px\9; font-size: 14px; padding: 0; background-color: #ddd; background-position: 0 -48px; border: 0; cursor: pointer }
        .s_btn_h {background-position: -240px -48px }
        .s_btn_wr {width: 97px; height: 34px; display: inline-block; background-position: -120px -48px; *position: relative; z-index: 0; vertical-align: top }
        #foot {}
        #foot span {color: #666 }
        .s_ipt_wr {height: 32px }
        .s_form:after, .s_tab:after {content: "."; display: block; height: 0; clear: both; visibility: hidden }
        .s_form {zoom: 1; height: 55px; padding: 0 0 0 10px }
        #result_logo {float: left; margin: 7px 0 0 }
        #result_logo img {width: 101px }
        #head {padding: 0; margin: 0; width: 100%; position: absolute; z-index: 301; min-width: 1000px; background: #fff; border-bottom: 1px solid #ebebeb; position: fixed; _position: absolute; -webkit-transform: translateZ(0) }
        #head .head_wrapper {_width: 1000px }
        #head.s_down {box-shadow: 0 0 5px #888 }
        .fm {clear: none; float: left; margin: 11px 0 0 10px }
        #s_tab {background: #f8f8f8; line-height: 36px; height: 38px; padding: 55px 0 0 121px; float: none; zoom: 1 }
        #s_tab a, #s_tab b {width: 54px; display: inline-block; text-decoration: none; text-align: center; color: #666; font-size: 14px }
        #s_tab b {border-bottom: 2px solid #38f; font-weight: bold; color: #323232 }
        #s_tab a:hover {color: #323232 }
        #content_left {width: 540px; padding-left: 121px; padding-top: 5px }
        .to_tieba, .to_zhidao_bottom {margin: 10px 0 0 121px }
        #help {background: #f5f6f5; zoom: 1; padding: 0 0 0 50px; float: right }
        #help a {color: #777; padding: 0 15px; text-decoration: none }
        #help a:hover {color: #333 }
        #foot {position: fixed; bottom:0; width: 100%; background: #f5f6f5; border-top: 1px solid #ebebeb; text-align: left; height: 42px; line-height: 42px; margin-top: 40px; *margin-top: 0; _position:absolute; _bottom:auto; _top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0)-(parseInt(this.currentStyle.marginBottom,10)||0))); }

        .content_none {padding: 45px 0 25px 121px } .s_ipt_wr.bg,
        .s_btn_wr.bg, #su.bg {background-image: none }
        .s_ipt_wr.bg {background: 0 }
        .s_btn_wr {width: auto; height: auto; border-bottom: 1px solid transparent; *border-bottom: 0 }
        .s_btn {width: 100px; height: 34px; color: white; letter-spacing: 1px; background: #3385ff; border-bottom: 1px solid #2d78f4; outline: medium; *border-bottom: 0; -webkit-appearance: none; -webkit-border-radius: 0 }
        .s_btn:hover {background: #317ef3; border-bottom: 1px solid #2868c8; *border-bottom: 0; box-shadow: 1px 1px 1px #ccc }
        .s_btn:active {background: #3075dc; box-shadow: inset 1px 1px 3px #2964bb; -webkit-box-shadow: inset 1px 1px 3px #2964bb; -moz-box-shadow: inset 1px 1px 3px #2964bb; -o-box-shadow: inset 1px 1px 3px #2964bb }
        #lg {display: none }
        #head .headBlock {margin: -5px 0 6px 121px }
        #content_left .leftBlock {margin-bottom: 14px; padding-bottom: 5px; border-bottom: 1px solid #f3f3f3 }
        .s_ipt_wr {border: 1px solid #b6b6b6; border-color: #7b7b7b #b6b6b6 #b6b6b6 #7b7b7b; background: #fff; display: inline-block; vertical-align: top; width: 539px; margin-right: 0; border-right-width: 0; border-color: #b8b8b8 transparent #ccc #b8b8b8; overflow: hidden }
        .s_ipt_wr.ip_short {width: 439px; }
        .s_ipt_wr:hover, .s_ipt_wr.ipthover {border-color: #999 transparent #b3b3b3 #999 }
        .s_ipt_wr.iptfocus {border-color: #4791ff transparent #4791ff #4791ff }
        .s_ipt_tip {color: #aaa; position: absolute; z-index: -10; font: 16px/22px arial; height: 32px; line-height: 32px; padding-left: 7px; overflow: hidden; width: 526px }
        .s_ipt {width: 526px; height: 22px; font: 16px/18px arial; line-height: 22px\9; margin: 6px 0 0 7px; padding: 0; background: transparent; border: 0; outline: 0; -webkit-appearance: none }
        #kw {position: relative;display: inline-block;}
        input::-ms-clear {display: none }
        /*Error page css*/
        .norsSuggest {display: inline-block; color: #333; font-family: arial; font-size: 13px; position: relative; } 
        .norsTitle {font-size: 22px; font-family: Microsoft Yahei; font-weight: normal; color: #333; margin: 35px 0 25px 0; }
        .norsTitle2 {font-family: arial; font-size: 13px; color: #666; }
        .norsSuggest ol {margin-left: 47px; }
        .norsSuggest li {margin: 13px 0; }
        #content_right {
    border-left: 1px solid #e1e1e1;
    width: 384px;
    margin-top: 25px;
    float: right;
    padding-left: 17px;
}
#wrapper_wrapper {
    width: 1212px;
}
.cr-content {
    width: 351px;
    font-size: 13px;
    line-height: 1.54em;
    color: #333;
    margin-top: 6px;
    margin-bottom: 28px;
    word-wrap: break-word;
    word-break: normal;
}
@media screen and (max-width: 1217px) {
    #wrapper_wrapper {
        width: 1002px;
    }
    #wrapper_wrapper #content_right {
        width: 271px;
    }
    #wrapper_wrapper .cr-content {
        width: 259px;
    }
}
.opr-toplist-title {
    position: relative;
    font-size: 14px;
    line-height: 1.29em;
    font-weight: 700;
    margin-bottom: 10px;
}
.opr-toplist-table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    font-size: 13px;
}
.opr-toplist-table th,td {
    line-height: 1.54;
    border-bottom: 1px solid #f3f3f3;
    text-align: left;
}
.opr-toplist-table thead th {
    padding-top: 4px;
    padding-bottom: 4px;
    font-weight: 400;
    color: #666;
    white-space: nowrap;
    background-color: #fafafa;  
}
.opr-toplist-table .opr-toplist-right {
    text-align: right;
    white-space: nowrap;
}
.opr-toplist-table td {
    width: 100%;
    font-size: 13px;
    padding-top: 6.5px;
    padding-bottom: 6.5px;
    vertical-align: top;
}
.opr-toplist-table a:hover {
    text-decoration: underline;
}
.opr-index-item {
    display: inline-block;
    padding:1px 0;
    color: #fff;
    width: 14px;
    line-height: 100%;
    font-size: 12px;
    text-align: center;
    background-color: #8eb9f5;
    margin-right: 5px;
}
.opr-index-hot1 {
    background-color: #f54545;
}

.opr-index-hot2 {
    background-color: #ff8547;
}
.opr-index-hot3 {
    background-color: #ffac38;
}
.opr-item-text {
    text-decoration: none;  
}
.opr-toplist-info {
    color: #666;
    text-align: right;
    margin-top: 5px;
}
.opr-toplist-info>a {
    color: #666;
}
    </style>
</head>

<body link="#0000cc">
    <div id="wrapper" class="wrapper_l">
        <div id="head">
            <div class="head_wrapper">
                <div class="s_form">
                    <div class="s_form_wrapper">
                        <a href="//www.baidu.com/" id="result_logo"><img src="//www.baidu.com/img/baidu_jgylogo3.gif" alt="å°ç¾åº¦é¦é¡µ" title="å°ç¾åº¦é¦é¡µ"></a>
                        <form id="form" name="f" action="//www.baidu.com/s" class="fm">
                            <input type="hidden" name="ie" value="utf-8">
                            <input type="hidden" name="f" value="8">
                            <input type="hidden" name="rsv_bp" value="1">
                            <input type="hidden" name="ch" value="">
                            <input type="hidden" name="tn" value="baiduerr">
                            <input type="hidden" name="bar" value="">
                            <span class="bg s_ipt_wr iptfocus">
                                <input id="kw" name="wd" class="s_ipt" value="" maxlength="255" autocomplete="off" autofocus>
                            </span><span class="bg s_btn_wr">
                                <input type="submit" id="su" value="ç¾åº¦ä¸ä¸" class="bg s_btn">
                            </span>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="s_tab" id="s_tab">
        <b>ç½é¡µ</b>
        <a href="http://tieba.baidu.com/f?kw=&fr=wwwt" wdfield="kw">è´´å§</a>
        <a href="http://zhidao.baidu.com/q?ct=17&pn=0&tn=ikaslist&rn=10&word=&fr=wwwt" wdfield="word">ç¥é</a>
        <a href="http://music.baidu.com/search?fr=ps&ie=utf-8&key=" wdfield="key">é³ä¹</a>
        <a href="http://image.baidu.com/i?tn=baiduimage&ps=1&ct=201326592&lm=-1&cl=2&nc=1&ie=utf-8&word=" wdfield="word">å¾ç</a>
        <a href="http://v.baidu.com/v?ct=301989888&rn=20&pn=0&db=0&s=25&ie=utf-8&word=" wdfield="word">è§é¢</a>
        <a href="http://map.baidu.com/m?word=&fr=ps01000" wdfield="word">å°å¾</a>
        <a href="http://wenku.baidu.com/search?word=&lm=0&od=0&ie=utf-8" wdfield="word">æåº</a>
        <a href="//www.baidu.com/more/">æ´å¤Â»</a>
    </div>
    <div id="wrapper_wrapper">
        <div id="content_left">
            <div class="nors">
                <div class="norsSuggest">
                    <h3 class="norsTitle">å¾æ±æ­ï¼æ¨è¦è®¿é®çé¡µé¢ä¸å­å¨ï¼</h3>
                    <p class="norsTitle2">æ¸©é¦¨æç¤ºï¼</p>
                    <ol>
                        <li>è¯·æ£æ¥æ¨è®¿é®çç½åæ¯å¦æ­£ç¡®</li>
                        <li>å¦ææ¨ä¸è½ç¡®è®¤è®¿é®çç½åï¼è¯·æµè§<a href="//www.baidu.com/more/index.html">ç¾åº¦æ´å¤</a>é¡µé¢æ¥çæ´å¤ç½åã</li>
                        <li>åå°é¡¶é¨éæ°åèµ·æç´¢</li>
                        <li>å¦æä»»ä½æè§æå»ºè®®ï¼è¯·åæ¶<a href="http://qingting.baidu.com/index">åé¦ç»æä»¬</a>ã</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <div id="foot">
        <span id="help" style="float:left;padding-left:121px">
            <a href="http://help.baidu.com/question" target="_blank">å¸®å©</a>
            <a href="http://www.baidu.com/search/jubao.html" target="_blank">ä¸¾æ¥</a>
            <a href="http://jianyi.baidu.com" target="_blank">ç»ç¾åº¦æå»ºè®®</a>
        </span>
    </div>
</body>
<script>
(function () {
        var LOGURL = 'https://sp1.baidu.com/5b1ZeDe5KgQFm2e88IuM_a/cm.gif';
        var params = 'type=wwwerror&terminal=www';
        var img = new Image();
        img.src = LOGURL + '?' + params;
    })();
    (function () {
        if(window.recommend && window.recommend.query && window.recommend.query.length > 0) {
            var recommendWrapper = document.createElement('div');
            var recommendHtml = '<div class="cr-content"><div class="opr-toplist-title">' + window.recommend.title + '</div><table class="opr-toplist-table"><thead><tr><th>æå</th></tr></thead>';
            var queryArray = window.recommend.query;
            var itemUrl = '';
            for(var i = 1; i < (queryArray.length+1); i++) {
                itemUrl = '//www.baidu.com/s?word=' + encodeURIComponent(queryArray[i-1].word) + '&sa=' + queryArray[i-1].sa + '&tn=' + queryArray[i-1].tn;
                if (queryArray[i-1].rsv_dl) {
                    itemUrl += "&rsv_dl=" + queryArray[i-1].rsv_dl;
                }
                
                if (i < 4) {
                    recommendHtml += '<tr><td><span class="opr-index-hot' + i + ' opr-index-item">' + i + '</span><a target="_blank" href="' + itemUrl +'" class="opr-item-text">' + queryArray[i-1].word + '</a></td></tr>';
                } else {
                    recommendHtml += '<tr><td><span class="opr-index-item">' + i + '</span><a target="_blank" href="' + itemUrl +'" class="opr-item-text">' + queryArray[i-1].word + '</a></td></tr>';
                }
            }
            recommendHtml += '</tbody></table><div class="opr-toplist-info"><span>æ¥æºï¼</span><a target="_blank" href="http://www.baidu.com/link?url=sLR63PtaB7kc3YkTtzDy1k3mbTm1DXDMu-nLcijZx8DmWgOff4lBxqmY-LGDyHqw">ç¾åº¦é£äºæ¦</a><span>&nbsp;-&nbsp;</span><a target="_blank" href="http://www.baidu.com/link?url=01vNBVXR2eaJxETl9PI3hcrvKCcwaJIKk5FkpO7l5YI_Q_pC24ogIBoZxI0LAu5oYpAdhRH42nzxAqfui0YnHK">å®æ¶ç­ç¹</a></div></div>';
            recommendWrapper.setAttribute('id', 'content_right');
            document.getElementById('wrapper_wrapper').insertBefore(recommendWrapper, document.getElementById('content_left'));
            var recommend = document.getElementById('content_right');
            recommend.innerHTML = recommendHtml;
        }
})();
(function(){
    var bds = {
        util: {}
    };
    var c = document.getElementById('kw').parentNode;

    bds.util.getWinWidth = function(){
        return window.document.documentElement.clientWidth;
    };

    bds.util.setFormWidth = function(){
        var width = bds.util.getWinWidth();
        if(width < 1217)    {bds.util.setClass(c, 'ip_short', 'add')}
        else                {bds.util.setClass(c, 'ip_short', 'remove')};
    };

    bds.util.setClass = function(obj, class_name, set) {
        var ori_class = obj.className,
            has_class_p = -1,
            ori_class_arr = [],
            new_class = '';

        if(ori_class.length) ori_class_arr = ori_class.split(' ');

        for( i in ori_class_arr) {
            if(ori_class_arr[i] == class_name) has_class_p = i;
        }

        if( set == 'remove' && has_class_p >= 0) {
            ori_class_arr.splice(has_class_p, 1);
            new_class = ori_class_arr.join(' ');
            obj.className = new_class;
        } else if( set == 'add' && has_class_p < 0) {
            ori_class_arr.push(class_name);
            new_class = ori_class_arr.join(' ');
            obj.className = new_class;
        }
    }
    bds.util.setFormWidth();

    if (typeof document.addEventListener != "undefined") {
        window.addEventListener('resize', bds.util.setFormWidth, false);
        document.getElementById('kw').addEventListener('focus', function(){bds.util.setClass(c,'iptfocus', 'add');}, false);
        document.getElementById('kw').addEventListener('blur', function(){bds.util.setClass(c,'iptfocus', 'remove');}, false);
    } else {
        window.attachEvent('onresize', bds.util.setFormWidth, false);
        document.getElementById('kw').attachEvent('onfocus', function(){bds.util.setClass(c,'iptfocus', 'add');}, false);
        document.getElementById('kw').attachEvent('onblur', function(){bds.util.setClass(c,'iptfocus', 'remove');}, false);
    } 

})();


</script>

</html>
; line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:1702)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:558)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:456)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:1906)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:749)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:3850)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3799)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2858)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.ipToRegion(BaiduApiIpLookUp.java:65)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.lookUp(BaiduApiIpLookUp.java:39)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.buildRegion(IpServiceSessionAttributeProcessor.java:59)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.processServiceSessionAttribute(IpServiceSessionAttributeProcessor.java:47)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesManager.saveServiceSessionAttributes(ServiceSessionAttributesManager.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesCreationWorker.run(ServiceSessionAttributesCreationWorker.java:43)
	at com.easemob.weichat.service.message.BlockingRedisMessageConsumer$InternalQueueConsumer.run(BlockingRedisMessageConsumer.java:187)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:17,462 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-3]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionAttributesUpdateEvent sessionId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:28:17,467 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2377a470-0f29-11e9-be1a-df38147949f6","type":"com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent","timestamp":1546500497463,"body":{"timestamp":1546500497462,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":4,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","agentType":1,"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500496881,"timestamp":1546500497000,"createMicroTimestamp":1546500496881000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 11, current offset is 1910
2019-01-03 15:28:17,469 INFO  [SimpleAsyncTaskExecutor-12]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:9ec93051-b904-46a5-8d29-7eebcd7fdb6a message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"ServiceSessionAttributesChange","body":"200175ef-5064-40bf-a836-667a8c2b4050"}],"timestamp":1546500497465,"type":null}
2019-01-03 15:28:17,469 INFO  [SimpleAsyncTaskExecutor-12]  c.e.w.n.service.PushDataService - prepare message noticeId:9ec93051-b904-46a5-8d29-7eebcd7fdb6a messageType:ServiceSessionAttributesChange path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:28:17,471 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2377f290-0f29-11e9-99bc-7db5f2f80672","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500497465,"body":{"source":{},"timestamp":1546500497464,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"ServiceSessionAttributesChange","body":"200175ef-5064-40bf-a836-667a8c2b4050"}],"broadcast":false}}} has been send to kafka with in topic events partition 10, current offset is 2119
2019-01-03 15:28:17,471 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2377a470-0f29-11e9-be1a-df38147949f6, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent, timestamp=1546500497463, properties={}, body={timestamp=1546500497462, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Processing, chatGroupId=111, messageSeqId=4, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=2019-01-03 15:28:16, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionOpenedEvent, type=cmd}], ext={weichat={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500496881, timestamp=1546500497000, createMicroTimestamp=1546500496881000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:28:17,474 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2377f290-0f29-11e9-99bc-7db5f2f80672, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500497465, properties={}, body={source={}, timestamp=1546500497464, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=ServiceSessionAttributesChange, body=200175ef-5064-40bf-a836-667a8c2b4050}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:17,479 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:9ec93051-b904-46a5-8d29-7eebcd7fdb6a messageType:ServiceSessionAttributesChange
2019-01-03 15:28:17,479 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:9ec93051-b904-46a5-8d29-7eebcd7fdb6a
2019-01-03 15:28:17,570 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"9ec93051-b904-46a5-8d29-7eebcd7fdb6a"}
2019-01-03 15:28:17,570 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:9ec93051-b904-46a5-8d29-7eebcd7fdb6a
2019-01-03 15:28:18,336 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:18,356 INFO  [consumer-kf:schedule:signal:a-7-thread-29]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:20,821 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:20,842 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:28 start
2019-01-03 15:28:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:28
2019-01-03 15:28:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:28 complete
2019-01-03 15:28:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:28:22,841 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:22,858 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:24,851 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:24,879 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:25,705 INFO  [http-nio-8899-exec-10]  c.e.w.w.mvc.WebimConfigController - GET /v1/webimplugin/settings/visitors/configs/b88b97a9-aed6-4b18-ac92-fd566addf0e8
2019-01-03 15:28:25,936 INFO  [http-nio-8899-exec-13]  c.e.w.w.mvc.WebimPluginController - GET /v1/webimplugin/visitors/password2 orgName:easemob-demo appName:chatdemoui imServiceNumber:153895 username:webim-visitor-BRM392HYE7EBV8B4996K
2019-01-03 15:28:25,942 INFO  [http-nio-8899-exec-13]  c.e.w.w.s.impl.WebimPluginService - isReadIMUserNew is true,getWebimFromUser from new table return is {"id":0,"userId":"webim-visitor-BRM392HYE7EBV8B4996K","userPassword":"QFQHCY9R7Q"},orgName:easemob-demo,appName:chatdemoui,imServiceNumber:153895
2019-01-03 15:28:26,050 INFO  [http-nio-8899-exec-9]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:26,088 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:26 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:26,092 INFO  [http-nio-8899-exec-14]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:26,093 INFO  [http-nio-8899-exec-14]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:26 CST 2019.
2019-01-03 15:28:26,098 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:26,108 INFO  [http-nio-8899-exec-9]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:26,118 WARN  [http-nio-8899-exec-15]  o.s.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/v1/webimplugin/tenants/4/info] in DispatcherServlet with name 'dispatcherServlet'
2019-01-03 15:28:26,161 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:26 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:26,163 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:26,164 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:26 CST 2019.
2019-01-03 15:28:26,169 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:26,172 INFO  [http-nio-8899-exec-9]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:26,172 INFO  [http-nio-8899-exec-9]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:26,176 INFO  [http-nio-8899-exec-9]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:28:26,176 INFO  [http-nio-8899-exec-9]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:28:26,247 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:26 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@7fee3f48 
2019-01-03 15:28:26,248 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:26,250 ERROR [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:26,251 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:28:26,251 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:28:26,253 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:25 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@7e396da0 
2019-01-03 15:28:26,254 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:28:26,255 ERROR [http-nio-8899-exec-6]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:26,356 INFO  [http-nio-8899-exec-13]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:26,394 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:26 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:26,396 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:26,397 INFO  [http-nio-8899-exec-12]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:26 CST 2019.
2019-01-03 15:28:26,401 INFO  [http-nio-8899-exec-12]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:26,410 INFO  [http-nio-8899-exec-13]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:26,457 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:26 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:26,459 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:26,460 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:26 CST 2019.
2019-01-03 15:28:26,464 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:26,466 INFO  [http-nio-8899-exec-13]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:26,466 INFO  [http-nio-8899-exec-13]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:26,469 INFO  [http-nio-8899-exec-13]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:28:26,469 INFO  [http-nio-8899-exec-13]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:28:26,550 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:26 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@7a95a6e8 
2019-01-03 15:28:26,552 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:26,554 ERROR [http-nio-8899-exec-5]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:26,555 INFO  [http-nio-8899-exec-5]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:28:26,555 INFO  [http-nio-8899-exec-5]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:28:26,557 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:25 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@47741ae7 
2019-01-03 15:28:26,558 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:28:26,559 ERROR [http-nio-8899-exec-2]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:26,565 INFO  [http-nio-8899-exec-9]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccounts tenantId:4 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 page:0 size:100
2019-01-03 15:28:26,600 INFO  [http-nio-8899-exec-10]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6/official-accounts page:0 size:100
2019-01-03 15:28:26,701 INFO  [http-nio-8899-exec-6]  c.e.w.w.s.i.WebimOfficialAccountClientService - getVisitorOfficialAccountMessages tenantId:4 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:26,705 INFO  [http-nio-8899-exec-3]  c.e.w.w.s.i.WebimOfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:26,744 INFO  [http-nio-8899-exec-14]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:26,744 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/visitors/ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages startId:null direction:before size:10
2019-01-03 15:28:26,871 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:26,893 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:26,939 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:26,970 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:26 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:26,973 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:26,974 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:26 CST 2019.
2019-01-03 15:28:26,979 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:26,996 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:27,017 INFO  [http-nio-8899-exec-10]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:26 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:27,020 INFO  [http-nio-8899-exec-10]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:27,021 INFO  [http-nio-8899-exec-10]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:26 CST 2019.
2019-01-03 15:28:27,026 INFO  [http-nio-8899-exec-10]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:27,027 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:27,027 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:27,030 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:28:27,030 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:28:27,036 INFO  [http-nio-8899-exec-5]  c.e.w.w.m.WebimSkillGroupMenuController - GET /v1/webimplugin/tenants/{tenantId}/skillgroup-menu,tenantId:4
2019-01-03 15:28:27,115 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:26 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@2353465e 
2019-01-03 15:28:27,119 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:27,121 ERROR [http-nio-8899-exec-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:27,122 INFO  [http-nio-8899-exec-14]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:28:27,122 INFO  [http-nio-8899-exec-14]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:28:27,125 WARN  [hystrix-KefuLiteWebapp-42]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:26 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@4959d201 
2019-01-03 15:28:27,126 WARN  [hystrix-KefuLiteWebapp-42]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:28:27,127 ERROR [http-nio-8899-exec-12]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:28,153 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:28,157 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:28,185 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:28 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:28,186 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:28,187 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:28 CST 2019.
2019-01-03 15:28:28,188 INFO  [http-nio-8899-exec-2]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:28,192 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:28,193 INFO  [http-nio-8899-exec-10]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:28,195 ERROR [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_3500_ServiceSessionProcessor - session not fount serviceSessionId:null context:{"channel":{"tenantId":4,"type":"easemob","id":1,"dutyType":"None","timeScheduleId":0,"name":"体验关联","info":"easemob-demo#chatdemoui#153895"},"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"message":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"tenantId":4,"properties":{}}
2019-01-03 15:28:28,209 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountSession tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,229 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:28 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:28,231 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:28,232 INFO  [http-nio-8899-exec-5]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:28 CST 2019.
2019-01-03 15:28:28,237 INFO  [http-nio-8899-exec-5]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:28,239 INFO  [http-nio-8899-exec-10]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:28,239 INFO  [http-nio-8899-exec-10]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:28,244 INFO  [http-nio-8899-exec-10]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:28:28,244 INFO  [http-nio-8899-exec-10]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:28:28,246 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-session body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:28:28,256 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.CreateSessionProcessor - key: webim-visitor-BRM392HYE7EBV8B4996K, msg: {"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":4,"state":"Prepare","chatGroupId":118,"messageSeqId":0,"agentUserType":1,"createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true}, result: true
2019-01-03 15:28:28,256 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), queueId=4, robotId=4, chatRoomId=null, state=Prepare, chatGroupId=118, messageSeqId=0, agentUserId=null, agentUserNiceName=null, agentUserType=1, startDateTime=null, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:28:28,259 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:28,289 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:28 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:28,292 INFO  [http-nio-8899-exec-14]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:28,293 INFO  [http-nio-8899-exec-14]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:28 CST 2019.
2019-01-03 15:28:28,297 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:28,299 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:28,321 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:28 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@162a3188 
2019-01-03 15:28:28,324 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:28,326 ERROR [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:28,327 INFO  [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:28:28,327 INFO  [http-nio-8899-exec-15]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:28:28,328 WARN  [hystrix-KefuLiteWebapp-42]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:28 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@60f5a4cf 
2019-01-03 15:28:28,335 WARN  [hystrix-KefuLiteWebapp-42]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:28:28,336 ERROR [http-nio-8899-exec-13]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:28,340 INFO  [http-nio-8899-exec-6]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:28 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:28,342 INFO  [http-nio-8899-exec-6]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:28,343 INFO  [http-nio-8899-exec-6]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:28 CST 2019.
2019-01-03 15:28:28,348 INFO  [http-nio-8899-exec-6]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:28,349 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:28,350 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:28,353 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314, matched robot id is 83886084
2019-01-03 15:28:28,353 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - ServiceSessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314,tenantId 4 , get routing result RoutingResult(queueId=4, robotId=83886084, agentUserId=null)
2019-01-03 15:28:28,876 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:28,929 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:28,934 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session mark delay sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,939 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session state change to wait sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,939 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - publish ServiceSessionCreatedEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,939 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionCreatedEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,941 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.r.s.l.SchedulerListenerForServiceSession - new service session created {"source":{},"timestamp":1546500508939,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Wait","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserType":6,"createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentCallback":false,"userPK":{"tenantId":4},"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"channelData":{"tenantId":4,"type":"easemob","id":1,"dutyType":"None","timeScheduleId":0,"name":"体验关联","info":"easemob-demo#chatdemoui#153895"},"routingPolicyType":"Channel","kickOff":true}
2019-01-03 15:28:28,944 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.ServiceSessionTransferManager - schedule answer for schedule tenantId:4 agentUserId:abd3b006-0451-45ec-a33b-161bb0feeee5 serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314 transferToAgent:false force:true scheduleId:null fromQueueId:null toQueueId:null time:null finishAck:true
2019-01-03 15:28:28,945 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a4ebdb0-0f29-11e9-b74a-89ad24c4ce30","type":"com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent","timestamp":1546500508939,"body":{"source":{},"timestamp":1546500508939,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Wait","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserType":6,"createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentCallback":false,"userPK":{"tenantId":4},"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"channelData":{"tenantId":4,"type":"easemob","id":1,"dutyType":"None","timeScheduleId":0,"name":"体验关联","info":"easemob-demo#chatdemoui#153895"},"routingPolicyType":"Channel","kickOff":true}} has been send to kafka with in topic events partition 16, current offset is 4026
2019-01-03 15:28:28,952 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionOpenedEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,954 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionCreatedEvent ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=4, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), channelData=ChannelData(tenantId=4, type=IM, id=1, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=体验关联, info=easemob-demo#chatdemoui#153895), routingPolicyType=Channel)
2019-01-03 15:28:28,956 INFO  [SimpleAsyncTaskExecutor-4237]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionOpenedEvent, sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,957 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a50b980-0f29-11e9-9eeb-770f9c337dc9","type":"com.easemob.weichat.service.events.session.ServiceSessionOpenedEvent","timestamp":1546500508952,"body":{"source":{},"timestamp":1546500508952,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Processing","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"scheduleId":null,"kickOff":true}} has been send to kafka with in topic events partition 16, current offset is 4027
2019-01-03 15:28:28,958 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,958 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,963 INFO  [SimpleAsyncTaskExecutor-4238]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionOpenedEvent event:agent user [tenantId = 4scheduleId=null, userId = abd3b006-0451-45ec-a33b-161bb0feeee5] opened servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,964 INFO  [SimpleAsyncTaskExecutor-4240]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log : service session 6b2f39c9-e766-490b-85ff-0bb06a3ca314 opened to agent abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:28,969 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.r.s.l.SchedulerListenerForServiceSession - new service session created and auto dispatched sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,971 INFO  [SimpleAsyncTaskExecutor-4245]  c.e.w.r.s.l.ServiceSessionCreatedEventListener - expectedType is ServiceSessionCreatedEvent , event:ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=4, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), channelData=ChannelData(tenantId=4, type=IM, id=1, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=体验关联, info=easemob-demo#chatdemoui#153895), routingPolicyType=Channel)
2019-01-03 15:28:28,972 INFO  [SimpleAsyncTaskExecutor-4245]  c.e.w.r.s.l.ServiceSessionCreatedEventListener - ServiceSessionCreatedEventHandler | getKefuExt or visitor is null. message.getKefuExt():KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)
2019-01-03 15:28:28,972 INFO  [SimpleAsyncTaskExecutor-4246]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionCreatedEvent, sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,973 INFO  [SimpleAsyncTaskExecutor-3]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:2852b309-eb2e-450a-8642-e85f166c487a message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"NewChatMessage","body":{"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","newSession":true,"fromUser":{"tenantId":0,"userType":"Visitor","userScope":"Tenant","status":"Disable","bizId":"0","roles":"","scope":"Tenant"}}}],"timestamp":1546500508969,"type":null}
2019-01-03 15:28:28,973 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,973 INFO  [SimpleAsyncTaskExecutor-3]  c.e.w.n.service.PushDataService - prepare message noticeId:2852b309-eb2e-450a-8642-e85f166c487a messageType:NewChatMessage path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:28,975 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a532a80-0f29-11e9-8549-ef9b65b71a66","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500508968,"body":{"source":{},"timestamp":1546500508968,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"NewChatMessage","body":{"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","newSession":true,"fromUser":{"tenantId":0,"userType":"Visitor","userScope":"Tenant","status":"Disable","bizId":"0","roles":"","scope":"Tenant"}}}],"broadcast":false}}} has been send to kafka with in topic events partition 19, current offset is 2014
2019-01-03 15:28:28,976 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingSessionTimerService - Save timer for service session 6b2f39c9-e766-490b-85ff-0bb06a3ca314 into redis, notifyTime = Thu Jan 03 15:31:28 CST 2019 notifyCount = 1 notifyInterval = 180 closeTime = null closeInterval = 0 closeNotifyTime = null closeNotifyCount = 0 closeNotifyInterval = 0
2019-01-03 15:28:28,976 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.l.ServiceSessionRelatedEventListener - Succeed to create service session queue timer for created servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,977 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionCreatedEvent serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314,queueId:4
2019-01-03 15:28:28,977 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2019-01-03 15:28:28,978 INFO  [SimpleAsyncTaskExecutor-4237]  c.e.w.s.p.h.ServiceSessionEventHandler - updated session ProcessingSession(tenantId=4, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, skillGroupId=4, state=Processing, chatGroupId=118, createDateTime=Thu Jan 03 15:28:28 CST 2019, startDateTime=Thu Jan 03 15:28:28 CST 2019, originType=webim, fromAgentCallback=false, channelId=1, channelType=easemob, channelName=null, agentId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentNickName=机器人测试, agentType=6, visitorId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, visitorNickName=1, visitorUserName=webim-visitor-BRM392HYE7EBV8B4996K, customerId=35ae7ca7-bfbe-4510-9980-25222e2fca24, customerNickName=1, customerTrueName=null) when got ServiceSessionOpenedEvent.
2019-01-03 15:28:28,978 INFO  [SimpleAsyncTaskExecutor-4237]  c.e.w.s.p.h.ServiceSessionEventHandler - begin to persist customer 35ae7ca7-bfbe-4510-9980-25222e2fca24 tags from crm for session 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:28,979 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionCreatedEventHandler - systemMessage get ServiceSessionCreatedEvent,serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:28,979 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2a532a80-0f29-11e9-8549-ef9b65b71a66, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500508968, properties={}, body={source={}, timestamp=1546500508968, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=NewChatMessage, body={sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, newSession=true, fromUser={tenantId=0, userType=Visitor, userScope=Tenant, status=Disable, bizId=0, roles=, scope=Tenant}}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:28,979 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getQueueOption] ---> GET http://KefuLiteWebapp/v5/tenants/4/skillgroups/4/options/timeScheduleId HTTP/1.1
2019-01-03 15:28:29,008 INFO  [SimpleAsyncTaskExecutor-4238]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:agent user [tenantId = 4scheduleId=null, userId = abd3b006-0451-45ec-a33b-161bb0feeee5] opened servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,010 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.q.s.WaitingSessionTimerService - Save timer for service session 6b2f39c9-e766-490b-85ff-0bb06a3ca314 into redis, notifyTime = Thu Jan 03 15:31:28 CST 2019 notifyCount = 1 notifyInterval = 180 closeTime = null closeInterval = 0 closeNotifyTime = null closeNotifyCount = 0 closeNotifyInterval = 0
2019-01-03 15:28:29,010 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.q.l.ServiceSessionRelatedEventListener - Succeed to create service session queue timer for created servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:29,010 INFO  [SimpleAsyncTaskExecutor-4246]  c.e.w.s.p.h.ServiceSessionEventHandler - saved session ProcessingSession(tenantId=4, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, skillGroupId=4, state=Processing, chatGroupId=118, createDateTime=Thu Jan 03 15:28:28 CST 2019, startDateTime=Thu Jan 03 15:28:28 CST 2019, originType=webim, fromAgentCallback=false, channelId=1, channelType=easemob, channelName=体验关联, agentId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentNickName=机器人测试, agentType=6, visitorId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, visitorNickName=1, visitorUserName=webim-visitor-BRM392HYE7EBV8B4996K, customerId=35ae7ca7-bfbe-4510-9980-25222e2fca24, customerNickName=1, customerTrueName=null) when got ServiceSessionCreatedEvent.
2019-01-03 15:28:29,012 INFO  [SimpleAsyncTaskExecutor-4247]  c.e.w.h.l.ServiceSessionHistoryListener - handle ServiceSessionCreatedEvent, start, serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,012 INFO  [SimpleAsyncTaskExecutor-4247]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:ServiceSessionCreatedEvent(fromAgentCallback=false, userPK=User{tenantId=4, userId='null'}, easemobMessage=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=null, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), channelData=ChannelData(tenantId=4, type=IM, id=1, dutyType=None, agentQueueId=null, secondQueueId=null, robotId=null, secondRobotId=null, timeScheduleId=0, name=体验关联, info=easemob-demo#chatdemoui#153895), routingPolicyType=Channel)
2019-01-03 15:28:29,021 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - send serviceRequest 6b2f39c9-e766-490b-85ff-0bb06a3ca314 from processor
2019-01-03 15:28:29,024 ERROR [SimpleAsyncTaskExecutor-4246]  o.h.e.jdbc.spi.SqlExceptionHelper - Duplicate entry '6b2f39c9-e766-490b-85ff-0bb06a3ca314' for key 'PRIMARY'
2019-01-03 15:28:29,036 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.S_007_PublishSessionCreatedProcessor - serviceRequest 6b2f39c9-e766-490b-85ff-0bb06a3ca314 sended from processor
2019-01-03 15:28:29,038 ERROR [SimpleAsyncTaskExecutor-4246]  o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected error occurred invoking async method 'public void com.easemob.weichat.service.processing.handlers.ServiceSessionEventHandler.onEvent(com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent)'.
org.springframework.dao.DataIntegrityViolationException: could not execute statement; SQL [n/a]; constraint [PRIMARY]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:278)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:521)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:761)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:730)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:504)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:292)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor$1.call(AsyncExecutionInterceptor.java:115)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:59)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:42)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:109)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:95)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:207)
	at org.hibernate.engine.jdbc.batch.internal.NonBatchingBatch.addToBatch(NonBatchingBatch.java:45)
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2949)
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3449)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:89)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:582)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:456)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:337)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1282)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:465)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2963)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2339)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:485)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:147)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.access$100(JdbcResourceLocalTransactionCoordinatorImpl.java:38)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:231)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:65)
	at org.hibernate.jpa.internal.TransactionImpl.commit(TransactionImpl.java:61)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:517)
	... 9 common frames omitted
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry '6b2f39c9-e766-490b-85ff-0bb06a3ca314' for key 'PRIMARY'
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:935)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2490)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.executeUpdateInternal(PreparedStatement.java:2079)
	at com.mysql.jdbc.PreparedStatement.executeUpdateInternal(PreparedStatement.java:2013)
	at com.mysql.jdbc.PreparedStatement.executeLargeUpdate(PreparedStatement.java:5104)
	at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1998)
	at sun.reflect.GeneratedMethodAccessor596.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.tomcat.jdbc.pool.StatementFacade$StatementProxy.invoke(StatementFacade.java:114)
	at com.sun.proxy.$Proxy467.executeUpdate(Unknown Source)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:204)
	... 28 common frames omitted
2019-01-03 15:28:29,038 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.ServiceSessionTransferManager - schedule answer for pre-schedule tenantId:4 agentUserId:abd3b006-0451-45ec-a33b-161bb0feeee5 serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314 transferToAgent:false force:false scheduleId:null fromQueueId:null toQueueId:null time:null finishAck:false
2019-01-03 15:28:29,039 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionPreScheduleEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,040 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a5d8ac0-0f29-11e9-b7cc-8b133348388e","type":"com.easemob.weichat.service.events.servicerequest.PublishServiceRequestEvent","timestamp":1546500509036,"body":{"source":{},"timestamp":1546500509035,"actor":null,"version":"1.1","serviceRequest":{"id":null,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","originType":"webim","channel":{"id":1,"name":"体验关联","type":"easemob"},"skillGroup":{"id":25,"name":"abd3b006-0451-45ec-a33b-161bb0feeee5","type":"QueueTemp"},"visitorUser":{"id":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","nickname":"1","isVip":0},"specifiedDateTime":1546500508935},"skipRouting":false,"useSpecifiedTime":true}} has been send to kafka with in topic events partition 9, current offset is 2120
2019-01-03 15:28:29,043 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2a5d8ac0-0f29-11e9-b7cc-8b133348388e, service=null, type=com.easemob.weichat.service.events.servicerequest.PublishServiceRequestEvent, timestamp=1546500509036, properties={}, body={source={}, timestamp=1546500509035, actor=null, version=1.1, serviceRequest={id=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, originType=webim, channel={id=1, name=体验关联, type=easemob}, skillGroup={id=25, name=abd3b006-0451-45ec-a33b-161bb0feeee5, type=QueueTemp}, visitorUser={id=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, nickname=1, isVip=0}, specifiedDateTime=1546500508935}, skipRouting=false, useSpecifiedTime=true}, topic=events, partitionKey=null)
2019-01-03 15:28:29,044 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a5dfff0-0f29-11e9-95e8-1b76474d8da4","type":"com.easemob.weichat.service.events.session.ServiceSessionPreScheduleEvent","timestamp":1546500509039,"body":{"source":{},"timestamp":1546500509039,"actor":null,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Processing","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"preScheduleData":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Processing","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","toAgentUserType":"Robot","toAgentQueueId":null,"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"}}}} has been send to kafka with in topic events partition 16, current offset is 4028
2019-01-03 15:28:29,045 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a5e4e10-0f29-11e9-9812-7d2c7f78c42f","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500509041,"body":{"source":{},"timestamp":1546500509040,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"Schedule","body":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Processing","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","toAgentUserType":"Robot","toAgentQueueId":null,"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"}}}],"broadcast":false}}} has been send to kafka with in topic events partition 18, current offset is 2564
2019-01-03 15:28:29,046 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.Kefu_4100_PublishSessionCreatedWrapperProcessor - session clear delay sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,046 INFO  [SimpleAsyncTaskExecutor-4]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:30c15121-7b70-41cd-a295-19c443403b8e message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"Schedule","body":{"scheduleType":"Schedule","serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Processing","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true},"fromAgentUserId":"_2","toAgentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","toAgentUserType":"Robot","toAgentQueueId":null,"easemobMessage":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"}}}],"timestamp":1546500509041,"type":null}
2019-01-03 15:28:29,046 INFO  [SimpleAsyncTaskExecutor-4]  c.e.w.n.service.PushDataService - prepare message noticeId:30c15121-7b70-41cd-a295-19c443403b8e messageType:Schedule path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,047 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2a5e4e10-0f29-11e9-9812-7d2c7f78c42f, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500509041, properties={}, body={source={}, timestamp=1546500509040, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=Schedule, body={scheduleType=Schedule, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=83886084, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, toAgentUserType=Robot, toAgentQueueId=null, easemobMessage={bodies=[{msg=111, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:29,063 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#getQueueOption] <--- HTTP/1.1 200 (83ms)
2019-01-03 15:28:29,064 INFO  [SimpleAsyncTaskExecutor-4247]  c.e.w.h.client.RemoteCustomerClient -  findByTenantIdAndVisitorId use CrmApiClient , query: tenantId=4,visitorId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 
2019-01-03 15:28:29,065 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] ---> GET http://KefuLiteWebapp/v5/tenants/4/istimeoffduty?scheduleId=0&dateTime=2019-01-03+15%3A28%3A29 HTTP/1.1
2019-01-03 15:28:29,067 INFO  [SimpleAsyncTaskExecutor-4249]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=111), msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509047, createMicroTimestamp=1546500509047000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), queueId=4, robotId=83886084, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,070 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 to 1546500509047 driven by message 82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b
2019-01-03 15:28:29,072 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a61f790-0f29-11e9-9c0f-a7dce65f8cf8","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500509065,"body":{"timestamp":1546500509065,"version":"1.1","tenantId":4,"message":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"111"},"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":11,"sessionServiceSeqId":1,"createDateTime":1546500509047,"timestamp":1546500509047,"createMicroTimestamp":1546500509047000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":83886084,"state":"Processing","chatGroupId":118,"messageSeqId":0,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4029
2019-01-03 15:28:29,076 WARN  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.SendTimeoutEventService - clear robot timeout notify count key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314 has something wrong
2019-01-03 15:28:29,077 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a637e30-0f29-11e9-9a6f-9d4591f7f46e","type":"com.easemob.weichat.service.timeout.event.TimeoutClearEvent","timestamp":1546500509075,"body":{"source":{},"timestamp":1546500509075,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500509075,"duration":0,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":1,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509047,"timestamp":1546500509000,"createMicroTimestamp":1546500509047000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic timeout-events-in partition 16, current offset is 348
2019-01-03 15:28:29,078 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - tenantId 4 message handle by robotmessageProcess
2019-01-03 15:28:29,081 INFO  [SimpleAsyncTaskExecutor-19]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:ef5b7af2-0159-4895-aa2f-c3db18f61cfc message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":11,"sessionServiceSeqId":1,"createDateTime":1546500509047,"timestamp":1546500509047,"createMicroTimestamp":1546500509047000}}],"timestamp":1546500509077,"type":null}
2019-01-03 15:28:29,081 INFO  [SimpleAsyncTaskExecutor-19]  c.e.w.n.service.PushDataService - prepare message noticeId:ef5b7af2-0159-4895-aa2f-c3db18f61cfc messageType:NewChatMessage path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,081 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a63cc50-0f29-11e9-98e6-bfad4827d933","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500509077,"body":{"source":{},"timestamp":1546500509077,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":11,"sessionServiceSeqId":1,"createDateTime":1546500509047,"timestamp":1546500509047,"createMicroTimestamp":1546500509047000}}],"broadcast":false}}} has been send to kafka with in topic events partition 12, current offset is 2508
2019-01-03 15:28:29,092 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:29 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:29,094 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:29,095 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:29 CST 2019.
2019-01-03 15:28:29,099 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:29,101 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.client.TimePlanFeignClient - [TimePlanFeignClient#isTimeOffDuty] <--- HTTP/1.1 200 (35ms)
2019-01-03 15:28:29,108 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 4 , serviceSessionId : 6b2f39c9-e766-490b-85ff-0bb06a3ca314,agentUserId : abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,112 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/4/messages HTTP/1.1
2019-01-03 15:28:29,117 INFO  [SimpleAsyncTaskExecutor-4247]  c.e.w.h.l.ServiceSessionHistoryListener - handle ServiceSessionCreatedEvent, end, serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,146 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/4/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"to":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","status":"Disable","bizId":"4","roles":"","scope":"Tenant"},"officialAccountId":null,"messageRequest":{"msg":"ServiceSessionCreatedEvent","type":"cmd","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":"ServiceSessionCreatedEvent","ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","mediaFileUrl":null,"tenantId":4,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","saveMessage":true}
2019-01-03 15:28:29,152 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,154 INFO  [http-nio-8899-exec-3]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,154 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - agent is robot and chatMessage is ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509047, createMicroTimestamp=1546500509047000) ___________ serviceSession is ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509000, createMicroTimestamp=1546500509047000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:28:29,207 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:29,216 INFO  [http-nio-8899-exec-5]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/6b2f39c9-e766-490b-85ff-0bb06a3ca314/official-accounts
2019-01-03 15:28:29,219 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,219 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - tenantId 4 message reply by robot,serviceSessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,220 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - get answer by robot route tenantid 4 and msg is 111
2019-01-03 15:28:29,235 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:29,236 INFO  [http-nio-8899-exec-3]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:4696b951-092d-45a5-8ced-d766a2632227
2019-01-03 15:28:29,257 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"4696b951-092d-45a5-8ced-d766a2632227","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:28:29,269 INFO  [SimpleAsyncTaskExecutor-4252]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=4696b951-092d-45a5-8ced-d766a2632227, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat=KefuExtMessage(msgId=4696b951-092d-45a5-8ced-d766a2632227, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionCreatedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=12, sessionServiceSeqId=2, createDateTime=2019-01-03 15:28:29.147, timestamp=1546500509147, createMicroTimestamp=1546500509147000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509000, createMicroTimestamp=1546500509047000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,273 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a80a320-0f29-11e9-9f41-85105c050ac9","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500509267,"body":{"timestamp":1546500509266,"version":"1.1","tenantId":4,"message":{"msgId":"4696b951-092d-45a5-8ced-d766a2632227","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"4696b951-092d-45a5-8ced-d766a2632227","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":12,"sessionServiceSeqId":2,"createDateTime":1546500509147,"timestamp":1546500509147,"createMicroTimestamp":1546500509147000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":1,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509047,"timestamp":1546500509000,"createMicroTimestamp":1546500509047000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4030
2019-01-03 15:28:29,274 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.SendTimeoutEventService - this message {"msgId":"4696b951-092d-45a5-8ced-d766a2632227","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"4696b951-092d-45a5-8ced-d766a2632227","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":12,"sessionServiceSeqId":2,"createDateTime":1546500509147,"timestamp":1546500509147,"createMicroTimestamp":1546500509147000} is cmd Message .
2019-01-03 15:28:29,275 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (162ms)
2019-01-03 15:28:29,279 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2a4ebdb0-0f29-11e9-b74a-89ad24c4ce30, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionCreatedEvent, timestamp=1546500508939, properties={}, body={source={}, timestamp=1546500508939, actor=null, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=83886084, state=Wait, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserType=6, createDatetime=2019-01-03 15:28:28, techChannelType=easemob, originType=webim, expire=true}, fromAgentCallback=false, userPK={tenantId=4}, easemobMessage={bodies=[{msg=111, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, channelData={tenantId=4, type=easemob, id=1, dutyType=None, timeScheduleId=0, name=体验关联, info=easemob-demo#chatdemoui#153895}, routingPolicyType=Channel, kickOff=true}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,303 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingSessionTimerService - Clear service session queue timer for session 6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:28:29,303 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionOpenedEvent serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314,queueId:4
2019-01-03 15:28:29,304 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2019-01-03 15:28:29,305 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionOpenedEventHandler - systemMessage get ServiceSessionOpenedEvent serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,304 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2a63cc50-0f29-11e9-98e6-bfad4827d933, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500509077, properties={}, body={source={}, timestamp=1546500509077, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=NewChatMessage, body={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=1546500509047, timestamp=1546500509047, createMicroTimestamp=1546500509047000}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:29,310 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.s.t.TransferedSessionNoPerceptionRedisService - redis key agent.greeting.number.6b2f39c9-e766-490b-85ff-0bb06a3ca314 set value = 1 ,expire day-time 1
2019-01-03 15:28:29,312 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 4 , serviceSessionId : 6b2f39c9-e766-490b-85ff-0bb06a3ca314,agentUserId : abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,316 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/4/messages HTTP/1.1
2019-01-03 15:28:29,354 INFO  [http-nio-8899-exec-14]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/4/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"to":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","status":"Disable","bizId":"4","roles":"","scope":"Tenant"},"officialAccountId":null,"messageRequest":{"msg":"ServiceSessionOpenedEvent","type":"cmd","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":"ServiceSessionOpenedEvent","ext":{"weichat":{"msgId":null,"originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","mediaFileUrl":null,"tenantId":4,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","saveMessage":true}
2019-01-03 15:28:29,360 INFO  [http-nio-8899-exec-14]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,374 INFO  [http-nio-8899-exec-13]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"abd3b006-0451-45ec-a33b-161bb0feeee5","tenantId":4,"type":"StateChange"}}],"timestamp":1546500509358,"type":null}
2019-01-03 15:28:29,374 INFO  [http-nio-8899-exec-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:7c7771d4-5d4e-426b-bb4d-2bed0cdf9de3 message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"abd3b006-0451-45ec-a33b-161bb0feeee5","tenantId":4,"type":"StateChange"}}],"timestamp":1546500509358,"type":null}
2019-01-03 15:28:29,374 INFO  [http-nio-8899-exec-13]  c.e.w.n.service.PushDataService - prepare message noticeId:7c7771d4-5d4e-426b-bb4d-2bed0cdf9de3 messageType:Daas path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,390 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - askRobotIntegrationForAnswer error, return default value 机器人刚刚开小差了，请转人工服务
2019-01-03 15:28:29,392 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied serviceSession {"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":1,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509047,"timestamp":1546500509000,"createMicroTimestamp":1546500509047000},"techChannelType":"easemob","originType":"webim","expire":true} ,RobotAnswer is {"enableSilence":false,"type":0,"content":"机器人刚刚开小差了，请转人工服务","similarity":null,"words":null,"answerType":null} ,ServiceSessionRobot is {"id":298,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","robotId":83886084,"createdAt":"2019-01-03 15:28:28","updatedAt":"2019-01-03 15:28:28"}
2019-01-03 15:28:29,392 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied RobotAnswer(enableSilence=false, answerType=ERROR, type=0, content=机器人刚刚开小差了，请转人工服务, similarity=null, words=null, answerDataType=null) to visitor for question ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat=KefuExtMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509047, createMicroTimestamp=1546500509047000)
2019-01-03 15:28:29,397 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/6b2f39c9-e766-490b-85ff-0bb06a3ca314/official-accounts
2019-01-03 15:28:29,411 INFO  [http-nio-8899-exec-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:d9fb215b-c817-4ff2-abe6-b2dc6da79441
2019-01-03 15:28:29,441 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"d9fb215b-c817-4ff2-abe6-b2dc6da79441","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:28:29,447 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,453 INFO  [SimpleAsyncTaskExecutor-4255]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=d9fb215b-c817-4ff2-abe6-b2dc6da79441, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat=KefuExtMessage(msgId=d9fb215b-c817-4ff2-abe6-b2dc6da79441, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionOpenedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=null, msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=13, sessionServiceSeqId=3, createDateTime=2019-01-03 15:28:29.354, timestamp=1546500509354, createMicroTimestamp=1546500509354000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=2, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=4696b951-092d-45a5-8ced-d766a2632227, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=4696b951-092d-45a5-8ced-d766a2632227, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.147, timestamp=1546500509000, createMicroTimestamp=1546500509147000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,456 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2a9cddb0-0f29-11e9-b555-cf91819167ca","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500509451,"body":{"timestamp":1546500509451,"version":"1.1","tenantId":4,"message":{"msgId":"d9fb215b-c817-4ff2-abe6-b2dc6da79441","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"d9fb215b-c817-4ff2-abe6-b2dc6da79441","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":13,"sessionServiceSeqId":3,"createDateTime":1546500509354,"timestamp":1546500509354,"createMicroTimestamp":1546500509354000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":2,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"4696b951-092d-45a5-8ced-d766a2632227","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionCreatedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"4696b951-092d-45a5-8ced-d766a2632227","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionCreatedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509147,"timestamp":1546500509000,"createMicroTimestamp":1546500509147000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4031
2019-01-03 15:28:29,461 INFO  [http-nio-8899-exec-14]  c.e.w.s.t.SendTimeoutEventService - this message {"msgId":"d9fb215b-c817-4ff2-abe6-b2dc6da79441","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"d9fb215b-c817-4ff2-abe6-b2dc6da79441","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentType":6,"sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":13,"sessionServiceSeqId":3,"createDateTime":1546500509354,"timestamp":1546500509354,"createMicroTimestamp":1546500509354000} is cmd Message .
2019-01-03 15:28:29,463 DEBUG [hystrix-KefuLiteWebapp-46]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (146ms)
2019-01-03 15:28:29,466 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2a50b980-0f29-11e9-9eeb-770f9c337dc9, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionOpenedEvent, timestamp=1546500508952, properties={}, body={source={}, timestamp=1546500508952, actor=null, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=83886084, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, techChannelType=easemob, originType=webim, expire=true}, userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, scheduleId=null, kickOff=true}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,479 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=111}, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509047, createMicroTimestamp=1546500509047000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=Sat Dec 29 01:13:42 CST 2018, lastUpdateDateTime=Sat Dec 29 01:13:42 CST 2018, sendMessageCount=0), queueId=4, robotId=83886084, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=null, techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,479 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2a5dfff0-0f29-11e9-95e8-1b76474d8da4, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionPreScheduleEvent, timestamp=1546500509039, properties={}, body={source={}, timestamp=1546500509039, actor=null, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=83886084, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, techChannelType=easemob, originType=webim, expire=true}, easemobMessage={bodies=[{msg=111, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, preScheduleData={scheduleType=Schedule, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=83886084, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, techChannelType=easemob, originType=webim, expire=true}, fromAgentUserId=_2, toAgentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, toAgentUserType=Robot, toAgentQueueId=null, easemobMessage={bodies=[{msg=111, type=txt}], ext={weichat={msgId=null, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,482 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 4 , serviceSessionId : 6b2f39c9-e766-490b-85ff-0bb06a3ca314,agentUserId : abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,485 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2a61f790-0f29-11e9-9c0f-a7dce65f8cf8, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500509065, properties={}, body={timestamp=1546500509065, version=1.1, tenantId=4, message={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=111}, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=1546500509047, timestamp=1546500509047, createMicroTimestamp=1546500509047000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=83886084, state=Processing, chatGroupId=118, messageSeqId=0, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,496 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=4696b951-092d-45a5-8ced-d766a2632227, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=4696b951-092d-45a5-8ced-d766a2632227, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=12, sessionServiceSeqId=2, createDateTime=2019-01-03 15:28:29.147, timestamp=1546500509147, createMicroTimestamp=1546500509147000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509000, createMicroTimestamp=1546500509047000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,498 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,500 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2a80a320-0f29-11e9-9f41-85105c050ac9, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500509267, properties={}, body={timestamp=1546500509266, version=1.1, tenantId=4, message={msgId=4696b951-092d-45a5-8ced-d766a2632227, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionCreatedEvent, type=cmd}], ext={weichat={msgId=4696b951-092d-45a5-8ced-d766a2632227, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=12, sessionServiceSeqId=2, createDateTime=1546500509147, timestamp=1546500509147, createMicroTimestamp=1546500509147000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500509047, timestamp=1546500509000, createMicroTimestamp=1546500509047000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,507 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.service.message.Processor - tenantid is 4 Label is zh-CN
2019-01-03 15:28:29,507 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.service.message.Processor - tenantid is 4  locale is zh-CN and weichatExt is KefuExtMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs=RobotServiceSessionTransfer(id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服), event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=null, type=SYSTEM, img=null, scheduleInfo=null), marketing=null, reserveQueue=null, matchFlag=null)
2019-01-03 15:28:29,512 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=d9fb215b-c817-4ff2-abe6-b2dc6da79441, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=d9fb215b-c817-4ff2-abe6-b2dc6da79441, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=13, sessionServiceSeqId=3, createDateTime=2019-01-03 15:28:29.354, timestamp=1546500509354, createMicroTimestamp=1546500509354000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=2, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=4696b951-092d-45a5-8ced-d766a2632227, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@2dc72973], ext={weichat={msgId=4696b951-092d-45a5-8ced-d766a2632227, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.147, timestamp=1546500509000, createMicroTimestamp=1546500509147000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,518 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2a9cddb0-0f29-11e9-b555-cf91819167ca, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500509451, properties={}, body={timestamp=1546500509451, version=1.1, tenantId=4, message={msgId=d9fb215b-c817-4ff2-abe6-b2dc6da79441, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionOpenedEvent, type=cmd}], ext={weichat={msgId=d9fb215b-c817-4ff2-abe6-b2dc6da79441, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=13, sessionServiceSeqId=3, createDateTime=1546500509354, timestamp=1546500509354, createMicroTimestamp=1546500509354000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=2, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=4696b951-092d-45a5-8ced-d766a2632227, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionCreatedEvent, type=cmd}], ext={weichat={msgId=4696b951-092d-45a5-8ced-d766a2632227, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionCreatedEvent, eventObj={userId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentType=6, sessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500509147, timestamp=1546500509000, createMicroTimestamp=1546500509147000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,615 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotAgentIdFromIntegration feign client success, tenantId : 4, robotAgentId : abd3b006-0451-45ec-a33b-161bb0feeee5, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,615 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,647 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/6b2f39c9-e766-490b-85ff-0bb06a3ca314/official-accounts
2019-01-03 15:28:29,667 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:0a3c56d3-3ad3-45a5-9b52-717efc9855e5
2019-01-03 15:28:29,700 INFO  [http-nio-8899-exec-2]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:28:29,711 INFO  [SimpleAsyncTaskExecutor-4258]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=RobotUser(robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, tenantId=4, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=60, createdTime=null, lastUpdatedTime=null, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat=KefuExtMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=机器人测试, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=机器人刚刚开小差了，请转人工服务), msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=14, sessionServiceSeqId=2, createDateTime=2019-01-03 15:28:29.615, timestamp=1546500509615, createMicroTimestamp=1546500509615000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509000, createMicroTimestamp=1546500509047000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,714 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2ac43bd0-0f29-11e9-b70b-8114d960a21e","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500509709,"body":{"timestamp":1546500509709,"version":"1.1","tenantId":4,"message":{"msgId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"c6e0fed1-8bed-4490-8629-d0075b2064d8","userType":"Robot","userScope":"Tenant","nicename":"机器人测试","robotId":"c6e0fed1-8bed-4490-8629-d0075b2064d8","type":0,"active":false,"rule":0,"enableMenu":false,"enableGreeting":false,"enableSimilarQuestionTransfer":false,"enableNoAnswerTransfer":false,"enableFreeChat":false,"currentServiceSessionCount":0,"maxServiceSessionCount":0,"timeout":60,"robotRouteId":"83886084","robotAgentId":"abd3b006-0451-45ec-a33b-161bb0feeee5","digitalMenu":false,"roles":"robot","username":"c6e0fed1-8bed-4490-8629-d0075b2064d8","status":"Disable","bizId":"0","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"569065b5-0e05-4c08-ad96-89433fe17fd8","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"机器人刚刚开小差了，请转人工服务"},"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":14,"sessionServiceSeqId":2,"createDateTime":1546500509615,"timestamp":1546500509615,"createMicroTimestamp":1546500509615000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":1,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509047,"timestamp":1546500509000,"createMicroTimestamp":1546500509047000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4032
2019-01-03 15:28:29,719 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=4, userId=c6e0fed1-8bed-4490-8629-d0075b2064d8, userType=Robot, userScope=Tenant, nicename=机器人测试), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=机器人刚刚开小差了，请转人工服务}, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=14, sessionServiceSeqId=2, createDateTime=2019-01-03 15:28:29.615, timestamp=1546500509615, createMicroTimestamp=1546500509615000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@be11], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:28 CST 2019, msgId=553774650249707924, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.047, timestamp=1546500509000, createMicroTimestamp=1546500509047000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:29,723 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2ac43bd0-0f29-11e9-b70b-8114d960a21e, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500509709, properties={}, body={timestamp=1546500509709, version=1.1, tenantId=4, message={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=c6e0fed1-8bed-4490-8629-d0075b2064d8, userType=Robot, userScope=Tenant, nicename=机器人测试, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5, digitalMenu=false, roles=robot, username=c6e0fed1-8bed-4490-8629-d0075b2064d8, status=Disable, bizId=0, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=机器人刚刚开小差了，请转人工服务, type=txt}], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=机器人刚刚开小差了，请转人工服务}, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=14, sessionServiceSeqId=2, createDateTime=1546500509615, timestamp=1546500509615, createMicroTimestamp=1546500509615000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=1, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500509047, timestamp=1546500509000, createMicroTimestamp=1546500509047000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,766 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,789 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:29,815 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:29,816 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.SendTimeoutEventService - robot timeout is 60 from sendRobotTimeoutFirstStartEvent
2019-01-03 15:28:29,817 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:29 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:29,817 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.SendTimeoutEventService - set robot timeout notify count key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314 for serviceSession 6b2f39c9-e766-490b-85ff-0bb06a3ca314 notify count is 1 , value is 2
2019-01-03 15:28:29,819 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:29,820 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:29 CST 2019.
2019-01-03 15:28:29,820 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2ad48f80-0f29-11e9-b0f1-29c49278f438","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546500509816,"body":{"source":{},"timestamp":1546500509816,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500509816,"duration":60,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":1,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509047,"timestamp":1546500509000,"createMicroTimestamp":1546500509047000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 16, current offset is 349
2019-01-03 15:28:29,818 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.service.message.Processor - tenantId is 4 send toVisitorMessage is ChatMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=RobotUser(robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, tenantId=4, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=60, createdTime=null, lastUpdatedTime=null, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat=KefuExtMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=机器人测试, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=333d6a26-9b98-46c6-91b6-20f052746ee9, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=14, sessionServiceSeqId=2, createDateTime=2019-01-03 15:28:29.615, timestamp=1546500509615, createMicroTimestamp=1546500509615000)
2019-01-03 15:28:29,827 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:29,834 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:29,836 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2ad66440-0f29-11e9-a5b7-d113555a5376","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500509828,"body":{"source":{},"timestamp":1546500509828,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"569065b5-0e05-4c08-ad96-89433fe17fd8","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":11,"sessionServiceSeqId":1,"createDateTime":1546500509047,"timestamp":1546500509047,"createMicroTimestamp":1546500509047000}}],"broadcast":false}}} has been send to kafka with in topic events partition 3, current offset is 2946
2019-01-03 15:28:29,837 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:5996f134-d211-4b83-aa85-76145a182171 message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"111","type":"txt"}],"ext":{"weichat":{"msgId":"82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"569065b5-0e05-4c08-ad96-89433fe17fd8","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","type":"SYSTEM"},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500508211,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774650249707924","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":11,"sessionServiceSeqId":1,"createDateTime":1546500509047,"timestamp":1546500509047,"createMicroTimestamp":1546500509047000}}],"timestamp":1546500509831,"type":null}
2019-01-03 15:28:29,837 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.PushDataService - prepare message noticeId:5996f134-d211-4b83-aa85-76145a182171 messageType:NewChatMessage path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,839 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2ad66440-0f29-11e9-a5b7-d113555a5376, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500509828, properties={}, body={source={}, timestamp=1546500509828, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=NewChatMessage, body={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=111, type=txt}], ext={weichat={msgId=82a8136c-9b34-4c95-90fb-1e1cc9e5ba3b, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, type=SYSTEM}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500508211, tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774650249707924, channel_id=1, channel_name=体验关联}, chatGroupSeqId=11, sessionServiceSeqId=1, createDateTime=1546500509047, timestamp=1546500509047, createMicroTimestamp=1546500509047000}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:29,871 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:29 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:29,873 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:29,874 INFO  [http-nio-8899-exec-15]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:29 CST 2019.
2019-01-03 15:28:29,878 INFO  [http-nio-8899-exec-15]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:29,880 INFO  [http-nio-8899-exec-3]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:29,880 INFO  [http-nio-8899-exec-3]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:29,885 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:28:29,885 INFO  [http-nio-8899-exec-3]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:28:29,933 ERROR [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  c.e.w.s.s.impl.BaiduApiIpLookUp - ipToRegion error ip:88.0.64.49
com.fasterxml.jackson.core.JsonParseException: Unexpected character ('<' (code 60)): expected a valid value (number, String, array, object, 'true', 'false' or 'null')
 at [Source: <!DOCTYPE html>
<!--STATUS OK-->
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta content="always" name="referrer">
    <script src="https://ss1.bdstatic.com/5eN1bjq8AAUYm2zgoY3K/r/www/nocache/imgdata/seErrorRec.js"></script>
    <title>é¡µé¢ä¸å­å¨_ç¾åº¦æç´¢</title>
    <style data-for="result">
        body {color: #333; background: #fff; padding: 0; margin: 0; position: relative; min-width: 700px; font-family: arial; font-size: 12px }
        p, form, ol, ul, li, dl, dt, dd, h3 {margin: 0; padding: 0; list-style: none }
        input {padding-top: 0; padding-bottom: 0; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box } img {border: none; }
        .logo {width: 117px; height: 38px; cursor: pointer }
         #wrapper {_zoom: 1 }
        #head {padding-left: 35px; margin-bottom: 20px; width: 900px }
        .fm {clear: both; position: relative; z-index: 297 }
        .btn, #more {font-size: 14px } 
        .s_btn {width: 95px; height: 32px; padding-top: 2px\9; font-size: 14px; padding: 0; background-color: #ddd; background-position: 0 -48px; border: 0; cursor: pointer }
        .s_btn_h {background-position: -240px -48px }
        .s_btn_wr {width: 97px; height: 34px; display: inline-block; background-position: -120px -48px; *position: relative; z-index: 0; vertical-align: top }
        #foot {}
        #foot span {color: #666 }
        .s_ipt_wr {height: 32px }
        .s_form:after, .s_tab:after {content: "."; display: block; height: 0; clear: both; visibility: hidden }
        .s_form {zoom: 1; height: 55px; padding: 0 0 0 10px }
        #result_logo {float: left; margin: 7px 0 0 }
        #result_logo img {width: 101px }
        #head {padding: 0; margin: 0; width: 100%; position: absolute; z-index: 301; min-width: 1000px; background: #fff; border-bottom: 1px solid #ebebeb; position: fixed; _position: absolute; -webkit-transform: translateZ(0) }
        #head .head_wrapper {_width: 1000px }
        #head.s_down {box-shadow: 0 0 5px #888 }
        .fm {clear: none; float: left; margin: 11px 0 0 10px }
        #s_tab {background: #f8f8f8; line-height: 36px; height: 38px; padding: 55px 0 0 121px; float: none; zoom: 1 }
        #s_tab a, #s_tab b {width: 54px; display: inline-block; text-decoration: none; text-align: center; color: #666; font-size: 14px }
        #s_tab b {border-bottom: 2px solid #38f; font-weight: bold; color: #323232 }
        #s_tab a:hover {color: #323232 }
        #content_left {width: 540px; padding-left: 121px; padding-top: 5px }
        .to_tieba, .to_zhidao_bottom {margin: 10px 0 0 121px }
        #help {background: #f5f6f5; zoom: 1; padding: 0 0 0 50px; float: right }
        #help a {color: #777; padding: 0 15px; text-decoration: none }
        #help a:hover {color: #333 }
        #foot {position: fixed; bottom:0; width: 100%; background: #f5f6f5; border-top: 1px solid #ebebeb; text-align: left; height: 42px; line-height: 42px; margin-top: 40px; *margin-top: 0; _position:absolute; _bottom:auto; _top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0)-(parseInt(this.currentStyle.marginBottom,10)||0))); }

        .content_none {padding: 45px 0 25px 121px } .s_ipt_wr.bg,
        .s_btn_wr.bg, #su.bg {background-image: none }
        .s_ipt_wr.bg {background: 0 }
        .s_btn_wr {width: auto; height: auto; border-bottom: 1px solid transparent; *border-bottom: 0 }
        .s_btn {width: 100px; height: 34px; color: white; letter-spacing: 1px; background: #3385ff; border-bottom: 1px solid #2d78f4; outline: medium; *border-bottom: 0; -webkit-appearance: none; -webkit-border-radius: 0 }
        .s_btn:hover {background: #317ef3; border-bottom: 1px solid #2868c8; *border-bottom: 0; box-shadow: 1px 1px 1px #ccc }
        .s_btn:active {background: #3075dc; box-shadow: inset 1px 1px 3px #2964bb; -webkit-box-shadow: inset 1px 1px 3px #2964bb; -moz-box-shadow: inset 1px 1px 3px #2964bb; -o-box-shadow: inset 1px 1px 3px #2964bb }
        #lg {display: none }
        #head .headBlock {margin: -5px 0 6px 121px }
        #content_left .leftBlock {margin-bottom: 14px; padding-bottom: 5px; border-bottom: 1px solid #f3f3f3 }
        .s_ipt_wr {border: 1px solid #b6b6b6; border-color: #7b7b7b #b6b6b6 #b6b6b6 #7b7b7b; background: #fff; display: inline-block; vertical-align: top; width: 539px; margin-right: 0; border-right-width: 0; border-color: #b8b8b8 transparent #ccc #b8b8b8; overflow: hidden }
        .s_ipt_wr.ip_short {width: 439px; }
        .s_ipt_wr:hover, .s_ipt_wr.ipthover {border-color: #999 transparent #b3b3b3 #999 }
        .s_ipt_wr.iptfocus {border-color: #4791ff transparent #4791ff #4791ff }
        .s_ipt_tip {color: #aaa; position: absolute; z-index: -10; font: 16px/22px arial; height: 32px; line-height: 32px; padding-left: 7px; overflow: hidden; width: 526px }
        .s_ipt {width: 526px; height: 22px; font: 16px/18px arial; line-height: 22px\9; margin: 6px 0 0 7px; padding: 0; background: transparent; border: 0; outline: 0; -webkit-appearance: none }
        #kw {position: relative;display: inline-block;}
        input::-ms-clear {display: none }
        /*Error page css*/
        .norsSuggest {display: inline-block; color: #333; font-family: arial; font-size: 13px; position: relative; } 
        .norsTitle {font-size: 22px; font-family: Microsoft Yahei; font-weight: normal; color: #333; margin: 35px 0 25px 0; }
        .norsTitle2 {font-family: arial; font-size: 13px; color: #666; }
        .norsSuggest ol {margin-left: 47px; }
        .norsSuggest li {margin: 13px 0; }
        #content_right {
    border-left: 1px solid #e1e1e1;
    width: 384px;
    margin-top: 25px;
    float: right;
    padding-left: 17px;
}
#wrapper_wrapper {
    width: 1212px;
}
.cr-content {
    width: 351px;
    font-size: 13px;
    line-height: 1.54em;
    color: #333;
    margin-top: 6px;
    margin-bottom: 28px;
    word-wrap: break-word;
    word-break: normal;
}
@media screen and (max-width: 1217px) {
    #wrapper_wrapper {
        width: 1002px;
    }
    #wrapper_wrapper #content_right {
        width: 271px;
    }
    #wrapper_wrapper .cr-content {
        width: 259px;
    }
}
.opr-toplist-title {
    position: relative;
    font-size: 14px;
    line-height: 1.29em;
    font-weight: 700;
    margin-bottom: 10px;
}
.opr-toplist-table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    font-size: 13px;
}
.opr-toplist-table th,td {
    line-height: 1.54;
    border-bottom: 1px solid #f3f3f3;
    text-align: left;
}
.opr-toplist-table thead th {
    padding-top: 4px;
    padding-bottom: 4px;
    font-weight: 400;
    color: #666;
    white-space: nowrap;
    background-color: #fafafa;  
}
.opr-toplist-table .opr-toplist-right {
    text-align: right;
    white-space: nowrap;
}
.opr-toplist-table td {
    width: 100%;
    font-size: 13px;
    padding-top: 6.5px;
    padding-bottom: 6.5px;
    vertical-align: top;
}
.opr-toplist-table a:hover {
    text-decoration: underline;
}
.opr-index-item {
    display: inline-block;
    padding:1px 0;
    color: #fff;
    width: 14px;
    line-height: 100%;
    font-size: 12px;
    text-align: center;
    background-color: #8eb9f5;
    margin-right: 5px;
}
.opr-index-hot1 {
    background-color: #f54545;
}

.opr-index-hot2 {
    background-color: #ff8547;
}
.opr-index-hot3 {
    background-color: #ffac38;
}
.opr-item-text {
    text-decoration: none;  
}
.opr-toplist-info {
    color: #666;
    text-align: right;
    margin-top: 5px;
}
.opr-toplist-info>a {
    color: #666;
}
    </style>
</head>

<body link="#0000cc">
    <div id="wrapper" class="wrapper_l">
        <div id="head">
            <div class="head_wrapper">
                <div class="s_form">
                    <div class="s_form_wrapper">
                        <a href="//www.baidu.com/" id="result_logo"><img src="//www.baidu.com/img/baidu_jgylogo3.gif" alt="å°ç¾åº¦é¦é¡µ" title="å°ç¾åº¦é¦é¡µ"></a>
                        <form id="form" name="f" action="//www.baidu.com/s" class="fm">
                            <input type="hidden" name="ie" value="utf-8">
                            <input type="hidden" name="f" value="8">
                            <input type="hidden" name="rsv_bp" value="1">
                            <input type="hidden" name="ch" value="">
                            <input type="hidden" name="tn" value="baiduerr">
                            <input type="hidden" name="bar" value="">
                            <span class="bg s_ipt_wr iptfocus">
                                <input id="kw" name="wd" class="s_ipt" value="" maxlength="255" autocomplete="off" autofocus>
                            </span><span class="bg s_btn_wr">
                                <input type="submit" id="su" value="ç¾åº¦ä¸ä¸" class="bg s_btn">
                            </span>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="s_tab" id="s_tab">
        <b>ç½é¡µ</b>
        <a href="http://tieba.baidu.com/f?kw=&fr=wwwt" wdfield="kw">è´´å§</a>
        <a href="http://zhidao.baidu.com/q?ct=17&pn=0&tn=ikaslist&rn=10&word=&fr=wwwt" wdfield="word">ç¥é</a>
        <a href="http://music.baidu.com/search?fr=ps&ie=utf-8&key=" wdfield="key">é³ä¹</a>
        <a href="http://image.baidu.com/i?tn=baiduimage&ps=1&ct=201326592&lm=-1&cl=2&nc=1&ie=utf-8&word=" wdfield="word">å¾ç</a>
        <a href="http://v.baidu.com/v?ct=301989888&rn=20&pn=0&db=0&s=25&ie=utf-8&word=" wdfield="word">è§é¢</a>
        <a href="http://map.baidu.com/m?word=&fr=ps01000" wdfield="word">å°å¾</a>
        <a href="http://wenku.baidu.com/search?word=&lm=0&od=0&ie=utf-8" wdfield="word">æåº</a>
        <a href="//www.baidu.com/more/">æ´å¤Â»</a>
    </div>
    <div id="wrapper_wrapper">
        <div id="content_left">
            <div class="nors">
                <div class="norsSuggest">
                    <h3 class="norsTitle">å¾æ±æ­ï¼æ¨è¦è®¿é®çé¡µé¢ä¸å­å¨ï¼</h3>
                    <p class="norsTitle2">æ¸©é¦¨æç¤ºï¼</p>
                    <ol>
                        <li>è¯·æ£æ¥æ¨è®¿é®çç½åæ¯å¦æ­£ç¡®</li>
                        <li>å¦ææ¨ä¸è½ç¡®è®¤è®¿é®çç½åï¼è¯·æµè§<a href="//www.baidu.com/more/index.html">ç¾åº¦æ´å¤</a>é¡µé¢æ¥çæ´å¤ç½åã</li>
                        <li>åå°é¡¶é¨éæ°åèµ·æç´¢</li>
                        <li>å¦æä»»ä½æè§æå»ºè®®ï¼è¯·åæ¶<a href="http://qingting.baidu.com/index">åé¦ç»æä»¬</a>ã</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <div id="foot">
        <span id="help" style="float:left;padding-left:121px">
            <a href="http://help.baidu.com/question" target="_blank">å¸®å©</a>
            <a href="http://www.baidu.com/search/jubao.html" target="_blank">ä¸¾æ¥</a>
            <a href="http://jianyi.baidu.com" target="_blank">ç»ç¾åº¦æå»ºè®®</a>
        </span>
    </div>
</body>
<script>
(function () {
        var LOGURL = 'https://sp1.baidu.com/5b1ZeDe5KgQFm2e88IuM_a/cm.gif';
        var params = 'type=wwwerror&terminal=www';
        var img = new Image();
        img.src = LOGURL + '?' + params;
    })();
    (function () {
        if(window.recommend && window.recommend.query && window.recommend.query.length > 0) {
            var recommendWrapper = document.createElement('div');
            var recommendHtml = '<div class="cr-content"><div class="opr-toplist-title">' + window.recommend.title + '</div><table class="opr-toplist-table"><thead><tr><th>æå</th></tr></thead>';
            var queryArray = window.recommend.query;
            var itemUrl = '';
            for(var i = 1; i < (queryArray.length+1); i++) {
                itemUrl = '//www.baidu.com/s?word=' + encodeURIComponent(queryArray[i-1].word) + '&sa=' + queryArray[i-1].sa + '&tn=' + queryArray[i-1].tn;
                if (queryArray[i-1].rsv_dl) {
                    itemUrl += "&rsv_dl=" + queryArray[i-1].rsv_dl;
                }
                
                if (i < 4) {
                    recommendHtml += '<tr><td><span class="opr-index-hot' + i + ' opr-index-item">' + i + '</span><a target="_blank" href="' + itemUrl +'" class="opr-item-text">' + queryArray[i-1].word + '</a></td></tr>';
                } else {
                    recommendHtml += '<tr><td><span class="opr-index-item">' + i + '</span><a target="_blank" href="' + itemUrl +'" class="opr-item-text">' + queryArray[i-1].word + '</a></td></tr>';
                }
            }
            recommendHtml += '</tbody></table><div class="opr-toplist-info"><span>æ¥æºï¼</span><a target="_blank" href="http://www.baidu.com/link?url=sLR63PtaB7kc3YkTtzDy1k3mbTm1DXDMu-nLcijZx8DmWgOff4lBxqmY-LGDyHqw">ç¾åº¦é£äºæ¦</a><span>&nbsp;-&nbsp;</span><a target="_blank" href="http://www.baidu.com/link?url=01vNBVXR2eaJxETl9PI3hcrvKCcwaJIKk5FkpO7l5YI_Q_pC24ogIBoZxI0LAu5oYpAdhRH42nzxAqfui0YnHK">å®æ¶ç­ç¹</a></div></div>';
            recommendWrapper.setAttribute('id', 'content_right');
            document.getElementById('wrapper_wrapper').insertBefore(recommendWrapper, document.getElementById('content_left'));
            var recommend = document.getElementById('content_right');
            recommend.innerHTML = recommendHtml;
        }
})();
(function(){
    var bds = {
        util: {}
    };
    var c = document.getElementById('kw').parentNode;

    bds.util.getWinWidth = function(){
        return window.document.documentElement.clientWidth;
    };

    bds.util.setFormWidth = function(){
        var width = bds.util.getWinWidth();
        if(width < 1217)    {bds.util.setClass(c, 'ip_short', 'add')}
        else                {bds.util.setClass(c, 'ip_short', 'remove')};
    };

    bds.util.setClass = function(obj, class_name, set) {
        var ori_class = obj.className,
            has_class_p = -1,
            ori_class_arr = [],
            new_class = '';

        if(ori_class.length) ori_class_arr = ori_class.split(' ');

        for( i in ori_class_arr) {
            if(ori_class_arr[i] == class_name) has_class_p = i;
        }

        if( set == 'remove' && has_class_p >= 0) {
            ori_class_arr.splice(has_class_p, 1);
            new_class = ori_class_arr.join(' ');
            obj.className = new_class;
        } else if( set == 'add' && has_class_p < 0) {
            ori_class_arr.push(class_name);
            new_class = ori_class_arr.join(' ');
            obj.className = new_class;
        }
    }
    bds.util.setFormWidth();

    if (typeof document.addEventListener != "undefined") {
        window.addEventListener('resize', bds.util.setFormWidth, false);
        document.getElementById('kw').addEventListener('focus', function(){bds.util.setClass(c,'iptfocus', 'add');}, false);
        document.getElementById('kw').addEventListener('blur', function(){bds.util.setClass(c,'iptfocus', 'remove');}, false);
    } else {
        window.attachEvent('onresize', bds.util.setFormWidth, false);
        document.getElementById('kw').attachEvent('onfocus', function(){bds.util.setClass(c,'iptfocus', 'add');}, false);
        document.getElementById('kw').attachEvent('onblur', function(){bds.util.setClass(c,'iptfocus', 'remove');}, false);
    } 

})();


</script>

</html>
; line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:1702)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:558)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:456)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:1906)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:749)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:3850)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3799)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2858)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.ipToRegion(BaiduApiIpLookUp.java:65)
	at com.easemob.weichat.servicesessionattributes.service.impl.BaiduApiIpLookUp.lookUp(BaiduApiIpLookUp.java:39)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.buildRegion(IpServiceSessionAttributeProcessor.java:59)
	at com.easemob.weichat.servicesessionattributes.service.impl.IpServiceSessionAttributeProcessor.processServiceSessionAttribute(IpServiceSessionAttributeProcessor.java:47)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesManager.saveServiceSessionAttributes(ServiceSessionAttributesManager.java:63)
	at com.easemob.weichat.servicesessionattributes.service.impl.ServiceSessionAttributesCreationWorker.run(ServiceSessionAttributesCreationWorker.java:43)
	at com.easemob.weichat.service.message.BlockingRedisMessageConsumer$InternalQueueConsumer.run(BlockingRedisMessageConsumer.java:187)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:29,947 INFO  [consumer-kf_msg_in:session:attribute:topic-10-thread-2]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionAttributesUpdateEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:29,951 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:29 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@1db69c7 
2019-01-03 15:28:29,952 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2ae88cb0-0f29-11e9-b89e-03a15344be96","type":"com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent","timestamp":1546500509947,"body":{"timestamp":1546500509947,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":4,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"569065b5-0e05-4c08-ad96-89433fe17fd8","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509615,"timestamp":1546500509000,"createMicroTimestamp":1546500509615000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4033
2019-01-03 15:28:29,953 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:29,954 INFO  [SimpleAsyncTaskExecutor-17]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:0f731c5d-d3e0-463e-b680-30fe5e6a9dce message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"ServiceSessionAttributesChange","body":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}],"timestamp":1546500509950,"type":null}
2019-01-03 15:28:29,954 INFO  [SimpleAsyncTaskExecutor-17]  c.e.w.n.service.PushDataService - prepare message noticeId:0f731c5d-d3e0-463e-b680-30fe5e6a9dce messageType:ServiceSessionAttributesChange path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:29,955 ERROR [http-nio-8899-exec-6]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:29,955 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2ae8dad0-0f29-11e9-9c1a-ab84d4ff6026","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500509949,"body":{"source":{},"timestamp":1546500509949,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"ServiceSessionAttributesChange","body":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}],"broadcast":false}}} has been send to kafka with in topic events partition 6, current offset is 2177
2019-01-03 15:28:29,956 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:28:29,956 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:28:29,957 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2ae88cb0-0f29-11e9-b89e-03a15344be96, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionAttributesUpdateEvent, timestamp=1546500509947, properties={}, body={timestamp=1546500509947, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=4, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=机器人刚刚开小差了，请转人工服务, type=txt}], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500509615, timestamp=1546500509000, createMicroTimestamp=1546500509615000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:29,958 WARN  [hystrix-KefuLiteWebapp-42]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:29 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@c39a7f8 
2019-01-03 15:28:29,958 WARN  [hystrix-KefuLiteWebapp-42]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:28:29,960 ERROR [http-nio-8899-exec-10]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:29,960 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2ae8dad0-0f29-11e9-9c1a-ab84d4ff6026, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500509949, properties={}, body={source={}, timestamp=1546500509949, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=ServiceSessionAttributesChange, body=6b2f39c9-e766-490b-85ff-0bb06a3ca314}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:30,836 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:30,858 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:31,679 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccountVisitorLatestSession tenantId:4 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:31,718 INFO  [http-nio-8899-exec-12]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-account-sessions/latest visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:31,729 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - getOfficialAccount tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:31,751 INFO  [http-nio-8899-exec-5]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:28:31,757 INFO  [http-nio-8899-exec-9]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48
2019-01-03 15:28:31,762 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.s.p.Kefu_4050_SessionRoutingProcessor - go into Kefu_4050_SessionRoutingProcessor with  ServiceSession ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=4, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.615, timestamp=1546500509000, createMicroTimestamp=1546500509615000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:28:31,777 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:85528c11-744e-47f7-bafa-0d0c669e9693
2019-01-03 15:28:31,788 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:31 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:31,790 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:31,791 INFO  [http-nio-8899-exec-13]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:31 CST 2019.
2019-01-03 15:28:31,795 INFO  [http-nio-8899-exec-13]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:31,797 INFO  [http-nio-8899-exec-5]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:31,806 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"85528c11-744e-47f7-bafa-0d0c669e9693","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:28:31,820 INFO  [SimpleAsyncTaskExecutor-4262]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat=KefuExtMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=北京), msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511764, createMicroTimestamp=1546500511764000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=4, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.615, timestamp=1546500509000, createMicroTimestamp=1546500509615000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:31,822 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.r.s.l.VisitorMessageTimeAfterAgentListener - set visitor:last:message:time:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 to 1546500511764 driven by message 85528c11-744e-47f7-bafa-0d0c669e9693
2019-01-03 15:28:31,826 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2c0631b0-0f29-11e9-b48a-75ed0570ba80","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500511819,"body":{"timestamp":1546500511819,"version":"1.1","tenantId":4,"message":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"北京"},"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":15,"sessionServiceSeqId":5,"createDateTime":1546500511764,"timestamp":1546500511764,"createMicroTimestamp":1546500511764000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":4,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"0a3c56d3-3ad3-45a5-9b52-717efc9855e5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"569065b5-0e05-4c08-ad96-89433fe17fd8","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"333d6a26-9b98-46c6-91b6-20f052746ee9","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500509615,"timestamp":1546500509000,"createMicroTimestamp":1546500509615000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4034
2019-01-03 15:28:31,829 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=北京}, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511764, createMicroTimestamp=1546500511764000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=Sat Dec 29 01:13:42 CST 2018, lastUpdateDateTime=Sat Dec 29 01:13:42 CST 2018, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=4, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:29.615, timestamp=1546500509000, createMicroTimestamp=1546500509615000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:31,832 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.c.RemoteWebappReadOnlyClient - systemMessage findByTenantIdAndUserId start, tenantId : 4 , serviceSessionId : 6b2f39c9-e766-490b-85ff-0bb06a3ca314,agentUserId : abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:31,833 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.SendTimeoutEventService - clear robot timeout notify count key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:31,834 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - tenantId 4 message handle by robotmessageProcess
2019-01-03 15:28:31,836 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:28:31 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:28:31,837 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2c0631b0-0f29-11e9-b48a-75ed0570ba80, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500511819, properties={}, body={timestamp=1546500511819, version=1.1, tenantId=4, message={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=北京}, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500511738, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774665324036500, channel_id=1, channel_name=体验关联}, chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=1546500511764, timestamp=1546500511764, createMicroTimestamp=1546500511764000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=4, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=机器人刚刚开小差了，请转人工服务, type=txt}], ext={weichat={msgId=0a3c56d3-3ad3-45a5-9b52-717efc9855e5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=569065b5-0e05-4c08-ad96-89433fe17fd8, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=333d6a26-9b98-46c6-91b6-20f052746ee9, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500509615, timestamp=1546500509000, createMicroTimestamp=1546500509615000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:31,839 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:28:31,841 INFO  [http-nio-8899-exec-3]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:28:31 CST 2019.
2019-01-03 15:28:31,849 INFO  [SimpleAsyncTaskExecutor-18]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:e30447e9-8c20-4566-9156-ac1107a014e5 message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":15,"sessionServiceSeqId":5,"createDateTime":1546500511764,"timestamp":1546500511764,"createMicroTimestamp":1546500511764000}}],"timestamp":1546500511834,"type":null}
2019-01-03 15:28:31,850 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2c080670-0f29-11e9-bd65-693bd7fc18bd","type":"com.easemob.weichat.service.timeout.event.TimeoutClearEvent","timestamp":1546500511831,"body":{"source":{},"timestamp":1546500511830,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500511830,"duration":0,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":5,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500511764,"timestamp":1546500511000,"createMicroTimestamp":1546500511764000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic timeout-events-in partition 16, current offset is 350
2019-01-03 15:28:31,850 INFO  [SimpleAsyncTaskExecutor-18]  c.e.w.n.service.PushDataService - prepare message noticeId:e30447e9-8c20-4566-9156-ac1107a014e5 messageType:NewChatMessage path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:31,851 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2c085490-0f29-11e9-bd25-55bec9180421","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500511833,"body":{"source":{},"timestamp":1546500511833,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":15,"sessionServiceSeqId":5,"createDateTime":1546500511764,"timestamp":1546500511764,"createMicroTimestamp":1546500511764000}}],"broadcast":false}}} has been send to kafka with in topic events partition 15, current offset is 2477
2019-01-03 15:28:31,853 INFO  [http-nio-8899-exec-3]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:28:31,854 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2c085490-0f29-11e9-bd25-55bec9180421, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500511833, properties={}, body={source={}, timestamp=1546500511833, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=NewChatMessage, body={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500511738, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774665324036500, channel_id=1, channel_name=体验关联}, chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=1546500511764, timestamp=1546500511764, createMicroTimestamp=1546500511764000}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:31,855 INFO  [http-nio-8899-exec-5]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:28:31,855 INFO  [http-nio-8899-exec-5]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:28:31,859 INFO  [http-nio-8899-exec-5]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:28:31,859 INFO  [http-nio-8899-exec-5]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:28:31,977 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:31,978 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - agent is robot and chatMessage is ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat=KefuExtMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511764, createMicroTimestamp=1546500511764000) ___________ serviceSession is ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=5, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511000, createMicroTimestamp=1546500511764000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:28:32,027 WARN  [hystrix-KefuRobotIntegration-50]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:32 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@1b9e039c 
2019-01-03 15:28:32,030 WARN  [hystrix-KefuRobotIntegration-50]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:28:32,031 ERROR [http-nio-8899-exec-6]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:32,033 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:28:32,033 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:28:32,035 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:28:31 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@5fe1641a 
2019-01-03 15:28:32,036 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:28:32,038 ERROR [http-nio-8899-exec-2]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:28:32,045 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:32,045 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - tenantId 4 message reply by robot,serviceSessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:32,046 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - get answer by robot route tenantid 4 and msg is 北京
2019-01-03 15:28:32,129 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - askRobotIntegrationForAnswer error, return default value 机器人刚刚开小差了，请转人工服务
2019-01-03 15:28:32,130 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied serviceSession {"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":5,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500511764,"timestamp":1546500511000,"createMicroTimestamp":1546500511764000},"techChannelType":"easemob","originType":"webim","expire":true} ,RobotAnswer is {"enableSilence":false,"type":0,"content":"机器人刚刚开小差了，请转人工服务","similarity":null,"words":null,"answerType":null} ,ServiceSessionRobot is {"id":298,"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","robotId":83886084,"createdAt":"2019-01-03 15:28:28","updatedAt":"2019-01-03 15:28:28"}
2019-01-03 15:28:32,131 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.m.p.Kefu_11000_RobotMessageProcessor - robot replied RobotAnswer(enableSilence=false, answerType=ERROR, type=0, content=机器人刚刚开小差了，请转人工服务, similarity=null, words=null, answerDataType=null) to visitor for question ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=VisitorUser(username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, uri=null, chatGroupId=118, trueName=null, sex=0, qq=null, email=1, phone=1, companyName=null, description=null, weixin=null, createDateTime=2018-12-29 01:13:42.0, lastUpdateDateTime=2018-12-29 01:13:42.0, sendMessageCount=0), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat=KefuExtMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511764, createMicroTimestamp=1546500511764000)
2019-01-03 15:28:32,170 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:32,206 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:32,206 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.service.message.Processor - tenantid is 4 Label is zh-CN
2019-01-03 15:28:32,207 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.service.message.Processor - tenantid is 4  locale is zh-CN and weichatExt is KefuExtMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=WEBIM, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs=RobotServiceSessionTransfer(id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服), event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)
2019-01-03 15:28:32,243 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotAgentIdFromIntegration feign client success, tenantId : 4, robotAgentId : abd3b006-0451-45ec-a33b-161bb0feeee5, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:32,244 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:28:32,298 INFO  [http-nio-8899-exec-10]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/6b2f39c9-e766-490b-85ff-0bb06a3ca314/official-accounts
2019-01-03 15:28:32,326 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:21e9df62-d679-47a1-b3f8-75427a83cee6
2019-01-03 15:28:32,362 INFO  [http-nio-8899-exec-14]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"21e9df62-d679-47a1-b3f8-75427a83cee6","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:28:32,376 INFO  [SimpleAsyncTaskExecutor-4265]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=RobotUser(robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, tenantId=4, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=60, createdTime=null, lastUpdatedTime=null, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat=KefuExtMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=机器人测试, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=机器人刚刚开小差了，请转人工服务), msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=16, sessionServiceSeqId=6, createDateTime=2019-01-03 15:28:32.244, timestamp=1546500512244, createMicroTimestamp=1546500512244000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=5, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511000, createMicroTimestamp=1546500511764000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:32,381 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2c5aba50-0f29-11e9-bb8d-ff162ac7d221","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500512373,"body":{"timestamp":1546500512373,"version":"1.1","tenantId":4,"message":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"c6e0fed1-8bed-4490-8629-d0075b2064d8","userType":"Robot","userScope":"Tenant","nicename":"机器人测试","robotId":"c6e0fed1-8bed-4490-8629-d0075b2064d8","type":0,"active":false,"rule":0,"enableMenu":false,"enableGreeting":false,"enableSimilarQuestionTransfer":false,"enableNoAnswerTransfer":false,"enableFreeChat":false,"currentServiceSessionCount":0,"maxServiceSessionCount":0,"timeout":60,"robotRouteId":"83886084","robotAgentId":"abd3b006-0451-45ec-a33b-161bb0feeee5","digitalMenu":false,"roles":"robot","username":"c6e0fed1-8bed-4490-8629-d0075b2064d8","status":"Disable","bizId":"0","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"机器人刚刚开小差了，请转人工服务"},"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":16,"sessionServiceSeqId":6,"createDateTime":1546500512244,"timestamp":1546500512244,"createMicroTimestamp":1546500512244000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":5,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500511764,"timestamp":1546500511000,"createMicroTimestamp":1546500511764000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4035
2019-01-03 15:28:32,383 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=4, userId=c6e0fed1-8bed-4490-8629-d0075b2064d8, userType=Robot, userScope=Tenant, nicename=机器人测试), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=机器人刚刚开小差了，请转人工服务}, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=16, sessionServiceSeqId=6, createDateTime=2019-01-03 15:28:32.244, timestamp=1546500512244, createMicroTimestamp=1546500512244000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=5, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@a5e75], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, toJid=easemob-demo#chatdemoui_153895@easemob.com, channelType=IM, timestamp=Thu Jan 03 15:28:31 CST 2019, msgId=553774665324036500, channelId=1, channelName=体验关联, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:31.764, timestamp=1546500511000, createMicroTimestamp=1546500511764000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:28:32,387 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=2c5aba50-0f29-11e9-bb8d-ff162ac7d221, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500512373, properties={}, body={timestamp=1546500512373, version=1.1, tenantId=4, message={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=c6e0fed1-8bed-4490-8629-d0075b2064d8, userType=Robot, userScope=Tenant, nicename=机器人测试, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5, digitalMenu=false, roles=robot, username=c6e0fed1-8bed-4490-8629-d0075b2064d8, status=Disable, bizId=0, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=机器人刚刚开小差了，请转人工服务, type=txt}], ext={weichat={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=机器人刚刚开小差了，请转人工服务}, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=16, sessionServiceSeqId=6, createDateTime=1546500512244, timestamp=1546500512244, createMicroTimestamp=1546500512244000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=5, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500511738, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774665324036500, channel_id=1, channel_name=体验关联}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500511764, timestamp=1546500511000, createMicroTimestamp=1546500511764000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:28:32,426 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:32,492 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:28:32,493 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.SendTimeoutEventService - robot timeout is 60 from sendRobotTimeoutFirstStartEvent
2019-01-03 15:28:32,495 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.s.t.SendTimeoutEventService - set robot timeout notify count key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314 for serviceSession 6b2f39c9-e766-490b-85ff-0bb06a3ca314 notify count is 1 , value is 2
2019-01-03 15:28:32,495 INFO  [kafka-kf_msg_in-consumer-4-thread-14]  c.e.w.service.message.Processor - tenantId is 4 send toVisitorMessage is ChatMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=RobotUser(robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, tenantId=4, type=0, active=false, rule=0, enableMenu=false, enableGreeting=false, enableSimilarQuestionTransfer=false, enableNoAnswerTransfer=false, enableFreeChat=false, appKey=null, appSecret=null, currentServiceSessionCount=0, maxServiceSessionCount=0, timeout=60, createdTime=null, lastUpdatedTime=null, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5, digitalMenu=false), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat=KefuExtMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=机器人测试, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=null, msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=16, sessionServiceSeqId=6, createDateTime=2019-01-03 15:28:32.244, timestamp=1546500512244, createMicroTimestamp=1546500512244000)
2019-01-03 15:28:32,499 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2c6d09d0-0f29-11e9-b3b0-a380e0903703","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546500512493,"body":{"source":{},"timestamp":1546500512493,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500512493,"duration":60,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":5,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500511764,"timestamp":1546500511000,"createMicroTimestamp":1546500511764000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 16, current offset is 351
2019-01-03 15:28:32,501 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"2c6d7f00-0f29-11e9-ad0e-b340eed3b884","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500512496,"body":{"source":{},"timestamp":1546500512496,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":15,"sessionServiceSeqId":5,"createDateTime":1546500511764,"timestamp":1546500511764,"createMicroTimestamp":1546500511764000}}],"broadcast":false}}} has been send to kafka with in topic events partition 0, current offset is 2289
2019-01-03 15:28:32,504 INFO  [SimpleAsyncTaskExecutor-8]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:b6c5b33a-b305-4671-897e-45cf5df34bbb message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","username":"webim-visitor-BRM392HYE7EBV8B4996K","techChannelType":"easemob","techChannelId":1,"techChannelInfo":"easemob-demo#chatdemoui#153895","chatGroupId":118,"sex":0,"email":"1","phone":"1","createDateTime":1546017222000,"lastUpdateDateTime":1546017222000,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":15,"sessionServiceSeqId":5,"createDateTime":1546500511764,"timestamp":1546500511764,"createMicroTimestamp":1546500511764000}}],"timestamp":1546500512497,"type":null}
2019-01-03 15:28:32,504 INFO  [SimpleAsyncTaskExecutor-8]  c.e.w.n.service.PushDataService - prepare message noticeId:b6c5b33a-b305-4671-897e-45cf5df34bbb messageType:NewChatMessage path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:28:32,505 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=2c6d7f00-0f29-11e9-ad0e-b340eed3b884, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500512496, properties={}, body={source={}, timestamp=1546500512496, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=NewChatMessage, body={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, username=webim-visitor-BRM392HYE7EBV8B4996K, techChannelType=easemob, techChannelId=1, techChannelInfo=easemob-demo#chatdemoui#153895, chatGroupId=118, sex=0, email=1, phone=1, createDateTime=1546017222000, lastUpdateDateTime=1546017222000, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=北京, type=txt}], ext={weichat={msgId=85528c11-744e-47f7-bafa-0d0c669e9693, originType=webim, visitor=null, agent=null, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=webim-visitor-BRM392HYE7EBV8B4996K, to=153895, channelType=easemob, timestamp=1546500511738, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, to_jid=easemob-demo#chatdemoui_153895@easemob.com, msg_id=553774665324036500, channel_id=1, channel_name=体验关联}, chatGroupSeqId=15, sessionServiceSeqId=5, createDateTime=1546500511764, timestamp=1546500511764, createMicroTimestamp=1546500511764000}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:28:32,852 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:32,876 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:34,840 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:34,860 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:36,840 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:36,859 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:38,831 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:38,856 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:40,835 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:40,858 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:42,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:28 start
2019-01-03 15:28:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:28
2019-01-03 15:28:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:28 complete
2019-01-03 15:28:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:28:42,856 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:42,876 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:44,837 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:44,863 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:46,833 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:46,852 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:48,843 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:48,863 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:50,850 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:50,873 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:52,852 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:52,875 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:54,842 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:54,892 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:55,877 INFO  [SockJS-7]  o.a.coyote.http11.Http11Processor - An error occurred in processing while on a non-container thread. The connection will be closed immediately
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.Response.flushBuffer(Response.java:543)
	at org.apache.catalina.connector.ResponseFacade.flushBuffer(ResponseFacade.java:312)
	at javax.servlet.ServletResponseWrapper.flushBuffer(ServletResponseWrapper.java:176)
	at org.springframework.http.server.ServletServerHttpResponse.flush(ServletServerHttpResponse.java:96)
	at org.springframework.web.socket.sockjs.transport.session.AbstractHttpSockJsSession.writeFrameInternal(AbstractHttpSockJsSession.java:350)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:318)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendHeartbeat(AbstractSockJsSession.java:251)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession$HeartbeatTask.run(AbstractSockJsSession.java:453)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:55,878 INFO  [SockJS-7]  c.e.w.n.handler.MainHandler - session closed wsId:l3w4xfrg count:5 path:null token:null
2019-01-03 15:28:55,878 WARN  [SockJS-7]  c.e.w.n.handler.MainHandler - session has no amqp container wsId:l3w4xfrg path:null tokennull
2019-01-03 15:28:55,897 ERROR [http-nio-8899-exec-10]  c.e.w.r.e.GlobalExceptionHandler - handle exception
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 57 common frames omitted
2019-01-03 15:28:55,900 WARN  [http-nio-8899-exec-10]  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Failed to invoke @ExceptionHandler method: public org.springframework.http.ResponseEntity<com.easemob.weichat.models.data.ApiResponse> com.easemob.weichat.rest.exception.GlobalExceptionHandler.handleException(java.lang.Exception)
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver.doResolveHandlerMethodException(ExceptionHandlerExceptionResolver.java:380)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:59)
	at org.springframework.web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:136)
	at org.springframework.web.servlet.handler.HandlerExceptionResolverComposite.resolveException(HandlerExceptionResolverComposite.java:74)
	at org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1222)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1034)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 60 common frames omitted
2019-01-03 15:28:55,903 ERROR [http-nio-8899-exec-10]  o.a.c.c.C.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 57 common frames omitted
2019-01-03 15:28:55,910 ERROR [http-nio-8899-exec-10]  c.e.w.r.e.GlobalExceptionHandler - handle exception
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 59 common frames omitted
2019-01-03 15:28:55,912 WARN  [http-nio-8899-exec-10]  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Failed to invoke @ExceptionHandler method: public org.springframework.http.ResponseEntity<com.easemob.weichat.models.data.ApiResponse> com.easemob.weichat.rest.exception.GlobalExceptionHandler.handleException(java.lang.Exception)
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver.doResolveHandlerMethodException(ExceptionHandlerExceptionResolver.java:380)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:59)
	at org.springframework.web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:136)
	at org.springframework.web.servlet.handler.HandlerExceptionResolverComposite.resolveException(HandlerExceptionResolverComposite.java:74)
	at org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1222)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1034)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 62 common frames omitted
2019-01-03 15:28:55,913 ERROR [http-nio-8899-exec-10]  o.a.c.c.C.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 59 common frames omitted
2019-01-03 15:28:56,813 INFO  [SockJS-5]  o.a.coyote.http11.Http11Processor - An error occurred in processing while on a non-container thread. The connection will be closed immediately
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.Response.flushBuffer(Response.java:543)
	at org.apache.catalina.connector.ResponseFacade.flushBuffer(ResponseFacade.java:312)
	at javax.servlet.ServletResponseWrapper.flushBuffer(ServletResponseWrapper.java:176)
	at org.springframework.http.server.ServletServerHttpResponse.flush(ServletServerHttpResponse.java:96)
	at org.springframework.web.socket.sockjs.transport.session.AbstractHttpSockJsSession.writeFrameInternal(AbstractHttpSockJsSession.java:350)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:318)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendHeartbeat(AbstractSockJsSession.java:251)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession$HeartbeatTask.run(AbstractSockJsSession.java:453)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:56,814 INFO  [SockJS-5]  c.e.w.n.handler.MainHandler - session closed wsId:qlqmrlb0 count:4 path:null token:null
2019-01-03 15:28:56,814 WARN  [SockJS-5]  c.e.w.n.handler.MainHandler - session has no amqp container wsId:qlqmrlb0 path:null tokennull
2019-01-03 15:28:56,822 ERROR [http-nio-8899-exec-12]  c.e.w.r.e.GlobalExceptionHandler - handle exception
org.springframework.web.HttpMediaTypeNotAcceptableException: Could not find acceptable representation
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:200)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:56,823 WARN  [http-nio-8899-exec-12]  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Failed to invoke @ExceptionHandler method: public org.springframework.http.ResponseEntity<com.easemob.weichat.models.data.ApiResponse> com.easemob.weichat.rest.exception.GlobalExceptionHandler.handleException(java.lang.Exception)
org.springframework.web.HttpMediaTypeNotAcceptableException: Could not find acceptable representation
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:200)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver.doResolveHandlerMethodException(ExceptionHandlerExceptionResolver.java:384)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:59)
	at org.springframework.web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:136)
	at org.springframework.web.servlet.handler.HandlerExceptionResolverComposite.resolveException(HandlerExceptionResolverComposite.java:74)
	at org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1222)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1034)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:28:56,909 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:56,937 INFO  [consumer-kf:schedule:signal:a-7-thread-39]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:28:58,839 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:28:58,860 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:00,845 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:00,866 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:01,703 INFO  [SockJS-12]  o.a.coyote.http11.Http11Processor - An error occurred in processing while on a non-container thread. The connection will be closed immediately
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.Response.flushBuffer(Response.java:543)
	at org.apache.catalina.connector.ResponseFacade.flushBuffer(ResponseFacade.java:312)
	at javax.servlet.ServletResponseWrapper.flushBuffer(ServletResponseWrapper.java:176)
	at org.springframework.http.server.ServletServerHttpResponse.flush(ServletServerHttpResponse.java:96)
	at org.springframework.web.socket.sockjs.transport.session.AbstractHttpSockJsSession.writeFrameInternal(AbstractHttpSockJsSession.java:350)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:318)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendHeartbeat(AbstractSockJsSession.java:251)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession$HeartbeatTask.run(AbstractSockJsSession.java:453)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:29:01,704 INFO  [SockJS-12]  c.e.w.n.handler.MainHandler - session closed wsId:3k4kkqrs count:3 path:null token:null
2019-01-03 15:29:01,704 WARN  [SockJS-12]  c.e.w.n.handler.MainHandler - session has no amqp container wsId:3k4kkqrs path:null tokennull
2019-01-03 15:29:01,730 ERROR [http-nio-8899-exec-5]  o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.lang.IllegalStateException: getOutputStream() has already been called for this response
	at org.apache.catalina.connector.Response.getWriter(Response.java:626)
	at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:211)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:218)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1286)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1041)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:29:01,732 ERROR [http-nio-8899-exec-5]  o.a.c.c.C.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.IllegalStateException: getOutputStream() has already been called for this response
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:982)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: getOutputStream() has already been called for this response
	at org.apache.catalina.connector.Response.getWriter(Response.java:626)
	at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:211)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:218)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1286)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1041)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	... 41 common frames omitted
2019-01-03 15:29:01,752 ERROR [http-nio-8899-exec-5]  o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.lang.IllegalStateException: getOutputStream() has already been called for this response
	at org.apache.catalina.connector.Response.getWriter(Response.java:626)
	at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:211)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:218)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1286)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1041)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:29:01,754 ERROR [http-nio-8899-exec-5]  o.a.c.c.C.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is java.lang.IllegalStateException: getOutputStream() has already been called for this response
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:982)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:861)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:635)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: getOutputStream() has already been called for this response
	at org.apache.catalina.connector.Response.getWriter(Response.java:626)
	at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:211)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:109)
	at org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration$SpelView.render(ErrorMvcAutoConfiguration.java:218)
	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1286)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1041)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	... 43 common frames omitted
2019-01-03 15:29:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:29 start
2019-01-03 15:29:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:29
2019-01-03 15:29:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:29 complete
2019-01-03 15:29:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:29:02,840 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:02,865 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:04,837 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:04,856 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:06,802 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:29:06,804 INFO  [kf-webapp-scheduler-pool-24]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:29:06,840 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:06,860 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:09,849 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:09,875 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:10,844 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:12,845 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:12,873 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:14,858 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:14,893 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:16,863 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:16,885 INFO  [consumer-kf:schedule:signal:a-7-thread-39]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:18,869 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:18,890 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:20,853 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:20,875 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:29 start
2019-01-03 15:29:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:29
2019-01-03 15:29:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:29 complete
2019-01-03 15:29:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:29:22,861 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:22,881 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:24,836 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:24,893 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:26,839 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:26,869 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:27,776 INFO  [kf-webapp-scheduler-pool-11]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 6ms
2019-01-03 15:29:28,841 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:28,861 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:29,140 INFO  [SimpleAsyncTaskExecutor-16]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:a9c932bc-c80c-483d-91e0-bcbc7efda58a message:{"path":"/tenants/4/agents/_2","key":null,"payload":[{"messageType":"ScheduleTimeout","body":"Schedule:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314:_2:abd3b006-0451-45ec-a33b-161bb0feeee5:Robot"}],"timestamp":1546500569135,"type":null}
2019-01-03 15:29:29,140 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:2667e836-b14a-4f9d-8f6d-d2b62213e08b message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"ScheduleTimeout","body":"Schedule:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314:_2:abd3b006-0451-45ec-a33b-161bb0feeee5:Robot"}],"timestamp":1546500569136,"type":null}
2019-01-03 15:29:29,140 INFO  [SimpleAsyncTaskExecutor-20]  c.e.w.n.service.PushDataService - prepare message noticeId:2667e836-b14a-4f9d-8f6d-d2b62213e08b messageType:ScheduleTimeout path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:29:29,140 INFO  [SimpleAsyncTaskExecutor-16]  c.e.w.n.service.PushDataService - prepare message noticeId:a9c932bc-c80c-483d-91e0-bcbc7efda58a messageType:ScheduleTimeout path:/tenants/4/agents/_2
2019-01-03 15:29:29,148 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"4e2fc4e0-0f29-11e9-bdb3-f7668ca8a210","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500569134,"body":{"source":{},"timestamp":1546500569133,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"_2"},"messages":[{"messageType":"ScheduleTimeout","body":"Schedule:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314:_2:abd3b006-0451-45ec-a33b-161bb0feeee5:Robot"}],"broadcast":false}}} has been send to kafka with in topic events partition 8, current offset is 2488
2019-01-03 15:29:29,149 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=4e2fc4e0-0f29-11e9-bdb3-f7668ca8a210, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500569134, properties={}, body={source={}, timestamp=1546500569133, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=_2}, messages=[{messageType=ScheduleTimeout, body=Schedule:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314:_2:abd3b006-0451-45ec-a33b-161bb0feeee5:Robot}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:29:29,151 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"4e301300-0f29-11e9-b616-2be0c4500fab","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500569136,"body":{"source":{},"timestamp":1546500569136,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"ScheduleTimeout","body":"Schedule:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314:_2:abd3b006-0451-45ec-a33b-161bb0feeee5:Robot"}],"broadcast":false}}} has been send to kafka with in topic events partition 17, current offset is 2298
2019-01-03 15:29:29,157 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=4e301300-0f29-11e9-b616-2be0c4500fab, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500569136, properties={}, body={source={}, timestamp=1546500569136, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=ScheduleTimeout, body=Schedule:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314:_2:abd3b006-0451-45ec-a33b-161bb0feeee5:Robot}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:29:30,842 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:30,860 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:32,510 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5031fd80-0f29-11e9-9ad5-cdbef5718fe3","type":"com.easemob.weichat.service.timeout.event.TimeoutNotifyEvent","timestamp":1546500572504,"body":{"source":{},"timestamp":1546500572504,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500512493,"duration":60,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":5,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"85528c11-744e-47f7-bafa-0d0c669e9693","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-BRM392HYE7EBV8B4996K","to":"153895","channelType":"easemob","timestamp":1546500511738,"tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","to_jid":"easemob-demo#chatdemoui_153895@easemob.com","msg_id":"553774665324036500","channel_id":1,"channel_name":"体验关联"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500511764,"timestamp":1546500511000,"createMicroTimestamp":1546500511764000},"techChannelType":"easemob","originType":"webim","expire":true},"notifyCount":0,"endTime":1546500572504}} has been send to kafka with in topic timeout-events-out partition 16, current offset is 49
2019-01-03 15:29:32,519 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.r.t.l.TimeoutNotifyEventListener - RobotTimeoutNotification is got by TimeoutNotifyEventListener, TimeoutNotifyEvent is {"source":{},"timestamp":1546500572510,"actor":null,"version":"1.1","topic":"timeout-events-out","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500512493,"duration":60,"endTime":1546500572504,"deviation":0.011,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":6,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500512244,"timestamp":1546500512000,"createMicroTimestamp":1546500512244000},"techChannelType":"easemob","originType":"webim","expire":true}}
2019-01-03 15:29:32,520 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutNotificationService - get notifyCount 1 from redis key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314 from SendRobotTimeoutNotification
2019-01-03 15:29:32,562 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:29:32,616 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration feign client success, tenantId : 4, robotRouteId : 83886084, robotData : RobotData(id=8, tenantId=4, robotId=c6e0fed1-8bed-4490-8629-d0075b2064d8, name=机器人测试, manufacturerId=2, status=ENABLED, digitalMenu=false, avatar=null, type=ai-saas, timeout=60, robotRouteId=83886084, robotAgentId=abd3b006-0451-45ec-a33b-161bb0feeee5)
2019-01-03 15:29:32,693 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:29:32,722 INFO  [http-nio-8899-exec-2]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/6b2f39c9-e766-490b-85ff-0bb06a3ca314/official-accounts
2019-01-03 15:29:32,748 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:f801ffdc-a8e4-4844-bbba-a2a44149453c
2019-01-03 15:29:32,782 INFO  [http-nio-8899-exec-10]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:29:32,798 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"505e3da0-0f29-11e9-aad6-bbd2ce99305e","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500572794,"body":{"timestamp":1546500572793,"version":"1.1","tenantId":4,"message":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！"},"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":17,"sessionServiceSeqId":7,"createDateTime":1546500572693,"timestamp":1546500572693,"createMicroTimestamp":1546500572693000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":6,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500512244,"timestamp":1546500512000,"createMicroTimestamp":1546500512244000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4036
2019-01-03 15:29:32,801 INFO  [SimpleAsyncTaskExecutor-4268]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat=KefuExtMessage(msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！), msgIdForAck=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=17, sessionServiceSeqId=7, createDateTime=2019-01-03 15:29:32.693, timestamp=1546500572693, createMicroTimestamp=1546500572693000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=6, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=null, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:32.244, timestamp=1546500512000, createMicroTimestamp=1546500512244000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:29:32,804 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=17, sessionServiceSeqId=7, createDateTime=2019-01-03 15:29:32.693, timestamp=1546500572693, createMicroTimestamp=1546500572693000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Processing, chatGroupId=118, messageSeqId=6, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@851c1f6d], ext={weichat={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:32.244, timestamp=1546500512000, createMicroTimestamp=1546500512244000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:29:32,809 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutNotificationService - send remindMsg 先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！ of Robot with ServiceSession {"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":6,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500512244,"timestamp":1546500512000,"createMicroTimestamp":1546500512244000},"techChannelType":"easemob","originType":"webim","expire":true}
2019-01-03 15:29:32,809 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=505e3da0-0f29-11e9-aad6-bbd2ce99305e, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500572794, properties={}, body={timestamp=1546500572793, version=1.1, tenantId=4, message={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！, type=txt}], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！}, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=17, sessionServiceSeqId=7, createDateTime=1546500572693, timestamp=1546500572693, createMicroTimestamp=1546500572693000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=6, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=机器人刚刚开小差了，请转人工服务, type=txt}], ext={weichat={msgId=21e9df62-d679-47a1-b3f8-75427a83cee6, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=机器人测试}, queueId=null, queueName=null, agentUsername=null, ctrlType=TransferToKfHint, ctrlArgs={id=82b3b91e-97af-4e30-8191-2a1829c81ec5, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, label=转人工客服}, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=机器人测试, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500512244, timestamp=1546500512000, createMicroTimestamp=1546500512244000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:29:32,810 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutNotificationService - send visitor timeout reminder with robot to visitor for sessionId 6b2f39c9-e766-490b-85ff-0bb06a3ca314 increment is 1 with CloseDuration
2019-01-03 15:29:32,812 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:6457a537-700e-45c5-b416-9ef612017800 message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":17,"sessionServiceSeqId":7,"createDateTime":1546500572693,"timestamp":1546500572693,"createMicroTimestamp":1546500572693000}}],"timestamp":1546500572808,"type":null}
2019-01-03 15:29:32,813 INFO  [SimpleAsyncTaskExecutor-6]  c.e.w.n.service.PushDataService - prepare message noticeId:6457a537-700e-45c5-b416-9ef612017800 messageType:NewChatMessage path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:29:32,813 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"50606080-0f29-11e9-b343-c7d44a4ff196","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500572808,"body":{"source":{},"timestamp":1546500572808,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":17,"sessionServiceSeqId":7,"createDateTime":1546500572693,"timestamp":1546500572693,"createMicroTimestamp":1546500572693000}}],"broadcast":false}}} has been send to kafka with in topic events partition 11, current offset is 1911
2019-01-03 15:29:32,817 WARN  [pool-30-thread-4]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=50606080-0f29-11e9-b343-c7d44a4ff196, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500572808, properties={}, body={source={}, timestamp=1546500572808, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=NewChatMessage, body={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！, type=txt}], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=17, sessionServiceSeqId=7, createDateTime=1546500572693, timestamp=1546500572693, createMicroTimestamp=1546500572693000}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:29:32,818 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"5060aea0-0f29-11e9-a79e-c9487b71e5ef","type":"com.easemob.weichat.service.timeout.event.TimeoutStartEvent","timestamp":1546500572810,"body":{"source":{},"timestamp":1546500572809,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500572809,"duration":60,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":6,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500512244,"timestamp":1546500512000,"createMicroTimestamp":1546500512244000},"techChannelType":"easemob","originType":"webim","expire":true},"remindCount":1}} has been send to kafka with in topic timeout-events-in partition 16, current offset is 352
2019-01-03 15:29:32,844 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:32,864 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:35,863 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:35,882 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:36,834 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:38,852 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:38,874 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:40,879 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:40,898 INFO  [consumer-kf:schedule:signal:a-7-thread-3]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:29 start
2019-01-03 15:29:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:29
2019-01-03 15:29:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:29 complete
2019-01-03 15:29:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:29:42,866 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:42,886 INFO  [consumer-kf:schedule:signal:a-7-thread-9]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:44,927 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:44,956 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:46,837 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:46,856 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:48,845 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:48,867 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:49,617 INFO  [SockJS-9]  o.a.coyote.http11.Http11Processor - An error occurred in processing while on a non-container thread. The connection will be closed immediately
java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.Response.flushBuffer(Response.java:543)
	at org.apache.catalina.connector.ResponseFacade.flushBuffer(ResponseFacade.java:312)
	at javax.servlet.ServletResponseWrapper.flushBuffer(ServletResponseWrapper.java:176)
	at org.springframework.http.server.ServletServerHttpResponse.flush(ServletServerHttpResponse.java:96)
	at org.springframework.web.socket.sockjs.transport.session.AbstractHttpSockJsSession.writeFrameInternal(AbstractHttpSockJsSession.java:350)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:318)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendHeartbeat(AbstractSockJsSession.java:251)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession$HeartbeatTask.run(AbstractSockJsSession.java:453)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2019-01-03 15:29:49,617 INFO  [SockJS-9]  c.e.w.n.handler.MainHandler - session closed wsId:xlkij3aa count:2 path:null token:null
2019-01-03 15:29:49,617 WARN  [SockJS-9]  c.e.w.n.handler.MainHandler - session has no amqp container wsId:xlkij3aa path:null tokennull
2019-01-03 15:29:49,627 ERROR [http-nio-8899-exec-15]  c.e.w.r.e.GlobalExceptionHandler - handle exception
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 57 common frames omitted
2019-01-03 15:29:49,629 WARN  [http-nio-8899-exec-15]  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Failed to invoke @ExceptionHandler method: public org.springframework.http.ResponseEntity<com.easemob.weichat.models.data.ApiResponse> com.easemob.weichat.rest.exception.GlobalExceptionHandler.handleException(java.lang.Exception)
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver.doResolveHandlerMethodException(ExceptionHandlerExceptionResolver.java:380)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:59)
	at org.springframework.web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:136)
	at org.springframework.web.servlet.handler.HandlerExceptionResolverComposite.resolveException(HandlerExceptionResolverComposite.java:74)
	at org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1222)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1034)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 60 common frames omitted
2019-01-03 15:29:49,633 ERROR [http-nio-8899-exec-15]  o.a.c.c.C.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:418)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:176)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 57 common frames omitted
2019-01-03 15:29:49,640 ERROR [http-nio-8899-exec-15]  c.e.w.r.e.GlobalExceptionHandler - handle exception
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 59 common frames omitted
2019-01-03 15:29:49,642 WARN  [http-nio-8899-exec-15]  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Failed to invoke @ExceptionHandler method: public org.springframework.http.ResponseEntity<com.easemob.weichat.models.data.ApiResponse> com.easemob.weichat.rest.exception.GlobalExceptionHandler.handleException(java.lang.Exception)
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver.doResolveHandlerMethodException(ExceptionHandlerExceptionResolver.java:380)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodExceptionResolver.doResolveException(AbstractHandlerMethodExceptionResolver.java:59)
	at org.springframework.web.servlet.handler.AbstractHandlerExceptionResolver.resolveException(AbstractHandlerExceptionResolver.java:136)
	at org.springframework.web.servlet.handler.HandlerExceptionResolverComposite.resolveException(HandlerExceptionResolverComposite.java:74)
	at org.springframework.web.servlet.DispatcherServlet.processHandlerException(DispatcherServlet.java:1222)
	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1034)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:984)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 62 common frames omitted
2019-01-03 15:29:49,642 ERROR [http-nio-8899-exec-15]  o.a.c.c.C.[Tomcat].[localhost] - Exception Processing ErrorPage[errorCode=0, location=/error]
org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:321)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:284)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:118)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1054)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:953)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:292)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:231)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:203)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:81)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:113)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:661)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:742)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:101)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:728)
	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:590)
	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:524)
	at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:389)
	at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:254)
	at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:349)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:175)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:80)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)
	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:230)
	at org.apache.coyote.AbstractProcessor.dispatch(AbstractProcessor.java:221)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1455)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:65)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:134)
	at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)
	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1259)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:670)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:607)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:597)
	at org.apache.coyote.http11.Http11OutputBuffer.flushBuffer(Http11OutputBuffer.java:581)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:272)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1506)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:279)
	at org.apache.coyote.Response.action(Response.java:174)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:317)
	... 59 common frames omitted
2019-01-03 15:29:50,845 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:50,867 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:52,843 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:52,861 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:54,852 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:54,884 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:56,852 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:56,875 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:29:58,850 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:29:58,870 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:01,846 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:01,865 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:30 start
2019-01-03 15:30:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:30
2019-01-03 15:30:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:30 complete
2019-01-03 15:30:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:30:02,844 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:02,869 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:04,840 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:04,859 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:06,809 INFO  [kf-webapp-scheduler-pool-21]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:30:06,810 INFO  [kf-webapp-scheduler-pool-21]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:30:06,845 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:06,866 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:08,850 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:08,874 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:10,845 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:10,865 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:12,850 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:12,868 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:14,844 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:14,867 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:16,868 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:16,895 INFO  [consumer-kf:schedule:signal:a-7-thread-39]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:18,850 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:18,876 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:20,844 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:20,866 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:22,566 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:30 start
2019-01-03 15:30:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:30
2019-01-03 15:30:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:30 complete
2019-01-03 15:30:22,568 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:30:22,865 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:22,887 INFO  [consumer-kf:schedule:signal:a-7-thread-9]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:24,893 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:24,948 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:27,844 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:27,872 INFO  [consumer-kf:schedule:signal:a-7-thread-6]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:28,854 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:28,874 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:30,849 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:30,868 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:32,834 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"74268cb0-0f29-11e9-8251-a310e18909bd","type":"com.easemob.weichat.service.timeout.event.TimeoutNotifyEvent","timestamp":1546500632827,"body":{"source":{},"timestamp":1546500632826,"actor":null,"version":"1.1","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500572809,"duration":60,"businessObj":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":6,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"机器人刚刚开小差了，请转人工服务","type":"txt"}],"ext":{"weichat":{"msgId":"21e9df62-d679-47a1-b3f8-75427a83cee6","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"机器人测试"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":"TransferToKfHint","ctrlArgs":{"id":"82b3b91e-97af-4e30-8191-2a1829c81ec5","serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","label":"转人工客服"},"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"机器人测试","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500512244,"timestamp":1546500512000,"createMicroTimestamp":1546500512244000},"techChannelType":"easemob","originType":"webim","expire":true},"notifyCount":0,"endTime":1546500632826}} has been send to kafka with in topic timeout-events-out partition 16, current offset is 50
2019-01-03 15:30:32,846 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.r.t.l.TimeoutNotifyEventListener - RobotTimeoutNotification is got by TimeoutNotifyEventListener, TimeoutNotifyEvent is {"source":{},"timestamp":1546500632835,"actor":null,"version":"1.1","topic":"timeout-events-out","key":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","type":"ROBOT","startTime":1546500572809,"duration":60,"endTime":1546500632826,"deviation":0.017,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":7,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500572693,"timestamp":1546500572000,"createMicroTimestamp":1546500572693000},"techChannelType":"easemob","originType":"webim","expire":true}}
2019-01-03 15:30:32,847 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutNotificationService - get notifyCount 0 from redis key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314 from SendRobotTimeoutNotification
2019-01-03 15:30:32,848 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutEventService - clear robot timeout notify count key kf:robot:timeout:session.notify.count:4:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:32,884 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.e.EnquiryReadWriteRemoteClient - enquiryApiClient findByTenantIdAndServiceSessionId,tenantId:4, serviceSessionId：6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:32,921 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:32,968 INFO  [http-nio-8899-exec-14]  c.e.w.e.m.EvaluationDegreesController - findByTenantIdAndServiceSessionId param: tenantId:4, serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:32,971 INFO  [http-nio-8899-exec-14]  c.e.w.e.m.EvaluationDegreesController - findByTenantIdAndServiceSessionId return list:[]
2019-01-03 15:30:32,985 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:32,988 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionResolvedEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:32,996 INFO  [SimpleAsyncTaskExecutor-4271]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionResolvedEvent, sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:30:33,000 INFO  [SimpleAsyncTaskExecutor-4272]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionResolvedEvent event:agent user [tenantId = 4, userId = abd3b006-0451-45ec-a33b-161bb0feeee5] closed servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,003 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.e.k.p.SpringEventBridge - prepare base event type:ServiceSessionClosedEvent sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,005 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"743f1dc0-0f29-11e9-8a02-9bfb35c6e564","type":"com.easemob.weichat.service.events.session.ServiceSessionResolvedEvent","timestamp":1546500632989,"body":{"timestamp":1546500632988,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Resolved","chatGroupId":118,"messageSeqId":7,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500572693,"timestamp":1546500572000,"createMicroTimestamp":1546500572693000},"techChannelType":"easemob","originType":"webim","expire":true},"extendData":{"channel":{"tenantId":4,"type":"easemob","id":1,"dutyType":"None","timeScheduleId":0,"name":"体验关联","info":"easemob-demo#chatdemoui#153895"},"visitorChannelUser":{"orgName":"easemob-demo","imId":"webim-visitor-BRM392HYE7EBV8B4996K","appName":"chatdemoui","channelType":"easemob"},"visitor":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"agent":{"tenantId":0,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","userType":"Robot","userScope":"Tenant","nicename":"机器人测试","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"agentQueue":{"tenantId":4,"queueId":4,"queueName":"未分组","queueType":"QueueNormal","priority":0,"createDateTime":1542707002000,"lastUpdateDateTime":1542707002000,"queueGroupType":"SystemDefault","agentUsers":[{"tenantId":4,"userId":"9d87ef07-a867-4adf-b610-44b1df7895a1","userType":"Agent","userScope":"Tenant","nicename":"临时值班长","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-11-26 21:40:00","lastUpdateDateTime":"2018-11-26 21:40:00","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"临时值班长","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"34959a49-1dfe-43f9-85d1-4de5323d1602","userType":"Agent","userScope":"Tenant","nicename":"王悦","password":"","username":"wangyuen@zking.com","roles":"agent","createDateTime":"2018-11-26 21:38:24","lastUpdateDateTime":"2018-11-26 21:38:24","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"王悦","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"779a9b78-8436-4bf2-9d12-361f78710e25","userType":"Agent","userScope":"Tenant","nicename":"test@11.com","password":"","username":"test@11.com","roles":"admin,agent","createDateTime":"2018-11-27 11:45:27","lastUpdateDateTime":"2018-12-28 10:54:34","firstLoginTimeOfRecentDay":"2018-12-28 10:54:34","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"281848c3-2b84-4604-8fd3-09daa5611ef8","userType":"Agent","userScope":"Tenant","nicename":"曾晴","password":"","username":"zengqing@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:40:19","lastUpdateDateTime":"2018-12-26 09:27:10","firstLoginTimeOfRecentDay":"2018-12-26 09:23:20","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"曾晴","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"f3d71215-7582-404b-8edd-9dd1dd1e2c78","userType":"Agent","userScope":"Tenant","nicename":"束峥 ","password":"","username":"shuzheng@zking.com","roles":"agent","createDateTime":"2018-11-26 21:36:07","lastUpdateDateTime":"2018-11-26 21:36:07","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"束峥 ","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"5983a725-851e-4364-a215-bc86e460c83f","userType":"Agent","userScope":"Tenant","nicename":"ccc","password":"","username":"robot@50331654.com","roles":"agent","createDateTime":"2018-11-30 12:55:33","lastUpdateDateTime":"2018-11-30 12:55:33","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"b3ce3e20-ed71-40c5-b78a-b3bf02b6ec0b","userType":"Agent","userScope":"Tenant","nicename":"111","password":"","username":"robot@33554440.com","roles":"agent","createDateTime":"2018-11-29 11:21:40","lastUpdateDateTime":"2018-11-29 11:21:40","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"227255c6-abf4-4d0e-9bbd-1bbb55e33709","userType":"Agent","userScope":"Tenant","nicename":"吴柯","password":"","username":"wuke001@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:41:21","lastUpdateDateTime":"2018-12-26 09:24:53","firstLoginTimeOfRecentDay":"2018-12-26 09:24:53","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"吴柯","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"ade55cfb-8328-431a-9b9d-800122e82078","userType":"Agent","userScope":"Tenant","nicename":"曹正海","password":"","username":"caozhenghai@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:42:48","lastUpdateDateTime":"2018-12-29 11:41:33","firstLoginTimeOfRecentDay":"2018-12-29 11:41:33","status":"Enable","state":"Online","maxServiceSessionCount":1,"trueName":"曹正海","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"9da5a683-db4d-4e2b-b604-753b80143381","userType":"Agent","userScope":"Tenant","nicename":"robot11","password":"","username":"robot11@easemob.com","roles":"agent","createDateTime":"2018-11-23 16:51:28","lastUpdateDateTime":"2018-11-23 16:53:13","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"da4dc75e-96c6-4b3b-9811-1fe29a7859f8","userType":"Agent","userScope":"Tenant","nicename":"鞠恒俊","password":"","username":"juhengjun@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:43:04","lastUpdateDateTime":"2018-12-28 15:02:24","firstLoginTimeOfRecentDay":"2018-12-28 15:02:24","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"鞠恒俊","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"bd6f3d66-4af5-4bc6-af8f-57bf91ce3c82","userType":"Agent","userScope":"Tenant","nicename":"李文慧","password":"","username":"liwenhui@zking.com","roles":"agent","createDateTime":"2018-11-26 21:38:01","lastUpdateDateTime":"2018-12-26 09:26:28","firstLoginTimeOfRecentDay":"2018-12-26 09:26:28","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"李文慧","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"bfeadb77-ed34-4165-a5cc-5d720f85a58b","userType":"Agent","userScope":"Tenant","nicename":"李云龙","password":"","username":"liyunlong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:39:26","lastUpdateDateTime":"2018-11-26 21:39:26","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"李云龙","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"143780ab-a30c-42f5-9ad8-55c3afade15d","userType":"Agent","userScope":"Tenant","nicename":"紫金财险测试","password":"","username":"kefutest@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 16:19:31","lastUpdateDateTime":"2018-12-12 22:37:38","firstLoginTimeOfRecentDay":"2018-12-12 22:37:38","status":"Enable","state":"Offline","maxServiceSessionCount":1,"trueName":"紫金财险测试","mobilePhone":"","avatar":"//kefutest.zking.com:12508/v1/tenants/4/mediafiles/1bac067d-f1e6-432d-bba9-6e7d86203a01MS5wbmc=/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"ed64aed8-94f2-4c47-b43d-f183cf8f4047","userType":"Agent","userScope":"Tenant","nicename":"孙同海","password":"","username":"suntonghai@zking.com","roles":"agent","createDateTime":"2018-11-26 21:43:54","lastUpdateDateTime":"2018-11-26 21:43:54","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙同海","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"6e49c172-6265-42c2-906a-62b6f976f361","userType":"Agent","userScope":"Tenant","nicename":"徐伟","password":"","username":"xuwei002@zking.com","roles":"agent","createDateTime":"2018-11-26 21:35:22","lastUpdateDateTime":"2018-11-26 21:35:22","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"徐伟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"7272fe31-434e-4a0b-9d59-b04ecd071964","userType":"Agent","userScope":"Tenant","nicename":"黄苏扬","password":"","username":"huangsuyang@zking.com","roles":"agent","createDateTime":"2018-11-26 21:32:20","lastUpdateDateTime":"2018-11-26 21:32:20","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"黄苏扬","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"cc78123e-3ab7-4703-8fcc-93f863e03916","userType":"Agent","userScope":"Tenant","nicename":"尹茂龙","password":"","username":"yinmaolong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:43:21","lastUpdateDateTime":"2018-11-26 21:43:21","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"尹茂龙","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"8848c61e-ecf3-4591-b2a5-399801759f4c","userType":"Agent","userScope":"Tenant","nicename":"征秀","password":"","username":"zhengxiu@zking.com","roles":"agent","createDateTime":"2018-11-26 21:35:45","lastUpdateDateTime":"2018-11-26 21:35:45","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"征秀","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"9d40eed5-f877-42f3-93ef-91701a3a531c","userType":"Agent","userScope":"Tenant","nicename":"孙悦","password":"","username":"sunyue@zking.com","roles":"agent","createDateTime":"2018-11-26 21:36:46","lastUpdateDateTime":"2018-11-26 21:36:46","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙悦","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"1e0d9710-0f4a-44eb-bd0a-dc71db5b1ed3","userType":"Agent","userScope":"Tenant","nicename":"孙娟","password":"","username":"sunjuan@zking.com","roles":"agent","createDateTime":"2018-11-26 21:36:27","lastUpdateDateTime":"2018-11-26 21:36:27","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙娟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"3a181f32-19b9-43ae-8555-8da9186fad19","userType":"Agent","userScope":"Tenant","nicename":"紫金财险机器人","password":"","username":"robot@4.com","roles":"agent","createDateTime":"2018-11-26 17:55:40","lastUpdateDateTime":"2018-11-26 21:54:20","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"a3a9c957-9d88-402a-8032-84039f1eacdd","userType":"Agent","userScope":"Tenant","nicename":"卞骐","password":"","username":"bianqi@zking.com","roles":"agent","createDateTime":"2018-11-26 21:37:46","lastUpdateDateTime":"2018-11-26 21:37:46","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"卞骐","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"ace11a88-b85a-4732-b08a-c5f109a22be7","userType":"Agent","userScope":"Tenant","nicename":"蒋文婷","password":"","username":"jiangwenting@zking.com","roles":"agent","createDateTime":"2018-11-26 21:37:25","lastUpdateDateTime":"2018-11-26 21:37:25","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"蒋文婷","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"3d75dc9d-145a-49ab-9579-c35e410584a6","userType":"Agent","userScope":"Tenant","nicename":"工号001","password":"","username":"changdan@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:40:37","lastUpdateDateTime":"2018-12-24 15:52:14","firstLoginTimeOfRecentDay":"2018-12-24 15:52:14","status":"Enable","state":"Hidden","maxServiceSessionCount":7,"trueName":"ＡＢＣＤ","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Hidden","currentOnLineState":"Hidden"},{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","userType":"Agent","userScope":"Tenant","nicename":"机器人测试","password":"","username":"robot@83886084.com","roles":"agent","createDateTime":"2018-12-05 16:24:26","lastUpdateDateTime":"2018-12-05 16:24:26","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"1741bffb-4561-4204-8b9f-775243f86ab1","userType":"Agent","userScope":"Tenant","nicename":"刘倩","password":"","username":"liuqian@zking.com","roles":"agent","createDateTime":"2018-11-26 21:39:43","lastUpdateDateTime":"2018-11-26 21:39:43","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"刘倩","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"5f19b772-4fa3-40ec-8aa3-b9ae7f34d2f2","userType":"Agent","userScope":"Tenant","nicename":"蒋逸鸥","password":"","username":"jiangyiou@zking.com","roles":"agent","createDateTime":"2018-11-26 21:39:12","lastUpdateDateTime":"2018-11-26 21:39:12","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"蒋逸鸥","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"560ea0c4-a0c2-4dad-830a-7d5e5d34975d","userType":"Agent","userScope":"Tenant","nicename":"12345","password":"","username":"robot@67108870.com","roles":"agent","createDateTime":"2018-12-04 01:34:45","lastUpdateDateTime":"2018-12-04 01:34:45","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"98461a5e-af68-41ce-954e-546ae32b60e2","userType":"Agent","userScope":"Tenant","nicename":"Admin","password":"","username":"zijincaixian@easemob.com","roles":"admin,agent","createDateTime":"2018-11-20 17:43:27","lastUpdateDateTime":"2019-01-02 14:49:47","firstLoginTimeOfRecentDay":"2019-01-02 14:49:47","status":"Enable","state":"Hidden","maxServiceSessionCount":4,"trueName":"","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Hidden","currentOnLineState":"Hidden"},{"tenantId":4,"userId":"dd262b0b-e657-46e6-81aa-f46450b829b3","userType":"Agent","userScope":"Tenant","nicename":"袁娟","password":"","username":"yuanjuan@zking.com","roles":"agent","createDateTime":"2018-11-26 21:38:43","lastUpdateDateTime":"2018-11-26 21:38:43","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"袁娟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"5de7020d-6939-43d8-855e-3e2f887fa707","userType":"Agent","userScope":"Tenant","nicename":"姜芳","password":"","username":"jiangfang@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:41:42","lastUpdateDateTime":"2018-12-26 09:25:02","firstLoginTimeOfRecentDay":"2018-12-26 09:25:02","status":"Enable","state":"Online","maxServiceSessionCount":0,"trueName":"姜芳","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"84620ad2-ad5e-42d5-978b-ef76c0c74cf1","userType":"Agent","userScope":"Tenant","nicename":"刘佳","password":"","username":"liujia@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:33:02","lastUpdateDateTime":"2018-11-26 21:33:02","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"刘佳","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"f287b21e-6834-49ea-b10d-82f4d7bfa149","userType":"Agent","userScope":"Tenant","nicename":"孟执中","password":"","username":"mengzhizhong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:43:37","lastUpdateDateTime":"2018-11-26 21:43:37","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孟执中","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"436a6dca-bdde-4c31-a0b1-585e97eb5507","userType":"Agent","userScope":"Tenant","nicename":"test2","password":"","username":"test2@zijin.com","roles":"admin,agent","createDateTime":"2018-11-27 09:48:00","lastUpdateDateTime":"2018-12-26 14:31:05","firstLoginTimeOfRecentDay":"2018-12-26 14:31:05","status":"Enable","state":"Offline","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"7db8572c-8ec9-4afd-af51-ba12e211a6f3","userType":"Agent","userScope":"Tenant","nicename":"孙莲","password":"","username":"sunlian@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:42:31","lastUpdateDateTime":"2018-11-26 21:42:31","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙莲","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"8dd001a0-3b02-45e8-b97c-291d15d2997d","userType":"Agent","userScope":"Tenant","nicename":"bbb","password":"","username":"robot@16777222.com","roles":"agent","createDateTime":"2018-11-26 17:56:21","lastUpdateDateTime":"2018-11-26 17:56:21","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"f2f5fce6-ebc3-41fe-ae30-24308994e6c8","userType":"Agent","userScope":"Tenant","nicename":"万田菁","password":"","username":"wantianqing@zking.com","roles":"agent","createDateTime":"2018-11-26 21:37:03","lastUpdateDateTime":"2018-11-26 21:37:03","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"万田菁","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"0e7bf062-14bd-4643-8d75-41ed01613d8c","userType":"Agent","userScope":"Tenant","nicename":"许正香","password":"","username":"xuzhengxiang@zking.com","roles":"agent","createDateTime":"2018-11-26 21:42:12","lastUpdateDateTime":"2018-11-26 21:42:12","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"许正香","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"4330dde5-8e76-47e5-aa0a-8e901d7bdf7e","userType":"Agent","userScope":"Tenant","nicename":"卢蓉","password":"","username":"lurong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:34:42","lastUpdateDateTime":"2018-11-26 21:34:42","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"卢蓉","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"d372e396-ef23-4efc-94ee-ef02c03dd587","userType":"Agent","userScope":"Tenant","nicename":"王娟","password":"","username":"wangjuan003@zking.com","roles":"agent","createDateTime":"2018-11-26 21:35:03","lastUpdateDateTime":"2018-11-26 21:35:03","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"王娟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"c9e704c4-5bfa-4746-b875-80f678b75fab","userType":"Agent","userScope":"Tenant","nicename":"刘露","password":"","username":"liulu@zking.com","roles":"agent","createDateTime":"2018-11-26 21:33:34","lastUpdateDateTime":"2018-11-26 21:33:34","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"刘露","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"}]},"originType":"webim"}}} has been send to kafka with in topic events partition 16, current offset is 4037
2019-01-03 15:30:33,007 INFO  [SimpleAsyncTaskExecutor-4274]  c.e.w.s.p.h.ServiceSessionEventHandler - got ServiceSessionClosedEvent, sessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314.
2019-01-03 15:30:33,013 INFO  [SimpleAsyncTaskExecutor-4276]  c.e.w.s.a.s.l.AgentStateListener - AgentStateListener log : service session 6b2f39c9-e766-490b-85ff-0bb06a3ca314 closed for agent abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:30:33,043 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"744167b0-0f29-11e9-983f-21254cc4135c","type":"com.easemob.weichat.service.events.session.ServiceSessionClosedEvent","timestamp":1546500633003,"body":{"timestamp":1546500633002,"version":"1.1","tenantId":4,"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Terminal","chatGroupId":118,"messageSeqId":7,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","stopDateTime":"2019-01-03 15:30:32","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500572693,"timestamp":1546500572000,"createMicroTimestamp":1546500572693000},"techChannelType":"easemob","originType":"webim","expire":true},"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"extendData":{"channel":{"tenantId":4,"type":"easemob","id":1,"dutyType":"None","timeScheduleId":0,"name":"体验关联","info":"easemob-demo#chatdemoui#153895"},"visitorChannelUser":{"orgName":"easemob-demo","imId":"webim-visitor-BRM392HYE7EBV8B4996K","appName":"chatdemoui","channelType":"easemob"},"visitor":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"agent":{"tenantId":0,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","userType":"Robot","userScope":"Tenant","nicename":"机器人测试","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"agentQueue":{"tenantId":4,"queueId":4,"queueName":"未分组","queueType":"QueueNormal","priority":0,"createDateTime":1542707002000,"lastUpdateDateTime":1542707002000,"queueGroupType":"SystemDefault","agentUsers":[{"tenantId":4,"userId":"9d87ef07-a867-4adf-b610-44b1df7895a1","userType":"Agent","userScope":"Tenant","nicename":"临时值班长","password":"","username":"lszbz@zking.com","roles":"agent","createDateTime":"2018-11-26 21:40:00","lastUpdateDateTime":"2018-11-26 21:40:00","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"临时值班长","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"34959a49-1dfe-43f9-85d1-4de5323d1602","userType":"Agent","userScope":"Tenant","nicename":"王悦","password":"","username":"wangyuen@zking.com","roles":"agent","createDateTime":"2018-11-26 21:38:24","lastUpdateDateTime":"2018-11-26 21:38:24","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"王悦","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"779a9b78-8436-4bf2-9d12-361f78710e25","userType":"Agent","userScope":"Tenant","nicename":"test@11.com","password":"","username":"test@11.com","roles":"admin,agent","createDateTime":"2018-11-27 11:45:27","lastUpdateDateTime":"2018-12-28 10:54:34","firstLoginTimeOfRecentDay":"2018-12-28 10:54:34","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"281848c3-2b84-4604-8fd3-09daa5611ef8","userType":"Agent","userScope":"Tenant","nicename":"曾晴","password":"","username":"zengqing@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:40:19","lastUpdateDateTime":"2018-12-26 09:27:10","firstLoginTimeOfRecentDay":"2018-12-26 09:23:20","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"曾晴","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"f3d71215-7582-404b-8edd-9dd1dd1e2c78","userType":"Agent","userScope":"Tenant","nicename":"束峥 ","password":"","username":"shuzheng@zking.com","roles":"agent","createDateTime":"2018-11-26 21:36:07","lastUpdateDateTime":"2018-11-26 21:36:07","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"束峥 ","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"5983a725-851e-4364-a215-bc86e460c83f","userType":"Agent","userScope":"Tenant","nicename":"ccc","password":"","username":"robot@50331654.com","roles":"agent","createDateTime":"2018-11-30 12:55:33","lastUpdateDateTime":"2018-11-30 12:55:33","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"b3ce3e20-ed71-40c5-b78a-b3bf02b6ec0b","userType":"Agent","userScope":"Tenant","nicename":"111","password":"","username":"robot@33554440.com","roles":"agent","createDateTime":"2018-11-29 11:21:40","lastUpdateDateTime":"2018-11-29 11:21:40","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"227255c6-abf4-4d0e-9bbd-1bbb55e33709","userType":"Agent","userScope":"Tenant","nicename":"吴柯","password":"","username":"wuke001@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:41:21","lastUpdateDateTime":"2018-12-26 09:24:53","firstLoginTimeOfRecentDay":"2018-12-26 09:24:53","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"吴柯","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"ade55cfb-8328-431a-9b9d-800122e82078","userType":"Agent","userScope":"Tenant","nicename":"曹正海","password":"","username":"caozhenghai@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:42:48","lastUpdateDateTime":"2018-12-29 11:41:33","firstLoginTimeOfRecentDay":"2018-12-29 11:41:33","status":"Enable","state":"Online","maxServiceSessionCount":1,"trueName":"曹正海","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"9da5a683-db4d-4e2b-b604-753b80143381","userType":"Agent","userScope":"Tenant","nicename":"robot11","password":"","username":"robot11@easemob.com","roles":"agent","createDateTime":"2018-11-23 16:51:28","lastUpdateDateTime":"2018-11-23 16:53:13","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"da4dc75e-96c6-4b3b-9811-1fe29a7859f8","userType":"Agent","userScope":"Tenant","nicename":"鞠恒俊","password":"","username":"juhengjun@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:43:04","lastUpdateDateTime":"2018-12-28 15:02:24","firstLoginTimeOfRecentDay":"2018-12-28 15:02:24","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"鞠恒俊","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"bd6f3d66-4af5-4bc6-af8f-57bf91ce3c82","userType":"Agent","userScope":"Tenant","nicename":"李文慧","password":"","username":"liwenhui@zking.com","roles":"agent","createDateTime":"2018-11-26 21:38:01","lastUpdateDateTime":"2018-12-26 09:26:28","firstLoginTimeOfRecentDay":"2018-12-26 09:26:28","status":"Enable","state":"Online","maxServiceSessionCount":10,"trueName":"李文慧","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"bfeadb77-ed34-4165-a5cc-5d720f85a58b","userType":"Agent","userScope":"Tenant","nicename":"李云龙","password":"","username":"liyunlong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:39:26","lastUpdateDateTime":"2018-11-26 21:39:26","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"李云龙","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"143780ab-a30c-42f5-9ad8-55c3afade15d","userType":"Agent","userScope":"Tenant","nicename":"紫金财险测试","password":"","username":"kefutest@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 16:19:31","lastUpdateDateTime":"2018-12-12 22:37:38","firstLoginTimeOfRecentDay":"2018-12-12 22:37:38","status":"Enable","state":"Offline","maxServiceSessionCount":1,"trueName":"紫金财险测试","mobilePhone":"","avatar":"//kefutest.zking.com:12508/v1/tenants/4/mediafiles/1bac067d-f1e6-432d-bba9-6e7d86203a01MS5wbmc=/cutout?arg=0_0_200_200_300_300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"ed64aed8-94f2-4c47-b43d-f183cf8f4047","userType":"Agent","userScope":"Tenant","nicename":"孙同海","password":"","username":"suntonghai@zking.com","roles":"agent","createDateTime":"2018-11-26 21:43:54","lastUpdateDateTime":"2018-11-26 21:43:54","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙同海","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"6e49c172-6265-42c2-906a-62b6f976f361","userType":"Agent","userScope":"Tenant","nicename":"徐伟","password":"","username":"xuwei002@zking.com","roles":"agent","createDateTime":"2018-11-26 21:35:22","lastUpdateDateTime":"2018-11-26 21:35:22","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"徐伟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"7272fe31-434e-4a0b-9d59-b04ecd071964","userType":"Agent","userScope":"Tenant","nicename":"黄苏扬","password":"","username":"huangsuyang@zking.com","roles":"agent","createDateTime":"2018-11-26 21:32:20","lastUpdateDateTime":"2018-11-26 21:32:20","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"黄苏扬","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"cc78123e-3ab7-4703-8fcc-93f863e03916","userType":"Agent","userScope":"Tenant","nicename":"尹茂龙","password":"","username":"yinmaolong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:43:21","lastUpdateDateTime":"2018-11-26 21:43:21","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"尹茂龙","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"8848c61e-ecf3-4591-b2a5-399801759f4c","userType":"Agent","userScope":"Tenant","nicename":"征秀","password":"","username":"zhengxiu@zking.com","roles":"agent","createDateTime":"2018-11-26 21:35:45","lastUpdateDateTime":"2018-11-26 21:35:45","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"征秀","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"9d40eed5-f877-42f3-93ef-91701a3a531c","userType":"Agent","userScope":"Tenant","nicename":"孙悦","password":"","username":"sunyue@zking.com","roles":"agent","createDateTime":"2018-11-26 21:36:46","lastUpdateDateTime":"2018-11-26 21:36:46","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙悦","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"1e0d9710-0f4a-44eb-bd0a-dc71db5b1ed3","userType":"Agent","userScope":"Tenant","nicename":"孙娟","password":"","username":"sunjuan@zking.com","roles":"agent","createDateTime":"2018-11-26 21:36:27","lastUpdateDateTime":"2018-11-26 21:36:27","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙娟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"3a181f32-19b9-43ae-8555-8da9186fad19","userType":"Agent","userScope":"Tenant","nicename":"紫金财险机器人","password":"","username":"robot@4.com","roles":"agent","createDateTime":"2018-11-26 17:55:40","lastUpdateDateTime":"2018-11-26 21:54:20","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"a3a9c957-9d88-402a-8032-84039f1eacdd","userType":"Agent","userScope":"Tenant","nicename":"卞骐","password":"","username":"bianqi@zking.com","roles":"agent","createDateTime":"2018-11-26 21:37:46","lastUpdateDateTime":"2018-11-26 21:37:46","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"卞骐","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"ace11a88-b85a-4732-b08a-c5f109a22be7","userType":"Agent","userScope":"Tenant","nicename":"蒋文婷","password":"","username":"jiangwenting@zking.com","roles":"agent","createDateTime":"2018-11-26 21:37:25","lastUpdateDateTime":"2018-11-26 21:37:25","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"蒋文婷","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"3d75dc9d-145a-49ab-9579-c35e410584a6","userType":"Agent","userScope":"Tenant","nicename":"工号001","password":"","username":"changdan@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:40:37","lastUpdateDateTime":"2018-12-24 15:52:14","firstLoginTimeOfRecentDay":"2018-12-24 15:52:14","status":"Enable","state":"Hidden","maxServiceSessionCount":7,"trueName":"ＡＢＣＤ","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Hidden","currentOnLineState":"Hidden"},{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5","userType":"Agent","userScope":"Tenant","nicename":"机器人测试","password":"","username":"robot@83886084.com","roles":"agent","createDateTime":"2018-12-05 16:24:26","lastUpdateDateTime":"2018-12-05 16:24:26","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"1741bffb-4561-4204-8b9f-775243f86ab1","userType":"Agent","userScope":"Tenant","nicename":"刘倩","password":"","username":"liuqian@zking.com","roles":"agent","createDateTime":"2018-11-26 21:39:43","lastUpdateDateTime":"2018-11-26 21:39:43","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"刘倩","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"5f19b772-4fa3-40ec-8aa3-b9ae7f34d2f2","userType":"Agent","userScope":"Tenant","nicename":"蒋逸鸥","password":"","username":"jiangyiou@zking.com","roles":"agent","createDateTime":"2018-11-26 21:39:12","lastUpdateDateTime":"2018-11-26 21:39:12","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"蒋逸鸥","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"560ea0c4-a0c2-4dad-830a-7d5e5d34975d","userType":"Agent","userScope":"Tenant","nicename":"12345","password":"","username":"robot@67108870.com","roles":"agent","createDateTime":"2018-12-04 01:34:45","lastUpdateDateTime":"2018-12-04 01:34:45","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"98461a5e-af68-41ce-954e-546ae32b60e2","userType":"Agent","userScope":"Tenant","nicename":"Admin","password":"","username":"zijincaixian@easemob.com","roles":"admin,agent","createDateTime":"2018-11-20 17:43:27","lastUpdateDateTime":"2019-01-02 14:49:47","firstLoginTimeOfRecentDay":"2019-01-02 14:49:47","status":"Enable","state":"Hidden","maxServiceSessionCount":4,"trueName":"","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Hidden","currentOnLineState":"Hidden"},{"tenantId":4,"userId":"dd262b0b-e657-46e6-81aa-f46450b829b3","userType":"Agent","userScope":"Tenant","nicename":"袁娟","password":"","username":"yuanjuan@zking.com","roles":"agent","createDateTime":"2018-11-26 21:38:43","lastUpdateDateTime":"2018-11-26 21:38:43","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"袁娟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"5de7020d-6939-43d8-855e-3e2f887fa707","userType":"Agent","userScope":"Tenant","nicename":"姜芳","password":"","username":"jiangfang@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:41:42","lastUpdateDateTime":"2018-12-26 09:25:02","firstLoginTimeOfRecentDay":"2018-12-26 09:25:02","status":"Enable","state":"Online","maxServiceSessionCount":0,"trueName":"姜芳","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Online","currentOnLineState":"Online"},{"tenantId":4,"userId":"84620ad2-ad5e-42d5-978b-ef76c0c74cf1","userType":"Agent","userScope":"Tenant","nicename":"刘佳","password":"","username":"liujia@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:33:02","lastUpdateDateTime":"2018-11-26 21:33:02","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"刘佳","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"f287b21e-6834-49ea-b10d-82f4d7bfa149","userType":"Agent","userScope":"Tenant","nicename":"孟执中","password":"","username":"mengzhizhong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:43:37","lastUpdateDateTime":"2018-11-26 21:43:37","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孟执中","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"436a6dca-bdde-4c31-a0b1-585e97eb5507","userType":"Agent","userScope":"Tenant","nicename":"test2","password":"","username":"test2@zijin.com","roles":"admin,agent","createDateTime":"2018-11-27 09:48:00","lastUpdateDateTime":"2018-12-26 14:31:05","firstLoginTimeOfRecentDay":"2018-12-26 14:31:05","status":"Enable","state":"Offline","maxServiceSessionCount":5,"trueName":"","mobilePhone":"","avatar":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"7db8572c-8ec9-4afd-af51-ba12e211a6f3","userType":"Agent","userScope":"Tenant","nicename":"孙莲","password":"","username":"sunlian@zking.com","roles":"admin,agent","createDateTime":"2018-11-26 21:42:31","lastUpdateDateTime":"2018-11-26 21:42:31","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"孙莲","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"8dd001a0-3b02-45e8-b97c-291d15d2997d","userType":"Agent","userScope":"Tenant","nicename":"bbb","password":"","username":"robot@16777222.com","roles":"agent","createDateTime":"2018-11-26 17:56:21","lastUpdateDateTime":"2018-11-26 17:56:21","status":"Disable","state":"Offline","maxServiceSessionCount":0,"mobilePhone":"13810026300","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"f2f5fce6-ebc3-41fe-ae30-24308994e6c8","userType":"Agent","userScope":"Tenant","nicename":"万田菁","password":"","username":"wantianqing@zking.com","roles":"agent","createDateTime":"2018-11-26 21:37:03","lastUpdateDateTime":"2018-11-26 21:37:03","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"万田菁","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"0e7bf062-14bd-4643-8d75-41ed01613d8c","userType":"Agent","userScope":"Tenant","nicename":"许正香","password":"","username":"xuzhengxiang@zking.com","roles":"agent","createDateTime":"2018-11-26 21:42:12","lastUpdateDateTime":"2018-11-26 21:42:12","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"许正香","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"4330dde5-8e76-47e5-aa0a-8e901d7bdf7e","userType":"Agent","userScope":"Tenant","nicename":"卢蓉","password":"","username":"lurong@zking.com","roles":"agent","createDateTime":"2018-11-26 21:34:42","lastUpdateDateTime":"2018-11-26 21:34:42","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"卢蓉","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"d372e396-ef23-4efc-94ee-ef02c03dd587","userType":"Agent","userScope":"Tenant","nicename":"王娟","password":"","username":"wangjuan003@zking.com","roles":"agent","createDateTime":"2018-11-26 21:35:03","lastUpdateDateTime":"2018-11-26 21:35:03","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"王娟","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"},{"tenantId":4,"userId":"c9e704c4-5bfa-4746-b875-80f678b75fab","userType":"Agent","userScope":"Tenant","nicename":"刘露","password":"","username":"liulu@zking.com","roles":"agent","createDateTime":"2018-11-26 21:33:34","lastUpdateDateTime":"2018-11-26 21:33:34","status":"Enable","state":"Offline","maxServiceSessionCount":10,"trueName":"刘露","mobilePhone":"","bizId":"4","scope":"Tenant","onLineState":"Offline","currentOnLineState":"Offline"}]},"originType":"webim"},"kickOff":true}} has been send to kafka with in topic events partition 16, current offset is 4038
2019-01-03 15:30:33,010 INFO  [SimpleAsyncTaskExecutor-4275]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionClosedEvent start, serviceSession:ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Terminal, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=Thu Jan 03 15:30:32 CST 2019, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:29:32.693, timestamp=1546500572000, createMicroTimestamp=1546500572693000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true)
2019-01-03 15:30:33,046 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionAbortedEvent|ServiceSessionResolvedEvent|ServiceSessionClosedEvent serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314,queueId:4
2019-01-03 15:30:33,046 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutNotificationService - visitor timeout with robot, stopping service session 6b2f39c9-e766-490b-85ff-0bb06a3ca314 for tenant 4
2019-01-03 15:30:33,046 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2019-01-03 15:30:33,048 INFO  [SimpleAsyncTaskExecutor-4275]  c.e.w.h.client.RemoteCustomerClient -  findByTenantIdAndVisitorId use CrmApiClient , query: tenantId=4,visitorId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 
2019-01-03 15:30:33,049 INFO  [kafka-timeout-events-out-consumer-5-thread-14]  c.e.w.s.t.SendTimeoutNotificationService - visitor timeout with robot, send session closed notification to agent for service session 6b2f39c9-e766-490b-85ff-0bb06a3ca314 for tenant 4
2019-01-03 15:30:33,052 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"74481e70-0f29-11e9-a598-d350c9f1822b","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500633047,"body":{"source":{},"timestamp":1546500633046,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"abd3b006-0451-45ec-a33b-161bb0feeee5"},"messages":[{"messageType":"ServiceSessionClosed","body":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":7,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500572693,"timestamp":1546500572000,"createMicroTimestamp":1546500572693000},"techChannelType":"easemob","originType":"webim","expire":true}}],"broadcast":false}}} has been send to kafka with in topic events partition 2, current offset is 2305
2019-01-03 15:30:33,054 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionResolvedEventHandler - systemMessage get ServiceSessionResolvedEvent,serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,061 ERROR [SimpleAsyncTaskExecutor-4271]  o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected error occurred invoking async method 'public void com.easemob.weichat.service.processing.handlers.ServiceSessionEventHandler.onEvent(com.easemob.weichat.service.events.session.ServiceSessionResolvedEvent)'.
org.springframework.orm.ObjectOptimisticLockingFailureException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1; nested exception is org.hibernate.StaleStateException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:320)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:521)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:761)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:730)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:504)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:292)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:673)
	at com.easemob.weichat.service.processing.ProcessingSessionServiceImpl$$EnhancerBySpringCGLIB$$6e36cc59.removeSession(<generated>)
	at com.easemob.weichat.service.processing.handlers.ServiceSessionEventHandler.onEvent(ServiceSessionEventHandler.java:193)
	at com.easemob.weichat.service.processing.handlers.ServiceSessionEventHandler$$FastClassBySpringCGLIB$$2e2bf718.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:738)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor$1.call(AsyncExecutionInterceptor.java:115)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.hibernate.StaleStateException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1
	at org.hibernate.jdbc.Expectations$BasicExpectation.checkBatched(Expectations.java:67)
	at org.hibernate.jdbc.Expectations$BasicExpectation.verifyOutcome(Expectations.java:54)
	at org.hibernate.engine.jdbc.batch.internal.NonBatchingBatch.addToBatch(NonBatchingBatch.java:46)
	at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:3261)
	at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:3498)
	at org.hibernate.action.internal.EntityDeleteAction.execute(EntityDeleteAction.java:98)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:582)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:456)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:337)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1282)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:465)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2963)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2339)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:485)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:147)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.access$100(JdbcResourceLocalTransactionCoordinatorImpl.java:38)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:231)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:65)
	at org.hibernate.jpa.internal.TransactionImpl.commit(TransactionImpl.java:61)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:517)
	... 16 common frames omitted
2019-01-03 15:30:33,061 WARN  [pool-30-thread-1]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=74481e70-0f29-11e9-a598-d350c9f1822b, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500633047, properties={}, body={source={}, timestamp=1546500633046, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, messages=[{messageType=ServiceSessionClosed, body={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Processing, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！, type=txt}], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500572693, timestamp=1546500572000, createMicroTimestamp=1546500572693000}, techChannelType=easemob, originType=webim, expire=true}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:30:33,063 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:8e13e691-2476-4029-a45f-e50ac1214ee2 message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"ServiceSessionClosed","body":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Processing","chatGroupId":118,"messageSeqId":7,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500572693,"timestamp":1546500572000,"createMicroTimestamp":1546500572693000},"techChannelType":"easemob","originType":"webim","expire":true}}],"timestamp":1546500633048,"type":null}
2019-01-03 15:30:33,064 INFO  [SimpleAsyncTaskExecutor-10]  c.e.w.n.service.PushDataService - prepare message noticeId:8e13e691-2476-4029-a45f-e50ac1214ee2 messageType:ServiceSessionClosed path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:30:33,068 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] ---> POST http://KefuLiteWebapp/v5/tenants/4/messages HTTP/1.1
2019-01-03 15:30:33,089 INFO  [SimpleAsyncTaskExecutor-4275]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionClosedEvent end, serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314, message count:0
2019-01-03 15:30:33,099 INFO  [SimpleAsyncTaskExecutor-4275]  c.e.w.h.l.ServiceSessionHistoryListener - createServiceSessionEventHistory | createServiceSessionEventHistory input. event:agent user [tenantId = 4, userId = abd3b006-0451-45ec-a33b-161bb0feeee5] closed servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,102 INFO  [http-nio-8899-exec-9]  c.e.w.r.m.m.MessageInternalReadWriteController - POST /v5/tenants/4/messages body:{"from":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"to":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","status":"Disable","bizId":"4","roles":"","scope":"Tenant"},"officialAccountId":null,"messageRequest":{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt","fromUserName":null,"toUser":null,"longitude":null,"latitude":null,"url":null,"filename":null,"mediaId":null,"imageHeight":null,"imageWidth":null,"fileLength":null,"action":null,"ext":{"weichat":{"msgId":null,"originType":null,"visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":null,"reserve_queue":null,"match_flag":null}},"fromUserId":null,"toUserId":null,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","mediaFileUrl":null,"tenantId":4,"audioLength":null,"thumb":null,"length":null,"thumbSecret":null,"sendTime":null},"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","saveMessage":true}
2019-01-03 15:30:33,107 INFO  [http-nio-8899-exec-9]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,158 INFO  [http-nio-8899-exec-15]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/6b2f39c9-e766-490b-85ff-0bb06a3ca314/official-accounts
2019-01-03 15:30:33,176 INFO  [http-nio-8899-exec-9]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6 messageId:9539d071-0d62-4c3e-bfd2-92286ea82989
2019-01-03 15:30:33,201 INFO  [http-nio-8899-exec-3]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","messageId":"9539d071-0d62-4c3e-bfd2-92286ea82989","sessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314"}
2019-01-03 15:30:33,213 INFO  [SimpleAsyncTaskExecutor-4281]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=9539d071-0d62-4c3e-bfd2-92286ea82989, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat=KefuExtMessage(msgId=9539d071-0d62-4c3e-bfd2-92286ea82989, originType=null, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=ExtEvent(eventName=ServiceSessionClosedEvent, eventObj=null), metadata=null, callcenter=null, serviceSession=null, language=null, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~), msgIdForAck=null, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=18, sessionServiceSeqId=8, createDateTime=2019-01-03 15:30:33.103, timestamp=1546500633103, createMicroTimestamp=1546500633103000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Terminal, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28.949, stopDateTime=2019-01-03 15:30:32.858, createDatetime=2019-01-03 15:28:28.935, lastChatMessage=ChatMessage(msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:29:32.693, timestamp=1546500572000, createMicroTimestamp=1546500572693000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:30:33,215 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"746124b0-0f29-11e9-85fb-1547a55ac93c","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500633211,"body":{"timestamp":1546500633211,"version":"1.1","tenantId":4,"message":{"msgId":"9539d071-0d62-4c3e-bfd2-92286ea82989","tenantId":4,"chatGroupId":118,"sessionServiceId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":0,"userId":"_1","userType":"All","userScope":"Tenant","nicename":"所有人","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~","type":"txt"}],"ext":{"weichat":{"msgId":"9539d071-0d62-4c3e-bfd2-92286ea82989","originType":null,"visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionClosedEvent","eventObj":null},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~"},"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":18,"sessionServiceSeqId":8,"createDateTime":1546500633103,"timestamp":1546500633103,"createMicroTimestamp":1546500633103000},"serviceSession":{"tenantId":4,"serviceSessionId":"6b2f39c9-e766-490b-85ff-0bb06a3ca314","techChannelId":1,"visitorUser":{"tenantId":4,"userId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","userType":"Visitor","userScope":"Tenant","nicename":"1","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":4,"robotId":0,"state":"Terminal","chatGroupId":118,"messageSeqId":7,"agentUserId":"abd3b006-0451-45ec-a33b-161bb0feeee5","agentUserNiceName":"机器人测试","agentUserType":6,"startDateTime":"2019-01-03 15:28:28","stopDateTime":"2019-01-03 15:30:32","createDatetime":"2019-01-03 15:28:28","lastChatMessage":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！","type":"txt"}],"ext":{"weichat":{"msgId":"f801ffdc-a8e4-4844-bbba-a2a44149453c","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"47258dc0-fd4e-42e7-8cf0-5166354f5a5c","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-BRM392HYE7EBV8B4996K","channelType":"easemob","tenantId":4,"visitorUserId":"ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6","originType":"webim","channel_id":1},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500572693,"timestamp":1546500572000,"createMicroTimestamp":1546500572693000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 16, current offset is 4039
2019-01-03 15:30:33,219 DEBUG [hystrix-KefuLiteWebapp-45]  c.e.w.s.m.c.WebappReadWriteClientFeign - [WebappReadWriteClientFeign#sendMessage] <--- HTTP/1.1 200 (150ms)
2019-01-03 15:30:33,220 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.e.consumer.KafkaEventConsumer - enquiry service got event com.easemob.weichat.service.events.session.ServiceSessionResolvedEvent
2019-01-03 15:30:33,223 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.e.client.WebappReadonlyClient - webappReadonlyApiClient findOptionsByOptionName, tenantId： 4, optionName=inviteEnquiryOnServiceSessionResolved
2019-01-03 15:30:33,223 WARN  [pool-30-thread-2]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=743f1dc0-0f29-11e9-8a02-9bfb35c6e564, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionResolvedEvent, timestamp=1546500632989, properties={}, body={timestamp=1546500632988, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Resolved, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！, type=txt}], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500572693, timestamp=1546500572000, createMicroTimestamp=1546500572693000}, techChannelType=easemob, originType=webim, expire=true}, extendData={channel={tenantId=4, type=easemob, id=1, dutyType=None, timeScheduleId=0, name=体验关联, info=easemob-demo#chatdemoui#153895}, visitorChannelUser={orgName=easemob-demo, imId=webim-visitor-BRM392HYE7EBV8B4996K, appName=chatdemoui, channelType=easemob}, visitor={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, agent={tenantId=0, userId=abd3b006-0451-45ec-a33b-161bb0feeee5, userType=Robot, userScope=Tenant, nicename=机器人测试, status=Disable, bizId=0, roles=, scope=Tenant}, agentQueue={tenantId=4, queueId=4, queueName=未分组, queueType=QueueNormal, priority=0, createDateTime=1542707002000, lastUpdateDateTime=1542707002000, queueGroupType=SystemDefault, agentUsers=[{tenantId=4, userId=9d87ef07-a867-4adf-b610-44b1df7895a1, userType=Agent, userScope=Tenant, nicename=临时值班长, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-11-26 21:40:00, lastUpdateDateTime=2018-11-26 21:40:00, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=临时值班长, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=34959a49-1dfe-43f9-85d1-4de5323d1602, userType=Agent, userScope=Tenant, nicename=王悦, password=, username=wangyuen@zking.com, roles=agent, createDateTime=2018-11-26 21:38:24, lastUpdateDateTime=2018-11-26 21:38:24, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=王悦, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=779a9b78-8436-4bf2-9d12-361f78710e25, userType=Agent, userScope=Tenant, nicename=test@11.com, password=, username=test@11.com, roles=admin,agent, createDateTime=2018-11-27 11:45:27, lastUpdateDateTime=2018-12-28 10:54:34, firstLoginTimeOfRecentDay=2018-12-28 10:54:34, status=Enable, state=Online, maxServiceSessionCount=10, trueName=, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=281848c3-2b84-4604-8fd3-09daa5611ef8, userType=Agent, userScope=Tenant, nicename=曾晴, password=, username=zengqing@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:40:19, lastUpdateDateTime=2018-12-26 09:27:10, firstLoginTimeOfRecentDay=2018-12-26 09:23:20, status=Enable, state=Online, maxServiceSessionCount=10, trueName=曾晴, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=f3d71215-7582-404b-8edd-9dd1dd1e2c78, userType=Agent, userScope=Tenant, nicename=束峥 , password=, username=shuzheng@zking.com, roles=agent, createDateTime=2018-11-26 21:36:07, lastUpdateDateTime=2018-11-26 21:36:07, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=束峥 , mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=5983a725-851e-4364-a215-bc86e460c83f, userType=Agent, userScope=Tenant, nicename=ccc, password=, username=robot@50331654.com, roles=agent, createDateTime=2018-11-30 12:55:33, lastUpdateDateTime=2018-11-30 12:55:33, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=b3ce3e20-ed71-40c5-b78a-b3bf02b6ec0b, userType=Agent, userScope=Tenant, nicename=111, password=, username=robot@33554440.com, roles=agent, createDateTime=2018-11-29 11:21:40, lastUpdateDateTime=2018-11-29 11:21:40, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=227255c6-abf4-4d0e-9bbd-1bbb55e33709, userType=Agent, userScope=Tenant, nicename=吴柯, password=, username=wuke001@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:41:21, lastUpdateDateTime=2018-12-26 09:24:53, firstLoginTimeOfRecentDay=2018-12-26 09:24:53, status=Enable, state=Online, maxServiceSessionCount=10, trueName=吴柯, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=ade55cfb-8328-431a-9b9d-800122e82078, userType=Agent, userScope=Tenant, nicename=曹正海, password=, username=caozhenghai@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:42:48, lastUpdateDateTime=2018-12-29 11:41:33, firstLoginTimeOfRecentDay=2018-12-29 11:41:33, status=Enable, state=Online, maxServiceSessionCount=1, trueName=曹正海, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=9da5a683-db4d-4e2b-b604-753b80143381, userType=Agent, userScope=Tenant, nicename=robot11, password=, username=robot11@easemob.com, roles=agent, createDateTime=2018-11-23 16:51:28, lastUpdateDateTime=2018-11-23 16:53:13, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=da4dc75e-96c6-4b3b-9811-1fe29a7859f8, userType=Agent, userScope=Tenant, nicename=鞠恒俊, password=, username=juhengjun@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:43:04, lastUpdateDateTime=2018-12-28 15:02:24, firstLoginTimeOfRecentDay=2018-12-28 15:02:24, status=Enable, state=Online, maxServiceSessionCount=10, trueName=鞠恒俊, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=bd6f3d66-4af5-4bc6-af8f-57bf91ce3c82, userType=Agent, userScope=Tenant, nicename=李文慧, password=, username=liwenhui@zking.com, roles=agent, createDateTime=2018-11-26 21:38:01, lastUpdateDateTime=2018-12-26 09:26:28, firstLoginTimeOfRecentDay=2018-12-26 09:26:28, status=Enable, state=Online, maxServiceSessionCount=10, trueName=李文慧, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=bfeadb77-ed34-4165-a5cc-5d720f85a58b, userType=Agent, userScope=Tenant, nicename=李云龙, password=, username=liyunlong@zking.com, roles=agent, createDateTime=2018-11-26 21:39:26, lastUpdateDateTime=2018-11-26 21:39:26, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=李云龙, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=143780ab-a30c-42f5-9ad8-55c3afade15d, userType=Agent, userScope=Tenant, nicename=紫金财险测试, password=, username=kefutest@zking.com, roles=admin,agent, createDateTime=2018-11-26 16:19:31, lastUpdateDateTime=2018-12-12 22:37:38, firstLoginTimeOfRecentDay=2018-12-12 22:37:38, status=Enable, state=Offline, maxServiceSessionCount=1, trueName=紫金财险测试, mobilePhone=, avatar=//kefutest.zking.com:12508/v1/tenants/4/mediafiles/1bac067d-f1e6-432d-bba9-6e7d86203a01MS5wbmc=/cutout?arg=0_0_200_200_300_300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=ed64aed8-94f2-4c47-b43d-f183cf8f4047, userType=Agent, userScope=Tenant, nicename=孙同海, password=, username=suntonghai@zking.com, roles=agent, createDateTime=2018-11-26 21:43:54, lastUpdateDateTime=2018-11-26 21:43:54, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙同海, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=6e49c172-6265-42c2-906a-62b6f976f361, userType=Agent, userScope=Tenant, nicename=徐伟, password=, username=xuwei002@zking.com, roles=agent, createDateTime=2018-11-26 21:35:22, lastUpdateDateTime=2018-11-26 21:35:22, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=徐伟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=7272fe31-434e-4a0b-9d59-b04ecd071964, userType=Agent, userScope=Tenant, nicename=黄苏扬, password=, username=huangsuyang@zking.com, roles=agent, createDateTime=2018-11-26 21:32:20, lastUpdateDateTime=2018-11-26 21:32:20, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=黄苏扬, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=cc78123e-3ab7-4703-8fcc-93f863e03916, userType=Agent, userScope=Tenant, nicename=尹茂龙, password=, username=yinmaolong@zking.com, roles=agent, createDateTime=2018-11-26 21:43:21, lastUpdateDateTime=2018-11-26 21:43:21, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=尹茂龙, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=8848c61e-ecf3-4591-b2a5-399801759f4c, userType=Agent, userScope=Tenant, nicename=征秀, password=, username=zhengxiu@zking.com, roles=agent, createDateTime=2018-11-26 21:35:45, lastUpdateDateTime=2018-11-26 21:35:45, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=征秀, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=9d40eed5-f877-42f3-93ef-91701a3a531c, userType=Agent, userScope=Tenant, nicename=孙悦, password=, username=sunyue@zking.com, roles=agent, createDateTime=2018-11-26 21:36:46, lastUpdateDateTime=2018-11-26 21:36:46, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙悦, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=1e0d9710-0f4a-44eb-bd0a-dc71db5b1ed3, userType=Agent, userScope=Tenant, nicename=孙娟, password=, username=sunjuan@zking.com, roles=agent, createDateTime=2018-11-26 21:36:27, lastUpdateDateTime=2018-11-26 21:36:27, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙娟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=3a181f32-19b9-43ae-8555-8da9186fad19, userType=Agent, userScope=Tenant, nicename=紫金财险机器人, password=, username=robot@4.com, roles=agent, createDateTime=2018-11-26 17:55:40, lastUpdateDateTime=2018-11-26 21:54:20, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=a3a9c957-9d88-402a-8032-84039f1eacdd, userType=Agent, userScope=Tenant, nicename=卞骐, password=, username=bianqi@zking.com, roles=agent, createDateTime=2018-11-26 21:37:46, lastUpdateDateTime=2018-11-26 21:37:46, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=卞骐, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=ace11a88-b85a-4732-b08a-c5f109a22be7, userType=Agent, userScope=Tenant, nicename=蒋文婷, password=, username=jiangwenting@zking.com, roles=agent, createDateTime=2018-11-26 21:37:25, lastUpdateDateTime=2018-11-26 21:37:25, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=蒋文婷, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=3d75dc9d-145a-49ab-9579-c35e410584a6, userType=Agent, userScope=Tenant, nicename=工号001, password=, username=changdan@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:40:37, lastUpdateDateTime=2018-12-24 15:52:14, firstLoginTimeOfRecentDay=2018-12-24 15:52:14, status=Enable, state=Hidden, maxServiceSessionCount=7, trueName=ＡＢＣＤ, mobilePhone=, bizId=4, scope=Tenant, onLineState=Hidden, currentOnLineState=Hidden}, {tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5, userType=Agent, userScope=Tenant, nicename=机器人测试, password=, username=robot@83886084.com, roles=agent, createDateTime=2018-12-05 16:24:26, lastUpdateDateTime=2018-12-05 16:24:26, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=1741bffb-4561-4204-8b9f-775243f86ab1, userType=Agent, userScope=Tenant, nicename=刘倩, password=, username=liuqian@zking.com, roles=agent, createDateTime=2018-11-26 21:39:43, lastUpdateDateTime=2018-11-26 21:39:43, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=刘倩, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=5f19b772-4fa3-40ec-8aa3-b9ae7f34d2f2, userType=Agent, userScope=Tenant, nicename=蒋逸鸥, password=, username=jiangyiou@zking.com, roles=agent, createDateTime=2018-11-26 21:39:12, lastUpdateDateTime=2018-11-26 21:39:12, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=蒋逸鸥, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=560ea0c4-a0c2-4dad-830a-7d5e5d34975d, userType=Agent, userScope=Tenant, nicename=12345, password=, username=robot@67108870.com, roles=agent, createDateTime=2018-12-04 01:34:45, lastUpdateDateTime=2018-12-04 01:34:45, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=98461a5e-af68-41ce-954e-546ae32b60e2, userType=Agent, userScope=Tenant, nicename=Admin, password=, username=zijincaixian@easemob.com, roles=admin,agent, createDateTime=2018-11-20 17:43:27, lastUpdateDateTime=2019-01-02 14:49:47, firstLoginTimeOfRecentDay=2019-01-02 14:49:47, status=Enable, state=Hidden, maxServiceSessionCount=4, trueName=, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Hidden, currentOnLineState=Hidden}, {tenantId=4, userId=dd262b0b-e657-46e6-81aa-f46450b829b3, userType=Agent, userScope=Tenant, nicename=袁娟, password=, username=yuanjuan@zking.com, roles=agent, createDateTime=2018-11-26 21:38:43, lastUpdateDateTime=2018-11-26 21:38:43, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=袁娟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=5de7020d-6939-43d8-855e-3e2f887fa707, userType=Agent, userScope=Tenant, nicename=姜芳, password=, username=jiangfang@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:41:42, lastUpdateDateTime=2018-12-26 09:25:02, firstLoginTimeOfRecentDay=2018-12-26 09:25:02, status=Enable, state=Online, maxServiceSessionCount=0, trueName=姜芳, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=84620ad2-ad5e-42d5-978b-ef76c0c74cf1, userType=Agent, userScope=Tenant, nicename=刘佳, password=, username=liujia@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:33:02, lastUpdateDateTime=2018-11-26 21:33:02, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=刘佳, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=f287b21e-6834-49ea-b10d-82f4d7bfa149, userType=Agent, userScope=Tenant, nicename=孟执中, password=, username=mengzhizhong@zking.com, roles=agent, createDateTime=2018-11-26 21:43:37, lastUpdateDateTime=2018-11-26 21:43:37, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孟执中, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=436a6dca-bdde-4c31-a0b1-585e97eb5507, userType=Agent, userScope=Tenant, nicename=test2, password=, username=test2@zijin.com, roles=admin,agent, createDateTime=2018-11-27 09:48:00, lastUpdateDateTime=2018-12-26 14:31:05, firstLoginTimeOfRecentDay=2018-12-26 14:31:05, status=Enable, state=Offline, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=7db8572c-8ec9-4afd-af51-ba12e211a6f3, userType=Agent, userScope=Tenant, nicename=孙莲, password=, username=sunlian@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:42:31, lastUpdateDateTime=2018-11-26 21:42:31, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙莲, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=8dd001a0-3b02-45e8-b97c-291d15d2997d, userType=Agent, userScope=Tenant, nicename=bbb, password=, username=robot@16777222.com, roles=agent, createDateTime=2018-11-26 17:56:21, lastUpdateDateTime=2018-11-26 17:56:21, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=f2f5fce6-ebc3-41fe-ae30-24308994e6c8, userType=Agent, userScope=Tenant, nicename=万田菁, password=, username=wantianqing@zking.com, roles=agent, createDateTime=2018-11-26 21:37:03, lastUpdateDateTime=2018-11-26 21:37:03, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=万田菁, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=0e7bf062-14bd-4643-8d75-41ed01613d8c, userType=Agent, userScope=Tenant, nicename=许正香, password=, username=xuzhengxiang@zking.com, roles=agent, createDateTime=2018-11-26 21:42:12, lastUpdateDateTime=2018-11-26 21:42:12, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=许正香, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=4330dde5-8e76-47e5-aa0a-8e901d7bdf7e, userType=Agent, userScope=Tenant, nicename=卢蓉, password=, username=lurong@zking.com, roles=agent, createDateTime=2018-11-26 21:34:42, lastUpdateDateTime=2018-11-26 21:34:42, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=卢蓉, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=d372e396-ef23-4efc-94ee-ef02c03dd587, userType=Agent, userScope=Tenant, nicename=王娟, password=, username=wangjuan003@zking.com, roles=agent, createDateTime=2018-11-26 21:35:03, lastUpdateDateTime=2018-11-26 21:35:03, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=王娟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=c9e704c4-5bfa-4746-b875-80f678b75fab, userType=Agent, userScope=Tenant, nicename=刘露, password=, username=liulu@zking.com, roles=agent, createDateTime=2018-11-26 21:33:34, lastUpdateDateTime=2018-11-26 21:33:34, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=刘露, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}]}, originType=webim}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:30:33,225 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.e.client.WebappReadonlyClient - webappReadonlyApiClient findOptionsByOptionName, tenantId： 4, optionName=doNotInviteEnquiryOnServiceSessionAutoResolved
2019-01-03 15:30:33,227 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.e.client.WebappReadonlyClient - webappReadonlyApiClient findOptionsByOptionName, tenantId： 4, optionName=doNotInviteEnquiryOnServiceSessionResolvedOfRobot
2019-01-03 15:30:33,250 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to AbstractServiceSessionEvent agent user [tenantId = 4, userId = abd3b006-0451-45ec-a33b-161bb0feeee5] closed servicesession 6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,255 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.s.WaitingDataUpdateService - ServiceSessionAbortedEvent|ServiceSessionResolvedEvent|ServiceSessionClosedEvent serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314,queueId:4
2019-01-03 15:30:33,255 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.q.a.s.UpdateDataFromKafkaService - this time upDateRedisDataByKafkaServiceSession speed time 0ms
2019-01-03 15:30:33,258 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.s.m.s.i.h.SystemMessageServiceSessionClosedEventHandler - systemMessage get ServiceSessionClosedEvent,serviceSessionId:6b2f39c9-e766-490b-85ff-0bb06a3ca314
2019-01-03 15:30:33,258 INFO  [pool-11-thread-4]  c.e.w.m.s.a.h.BaseAbstractEventHandler - actor is null , this is System Message
2019-01-03 15:30:33,263 WARN  [pool-30-thread-5]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=744167b0-0f29-11e9-983f-21254cc4135c, service=null, type=com.easemob.weichat.service.events.session.ServiceSessionClosedEvent, timestamp=1546500633003, properties={}, body={timestamp=1546500633002, version=1.1, tenantId=4, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Terminal, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, stopDateTime=2019-01-03 15:30:32, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！, type=txt}], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500572693, timestamp=1546500572000, createMicroTimestamp=1546500572693000}, techChannelType=easemob, originType=webim, expire=true}, userPK={tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5}, extendData={channel={tenantId=4, type=easemob, id=1, dutyType=None, timeScheduleId=0, name=体验关联, info=easemob-demo#chatdemoui#153895}, visitorChannelUser={orgName=easemob-demo, imId=webim-visitor-BRM392HYE7EBV8B4996K, appName=chatdemoui, channelType=easemob}, visitor={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, agent={tenantId=0, userId=abd3b006-0451-45ec-a33b-161bb0feeee5, userType=Robot, userScope=Tenant, nicename=机器人测试, status=Disable, bizId=0, roles=, scope=Tenant}, agentQueue={tenantId=4, queueId=4, queueName=未分组, queueType=QueueNormal, priority=0, createDateTime=1542707002000, lastUpdateDateTime=1542707002000, queueGroupType=SystemDefault, agentUsers=[{tenantId=4, userId=9d87ef07-a867-4adf-b610-44b1df7895a1, userType=Agent, userScope=Tenant, nicename=临时值班长, password=, username=lszbz@zking.com, roles=agent, createDateTime=2018-11-26 21:40:00, lastUpdateDateTime=2018-11-26 21:40:00, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=临时值班长, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=34959a49-1dfe-43f9-85d1-4de5323d1602, userType=Agent, userScope=Tenant, nicename=王悦, password=, username=wangyuen@zking.com, roles=agent, createDateTime=2018-11-26 21:38:24, lastUpdateDateTime=2018-11-26 21:38:24, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=王悦, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=779a9b78-8436-4bf2-9d12-361f78710e25, userType=Agent, userScope=Tenant, nicename=test@11.com, password=, username=test@11.com, roles=admin,agent, createDateTime=2018-11-27 11:45:27, lastUpdateDateTime=2018-12-28 10:54:34, firstLoginTimeOfRecentDay=2018-12-28 10:54:34, status=Enable, state=Online, maxServiceSessionCount=10, trueName=, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=281848c3-2b84-4604-8fd3-09daa5611ef8, userType=Agent, userScope=Tenant, nicename=曾晴, password=, username=zengqing@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:40:19, lastUpdateDateTime=2018-12-26 09:27:10, firstLoginTimeOfRecentDay=2018-12-26 09:23:20, status=Enable, state=Online, maxServiceSessionCount=10, trueName=曾晴, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=f3d71215-7582-404b-8edd-9dd1dd1e2c78, userType=Agent, userScope=Tenant, nicename=束峥 , password=, username=shuzheng@zking.com, roles=agent, createDateTime=2018-11-26 21:36:07, lastUpdateDateTime=2018-11-26 21:36:07, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=束峥 , mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=5983a725-851e-4364-a215-bc86e460c83f, userType=Agent, userScope=Tenant, nicename=ccc, password=, username=robot@50331654.com, roles=agent, createDateTime=2018-11-30 12:55:33, lastUpdateDateTime=2018-11-30 12:55:33, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=b3ce3e20-ed71-40c5-b78a-b3bf02b6ec0b, userType=Agent, userScope=Tenant, nicename=111, password=, username=robot@33554440.com, roles=agent, createDateTime=2018-11-29 11:21:40, lastUpdateDateTime=2018-11-29 11:21:40, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=227255c6-abf4-4d0e-9bbd-1bbb55e33709, userType=Agent, userScope=Tenant, nicename=吴柯, password=, username=wuke001@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:41:21, lastUpdateDateTime=2018-12-26 09:24:53, firstLoginTimeOfRecentDay=2018-12-26 09:24:53, status=Enable, state=Online, maxServiceSessionCount=10, trueName=吴柯, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=ade55cfb-8328-431a-9b9d-800122e82078, userType=Agent, userScope=Tenant, nicename=曹正海, password=, username=caozhenghai@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:42:48, lastUpdateDateTime=2018-12-29 11:41:33, firstLoginTimeOfRecentDay=2018-12-29 11:41:33, status=Enable, state=Online, maxServiceSessionCount=1, trueName=曹正海, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=9da5a683-db4d-4e2b-b604-753b80143381, userType=Agent, userScope=Tenant, nicename=robot11, password=, username=robot11@easemob.com, roles=agent, createDateTime=2018-11-23 16:51:28, lastUpdateDateTime=2018-11-23 16:53:13, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=da4dc75e-96c6-4b3b-9811-1fe29a7859f8, userType=Agent, userScope=Tenant, nicename=鞠恒俊, password=, username=juhengjun@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:43:04, lastUpdateDateTime=2018-12-28 15:02:24, firstLoginTimeOfRecentDay=2018-12-28 15:02:24, status=Enable, state=Online, maxServiceSessionCount=10, trueName=鞠恒俊, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=bd6f3d66-4af5-4bc6-af8f-57bf91ce3c82, userType=Agent, userScope=Tenant, nicename=李文慧, password=, username=liwenhui@zking.com, roles=agent, createDateTime=2018-11-26 21:38:01, lastUpdateDateTime=2018-12-26 09:26:28, firstLoginTimeOfRecentDay=2018-12-26 09:26:28, status=Enable, state=Online, maxServiceSessionCount=10, trueName=李文慧, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=bfeadb77-ed34-4165-a5cc-5d720f85a58b, userType=Agent, userScope=Tenant, nicename=李云龙, password=, username=liyunlong@zking.com, roles=agent, createDateTime=2018-11-26 21:39:26, lastUpdateDateTime=2018-11-26 21:39:26, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=李云龙, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=143780ab-a30c-42f5-9ad8-55c3afade15d, userType=Agent, userScope=Tenant, nicename=紫金财险测试, password=, username=kefutest@zking.com, roles=admin,agent, createDateTime=2018-11-26 16:19:31, lastUpdateDateTime=2018-12-12 22:37:38, firstLoginTimeOfRecentDay=2018-12-12 22:37:38, status=Enable, state=Offline, maxServiceSessionCount=1, trueName=紫金财险测试, mobilePhone=, avatar=//kefutest.zking.com:12508/v1/tenants/4/mediafiles/1bac067d-f1e6-432d-bba9-6e7d86203a01MS5wbmc=/cutout?arg=0_0_200_200_300_300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=ed64aed8-94f2-4c47-b43d-f183cf8f4047, userType=Agent, userScope=Tenant, nicename=孙同海, password=, username=suntonghai@zking.com, roles=agent, createDateTime=2018-11-26 21:43:54, lastUpdateDateTime=2018-11-26 21:43:54, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙同海, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=6e49c172-6265-42c2-906a-62b6f976f361, userType=Agent, userScope=Tenant, nicename=徐伟, password=, username=xuwei002@zking.com, roles=agent, createDateTime=2018-11-26 21:35:22, lastUpdateDateTime=2018-11-26 21:35:22, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=徐伟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=7272fe31-434e-4a0b-9d59-b04ecd071964, userType=Agent, userScope=Tenant, nicename=黄苏扬, password=, username=huangsuyang@zking.com, roles=agent, createDateTime=2018-11-26 21:32:20, lastUpdateDateTime=2018-11-26 21:32:20, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=黄苏扬, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=cc78123e-3ab7-4703-8fcc-93f863e03916, userType=Agent, userScope=Tenant, nicename=尹茂龙, password=, username=yinmaolong@zking.com, roles=agent, createDateTime=2018-11-26 21:43:21, lastUpdateDateTime=2018-11-26 21:43:21, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=尹茂龙, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=8848c61e-ecf3-4591-b2a5-399801759f4c, userType=Agent, userScope=Tenant, nicename=征秀, password=, username=zhengxiu@zking.com, roles=agent, createDateTime=2018-11-26 21:35:45, lastUpdateDateTime=2018-11-26 21:35:45, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=征秀, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=9d40eed5-f877-42f3-93ef-91701a3a531c, userType=Agent, userScope=Tenant, nicename=孙悦, password=, username=sunyue@zking.com, roles=agent, createDateTime=2018-11-26 21:36:46, lastUpdateDateTime=2018-11-26 21:36:46, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙悦, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=1e0d9710-0f4a-44eb-bd0a-dc71db5b1ed3, userType=Agent, userScope=Tenant, nicename=孙娟, password=, username=sunjuan@zking.com, roles=agent, createDateTime=2018-11-26 21:36:27, lastUpdateDateTime=2018-11-26 21:36:27, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙娟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=3a181f32-19b9-43ae-8555-8da9186fad19, userType=Agent, userScope=Tenant, nicename=紫金财险机器人, password=, username=robot@4.com, roles=agent, createDateTime=2018-11-26 17:55:40, lastUpdateDateTime=2018-11-26 21:54:20, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=a3a9c957-9d88-402a-8032-84039f1eacdd, userType=Agent, userScope=Tenant, nicename=卞骐, password=, username=bianqi@zking.com, roles=agent, createDateTime=2018-11-26 21:37:46, lastUpdateDateTime=2018-11-26 21:37:46, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=卞骐, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=ace11a88-b85a-4732-b08a-c5f109a22be7, userType=Agent, userScope=Tenant, nicename=蒋文婷, password=, username=jiangwenting@zking.com, roles=agent, createDateTime=2018-11-26 21:37:25, lastUpdateDateTime=2018-11-26 21:37:25, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=蒋文婷, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=3d75dc9d-145a-49ab-9579-c35e410584a6, userType=Agent, userScope=Tenant, nicename=工号001, password=, username=changdan@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:40:37, lastUpdateDateTime=2018-12-24 15:52:14, firstLoginTimeOfRecentDay=2018-12-24 15:52:14, status=Enable, state=Hidden, maxServiceSessionCount=7, trueName=ＡＢＣＤ, mobilePhone=, bizId=4, scope=Tenant, onLineState=Hidden, currentOnLineState=Hidden}, {tenantId=4, userId=abd3b006-0451-45ec-a33b-161bb0feeee5, userType=Agent, userScope=Tenant, nicename=机器人测试, password=, username=robot@83886084.com, roles=agent, createDateTime=2018-12-05 16:24:26, lastUpdateDateTime=2018-12-05 16:24:26, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=1741bffb-4561-4204-8b9f-775243f86ab1, userType=Agent, userScope=Tenant, nicename=刘倩, password=, username=liuqian@zking.com, roles=agent, createDateTime=2018-11-26 21:39:43, lastUpdateDateTime=2018-11-26 21:39:43, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=刘倩, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=5f19b772-4fa3-40ec-8aa3-b9ae7f34d2f2, userType=Agent, userScope=Tenant, nicename=蒋逸鸥, password=, username=jiangyiou@zking.com, roles=agent, createDateTime=2018-11-26 21:39:12, lastUpdateDateTime=2018-11-26 21:39:12, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=蒋逸鸥, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=560ea0c4-a0c2-4dad-830a-7d5e5d34975d, userType=Agent, userScope=Tenant, nicename=12345, password=, username=robot@67108870.com, roles=agent, createDateTime=2018-12-04 01:34:45, lastUpdateDateTime=2018-12-04 01:34:45, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=98461a5e-af68-41ce-954e-546ae32b60e2, userType=Agent, userScope=Tenant, nicename=Admin, password=, username=zijincaixian@easemob.com, roles=admin,agent, createDateTime=2018-11-20 17:43:27, lastUpdateDateTime=2019-01-02 14:49:47, firstLoginTimeOfRecentDay=2019-01-02 14:49:47, status=Enable, state=Hidden, maxServiceSessionCount=4, trueName=, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Hidden, currentOnLineState=Hidden}, {tenantId=4, userId=dd262b0b-e657-46e6-81aa-f46450b829b3, userType=Agent, userScope=Tenant, nicename=袁娟, password=, username=yuanjuan@zking.com, roles=agent, createDateTime=2018-11-26 21:38:43, lastUpdateDateTime=2018-11-26 21:38:43, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=袁娟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=5de7020d-6939-43d8-855e-3e2f887fa707, userType=Agent, userScope=Tenant, nicename=姜芳, password=, username=jiangfang@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:41:42, lastUpdateDateTime=2018-12-26 09:25:02, firstLoginTimeOfRecentDay=2018-12-26 09:25:02, status=Enable, state=Online, maxServiceSessionCount=0, trueName=姜芳, mobilePhone=, bizId=4, scope=Tenant, onLineState=Online, currentOnLineState=Online}, {tenantId=4, userId=84620ad2-ad5e-42d5-978b-ef76c0c74cf1, userType=Agent, userScope=Tenant, nicename=刘佳, password=, username=liujia@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:33:02, lastUpdateDateTime=2018-11-26 21:33:02, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=刘佳, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=f287b21e-6834-49ea-b10d-82f4d7bfa149, userType=Agent, userScope=Tenant, nicename=孟执中, password=, username=mengzhizhong@zking.com, roles=agent, createDateTime=2018-11-26 21:43:37, lastUpdateDateTime=2018-11-26 21:43:37, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孟执中, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=436a6dca-bdde-4c31-a0b1-585e97eb5507, userType=Agent, userScope=Tenant, nicename=test2, password=, username=test2@zijin.com, roles=admin,agent, createDateTime=2018-11-27 09:48:00, lastUpdateDateTime=2018-12-26 14:31:05, firstLoginTimeOfRecentDay=2018-12-26 14:31:05, status=Enable, state=Offline, maxServiceSessionCount=5, trueName=, mobilePhone=, avatar=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=7db8572c-8ec9-4afd-af51-ba12e211a6f3, userType=Agent, userScope=Tenant, nicename=孙莲, password=, username=sunlian@zking.com, roles=admin,agent, createDateTime=2018-11-26 21:42:31, lastUpdateDateTime=2018-11-26 21:42:31, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=孙莲, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=8dd001a0-3b02-45e8-b97c-291d15d2997d, userType=Agent, userScope=Tenant, nicename=bbb, password=, username=robot@16777222.com, roles=agent, createDateTime=2018-11-26 17:56:21, lastUpdateDateTime=2018-11-26 17:56:21, status=Disable, state=Offline, maxServiceSessionCount=0, mobilePhone=13810026300, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=f2f5fce6-ebc3-41fe-ae30-24308994e6c8, userType=Agent, userScope=Tenant, nicename=万田菁, password=, username=wantianqing@zking.com, roles=agent, createDateTime=2018-11-26 21:37:03, lastUpdateDateTime=2018-11-26 21:37:03, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=万田菁, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=0e7bf062-14bd-4643-8d75-41ed01613d8c, userType=Agent, userScope=Tenant, nicename=许正香, password=, username=xuzhengxiang@zking.com, roles=agent, createDateTime=2018-11-26 21:42:12, lastUpdateDateTime=2018-11-26 21:42:12, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=许正香, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=4330dde5-8e76-47e5-aa0a-8e901d7bdf7e, userType=Agent, userScope=Tenant, nicename=卢蓉, password=, username=lurong@zking.com, roles=agent, createDateTime=2018-11-26 21:34:42, lastUpdateDateTime=2018-11-26 21:34:42, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=卢蓉, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=d372e396-ef23-4efc-94ee-ef02c03dd587, userType=Agent, userScope=Tenant, nicename=王娟, password=, username=wangjuan003@zking.com, roles=agent, createDateTime=2018-11-26 21:35:03, lastUpdateDateTime=2018-11-26 21:35:03, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=王娟, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}, {tenantId=4, userId=c9e704c4-5bfa-4746-b875-80f678b75fab, userType=Agent, userScope=Tenant, nicename=刘露, password=, username=liulu@zking.com, roles=agent, createDateTime=2018-11-26 21:33:34, lastUpdateDateTime=2018-11-26 21:33:34, status=Enable, state=Offline, maxServiceSessionCount=10, trueName=刘露, mobilePhone=, bizId=4, scope=Tenant, onLineState=Offline, currentOnLineState=Offline}]}, originType=webim}, kickOff=true}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:30:33,273 INFO  [kafka-events-consumer-1-thread-2]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=9539d071-0d62-4c3e-bfd2-92286ea82989, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@aa9b0186], ext={weichat={msgId=9539d071-0d62-4c3e-bfd2-92286ea82989, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~}, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=18, sessionServiceSeqId=8, createDateTime=2019-01-03 15:30:33.103, timestamp=1546500633103, createMicroTimestamp=1546500633103000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=4, robotId=0, chatRoomId=null, state=Terminal, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=Thu Jan 03 15:28:28 CST 2019, stopDateTime=Thu Jan 03 15:30:32 CST 2019, createDatetime=Thu Jan 03 15:28:28 CST 2019, lastChatMessage=ChatMessage(msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@821a9d28], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=1, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:29:32.693, timestamp=1546500572000, createMicroTimestamp=1546500572693000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:30:33,276 WARN  [pool-30-thread-10]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=746124b0-0f29-11e9-85fb-1547a55ac93c, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500633211, properties={}, body={timestamp=1546500633211, version=1.1, tenantId=4, message={msgId=9539d071-0d62-4c3e-bfd2-92286ea82989, tenantId=4, chatGroupId=118, sessionServiceId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=0, userId=_1, userType=All, userScope=Tenant, nicename=所有人, status=Disable, bizId=0, roles=, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~, type=txt}], ext={weichat={msgId=9539d071-0d62-4c3e-bfd2-92286ea82989, originType=null, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionClosedEvent, eventObj=null}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。本次会话已经结束啦，感谢您的咨询。喜欢小紫的客户可以置顶紫金保险的公众号哦，下次再见啦~}, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=18, sessionServiceSeqId=8, createDateTime=1546500633103, timestamp=1546500633103, createMicroTimestamp=1546500633103000}, serviceSession={tenantId=4, serviceSessionId=6b2f39c9-e766-490b-85ff-0bb06a3ca314, techChannelId=1, visitorUser={tenantId=4, userId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, userType=Visitor, userScope=Tenant, nicename=1, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=4, robotId=0, state=Terminal, chatGroupId=118, messageSeqId=7, agentUserId=abd3b006-0451-45ec-a33b-161bb0feeee5, agentUserNiceName=机器人测试, agentUserType=6, startDateTime=2019-01-03 15:28:28, stopDateTime=2019-01-03 15:30:32, createDatetime=2019-01-03 15:28:28, lastChatMessage={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。因为您长时间没有回复，会话即将结束哟。如果您还有其他问题，请您再次联系我们。紫金保险祝您生活愉快！, type=txt}], ext={weichat={msgId=f801ffdc-a8e4-4844-bbba-a2a44149453c, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=47258dc0-fd4e-42e7-8cf0-5166354f5a5c, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-BRM392HYE7EBV8B4996K, channelType=easemob, tenantId=4, visitorUserId=ffcdbebd-3842-4d27-aa4d-90fa81cc2ef6, originType=webim, channel_id=1}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500572693, timestamp=1546500572000, createMicroTimestamp=1546500572693000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=6b2f39c9-e766-490b-85ff-0bb06a3ca314).
2019-01-03 15:30:33,290 INFO  [http-nio-8899-exec-13]  c.e.w.n.c.SendNotificationController - /v5/notification/send-message,requestBody:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"abd3b006-0451-45ec-a33b-161bb0feeee5","tenantId":4,"type":"StateChange"}}],"timestamp":1546500633274,"type":null}
2019-01-03 15:30:33,290 INFO  [http-nio-8899-exec-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:ad0e3a7f-266e-4f43-b56d-aea76729cfcb message:{"path":"/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5","key":null,"payload":[{"messageType":"Daas","body":{"agentId":"abd3b006-0451-45ec-a33b-161bb0feeee5","tenantId":4,"type":"StateChange"}}],"timestamp":1546500633274,"type":null}
2019-01-03 15:30:33,290 INFO  [http-nio-8899-exec-13]  c.e.w.n.service.PushDataService - prepare message noticeId:ad0e3a7f-266e-4f43-b56d-aea76729cfcb messageType:Daas path:/tenants/4/agents/abd3b006-0451-45ec-a33b-161bb0feeee5
2019-01-03 15:30:33,652 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.p.ChannelAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get tech channel  bind result RoutingResult(queueId=null, robotId=null, agentUserId=null)
2019-01-03 15:30:33,680 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:30:33 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:30:33,682 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:30:33,683 INFO  [http-nio-8899-exec-2]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:30:33 CST 2019.
2019-01-03 15:30:33,687 INFO  [http-nio-8899-exec-2]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:30:33,690 INFO  [http-nio-8899-exec-6]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:30:33,725 INFO  [http-nio-8899-exec-10]  c.e.w.r.m.i.TimeOffDutyInternalController - begin to query dateTime Thu Jan 03 15:30:33 CST 2019 is timeoffduty for tenant 4, schedule 0.
2019-01-03 15:30:33,726 INFO  [http-nio-8899-exec-10]  c.e.w.service.impl.ScheduleService - tenant 4 schedule 0 is not legal, will use system schedule:4
2019-01-03 15:30:33,727 INFO  [http-nio-8899-exec-10]  c.e.w.service.impl.ScheduleService - begin to judge isZoneDateOffDuty for tenant:4, schedule:4, zoneDate:Thu Jan 03 15:30:33 CST 2019.
2019-01-03 15:30:33,731 INFO  [http-nio-8899-exec-10]  c.e.w.r.m.i.TimeOffDutyInternalController - get tenant 4 schedule 0 istimeoffduty result:false
2019-01-03 15:30:33,732 INFO  [http-nio-8899-exec-6]  c.e.w.s.t.OriginBindingService - OriginBinding isRoutewayBindTypeWithDutyType tenantId:4,dutyType:Allday,timeScheduleId:0,isTimeOffDuty:false
2019-01-03 15:30:33,732 INFO  [http-nio-8899-exec-6]  c.e.w.s.r.p.OriginAssignRoutingPolicy - ServiceSessionId null,tenantId 4 ,get origin bind result RoutingResult(queueId=null, robotId=83886084, agentUserId=null)
2019-01-03 15:30:33,736 INFO  [http-nio-8899-exec-6]  c.e.w.s.routing.RoutingPolicyManager - get prioritized id from tenant 4, matched queeue id is 4, ServiceSessionId null, matched robot id is 83886084
2019-01-03 15:30:33,736 INFO  [http-nio-8899-exec-6]  c.e.w.s.routing.RoutingPolicyService - get RoutingResult by getRoutingResultByRobotParmeter queueId=4,robotId=83886084,agentUserId=null
2019-01-03 15:30:33,795 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Response is HTTP/1.1 400 Bad Request
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:30:33 GMT
server: Apache-Coyote/1.1
transfer-encoding: chunked
x-application-context: KefuRobotIntegration:8999

feign.Response$InputStreamBody@6c86fdb 
2019-01-03 15:30:33,796 WARN  [hystrix-KefuRobotIntegration-49]  c.e.w.s.r.f.RobotFeignClientConfiguration - RobotIntegrationFeignClient#getRobotByRobotRouteIdFromIntegration(int,String) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_ROBOT_INTEGRATION_0011","errorDescription":"robot not exist"} 
2019-01-03 15:30:33,798 ERROR [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationService - getRobotByRobotRouteIdFromIntegration fail, tenantId : 83886084, robotRouteId : 83886084
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:30:33,799 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefe robot tenantId 83886084,  robotId 83886084
2019-01-03 15:30:33,799 INFO  [http-nio-8899-exec-12]  c.e.w.s.r.KefuRobotIntegrationUtil -  go into is kefu robot tenantId 83886084,  robotId 83886084, kefuRobotEnable is false
2019-01-03 15:30:33,801 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Response is HTTP/1.1 400
connection: close
content-type: application/json;charset=UTF-8
date: Thu, 03 Jan 2019 07:30:32 GMT
transfer-encoding: chunked
x-application-context: KefuLiteWebapp:production,special,client,management,cassandra,kafka,mysql,rabbitmq,redis,elasticsearch,agent-state,authentication,kafka-bridge,kafka-stream,main,message-center,notification,official-account,session-attributes,system-message,verification-code,time-plan,processing-session,enquiry,webim,quality,session-history,permission,waiting-session,robot,timeout,tenantapp,webhook,media,tickets,rules-engine:8899

feign.Response$InputStreamBody@fb7aa1e 
2019-01-03 15:30:33,801 WARN  [hystrix-KefuLiteWebapp-45]  c.e.w.s.r.f.RobotFeignClientConfiguration - WebAppReadOnlyFeignClient#getRobotUserByTenantId(Integer) encounter error. Body is {"status":"FAIL","errorCode":"KEFU_951","errorDescription":"no available robot"} 
2019-01-03 15:30:33,802 ERROR [http-nio-8899-exec-5]  c.e.w.r.e.GlobalExceptionHandler - handle exception
com.netflix.hystrix.exception.HystrixBadRequestException: Bad request.
	at com.easemob.weichat.service.robot.feign.RobotFeignClientConfiguration.lambda$feignErrorDecoder$0(RobotFeignClientConfiguration.java:35)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:138)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:76)
	at feign.hystrix.HystrixInvocationHandler$1.run(HystrixInvocationHandler.java:108)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:301)
	at com.netflix.hystrix.HystrixCommand$2.call(HystrixCommand.java:297)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:46)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:51)
	at rx.internal.operators.OnSubscribeDefer.call(OnSubscribeDefer.java:35)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:41)
	at rx.internal.operators.OnSubscribeDoOnEach.call(OnSubscribeDoOnEach.java:30)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:48)
	at rx.internal.operators.OnSubscribeLift.call(OnSubscribeLift.java:30)
	at rx.Observable.unsafeSubscribe(Observable.java:10211)
	at rx.internal.operators.OperatorSubscribeOn$1.call(OperatorSubscribeOn.java:94)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:56)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction$1.call(HystrixContexSchedulerAction.java:47)
	at com.netflix.hystrix.strategy.concurrency.HystrixContexSchedulerAction.call(HystrixContexSchedulerAction.java:69)
	at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.easemob.weichat.models.exception.EasemobFeignException: null
	... 33 common frames omitted
2019-01-03 15:30:34,846 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:34,863 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:36,852 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:36,870 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:38,856 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:38,875 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:40,880 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:40,901 INFO  [consumer-kf:schedule:signal:a-7-thread-3]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:30 start
2019-01-03 15:30:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:30
2019-01-03 15:30:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:30 complete
2019-01-03 15:30:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:30:42,849 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:42,865 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:44,843 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:44,867 INFO  [consumer-kf:schedule:signal:a-7-thread-26]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:46,857 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:46,878 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:49,842 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:49,858 INFO  [consumer-kf:schedule:signal:a-7-thread-22]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:50,854 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:50,876 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:53,844 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:53,863 INFO  [consumer-kf:schedule:signal:a-7-thread-11]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:54,963 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:54,986 INFO  [consumer-kf:schedule:signal:a-7-thread-47]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:56,859 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:56,879 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:30:58,850 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:30:58,866 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:00,854 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:00,872 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:31 start
2019-01-03 15:31:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:31
2019-01-03 15:31:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:31 complete
2019-01-03 15:31:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:31:02,842 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:02,862 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:04,843 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:04,860 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:06,820 INFO  [kf-webapp-scheduler-pool-5]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:31:06,822 INFO  [kf-webapp-scheduler-pool-5]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:31:06,902 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:06,926 INFO  [consumer-kf:schedule:signal:a-7-thread-35]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:08,838 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:08,861 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:10,853 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:10,873 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:12,853 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:12,875 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:14,850 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:14,874 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:16,737 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"8e510160-0f29-11e9-ae78-a7e8ab0daada","type":"com.easemob.weichat.service.timeout.event.TimeoutNotifyEvent","timestamp":1546500676726,"body":{"source":{},"timestamp":1546500676725,"actor":null,"version":"1.1","key":"200175ef-5064-40bf-a836-667a8c2b4050","type":"AGENT","startTime":1546500496699,"duration":180,"businessObj":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":3,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"msg":"北京","type":"txt"}],"ext":{"weichat":{"msgId":"0c031763-d6e9-4d29-9e9c-8e7fe01d67e0","originType":"webim","visitor":null,"agent":null,"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"webim-visitor-632PMQ9WCH9BHBWP3MPG","to":"kefuchannelimid_569839","channelType":"easemob","timestamp":1546500437462,"tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","to_jid":"9900181204028764#kefuchannelapp4_kefuchannelimid_569839@easemob.com","msg_id":"553774346338828692","channel_id":16,"channel_name":"网站"},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500437484,"timestamp":1546500437000,"createMicroTimestamp":1546500437484000},"techChannelType":"easemob","originType":"webim","expire":true},"notifyCount":0,"endTime":1546500676725}} has been send to kafka with in topic timeout-events-out partition 11, current offset is 24
2019-01-03 15:31:16,744 INFO  [kafka-timeout-events-out-consumer-5-thread-2]  c.e.w.r.t.l.TimeoutNotifyEventListener - AgentTimeoutNotification is got by TimeoutNotifyEventListener, TimeoutNotifyEvent is {"source":{},"timestamp":1546500676736,"actor":null,"version":"1.1","topic":"timeout-events-out","key":"200175ef-5064-40bf-a836-667a8c2b4050","type":"AGENT","startTime":1546500496699,"duration":180,"endTime":1546500676725,"deviation":0.026,"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":4,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","agentType":1,"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500496881,"timestamp":1546500497000,"createMicroTimestamp":1546500496881000},"techChannelType":"easemob","originType":"webim","expire":true}}
2019-01-03 15:31:16,748 INFO  [kafka-timeout-events-out-consumer-5-thread-2]  c.e.w.s.t.SendTimeoutNotificationService - agent timeout, send reminder to agent by TimeoutService, sessionId 200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:31:16,754 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:cb116bfb-fb5e-4bf1-92fe-7c2edec149e6 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"ServiceSessionAgentReplyTimeout","body":{"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}}],"timestamp":1546500676750,"type":null}
2019-01-03 15:31:16,755 INFO  [SimpleAsyncTaskExecutor-15]  c.e.w.n.service.PushDataService - prepare message noticeId:cb116bfb-fb5e-4bf1-92fe-7c2edec149e6 messageType:ServiceSessionAgentReplyTimeout path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:31:16,755 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"8e54aae0-0f29-11e9-bb1f-ed57e701cc19","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500676750,"body":{"source":{},"timestamp":1546500676749,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"ServiceSessionAgentReplyTimeout","body":{"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}}],"broadcast":false}}} has been send to kafka with in topic events partition 5, current offset is 2105
2019-01-03 15:31:16,756 INFO  [kafka-timeout-events-out-consumer-5-thread-2]  c.e.w.s.t.SendTimeoutNotificationService - agent timeout, send reminder to visitor by TimeoutService, sessionId 200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:31:16,758 WARN  [pool-30-thread-8]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=8e54aae0-0f29-11e9-bb1f-ed57e701cc19, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500676750, properties={}, body={source={}, timestamp=1546500676749, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=ServiceSessionAgentReplyTimeout, body={serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:31:16,758 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:cb116bfb-fb5e-4bf1-92fe-7c2edec149e6 messageType:ServiceSessionAgentReplyTimeout
2019-01-03 15:31:16,761 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:cb116bfb-fb5e-4bf1-92fe-7c2edec149e6
2019-01-03 15:31:16,763 INFO  [kafka-timeout-events-out-consumer-5-thread-2]  c.e.w.s.o.OfficialAccountClientService - getSessionOfficialAccount tenantId:4 officialAccountId:200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:31:16,814 INFO  [http-nio-8899-exec-6]  c.e.w.o.c.OfficialAccountInternalController - GET /v5/tenants/4/sessions/200175ef-5064-40bf-a836-667a8c2b4050/official-accounts
2019-01-03 15:31:16,844 INFO  [kafka-timeout-events-out-consumer-5-thread-2]  c.e.w.s.o.OfficialAccountClientService - createOfficialAccountMessage tenantId:4 officialAccountId:2537428a-00b2-4076-9967-7b06e4e0ee48 visitorId:12e26dbf-dc23-431e-a5b1-526e18d4a399 messageId:ce79a219-de5f-49a8-9c49-142eb5ca24a2
2019-01-03 15:31:16,845 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"cb116bfb-fb5e-4bf1-92fe-7c2edec149e6"}
2019-01-03 15:31:16,846 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:cb116bfb-fb5e-4bf1-92fe-7c2edec149e6
2019-01-03 15:31:16,878 INFO  [http-nio-8899-exec-14]  c.e.w.o.c.OfficialAccountInternalController - POST /v5/tenants/4/official-accounts/2537428a-00b2-4076-9967-7b06e4e0ee48/official-account-messages body:{"visitorId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","messageId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}
2019-01-03 15:31:16,893 INFO  [SimpleAsyncTaskExecutor-4284]  c.e.w.h.l.ServiceSessionHistoryListener - handleServiceSessionMessageEvent event:ServiceSessionMessageEvent{message=ChatMessage(msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@67f5c67d], ext={weichat=KefuExtMessage(msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, originType=WEBIM, visitor=null, agent=ExtAgent(userNicename=紫金财产保险, avatar=null, agentNumber=null, userId=null, trueName=null), queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, serviceSession=null, language=zh-CN, htmlSafeBody=ExtHtmlSafeBody(type=txt, msg=先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！), msgIdForAck=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ackForMsgId=null, recallFlag=null, recallMsgId=null, officialAccount=OfficialAccountData(officialAccountId=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, scheduleInfo=OfficialAccountData.ScheduleInfo(skillgroupId=null, agentId=null)), marketing=null, reserveQueue=null, matchFlag=null)}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=48, sessionServiceSeqId=5, createDateTime=2019-01-03 15:31:16.763, timestamp=1546500676763, createMicroTimestamp=1546500676763000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Processing, chatGroupId=111, messageSeqId=4, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=2019-01-03 15:28:16.547, stopDateTime=null, createDatetime=2019-01-03 15:27:11.298, lastChatMessage=ChatMessage(msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:16.881, timestamp=1546500497000, createMicroTimestamp=1546500496881000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:31:16,895 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"8e6a07a0-0f29-11e9-9e06-353686937144","type":"com.easemob.weichat.service.events.ServiceSessionMessageEvent","timestamp":1546500676890,"body":{"timestamp":1546500676890,"version":"1.1","tenantId":4,"message":{"msgId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！","type":"txt"}],"ext":{"weichat":{"msgId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！"},"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":48,"sessionServiceSeqId":5,"createDateTime":1546500676763,"timestamp":1546500676763,"createMicroTimestamp":1546500676763000},"serviceSession":{"tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","techChannelId":16,"visitorUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"queueId":14,"robotId":0,"state":"Processing","chatGroupId":111,"messageSeqId":4,"agentUserId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","agentUserType":1,"startDateTime":"2019-01-03 15:28:16","createDatetime":"2019-01-03 15:27:11","lastChatMessage":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","tenantId":4,"chatGroupId":0,"messageType":"ChatMessage","contentType":"application/easemob-msg","body":{"bodies":[{"action":"ServiceSessionOpenedEvent","type":"cmd"}],"ext":{"weichat":{"msgId":"083cb5f3-8d6f-47a8-9000-b7acc2fbcce5","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":{"eventName":"ServiceSessionOpenedEvent","eventObj":{"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentUserNiceName":"测试","avatar":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","agentType":1,"sessionId":"200175ef-5064-40bf-a836-667a8c2b4050"}},"metadata":null,"callcenter":null,"language":null,"marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":null,"ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":0,"sessionServiceSeqId":0,"createDateTime":1546500496881,"timestamp":1546500497000,"createMicroTimestamp":1546500496881000},"techChannelType":"easemob","originType":"webim","expire":true}}} has been send to kafka with in topic events partition 11, current offset is 1912
2019-01-03 15:31:16,901 INFO  [kafka-timeout-events-out-consumer-5-thread-2]  c.e.w.s.t.SendTimeoutNotificationService - agent timeout, send alarm event to monitor panel, sessionId 200175ef-5064-40bf-a836-667a8c2b4050
2019-01-03 15:31:16,901 INFO  [kafka-events-consumer-1-thread-17]  c.e.w.r.e.e.RulesEngineReleatedEventConsumer - convert to ServiceSessionMessageEvent ServiceSessionMessageEvent{message=ChatMessage(msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser=User(tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险), toUser=User(tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG), contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobTxtMessageBody@67f5c67d], ext={weichat={msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！}, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=48, sessionServiceSeqId=5, createDateTime=2019-01-03 15:31:16.763, timestamp=1546500676763, createMicroTimestamp=1546500676763000), serviceSession=ServiceSession(tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser=VisitorUser(username=null, techChannelType=null, techChannelId=null, techChannelInfo=null, uri=null, chatGroupId=null, trueName=null, sex=0, qq=null, email=null, phone=null, companyName=null, description=null, weixin=null, createDateTime=null, lastUpdateDateTime=null, sendMessageCount=0), queueId=14, robotId=0, chatRoomId=null, state=Processing, chatGroupId=111, messageSeqId=4, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=Thu Jan 03 15:28:16 CST 2019, stopDateTime=null, createDatetime=Thu Jan 03 15:27:11 CST 2019, lastChatMessage=ChatMessage(msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=0, sessionServiceId=null, messageType=ChatMessage, fromUser=null, toUser=null, contentType=application/easemob-msg, body=EasemobMessage(bodies=[com.easemob.weichat.models.message.EasemobCmdMessageBody@5603deb0], ext={weichat={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, toJid=null, channelType=IM, timestamp=null, msgId=null, channelId=16, channelName=null, ignoreExistingCheck=null, tenantId=4, serviceSessionId=null, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=WEBIM), chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=2019-01-03 15:28:16.881, timestamp=1546500497000, createMicroTimestamp=1546500496881000), techChannelType=easemob, firstMessage=null, originType=WEBIM, expire=true), sendTime=null}
2019-01-03 15:31:16,902 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"8e6b6730-0f29-11e9-9794-194fd3ff6f1e","type":"com.easemob.weichat.service.events.QueueMessageEvent","timestamp":1546500676899,"body":{"source":{},"timestamp":1546500676898,"actor":null,"version":"1.1","queueMessageData":{"userPK":{"tenantId":4,"userId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a"},"messages":[{"messageType":"NewChatMessage","body":{"msgId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！","type":"txt"}],"ext":{"weichat":{"msgId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":null,"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":48,"sessionServiceSeqId":5,"createDateTime":1546500676763,"timestamp":1546500676763,"createMicroTimestamp":1546500676763000}}],"broadcast":false}}} has been send to kafka with in topic events partition 14, current offset is 2253
2019-01-03 15:31:16,903 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:ed2ba8b3-40d5-4ad0-9f19-c991b82128c9 message:{"path":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a","key":null,"payload":[{"messageType":"NewChatMessage","body":{"msgId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","tenantId":4,"chatGroupId":111,"sessionServiceId":"200175ef-5064-40bf-a836-667a8c2b4050","messageType":"ChatMessage","fromUser":{"tenantId":0,"userId":"_2","userType":"Scheduler","userScope":"Tenant","nicename":"紫金财产保险","status":"Disable","bizId":"0","roles":"","scope":"Tenant"},"toUser":{"tenantId":4,"userId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","userType":"Visitor","userScope":"Tenant","nicename":"webim-visitor-632PMQ9WCH9BHBWP3MPG","sex":0,"sendMessageCount":0,"roles":"visitor","status":"Disable","bizId":"4","scope":"Tenant"},"contentType":"application/easemob-msg","body":{"bodies":[{"msg":"先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！","type":"txt"}],"ext":{"weichat":{"msgId":"ce79a219-de5f-49a8-9c49-142eb5ca24a2","originType":"webim","visitor":null,"agent":{"avatar":null,"agentNumber":null,"userId":null,"trueName":null,"userNickname":"紫金财产保险"},"queueId":null,"queueName":null,"agentUsername":null,"ctrlType":null,"ctrlArgs":null,"event":null,"metadata":null,"callcenter":null,"language":"zh-CN","marketing":null,"service_session":null,"html_safe_body":{"type":"txt","msg":"先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！"},"msg_id_for_ack":"e14a72e6-fc1f-43ef-9255-e4d25a39fb1b","ack_for_msg_id":null,"recall_flag":null,"recall_msg_id":null,"official_account":{"official_account_id":"2537428a-00b2-4076-9967-7b06e4e0ee48","name":"紫金财产保险股份有限公司","type":"SYSTEM","img":"//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300","schedule_info":{}},"reserve_queue":null,"match_flag":null}},"from":"紫金财产保险","to":"webim-visitor-632PMQ9WCH9BHBWP3MPG","channelType":"easemob","tenantId":4,"visitorUserId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","originType":"webim","channel_id":16},"chatGroupSeqId":48,"sessionServiceSeqId":5,"createDateTime":1546500676763,"timestamp":1546500676763,"createMicroTimestamp":1546500676763000}}],"timestamp":1546500676899,"type":null}
2019-01-03 15:31:16,904 INFO  [SimpleAsyncTaskExecutor-13]  c.e.w.n.service.PushDataService - prepare message noticeId:ed2ba8b3-40d5-4ad0-9f19-c991b82128c9 messageType:NewChatMessage path:/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a
2019-01-03 15:31:16,905 WARN  [pool-30-thread-6]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=8e6b6730-0f29-11e9-9794-194fd3ff6f1e, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500676899, properties={}, body={source={}, timestamp=1546500676898, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=NewChatMessage, body={msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！, type=txt}], ext={weichat={msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！}, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=48, sessionServiceSeqId=5, createDateTime=1546500676763, timestamp=1546500676763, createMicroTimestamp=1546500676763000}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:31:16,906 WARN  [pool-30-thread-9]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=8e6a07a0-0f29-11e9-9e06-353686937144, service=null, type=com.easemob.weichat.service.events.ServiceSessionMessageEvent, timestamp=1546500676890, properties={}, body={timestamp=1546500676890, version=1.1, tenantId=4, message={msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, tenantId=4, chatGroupId=111, sessionServiceId=200175ef-5064-40bf-a836-667a8c2b4050, messageType=ChatMessage, fromUser={tenantId=0, userId=_2, userType=Scheduler, userScope=Tenant, nicename=紫金财产保险, status=Disable, bizId=0, roles=, scope=Tenant}, toUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, contentType=application/easemob-msg, body={bodies=[{msg=先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！, type=txt}], ext={weichat={msgId=ce79a219-de5f-49a8-9c49-142eb5ca24a2, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event=null, metadata=null, callcenter=null, language=zh-CN, marketing=null, service_session=null, html_safe_body={type=txt, msg=先生/女士，您好。我们人工客服全忙，请您耐心等待，稍后会有人工客服为您服务哟！}, msg_id_for_ack=e14a72e6-fc1f-43ef-9255-e4d25a39fb1b, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=48, sessionServiceSeqId=5, createDateTime=1546500676763, timestamp=1546500676763, createMicroTimestamp=1546500676763000}, serviceSession={tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, techChannelId=16, visitorUser={tenantId=4, userId=12e26dbf-dc23-431e-a5b1-526e18d4a399, userType=Visitor, userScope=Tenant, nicename=webim-visitor-632PMQ9WCH9BHBWP3MPG, sex=0, sendMessageCount=0, roles=visitor, status=Disable, bizId=4, scope=Tenant}, queueId=14, robotId=0, state=Processing, chatGroupId=111, messageSeqId=4, agentUserId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, agentUserType=1, startDateTime=2019-01-03 15:28:16, createDatetime=2019-01-03 15:27:11, lastChatMessage={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, tenantId=4, chatGroupId=0, messageType=ChatMessage, contentType=application/easemob-msg, body={bodies=[{action=ServiceSessionOpenedEvent, type=cmd}], ext={weichat={msgId=083cb5f3-8d6f-47a8-9000-b7acc2fbcce5, originType=webim, visitor=null, agent={avatar=null, agentNumber=null, userId=null, trueName=null, userNickname=紫金财产保险}, queueId=null, queueName=null, agentUsername=null, ctrlType=null, ctrlArgs=null, event={eventName=ServiceSessionOpenedEvent, eventObj={userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentUserNiceName=测试, avatar=//kefurobottest.zking.com/v1/tenants/4/mediafiles/dfac96a9-f4e5-492b-8423-984a175fdc69bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, agentType=1, sessionId=200175ef-5064-40bf-a836-667a8c2b4050}}, metadata=null, callcenter=null, language=null, marketing=null, service_session=null, html_safe_body=null, msg_id_for_ack=null, ack_for_msg_id=null, recall_flag=null, recall_msg_id=null, official_account={official_account_id=2537428a-00b2-4076-9967-7b06e4e0ee48, name=紫金财产保险股份有限公司, type=SYSTEM, img=//kefurobottest.zking.com/v1/tenants/4/mediafiles/47a6fde8-9bdd-4be2-9108-30b9a552da66bG9nbzIucG5n/cutout?arg=0_0_200_200_300_300, schedule_info={}}, reserve_queue=null, match_flag=null}}, from=紫金财产保险, to=webim-visitor-632PMQ9WCH9BHBWP3MPG, channelType=easemob, tenantId=4, visitorUserId=12e26dbf-dc23-431e-a5b1-526e18d4a399, originType=webim, channel_id=16}, chatGroupSeqId=0, sessionServiceSeqId=0, createDateTime=1546500496881, timestamp=1546500497000, createMicroTimestamp=1546500496881000}, techChannelType=easemob, originType=webim, expire=true}}, topic=events, partitionKey=200175ef-5064-40bf-a836-667a8c2b4050).
2019-01-03 15:31:16,907 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:ed2ba8b3-40d5-4ad0-9f19-c991b82128c9 messageType:NewChatMessage
2019-01-03 15:31:16,909 INFO  [kafka-producer-network-thread | producer-1]  c.e.w.s.e.k.p.KafkaEventProducer - event {"id":"8e6c2a80-0f29-11e9-8711-5b1230262da6","type":"com.easemob.weichat.service.events.alarm.AgentTimeoutAlarmEvent","timestamp":1546500676904,"body":{"source":{},"timestamp":1546500676903,"actor":null,"version":"1.1","tenantId":4,"serviceSessionId":"200175ef-5064-40bf-a836-667a8c2b4050","ruleName":"客服超时未回复","agentId":"aee4969c-c4a9-44d9-a1ba-453a07ac137a","agentName":"测试","visitorId":"12e26dbf-dc23-431e-a5b1-526e18d4a399","visitorName":"webim-visitor-632PMQ9WCH9BHBWP3MPG","alarmDatetime":1546500676903,"monitorLevel":"3","content":null}} has been send to kafka with in topic events partition 13, current offset is 2027
2019-01-03 15:31:16,909 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:ed2ba8b3-40d5-4ad0-9f19-c991b82128c9
2019-01-03 15:31:16,915 WARN  [pool-30-thread-7]  c.e.w.callback.service.CallbackJob - Ignore event data. no hook defined within tenantId 4. event BaseEvent(id=8e6c2a80-0f29-11e9-8711-5b1230262da6, service=null, type=com.easemob.weichat.service.events.alarm.AgentTimeoutAlarmEvent, timestamp=1546500676904, properties={}, body={source={}, timestamp=1546500676903, actor=null, version=1.1, tenantId=4, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, ruleName=客服超时未回复, agentId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentName=测试, visitorId=12e26dbf-dc23-431e-a5b1-526e18d4a399, visitorName=webim-visitor-632PMQ9WCH9BHBWP3MPG, alarmDatetime=1546500676903, monitorLevel=3, content=null}, topic=events, partitionKey=null).
2019-01-03 15:31:16,948 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - Get message from redis/mq noticeId:292381d5-c4f3-4f33-a944-5dff0fd22915 message:{"path":"/tenants/4/agents","key":null,"payload":[{"messageType":"MonitorAlarm"}],"timestamp":1546500677039,"type":null}
2019-01-03 15:31:16,948 INFO  [SimpleAsyncTaskExecutor-9]  c.e.w.n.service.PushDataService - prepare message noticeId:292381d5-c4f3-4f33-a944-5dff0fd22915 messageType:MonitorAlarm path:/tenants/4/agents
2019-01-03 15:31:16,950 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - receive message from mq wsId:xjpxh544 noticeId:292381d5-c4f3-4f33-a944-5dff0fd22915 messageType:MonitorAlarm
2019-01-03 15:31:16,950 INFO  [SimpleAsyncTaskExecutor-1]  c.e.w.n.service.AmqpService - acknowledged message to mq wsId:xjpxh544 noticeId:292381d5-c4f3-4f33-a944-5dff0fd22915
2019-01-03 15:31:16,952 WARN  [pool-30-thread-3]  c.e.w.callback.service.CallbackJob - No tenant id event found. data BaseEvent(id=8e80eb00-0f29-11e9-928a-ffd92e227533, service=null, type=com.easemob.weichat.service.events.QueueMessageEvent, timestamp=1546500677040, properties={}, body={source={}, timestamp=1546500677040, actor=null, version=1.1, queueMessageData={userPK={tenantId=4, userId=aee4969c-c4a9-44d9-a1ba-453a07ac137a}, messages=[{messageType=MonitorAlarm, body={id=539c0de7-58c4-47fa-8060-6f66144aa0da, tenantId=4, monitorLevel=3, serviceSessionId=200175ef-5064-40bf-a836-667a8c2b4050, agentId=aee4969c-c4a9-44d9-a1ba-453a07ac137a, agentName=测试, visitorId=12e26dbf-dc23-431e-a5b1-526e18d4a399, visitorName=webim-visitor-632PMQ9WCH9BHBWP3MPG, ruleName=客服超时未回复, alarmDateTime=1546500676903, content=null}}], broadcast=false}}, topic=events, partitionKey=null)
2019-01-03 15:31:17,894 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:17,896 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"ed2ba8b3-40d5-4ad0-9f19-c991b82128c9"}
2019-01-03 15:31:17,896 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:ed2ba8b3-40d5-4ad0-9f19-c991b82128c9
2019-01-03 15:31:17,917 INFO  [consumer-kf:schedule:signal:a-7-thread-49]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:19,848 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"noticeId":"292381d5-c4f3-4f33-a944-5dff0fd22915"}
2019-01-03 15:31:19,848 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - get ack from websocket wsId:xjpxh544 noticeId:292381d5-c4f3-4f33-a944-5dff0fd22915
2019-01-03 15:31:20,846 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:20,870 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:21,859 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:21,880 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:31 start
2019-01-03 15:31:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:31
2019-01-03 15:31:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:31 complete
2019-01-03 15:31:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:31:22,880 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:22,900 INFO  [consumer-kf:schedule:signal:a-7-thread-9]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:24,854 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:24,885 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:26,848 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:26,883 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:27,782 INFO  [kf-webapp-scheduler-pool-11]  c.e.w.r.e.p.RuleSetPreProcessor - refreshWaitingQueueRuleSetCache cost time 5ms
2019-01-03 15:31:28,863 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:28,884 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:30,860 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:30,879 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:32,837 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:32,858 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:34,854 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:34,878 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:36,860 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:36,879 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:38,845 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:38,867 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:40,850 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:40,870 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:42,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:31 start
2019-01-03 15:31:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:31
2019-01-03 15:31:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:31 complete
2019-01-03 15:31:42,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:31:42,843 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:42,863 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:45,851 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:45,876 INFO  [consumer-kf:schedule:signal:a-7-thread-16]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:46,862 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:46,888 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:48,878 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:48,901 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:50,853 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:50,886 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:52,915 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:52,942 INFO  [consumer-kf:schedule:signal:a-7-thread-50]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:54,849 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:54,875 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:56,847 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:56,867 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:31:58,852 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:31:58,880 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:00,859 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:00,882 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:02,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:32 start
2019-01-03 15:32:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:32
2019-01-03 15:32:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:32 complete
2019-01-03 15:32:02,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:32:02,843 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:02,863 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:04,846 INFO  [http-nio-8899-exec-2]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:04,871 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:06,828 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - schedule to check tenants maybe send sms,tenants size is 0
2019-01-03 15:32:06,829 INFO  [kf-webapp-scheduler-pool-6]  c.e.w.s.q.s.s.ScheduledShortMessageRemindAgentService - sms remind timer thread is running.
2019-01-03 15:32:06,867 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:06,887 INFO  [consumer-kf:schedule:signal:a-7-thread-39]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:08,897 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:08,920 INFO  [consumer-kf:schedule:signal:a-7-thread-41]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:11,852 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:11,876 INFO  [consumer-kf:schedule:signal:a-7-thread-31]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:12,861 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:12,885 INFO  [consumer-kf:schedule:signal:a-7-thread-9]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:14,866 INFO  [http-nio-8899-exec-9]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:14,887 INFO  [consumer-kf:schedule:signal:a-7-thread-48]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:16,848 INFO  [http-nio-8899-exec-3]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:16,869 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:18,860 INFO  [http-nio-8899-exec-13]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:18,886 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:20,852 INFO  [http-nio-8899-exec-10]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:20,874 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:22,565 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:32 start
2019-01-03 15:32:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.r.r.ServiceSessionQueueRedisRepository - get 0 timers from redisKey kf:service:session:queue:03 15:32
2019-01-03 15:32:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - getTimeoutTimerMapFromRedis from redisKey 03 15:32 complete
2019-01-03 15:32:22,567 INFO  [pool-18-thread-1]  c.e.w.s.q.l.ServiceSessionQueueTimerScanTask - Service session queue timer scan task thread is running.
2019-01-03 15:32:22,858 INFO  [http-nio-8899-exec-6]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:22,880 INFO  [consumer-kf:schedule:signal:a-7-thread-33]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:24,885 INFO  [http-nio-8899-exec-12]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:24,941 INFO  [consumer-kf:schedule:signal:a-7-thread-20]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:26,862 INFO  [http-nio-8899-exec-5]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:26,881 INFO  [consumer-kf:schedule:signal:a-7-thread-21]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:28,854 INFO  [http-nio-8899-exec-14]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:28,875 INFO  [consumer-kf:schedule:signal:a-7-thread-40]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
2019-01-03 15:32:30,848 INFO  [http-nio-8899-exec-15]  c.e.w.n.s.f.i.AuthorisedSessionFSM - AuthorisedSessionFSM wsId:xjpxh544 handleMessage:{"keepalive":"/tenants/4/agents/aee4969c-c4a9-44d9-a1ba-453a07ac137a/1546500489296"}
2019-01-03 15:32:30,870 INFO  [consumer-kf:schedule:signal:a-7-thread-36]  c.e.w.s.a.schedule.ScheduleWorker - schedule worker tenantId:4 queueId:14 byA:aee4969c-c4a9-44d9-a1ba-453a07ac137a toA:["aee4969c-c4a9-44d9-a1ba-453a07ac137a"] s1:[] s2:[]
